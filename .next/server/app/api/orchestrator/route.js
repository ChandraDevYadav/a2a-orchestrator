"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/orchestrator/route";
exports.ids = ["app/api/orchestrator/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_Chan_Dra_Dev_AtoA_Protocol_A2_Quiz_quiz_frontend_src_app_api_orchestrator_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/orchestrator/route.ts */ \"(rsc)/./src/app/api/orchestrator/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/orchestrator/route\",\n        pathname: \"/api/orchestrator\",\n        filename: \"route\",\n        bundlePath: \"app/api/orchestrator/route\"\n    },\n    resolvedPagePath: \"D:\\\\Chan Dra Dev\\\\AtoA_Protocol\\\\A2\\\\Quiz\\\\quiz-frontend\\\\src\\\\app\\\\api\\\\orchestrator\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Chan_Dra_Dev_AtoA_Protocol_A2_Quiz_quiz_frontend_src_app_api_orchestrator_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/orchestrator/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZvcmNoZXN0cmF0b3IlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm9yY2hlc3RyYXRvciUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRm9yY2hlc3RyYXRvciUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDQ2hhbiUyMERyYSUyMERldiU1Q0F0b0FfUHJvdG9jb2wlNUNBMiU1Q1F1aXolNUNxdWl6LWZyb250ZW5kJTVDc3JjJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1EJTNBJTVDQ2hhbiUyMERyYSUyMERldiU1Q0F0b0FfUHJvdG9jb2wlNUNBMiU1Q1F1aXolNUNxdWl6LWZyb250ZW5kJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUMrQztBQUM1SDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3F1aXotZnJvbnRlbmQvP2FhZjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcQ2hhbiBEcmEgRGV2XFxcXEF0b0FfUHJvdG9jb2xcXFxcQTJcXFxcUXVpelxcXFxxdWl6LWZyb250ZW5kXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXG9yY2hlc3RyYXRvclxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvb3JjaGVzdHJhdG9yL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvb3JjaGVzdHJhdG9yXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9vcmNoZXN0cmF0b3Ivcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxDaGFuIERyYSBEZXZcXFxcQXRvQV9Qcm90b2NvbFxcXFxBMlxcXFxRdWl6XFxcXHF1aXotZnJvbnRlbmRcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcb3JjaGVzdHJhdG9yXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9vcmNoZXN0cmF0b3Ivcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/orchestrator/route.ts":
/*!*******************************************!*\
  !*** ./src/app/api/orchestrator/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_orchestratorService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/orchestratorService */ \"(rsc)/./src/lib/orchestratorService.ts\");\n\n\n// Global orchestrator service instance\nlet orchestratorService;\n// Initialize orchestrator service\nfunction getOrchestratorService() {\n    if (!orchestratorService) {\n        orchestratorService = new _lib_orchestratorService__WEBPACK_IMPORTED_MODULE_1__.NextJSOrchestratorService();\n    }\n    return orchestratorService;\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { action, ...data } = body;\n        let result;\n        switch(action){\n            case \"discover_agents\":\n                result = await getOrchestratorService().discoverAgents(data);\n                break;\n            case \"orchestrate_quiz_workflow\":\n                result = await getOrchestratorService().orchestrateQuizWorkflow(data);\n                break;\n            case \"monitor_system_health\":\n                result = await getOrchestratorService().monitorSystemHealth(data);\n                break;\n            case \"get_chat_history\":\n                result = getOrchestratorService().getChatHistory();\n                break;\n            case \"get_workflow_chat_history\":\n                result = getOrchestratorService().getWorkflowChatHistory(data.workflowId);\n                break;\n            case \"clear_chat_history\":\n                getOrchestratorService().clearChatHistory();\n                result = {\n                    success: true\n                };\n                break;\n            case \"get_workflows\":\n                result = getOrchestratorService().getAllWorkflows();\n                break;\n            case \"get_workflow\":\n                result = getOrchestratorService().getWorkflow(data.workflowId);\n                break;\n            case \"get_agents\":\n                result = getOrchestratorService().getAllAgents();\n                break;\n            case \"get_agent\":\n                result = getOrchestratorService().getAgent(data.url);\n                break;\n            case \"determine_agent_for_query\":\n                result = getOrchestratorService().determineAgentForQuery(data.query, data.context);\n                break;\n            case \"execute_agent_with_resilience\":\n                result = await getOrchestratorService().executeAgentWithResilience(data.query, data.context);\n                break;\n            case \"handle_general_mcp_query\":\n                result = await getOrchestratorService().handleGeneralMCPQuery(data);\n                break;\n            case \"handle_centralized_request\":\n                result = await getOrchestratorService().handleCentralizedRequest(data);\n                break;\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: `Unknown action: ${action}`\n                }, {\n                    status: 400\n                });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error(\"Orchestrator API error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const action = searchParams.get(\"action\");\n        let result;\n        switch(action){\n            case \"health\":\n                result = {\n                    status: \"ok\",\n                    service: \"nextjs-orchestrator\"\n                };\n                break;\n            case \"status\":\n                result = {\n                    orchestrator: {\n                        status: \"running\",\n                        uptime: process.uptime(),\n                        memory: process.memoryUsage(),\n                        version: \"1.0.0\"\n                    },\n                    agents: {\n                        discovered: getOrchestratorService().getAllAgents().length,\n                        active: getOrchestratorService().getAllAgents().filter((a)=>a.status === \"online\").length,\n                        last_discovery: new Date().toISOString()\n                    }\n                };\n                break;\n            case \"chat_history\":\n                result = getOrchestratorService().getChatHistory();\n                break;\n            case \"workflows\":\n                result = getOrchestratorService().getAllWorkflows();\n                break;\n            case \"agents\":\n                result = getOrchestratorService().getAllAgents();\n                break;\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: `Unknown action: ${action}`\n                }, {\n                    status: 400\n                });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error(\"Orchestrator GET API error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9vcmNoZXN0cmF0b3Ivcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUF3RDtBQUNjO0FBRXRFLHVDQUF1QztBQUN2QyxJQUFJRTtBQUVKLGtDQUFrQztBQUNsQyxTQUFTQztJQUNQLElBQUksQ0FBQ0QscUJBQXFCO1FBQ3hCQSxzQkFBc0IsSUFBSUQsK0VBQXlCQTtJQUNyRDtJQUNBLE9BQU9DO0FBQ1Q7QUFFTyxlQUFlRSxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNRCxRQUFRRSxJQUFJO1FBQy9CLE1BQU0sRUFBRUMsTUFBTSxFQUFFLEdBQUdDLE1BQU0sR0FBR0g7UUFFNUIsSUFBSUk7UUFFSixPQUFRRjtZQUNOLEtBQUs7Z0JBQ0hFLFNBQVMsTUFBTVAseUJBQXlCUSxjQUFjLENBQUNGO2dCQUN2RDtZQUVGLEtBQUs7Z0JBQ0hDLFNBQVMsTUFBTVAseUJBQXlCUyx1QkFBdUIsQ0FBQ0g7Z0JBQ2hFO1lBRUYsS0FBSztnQkFDSEMsU0FBUyxNQUFNUCx5QkFBeUJVLG1CQUFtQixDQUFDSjtnQkFDNUQ7WUFFRixLQUFLO2dCQUNIQyxTQUFTUCx5QkFBeUJXLGNBQWM7Z0JBQ2hEO1lBRUYsS0FBSztnQkFDSEosU0FBU1AseUJBQXlCWSxzQkFBc0IsQ0FDdEROLEtBQUtPLFVBQVU7Z0JBRWpCO1lBRUYsS0FBSztnQkFDSGIseUJBQXlCYyxnQkFBZ0I7Z0JBQ3pDUCxTQUFTO29CQUFFUSxTQUFTO2dCQUFLO2dCQUN6QjtZQUVGLEtBQUs7Z0JBQ0hSLFNBQVNQLHlCQUF5QmdCLGVBQWU7Z0JBQ2pEO1lBRUYsS0FBSztnQkFDSFQsU0FBU1AseUJBQXlCaUIsV0FBVyxDQUFDWCxLQUFLTyxVQUFVO2dCQUM3RDtZQUVGLEtBQUs7Z0JBQ0hOLFNBQVNQLHlCQUF5QmtCLFlBQVk7Z0JBQzlDO1lBRUYsS0FBSztnQkFDSFgsU0FBU1AseUJBQXlCbUIsUUFBUSxDQUFDYixLQUFLYyxHQUFHO2dCQUNuRDtZQUVGLEtBQUs7Z0JBQ0hiLFNBQVNQLHlCQUF5QnFCLHNCQUFzQixDQUN0RGYsS0FBS2dCLEtBQUssRUFDVmhCLEtBQUtpQixPQUFPO2dCQUVkO1lBRUYsS0FBSztnQkFDSGhCLFNBQVMsTUFBTVAseUJBQXlCd0IsMEJBQTBCLENBQ2hFbEIsS0FBS2dCLEtBQUssRUFDVmhCLEtBQUtpQixPQUFPO2dCQUVkO1lBRUYsS0FBSztnQkFDSGhCLFNBQVMsTUFBTVAseUJBQXlCeUIscUJBQXFCLENBQUNuQjtnQkFDOUQ7WUFFRixLQUFLO2dCQUNIQyxTQUFTLE1BQU1QLHlCQUF5QjBCLHdCQUF3QixDQUFDcEI7Z0JBQ2pFO1lBRUY7Z0JBQ0UsT0FBT1QscURBQVlBLENBQUNPLElBQUksQ0FDdEI7b0JBQUV1QixPQUFPLENBQUMsZ0JBQWdCLEVBQUV0QixPQUFPLENBQUM7Z0JBQUMsR0FDckM7b0JBQUV1QixRQUFRO2dCQUFJO1FBRXBCO1FBRUEsT0FBTy9CLHFEQUFZQSxDQUFDTyxJQUFJLENBQUNHO0lBQzNCLEVBQUUsT0FBT29CLE9BQU87UUFDZEUsUUFBUUYsS0FBSyxDQUFDLDJCQUEyQkE7UUFDekMsT0FBTzlCLHFEQUFZQSxDQUFDTyxJQUFJLENBQ3RCO1lBQ0V1QixPQUFPQSxpQkFBaUJHLFFBQVFILE1BQU1JLE9BQU8sR0FBRztRQUNsRCxHQUNBO1lBQUVILFFBQVE7UUFBSTtJQUVsQjtBQUNGO0FBRU8sZUFBZUksSUFBSTlCLE9BQW9CO0lBQzVDLElBQUk7UUFDRixNQUFNLEVBQUUrQixZQUFZLEVBQUUsR0FBRyxJQUFJQyxJQUFJaEMsUUFBUWtCLEdBQUc7UUFDNUMsTUFBTWYsU0FBUzRCLGFBQWFFLEdBQUcsQ0FBQztRQUVoQyxJQUFJNUI7UUFFSixPQUFRRjtZQUNOLEtBQUs7Z0JBQ0hFLFNBQVM7b0JBQUVxQixRQUFRO29CQUFNUSxTQUFTO2dCQUFzQjtnQkFDeEQ7WUFFRixLQUFLO2dCQUNIN0IsU0FBUztvQkFDUDhCLGNBQWM7d0JBQ1pULFFBQVE7d0JBQ1JVLFFBQVFDLFFBQVFELE1BQU07d0JBQ3RCRSxRQUFRRCxRQUFRRSxXQUFXO3dCQUMzQkMsU0FBUztvQkFDWDtvQkFDQUMsUUFBUTt3QkFDTkMsWUFBWTVDLHlCQUF5QmtCLFlBQVksR0FBRzJCLE1BQU07d0JBQzFEQyxRQUFROUMseUJBQ0xrQixZQUFZLEdBQ1o2QixNQUFNLENBQUMsQ0FBQ0MsSUFBTUEsRUFBRXBCLE1BQU0sS0FBSyxVQUFVaUIsTUFBTTt3QkFDOUNJLGdCQUFnQixJQUFJQyxPQUFPQyxXQUFXO29CQUN4QztnQkFDRjtnQkFDQTtZQUVGLEtBQUs7Z0JBQ0g1QyxTQUFTUCx5QkFBeUJXLGNBQWM7Z0JBQ2hEO1lBRUYsS0FBSztnQkFDSEosU0FBU1AseUJBQXlCZ0IsZUFBZTtnQkFDakQ7WUFFRixLQUFLO2dCQUNIVCxTQUFTUCx5QkFBeUJrQixZQUFZO2dCQUM5QztZQUVGO2dCQUNFLE9BQU9yQixxREFBWUEsQ0FBQ08sSUFBSSxDQUN0QjtvQkFBRXVCLE9BQU8sQ0FBQyxnQkFBZ0IsRUFBRXRCLE9BQU8sQ0FBQztnQkFBQyxHQUNyQztvQkFBRXVCLFFBQVE7Z0JBQUk7UUFFcEI7UUFFQSxPQUFPL0IscURBQVlBLENBQUNPLElBQUksQ0FBQ0c7SUFDM0IsRUFBRSxPQUFPb0IsT0FBTztRQUNkRSxRQUFRRixLQUFLLENBQUMsK0JBQStCQTtRQUM3QyxPQUFPOUIscURBQVlBLENBQUNPLElBQUksQ0FDdEI7WUFDRXVCLE9BQU9BLGlCQUFpQkcsUUFBUUgsTUFBTUksT0FBTyxHQUFHO1FBQ2xELEdBQ0E7WUFBRUgsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6LWZyb250ZW5kLy4vc3JjL2FwcC9hcGkvb3JjaGVzdHJhdG9yL3JvdXRlLnRzP2I4NDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xyXG5pbXBvcnQgeyBOZXh0SlNPcmNoZXN0cmF0b3JTZXJ2aWNlIH0gZnJvbSBcIkAvbGliL29yY2hlc3RyYXRvclNlcnZpY2VcIjtcclxuXHJcbi8vIEdsb2JhbCBvcmNoZXN0cmF0b3Igc2VydmljZSBpbnN0YW5jZVxyXG5sZXQgb3JjaGVzdHJhdG9yU2VydmljZTogTmV4dEpTT3JjaGVzdHJhdG9yU2VydmljZSB8IHVuZGVmaW5lZDtcclxuXHJcbi8vIEluaXRpYWxpemUgb3JjaGVzdHJhdG9yIHNlcnZpY2VcclxuZnVuY3Rpb24gZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpOiBOZXh0SlNPcmNoZXN0cmF0b3JTZXJ2aWNlIHtcclxuICBpZiAoIW9yY2hlc3RyYXRvclNlcnZpY2UpIHtcclxuICAgIG9yY2hlc3RyYXRvclNlcnZpY2UgPSBuZXcgTmV4dEpTT3JjaGVzdHJhdG9yU2VydmljZSgpO1xyXG4gIH1cclxuICByZXR1cm4gb3JjaGVzdHJhdG9yU2VydmljZTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xyXG4gICAgY29uc3QgeyBhY3Rpb24sIC4uLmRhdGEgfSA9IGJvZHk7XHJcblxyXG4gICAgbGV0IHJlc3VsdDtcclxuXHJcbiAgICBzd2l0Y2ggKGFjdGlvbikge1xyXG4gICAgICBjYXNlIFwiZGlzY292ZXJfYWdlbnRzXCI6XHJcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmRpc2NvdmVyQWdlbnRzKGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcIm9yY2hlc3RyYXRlX3F1aXpfd29ya2Zsb3dcIjpcclxuICAgICAgICByZXN1bHQgPSBhd2FpdCBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkub3JjaGVzdHJhdGVRdWl6V29ya2Zsb3coZGF0YSk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwibW9uaXRvcl9zeXN0ZW1faGVhbHRoXCI6XHJcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLm1vbml0b3JTeXN0ZW1IZWFsdGgoZGF0YSk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiZ2V0X2NoYXRfaGlzdG9yeVwiOlxyXG4gICAgICAgIHJlc3VsdCA9IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5nZXRDaGF0SGlzdG9yeSgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImdldF93b3JrZmxvd19jaGF0X2hpc3RvcnlcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0V29ya2Zsb3dDaGF0SGlzdG9yeShcclxuICAgICAgICAgIGRhdGEud29ya2Zsb3dJZFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiY2xlYXJfY2hhdF9oaXN0b3J5XCI6XHJcbiAgICAgICAgZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmNsZWFyQ2hhdEhpc3RvcnkoKTtcclxuICAgICAgICByZXN1bHQgPSB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJnZXRfd29ya2Zsb3dzXCI6XHJcbiAgICAgICAgcmVzdWx0ID0gZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmdldEFsbFdvcmtmbG93cygpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImdldF93b3JrZmxvd1wiOlxyXG4gICAgICAgIHJlc3VsdCA9IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5nZXRXb3JrZmxvdyhkYXRhLndvcmtmbG93SWQpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImdldF9hZ2VudHNcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0QWxsQWdlbnRzKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiZ2V0X2FnZW50XCI6XHJcbiAgICAgICAgcmVzdWx0ID0gZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmdldEFnZW50KGRhdGEudXJsKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJkZXRlcm1pbmVfYWdlbnRfZm9yX3F1ZXJ5XCI6XHJcbiAgICAgICAgcmVzdWx0ID0gZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmRldGVybWluZUFnZW50Rm9yUXVlcnkoXHJcbiAgICAgICAgICBkYXRhLnF1ZXJ5LFxyXG4gICAgICAgICAgZGF0YS5jb250ZXh0XHJcbiAgICAgICAgKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJleGVjdXRlX2FnZW50X3dpdGhfcmVzaWxpZW5jZVwiOlxyXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5leGVjdXRlQWdlbnRXaXRoUmVzaWxpZW5jZShcclxuICAgICAgICAgIGRhdGEucXVlcnksXHJcbiAgICAgICAgICBkYXRhLmNvbnRleHRcclxuICAgICAgICApO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImhhbmRsZV9nZW5lcmFsX21jcF9xdWVyeVwiOlxyXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5oYW5kbGVHZW5lcmFsTUNQUXVlcnkoZGF0YSk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiaGFuZGxlX2NlbnRyYWxpemVkX3JlcXVlc3RcIjpcclxuICAgICAgICByZXN1bHQgPSBhd2FpdCBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuaGFuZGxlQ2VudHJhbGl6ZWRSZXF1ZXN0KGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgICB7IGVycm9yOiBgVW5rbm93biBhY3Rpb246ICR7YWN0aW9ufWAgfSxcclxuICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3VsdCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJPcmNoZXN0cmF0b3IgQVBJIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHtcclxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3JcIixcclxuICAgICAgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XHJcbiAgICBjb25zdCBhY3Rpb24gPSBzZWFyY2hQYXJhbXMuZ2V0KFwiYWN0aW9uXCIpO1xyXG5cclxuICAgIGxldCByZXN1bHQ7XHJcblxyXG4gICAgc3dpdGNoIChhY3Rpb24pIHtcclxuICAgICAgY2FzZSBcImhlYWx0aFwiOlxyXG4gICAgICAgIHJlc3VsdCA9IHsgc3RhdHVzOiBcIm9rXCIsIHNlcnZpY2U6IFwibmV4dGpzLW9yY2hlc3RyYXRvclwiIH07XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwic3RhdHVzXCI6XHJcbiAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgb3JjaGVzdHJhdG9yOiB7XHJcbiAgICAgICAgICAgIHN0YXR1czogXCJydW5uaW5nXCIsXHJcbiAgICAgICAgICAgIHVwdGltZTogcHJvY2Vzcy51cHRpbWUoKSxcclxuICAgICAgICAgICAgbWVtb3J5OiBwcm9jZXNzLm1lbW9yeVVzYWdlKCksXHJcbiAgICAgICAgICAgIHZlcnNpb246IFwiMS4wLjBcIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBhZ2VudHM6IHtcclxuICAgICAgICAgICAgZGlzY292ZXJlZDogZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmdldEFsbEFnZW50cygpLmxlbmd0aCxcclxuICAgICAgICAgICAgYWN0aXZlOiBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKClcclxuICAgICAgICAgICAgICAuZ2V0QWxsQWdlbnRzKClcclxuICAgICAgICAgICAgICAuZmlsdGVyKChhKSA9PiBhLnN0YXR1cyA9PT0gXCJvbmxpbmVcIikubGVuZ3RoLFxyXG4gICAgICAgICAgICBsYXN0X2Rpc2NvdmVyeTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImNoYXRfaGlzdG9yeVwiOlxyXG4gICAgICAgIHJlc3VsdCA9IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5nZXRDaGF0SGlzdG9yeSgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcIndvcmtmbG93c1wiOlxyXG4gICAgICAgIHJlc3VsdCA9IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5nZXRBbGxXb3JrZmxvd3MoKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJhZ2VudHNcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0QWxsQWdlbnRzKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgIHsgZXJyb3I6IGBVbmtub3duIGFjdGlvbjogJHthY3Rpb259YCB9LFxyXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIk9yY2hlc3RyYXRvciBHRVQgQVBJIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHtcclxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3JcIixcclxuICAgICAgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiTmV4dEpTT3JjaGVzdHJhdG9yU2VydmljZSIsIm9yY2hlc3RyYXRvclNlcnZpY2UiLCJnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlIiwiUE9TVCIsInJlcXVlc3QiLCJib2R5IiwianNvbiIsImFjdGlvbiIsImRhdGEiLCJyZXN1bHQiLCJkaXNjb3ZlckFnZW50cyIsIm9yY2hlc3RyYXRlUXVpeldvcmtmbG93IiwibW9uaXRvclN5c3RlbUhlYWx0aCIsImdldENoYXRIaXN0b3J5IiwiZ2V0V29ya2Zsb3dDaGF0SGlzdG9yeSIsIndvcmtmbG93SWQiLCJjbGVhckNoYXRIaXN0b3J5Iiwic3VjY2VzcyIsImdldEFsbFdvcmtmbG93cyIsImdldFdvcmtmbG93IiwiZ2V0QWxsQWdlbnRzIiwiZ2V0QWdlbnQiLCJ1cmwiLCJkZXRlcm1pbmVBZ2VudEZvclF1ZXJ5IiwicXVlcnkiLCJjb250ZXh0IiwiZXhlY3V0ZUFnZW50V2l0aFJlc2lsaWVuY2UiLCJoYW5kbGVHZW5lcmFsTUNQUXVlcnkiLCJoYW5kbGVDZW50cmFsaXplZFJlcXVlc3QiLCJlcnJvciIsInN0YXR1cyIsImNvbnNvbGUiLCJFcnJvciIsIm1lc3NhZ2UiLCJHRVQiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJnZXQiLCJzZXJ2aWNlIiwib3JjaGVzdHJhdG9yIiwidXB0aW1lIiwicHJvY2VzcyIsIm1lbW9yeSIsIm1lbW9yeVVzYWdlIiwidmVyc2lvbiIsImFnZW50cyIsImRpc2NvdmVyZWQiLCJsZW5ndGgiLCJhY3RpdmUiLCJmaWx0ZXIiLCJhIiwibGFzdF9kaXNjb3ZlcnkiLCJEYXRlIiwidG9JU09TdHJpbmciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/orchestrator/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/circuit-breaker.ts":
/*!************************************!*\
  !*** ./src/lib/circuit-breaker.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AgentCircuitBreaker: () => (/* binding */ AgentCircuitBreaker)\n/* harmony export */ });\n/**\r\n * Circuit Breaker Pattern for Agent Resilience\r\n * Prevents cascading failures and provides graceful degradation\r\n */ class AgentCircuitBreaker {\n    constructor(failureThreshold = 5, timeoutMs = 60000, successThreshold = 3){\n        this.breakers = new Map();\n        this.failureThreshold = failureThreshold;\n        this.timeoutMs = timeoutMs;\n        this.successThreshold = successThreshold;\n    }\n    /**\r\n   * Check if agent is available (circuit breaker allows)\r\n   */ isAgentAvailable(agentId) {\n        const breaker = this.breakers.get(agentId);\n        if (!breaker) return true; // No breaker = available\n        switch(breaker.state){\n            case \"closed\":\n                return true;\n            case \"open\":\n                // Check if timeout has passed\n                if (breaker.lastFailureTime && Date.now() - breaker.lastFailureTime.getTime() > this.timeoutMs) {\n                    breaker.state = \"half-open\";\n                    breaker.successCount = 0;\n                    return true;\n                }\n                return false;\n            case \"half-open\":\n                return true;\n            default:\n                return true;\n        }\n    }\n    /**\r\n   * Record a successful operation\r\n   */ recordSuccess(agentId) {\n        const breaker = this.breakers.get(agentId) || this.createBreaker(agentId);\n        breaker.successCount++;\n        breaker.failureCount = 0;\n        if (breaker.state === \"half-open\" && breaker.successCount >= this.successThreshold) {\n            breaker.state = \"closed\";\n        }\n    }\n    /**\r\n   * Record a failed operation\r\n   */ recordFailure(agentId) {\n        const breaker = this.breakers.get(agentId) || this.createBreaker(agentId);\n        breaker.failureCount++;\n        breaker.lastFailureTime = new Date();\n        if (breaker.failureCount >= this.failureThreshold) {\n            breaker.state = \"open\";\n        }\n    }\n    createBreaker(agentId) {\n        const breaker = {\n            state: \"closed\",\n            failureCount: 0,\n            successCount: 0\n        };\n        this.breakers.set(agentId, breaker);\n        return breaker;\n    }\n    /**\r\n   * Get circuit breaker status for monitoring\r\n   */ getStatus(agentId) {\n        return this.breakers.get(agentId) || null;\n    }\n    /**\r\n   * Reset circuit breaker (for manual intervention)\r\n   */ reset(agentId) {\n        this.breakers.delete(agentId);\n    }\n    /**\r\n   * Get all circuit breaker states\r\n   */ getAllStates() {\n        return new Map(this.breakers);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NpcmN1aXQtYnJlYWtlci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7OztDQUdDLEdBU00sTUFBTUE7SUFNWEMsWUFDRUMsbUJBQTJCLENBQUMsRUFDNUJDLFlBQW9CLEtBQUssRUFDekJDLG1CQUEyQixDQUFDLENBQzVCO2FBVE1DLFdBQTZDLElBQUlDO1FBVXZELElBQUksQ0FBQ0osZ0JBQWdCLEdBQUdBO1FBQ3hCLElBQUksQ0FBQ0MsU0FBUyxHQUFHQTtRQUNqQixJQUFJLENBQUNDLGdCQUFnQixHQUFHQTtJQUMxQjtJQUVBOztHQUVDLEdBQ0RHLGlCQUFpQkMsT0FBZSxFQUFXO1FBQ3pDLE1BQU1DLFVBQVUsSUFBSSxDQUFDSixRQUFRLENBQUNLLEdBQUcsQ0FBQ0Y7UUFDbEMsSUFBSSxDQUFDQyxTQUFTLE9BQU8sTUFBTSx5QkFBeUI7UUFFcEQsT0FBUUEsUUFBUUUsS0FBSztZQUNuQixLQUFLO2dCQUNILE9BQU87WUFDVCxLQUFLO2dCQUNILDhCQUE4QjtnQkFDOUIsSUFDRUYsUUFBUUcsZUFBZSxJQUN2QkMsS0FBS0MsR0FBRyxLQUFLTCxRQUFRRyxlQUFlLENBQUNHLE9BQU8sS0FBSyxJQUFJLENBQUNaLFNBQVMsRUFDL0Q7b0JBQ0FNLFFBQVFFLEtBQUssR0FBRztvQkFDaEJGLFFBQVFPLFlBQVksR0FBRztvQkFDdkIsT0FBTztnQkFDVDtnQkFDQSxPQUFPO1lBQ1QsS0FBSztnQkFDSCxPQUFPO1lBQ1Q7Z0JBQ0UsT0FBTztRQUNYO0lBQ0Y7SUFFQTs7R0FFQyxHQUNEQyxjQUFjVCxPQUFlLEVBQVE7UUFDbkMsTUFBTUMsVUFBVSxJQUFJLENBQUNKLFFBQVEsQ0FBQ0ssR0FBRyxDQUFDRixZQUFZLElBQUksQ0FBQ1UsYUFBYSxDQUFDVjtRQUVqRUMsUUFBUU8sWUFBWTtRQUNwQlAsUUFBUVUsWUFBWSxHQUFHO1FBRXZCLElBQ0VWLFFBQVFFLEtBQUssS0FBSyxlQUNsQkYsUUFBUU8sWUFBWSxJQUFJLElBQUksQ0FBQ1osZ0JBQWdCLEVBQzdDO1lBQ0FLLFFBQVFFLEtBQUssR0FBRztRQUNsQjtJQUNGO0lBRUE7O0dBRUMsR0FDRFMsY0FBY1osT0FBZSxFQUFRO1FBQ25DLE1BQU1DLFVBQVUsSUFBSSxDQUFDSixRQUFRLENBQUNLLEdBQUcsQ0FBQ0YsWUFBWSxJQUFJLENBQUNVLGFBQWEsQ0FBQ1Y7UUFFakVDLFFBQVFVLFlBQVk7UUFDcEJWLFFBQVFHLGVBQWUsR0FBRyxJQUFJQztRQUU5QixJQUFJSixRQUFRVSxZQUFZLElBQUksSUFBSSxDQUFDakIsZ0JBQWdCLEVBQUU7WUFDakRPLFFBQVFFLEtBQUssR0FBRztRQUNsQjtJQUNGO0lBRVFPLGNBQWNWLE9BQWUsRUFBdUI7UUFDMUQsTUFBTUMsVUFBK0I7WUFDbkNFLE9BQU87WUFDUFEsY0FBYztZQUNkSCxjQUFjO1FBQ2hCO1FBQ0EsSUFBSSxDQUFDWCxRQUFRLENBQUNnQixHQUFHLENBQUNiLFNBQVNDO1FBQzNCLE9BQU9BO0lBQ1Q7SUFFQTs7R0FFQyxHQUNEYSxVQUFVZCxPQUFlLEVBQThCO1FBQ3JELE9BQU8sSUFBSSxDQUFDSCxRQUFRLENBQUNLLEdBQUcsQ0FBQ0YsWUFBWTtJQUN2QztJQUVBOztHQUVDLEdBQ0RlLE1BQU1mLE9BQWUsRUFBUTtRQUMzQixJQUFJLENBQUNILFFBQVEsQ0FBQ21CLE1BQU0sQ0FBQ2hCO0lBQ3ZCO0lBRUE7O0dBRUMsR0FDRGlCLGVBQWlEO1FBQy9DLE9BQU8sSUFBSW5CLElBQUksSUFBSSxDQUFDRCxRQUFRO0lBQzlCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6LWZyb250ZW5kLy4vc3JjL2xpYi9jaXJjdWl0LWJyZWFrZXIudHM/MTJkNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ2lyY3VpdCBCcmVha2VyIFBhdHRlcm4gZm9yIEFnZW50IFJlc2lsaWVuY2VcclxuICogUHJldmVudHMgY2FzY2FkaW5nIGZhaWx1cmVzIGFuZCBwcm92aWRlcyBncmFjZWZ1bCBkZWdyYWRhdGlvblxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ2lyY3VpdEJyZWFrZXJTdGF0ZSB7XHJcbiAgc3RhdGU6IFwiY2xvc2VkXCIgfCBcIm9wZW5cIiB8IFwiaGFsZi1vcGVuXCI7XHJcbiAgZmFpbHVyZUNvdW50OiBudW1iZXI7XHJcbiAgbGFzdEZhaWx1cmVUaW1lPzogRGF0ZTtcclxuICBzdWNjZXNzQ291bnQ6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFnZW50Q2lyY3VpdEJyZWFrZXIge1xyXG4gIHByaXZhdGUgYnJlYWtlcnM6IE1hcDxzdHJpbmcsIENpcmN1aXRCcmVha2VyU3RhdGU+ID0gbmV3IE1hcCgpO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgZmFpbHVyZVRocmVzaG9sZDogbnVtYmVyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgdGltZW91dE1zOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBzdWNjZXNzVGhyZXNob2xkOiBudW1iZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZmFpbHVyZVRocmVzaG9sZDogbnVtYmVyID0gNSxcclxuICAgIHRpbWVvdXRNczogbnVtYmVyID0gNjAwMDAsIC8vIDEgbWludXRlXHJcbiAgICBzdWNjZXNzVGhyZXNob2xkOiBudW1iZXIgPSAzXHJcbiAgKSB7XHJcbiAgICB0aGlzLmZhaWx1cmVUaHJlc2hvbGQgPSBmYWlsdXJlVGhyZXNob2xkO1xyXG4gICAgdGhpcy50aW1lb3V0TXMgPSB0aW1lb3V0TXM7XHJcbiAgICB0aGlzLnN1Y2Nlc3NUaHJlc2hvbGQgPSBzdWNjZXNzVGhyZXNob2xkO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgYWdlbnQgaXMgYXZhaWxhYmxlIChjaXJjdWl0IGJyZWFrZXIgYWxsb3dzKVxyXG4gICAqL1xyXG4gIGlzQWdlbnRBdmFpbGFibGUoYWdlbnRJZDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBicmVha2VyID0gdGhpcy5icmVha2Vycy5nZXQoYWdlbnRJZCk7XHJcbiAgICBpZiAoIWJyZWFrZXIpIHJldHVybiB0cnVlOyAvLyBObyBicmVha2VyID0gYXZhaWxhYmxlXHJcblxyXG4gICAgc3dpdGNoIChicmVha2VyLnN0YXRlKSB7XHJcbiAgICAgIGNhc2UgXCJjbG9zZWRcIjpcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgY2FzZSBcIm9wZW5cIjpcclxuICAgICAgICAvLyBDaGVjayBpZiB0aW1lb3V0IGhhcyBwYXNzZWRcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICBicmVha2VyLmxhc3RGYWlsdXJlVGltZSAmJlxyXG4gICAgICAgICAgRGF0ZS5ub3coKSAtIGJyZWFrZXIubGFzdEZhaWx1cmVUaW1lLmdldFRpbWUoKSA+IHRoaXMudGltZW91dE1zXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICBicmVha2VyLnN0YXRlID0gXCJoYWxmLW9wZW5cIjtcclxuICAgICAgICAgIGJyZWFrZXIuc3VjY2Vzc0NvdW50ID0gMDtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGNhc2UgXCJoYWxmLW9wZW5cIjpcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlY29yZCBhIHN1Y2Nlc3NmdWwgb3BlcmF0aW9uXHJcbiAgICovXHJcbiAgcmVjb3JkU3VjY2VzcyhhZ2VudElkOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGNvbnN0IGJyZWFrZXIgPSB0aGlzLmJyZWFrZXJzLmdldChhZ2VudElkKSB8fCB0aGlzLmNyZWF0ZUJyZWFrZXIoYWdlbnRJZCk7XHJcblxyXG4gICAgYnJlYWtlci5zdWNjZXNzQ291bnQrKztcclxuICAgIGJyZWFrZXIuZmFpbHVyZUNvdW50ID0gMDtcclxuXHJcbiAgICBpZiAoXHJcbiAgICAgIGJyZWFrZXIuc3RhdGUgPT09IFwiaGFsZi1vcGVuXCIgJiZcclxuICAgICAgYnJlYWtlci5zdWNjZXNzQ291bnQgPj0gdGhpcy5zdWNjZXNzVGhyZXNob2xkXHJcbiAgICApIHtcclxuICAgICAgYnJlYWtlci5zdGF0ZSA9IFwiY2xvc2VkXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWNvcmQgYSBmYWlsZWQgb3BlcmF0aW9uXHJcbiAgICovXHJcbiAgcmVjb3JkRmFpbHVyZShhZ2VudElkOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGNvbnN0IGJyZWFrZXIgPSB0aGlzLmJyZWFrZXJzLmdldChhZ2VudElkKSB8fCB0aGlzLmNyZWF0ZUJyZWFrZXIoYWdlbnRJZCk7XHJcblxyXG4gICAgYnJlYWtlci5mYWlsdXJlQ291bnQrKztcclxuICAgIGJyZWFrZXIubGFzdEZhaWx1cmVUaW1lID0gbmV3IERhdGUoKTtcclxuXHJcbiAgICBpZiAoYnJlYWtlci5mYWlsdXJlQ291bnQgPj0gdGhpcy5mYWlsdXJlVGhyZXNob2xkKSB7XHJcbiAgICAgIGJyZWFrZXIuc3RhdGUgPSBcIm9wZW5cIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlQnJlYWtlcihhZ2VudElkOiBzdHJpbmcpOiBDaXJjdWl0QnJlYWtlclN0YXRlIHtcclxuICAgIGNvbnN0IGJyZWFrZXI6IENpcmN1aXRCcmVha2VyU3RhdGUgPSB7XHJcbiAgICAgIHN0YXRlOiBcImNsb3NlZFwiLFxyXG4gICAgICBmYWlsdXJlQ291bnQ6IDAsXHJcbiAgICAgIHN1Y2Nlc3NDb3VudDogMCxcclxuICAgIH07XHJcbiAgICB0aGlzLmJyZWFrZXJzLnNldChhZ2VudElkLCBicmVha2VyKTtcclxuICAgIHJldHVybiBicmVha2VyO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGNpcmN1aXQgYnJlYWtlciBzdGF0dXMgZm9yIG1vbml0b3JpbmdcclxuICAgKi9cclxuICBnZXRTdGF0dXMoYWdlbnRJZDogc3RyaW5nKTogQ2lyY3VpdEJyZWFrZXJTdGF0ZSB8IG51bGwge1xyXG4gICAgcmV0dXJuIHRoaXMuYnJlYWtlcnMuZ2V0KGFnZW50SWQpIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXNldCBjaXJjdWl0IGJyZWFrZXIgKGZvciBtYW51YWwgaW50ZXJ2ZW50aW9uKVxyXG4gICAqL1xyXG4gIHJlc2V0KGFnZW50SWQ6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgdGhpcy5icmVha2Vycy5kZWxldGUoYWdlbnRJZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIGNpcmN1aXQgYnJlYWtlciBzdGF0ZXNcclxuICAgKi9cclxuICBnZXRBbGxTdGF0ZXMoKTogTWFwPHN0cmluZywgQ2lyY3VpdEJyZWFrZXJTdGF0ZT4ge1xyXG4gICAgcmV0dXJuIG5ldyBNYXAodGhpcy5icmVha2Vycyk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJBZ2VudENpcmN1aXRCcmVha2VyIiwiY29uc3RydWN0b3IiLCJmYWlsdXJlVGhyZXNob2xkIiwidGltZW91dE1zIiwic3VjY2Vzc1RocmVzaG9sZCIsImJyZWFrZXJzIiwiTWFwIiwiaXNBZ2VudEF2YWlsYWJsZSIsImFnZW50SWQiLCJicmVha2VyIiwiZ2V0Iiwic3RhdGUiLCJsYXN0RmFpbHVyZVRpbWUiLCJEYXRlIiwibm93IiwiZ2V0VGltZSIsInN1Y2Nlc3NDb3VudCIsInJlY29yZFN1Y2Nlc3MiLCJjcmVhdGVCcmVha2VyIiwiZmFpbHVyZUNvdW50IiwicmVjb3JkRmFpbHVyZSIsInNldCIsImdldFN0YXR1cyIsInJlc2V0IiwiZGVsZXRlIiwiZ2V0QWxsU3RhdGVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/circuit-breaker.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/dynamic-agent-discovery.ts":
/*!********************************************!*\
  !*** ./src/lib/dynamic-agent-discovery.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DynamicAgentDiscovery: () => (/* binding */ DynamicAgentDiscovery)\n/* harmony export */ });\n/**\r\n * Dynamic Agent Discovery and Service Registry\r\n * Handles multiple agents dynamically without hardcoded URLs\r\n */ class DynamicAgentDiscovery {\n    constructor(config){\n        this.discoveredAgents = new Map();\n        this.discoveryInterval = null;\n        this.config = config;\n        this.startDiscovery();\n    }\n    /**\r\n   * Start agent discovery based on configuration\r\n   */ startDiscovery() {\n        // Initial discovery\n        this.performDiscovery();\n        // Periodic discovery every 30 seconds\n        this.discoveryInterval = setInterval(()=>{\n            this.performDiscovery();\n        }, 30000);\n    }\n    /**\r\n   * Perform discovery based on configured method\r\n   */ async performDiscovery() {\n        try {\n            switch(this.config.discoveryMethod){\n                case \"environment\":\n                    await this.discoverFromEnvironment();\n                    break;\n                case \"consul\":\n                    await this.discoverFromConsul();\n                    break;\n                case \"kubernetes\":\n                    await this.discoverFromKubernetes();\n                    break;\n                case \"multicast\":\n                    await this.discoverFromMulticast();\n                    break;\n                case \"manual\":\n                    await this.discoverFromManual();\n                    break;\n                default:\n                    console.warn(`Unknown discovery method: ${this.config.discoveryMethod}`);\n            }\n        } catch (error) {\n            console.error(\"Agent discovery failed:\", error);\n        }\n    }\n    /**\r\n   * Discover agents from environment variables\r\n   */ async discoverFromEnvironment() {\n        if (!this.config.environment) return;\n        const { prefix, ports = [\n            3000,\n            4001\n        ], hosts = [\n            \"localhost\"\n        ] } = this.config.environment;\n        for (const host of hosts){\n            for (const port of ports){\n                const url = `http://${host}:${port}`;\n                const agentId = `${host}:${port}`;\n                try {\n                    // Check if agent exists and get its capabilities\n                    const agentInfo = await this.probeAgent(url);\n                    if (agentInfo) {\n                        this.discoveredAgents.set(agentId, {\n                            id: agentId,\n                            name: agentInfo.name || `Agent-${agentId}`,\n                            url,\n                            capabilities: agentInfo.capabilities || [],\n                            status: \"online\",\n                            lastSeen: new Date(),\n                            metadata: {\n                                version: agentInfo.version,\n                                instance: agentId,\n                                tags: [\n                                    `env:${prefix}`\n                                ]\n                            }\n                        });\n                    }\n                } catch (error) {\n                    // Mark as offline if probe fails\n                    const existing = this.discoveredAgents.get(agentId);\n                    if (existing) {\n                        existing.status = \"offline\";\n                        existing.lastSeen = new Date();\n                    }\n                }\n            }\n        }\n    }\n    /**\r\n   * Discover agents from Consul service registry\r\n   */ async discoverFromConsul() {\n        if (!this.config.consul) return;\n        const { host, port, serviceName } = this.config.consul;\n        const consulUrl = `http://${host}:${port}`;\n        try {\n            const response = await fetch(`${consulUrl}/v1/health/service/${serviceName}`);\n            const services = await response.json();\n            for (const service of services){\n                const agent = service.Service;\n                const agentId = agent.ID;\n                this.discoveredAgents.set(agentId, {\n                    id: agentId,\n                    name: agent.Service,\n                    url: `http://${agent.Address}:${agent.Port}`,\n                    capabilities: agent.Tags || [],\n                    status: \"online\",\n                    lastSeen: new Date(),\n                    metadata: {\n                        version: agent.Meta?.version,\n                        region: service.Node?.Datacenter,\n                        instance: agentId,\n                        tags: agent.Tags\n                    }\n                });\n            }\n        } catch (error) {\n            console.error(\"Consul discovery failed:\", error);\n        }\n    }\n    /**\r\n   * Discover agents from Kubernetes\r\n   */ async discoverFromKubernetes() {\n        if (!this.config.kubernetes) return;\n        const { namespace, labelSelector } = this.config.kubernetes;\n        try {\n            // This would use Kubernetes API to discover services\n            // Implementation depends on your K8s setup\n            const response = await fetch(`/api/v1/namespaces/${namespace}/services?labelSelector=${labelSelector}`);\n            const services = await response.json();\n            for (const service of services.items){\n                const agentId = service.metadata.name;\n                const url = `http://${service.spec.clusterIP}:${service.spec.ports[0].port}`;\n                this.discoveredAgents.set(agentId, {\n                    id: agentId,\n                    name: service.metadata.name,\n                    url,\n                    capabilities: service.metadata.labels?.capabilities?.split(\",\") || [],\n                    status: \"online\",\n                    lastSeen: new Date(),\n                    metadata: {\n                        version: service.metadata.labels?.version,\n                        namespace: service.metadata.namespace,\n                        instance: agentId,\n                        tags: Object.keys(service.metadata.labels || {})\n                    }\n                });\n            }\n        } catch (error) {\n            console.error(\"Kubernetes discovery failed:\", error);\n        }\n    }\n    /**\r\n   * Discover agents using multicast\r\n   */ async discoverFromMulticast() {\n        if (!this.config.multicast) return;\n        // Implementation would use UDP multicast to discover agents\n        // This is a simplified version\n        console.log(\"Multicast discovery not implemented yet\");\n    }\n    /**\r\n   * Use manually configured agents\r\n   */ async discoverFromManual() {\n        if (!this.config.manual) return;\n        for (const agentConfig of this.config.manual.agents){\n            try {\n                const agentInfo = await this.probeAgent(agentConfig.url);\n                if (agentInfo) {\n                    this.discoveredAgents.set(agentConfig.id, {\n                        id: agentConfig.id,\n                        name: agentInfo.name || agentConfig.id,\n                        url: agentConfig.url,\n                        capabilities: agentConfig.capabilities,\n                        status: \"online\",\n                        lastSeen: new Date(),\n                        metadata: agentConfig.metadata\n                    });\n                }\n            } catch (error) {\n                console.warn(`Failed to probe manual agent ${agentConfig.id}:`, error);\n            }\n        }\n    }\n    /**\r\n   * Probe an agent to get its information\r\n   */ async probeAgent(url) {\n        const controller = new AbortController();\n        const timeoutId = setTimeout(()=>controller.abort(), 5000);\n        try {\n            const response = await fetch(`${url}/.well-known/agent-card.json`, {\n                signal: controller.signal\n            });\n            clearTimeout(timeoutId);\n            if (response.ok) {\n                return await response.json();\n            }\n        } catch (error) {\n            clearTimeout(timeoutId);\n            throw error;\n        }\n        return null;\n    }\n    /**\r\n   * Get all discovered agents\r\n   */ getAllAgents() {\n        return Array.from(this.discoveredAgents.values());\n    }\n    /**\r\n   * Get agents by capability\r\n   */ getAgentsByCapability(capability) {\n        return this.getAllAgents().filter((agent)=>agent.capabilities.includes(capability));\n    }\n    /**\r\n   * Get online agents only\r\n   */ getOnlineAgents() {\n        return this.getAllAgents().filter((agent)=>agent.status === \"online\");\n    }\n    /**\r\n   * Get agent by ID\r\n   */ getAgent(agentId) {\n        return this.discoveredAgents.get(agentId);\n    }\n    /**\r\n   * Stop discovery\r\n   */ stop() {\n        if (this.discoveryInterval) {\n            clearInterval(this.discoveryInterval);\n            this.discoveryInterval = null;\n        }\n    }\n    /**\r\n   * Update agent status\r\n   */ updateAgentStatus(agentId, status) {\n        const agent = this.discoveredAgents.get(agentId);\n        if (agent) {\n            agent.status = status;\n            agent.lastSeen = new Date();\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2R5bmFtaWMtYWdlbnQtZGlzY292ZXJ5LnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0NBR0MsR0F1RE0sTUFBTUE7SUFLWEMsWUFBWUMsTUFBNEIsQ0FBRTthQUpsQ0MsbUJBQWlELElBQUlDO2FBQ3JEQyxvQkFBMkM7UUFJakQsSUFBSSxDQUFDSCxNQUFNLEdBQUdBO1FBQ2QsSUFBSSxDQUFDSSxjQUFjO0lBQ3JCO0lBRUE7O0dBRUMsR0FDRCxpQkFBK0I7UUFDN0Isb0JBQW9CO1FBQ3BCLElBQUksQ0FBQ0MsZ0JBQWdCO1FBRXJCLHNDQUFzQztRQUN0QyxJQUFJLENBQUNGLGlCQUFpQixHQUFHRyxZQUFZO1lBQ25DLElBQUksQ0FBQ0QsZ0JBQWdCO1FBQ3ZCLEdBQUc7SUFDTDtJQUVBOztHQUVDLEdBQ0QsTUFBY0EsbUJBQWtDO1FBQzlDLElBQUk7WUFDRixPQUFRLElBQUksQ0FBQ0wsTUFBTSxDQUFDTyxlQUFlO2dCQUNqQyxLQUFLO29CQUNILE1BQU0sSUFBSSxDQUFDQyx1QkFBdUI7b0JBQ2xDO2dCQUNGLEtBQUs7b0JBQ0gsTUFBTSxJQUFJLENBQUNDLGtCQUFrQjtvQkFDN0I7Z0JBQ0YsS0FBSztvQkFDSCxNQUFNLElBQUksQ0FBQ0Msc0JBQXNCO29CQUNqQztnQkFDRixLQUFLO29CQUNILE1BQU0sSUFBSSxDQUFDQyxxQkFBcUI7b0JBQ2hDO2dCQUNGLEtBQUs7b0JBQ0gsTUFBTSxJQUFJLENBQUNDLGtCQUFrQjtvQkFDN0I7Z0JBQ0Y7b0JBQ0VDLFFBQVFDLElBQUksQ0FDVixDQUFDLDBCQUEwQixFQUFFLElBQUksQ0FBQ2QsTUFBTSxDQUFDTyxlQUFlLENBQUMsQ0FBQztZQUVoRTtRQUNGLEVBQUUsT0FBT1EsT0FBTztZQUNkRixRQUFRRSxLQUFLLENBQUMsMkJBQTJCQTtRQUMzQztJQUNGO0lBRUE7O0dBRUMsR0FDRCxNQUFjUCwwQkFBeUM7UUFDckQsSUFBSSxDQUFDLElBQUksQ0FBQ1IsTUFBTSxDQUFDZ0IsV0FB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RyxJQUFJQztRQUN2QjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6LWZyb250ZW5kLy4vc3JjL2xpYi9keW5hbWljLWFnZW50LWRpc2NvdmVyeS50cz8xZWE5Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBEeW5hbWljIEFnZW50IERpc2NvdmVyeSBhbmQgU2VydmljZSBSZWdpc3RyeVxyXG4gKiBIYW5kbGVzIG11bHRpcGxlIGFnZW50cyBkeW5hbWljYWxseSB3aXRob3V0IGhhcmRjb2RlZCBVUkxzXHJcbiAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBZ2VudERpc2NvdmVyeUNvbmZpZyB7XHJcbiAgZGlzY292ZXJ5TWV0aG9kOlxyXG4gICAgfCBcImVudmlyb25tZW50XCJcclxuICAgIHwgXCJjb25zdWxcIlxyXG4gICAgfCBcImV0Y2RcIlxyXG4gICAgfCBcImt1YmVybmV0ZXNcIlxyXG4gICAgfCBcIm11bHRpY2FzdFwiXHJcbiAgICB8IFwibWFudWFsXCI7XHJcbiAgZW52aXJvbm1lbnQ/OiB7XHJcbiAgICBwcmVmaXg6IHN0cmluZzsgLy8gZS5nLiwgXCJRVUlaX0FHRU5UXCJcclxuICAgIHBvcnRzPzogbnVtYmVyW107IC8vIGUuZy4sIFszMDAwLCA0MDAxLCA0MDAyXVxyXG4gICAgaG9zdHM/OiBzdHJpbmdbXTsgLy8gZS5nLiwgW1wibG9jYWxob3N0XCIsIFwiYWdlbnQxLmV4YW1wbGUuY29tXCJdXHJcbiAgfTtcclxuICBjb25zdWw/OiB7XHJcbiAgICBob3N0OiBzdHJpbmc7XHJcbiAgICBwb3J0OiBudW1iZXI7XHJcbiAgICBzZXJ2aWNlTmFtZTogc3RyaW5nO1xyXG4gIH07XHJcbiAga3ViZXJuZXRlcz86IHtcclxuICAgIG5hbWVzcGFjZTogc3RyaW5nO1xyXG4gICAgbGFiZWxTZWxlY3Rvcjogc3RyaW5nO1xyXG4gIH07XHJcbiAgbXVsdGljYXN0Pzoge1xyXG4gICAgcG9ydDogbnVtYmVyO1xyXG4gICAgZ3JvdXA6IHN0cmluZztcclxuICB9O1xyXG4gIG1hbnVhbD86IHtcclxuICAgIGFnZW50czogQXJyYXk8e1xyXG4gICAgICBpZDogc3RyaW5nO1xyXG4gICAgICB1cmw6IHN0cmluZztcclxuICAgICAgY2FwYWJpbGl0aWVzOiBzdHJpbmdbXTtcclxuICAgICAgbWV0YWRhdGE/OiBhbnk7XHJcbiAgICB9PjtcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERpc2NvdmVyZWRBZ2VudCB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgY2FwYWJpbGl0aWVzOiBzdHJpbmdbXTtcclxuICBzdGF0dXM6IFwib25saW5lXCIgfCBcIm9mZmxpbmVcIiB8IFwidW5rbm93blwiO1xyXG4gIGxhc3RTZWVuOiBEYXRlO1xyXG4gIG1ldGFkYXRhPzoge1xyXG4gICAgdmVyc2lvbj86IHN0cmluZztcclxuICAgIHJlZ2lvbj86IHN0cmluZztcclxuICAgIGluc3RhbmNlPzogc3RyaW5nO1xyXG4gICAgbG9hZD86IG51bWJlcjtcclxuICAgIHRhZ3M/OiBzdHJpbmdbXTtcclxuICAgIG5hbWVzcGFjZT86IHN0cmluZztcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRHluYW1pY0FnZW50RGlzY292ZXJ5IHtcclxuICBwcml2YXRlIGRpc2NvdmVyZWRBZ2VudHM6IE1hcDxzdHJpbmcsIERpc2NvdmVyZWRBZ2VudD4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSBkaXNjb3ZlcnlJbnRlcnZhbDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcclxuICBwcml2YXRlIGNvbmZpZzogQWdlbnREaXNjb3ZlcnlDb25maWc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogQWdlbnREaXNjb3ZlcnlDb25maWcpIHtcclxuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG4gICAgdGhpcy5zdGFydERpc2NvdmVyeSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhcnQgYWdlbnQgZGlzY292ZXJ5IGJhc2VkIG9uIGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIHN0YXJ0RGlzY292ZXJ5KCk6IHZvaWQge1xyXG4gICAgLy8gSW5pdGlhbCBkaXNjb3ZlcnlcclxuICAgIHRoaXMucGVyZm9ybURpc2NvdmVyeSgpO1xyXG5cclxuICAgIC8vIFBlcmlvZGljIGRpc2NvdmVyeSBldmVyeSAzMCBzZWNvbmRzXHJcbiAgICB0aGlzLmRpc2NvdmVyeUludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICB0aGlzLnBlcmZvcm1EaXNjb3ZlcnkoKTtcclxuICAgIH0sIDMwMDAwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBlcmZvcm0gZGlzY292ZXJ5IGJhc2VkIG9uIGNvbmZpZ3VyZWQgbWV0aG9kXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBwZXJmb3JtRGlzY292ZXJ5KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgc3dpdGNoICh0aGlzLmNvbmZpZy5kaXNjb3ZlcnlNZXRob2QpIHtcclxuICAgICAgICBjYXNlIFwiZW52aXJvbm1lbnRcIjpcclxuICAgICAgICAgIGF3YWl0IHRoaXMuZGlzY292ZXJGcm9tRW52aXJvbm1lbnQoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJjb25zdWxcIjpcclxuICAgICAgICAgIGF3YWl0IHRoaXMuZGlzY292ZXJGcm9tQ29uc3VsKCk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwia3ViZXJuZXRlc1wiOlxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5kaXNjb3ZlckZyb21LdWJlcm5ldGVzKCk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwibXVsdGljYXN0XCI6XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLmRpc2NvdmVyRnJvbU11bHRpY2FzdCgpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIm1hbnVhbFwiOlxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5kaXNjb3ZlckZyb21NYW51YWwoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oXHJcbiAgICAgICAgICAgIGBVbmtub3duIGRpc2NvdmVyeSBtZXRob2Q6ICR7dGhpcy5jb25maWcuZGlzY292ZXJ5TWV0aG9kfWBcclxuICAgICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJBZ2VudCBkaXNjb3ZlcnkgZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgZnJvbSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGRpc2NvdmVyRnJvbUVudmlyb25tZW50KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5lbnZpcm9ubWVudCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IHtcclxuICAgICAgcHJlZml4LFxyXG4gICAgICBwb3J0cyA9IFszMDAwLCA0MDAxXSxcclxuICAgICAgaG9zdHMgPSBbXCJsb2NhbGhvc3RcIl0sXHJcbiAgICB9ID0gdGhpcy5jb25maWcuZW52aXJvbm1lbnQ7XHJcblxyXG4gICAgZm9yIChjb25zdCBob3N0IG9mIGhvc3RzKSB7XHJcbiAgICAgIGZvciAoY29uc3QgcG9ydCBvZiBwb3J0cykge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwOi8vJHtob3N0fToke3BvcnR9YDtcclxuICAgICAgICBjb25zdCBhZ2VudElkID0gYCR7aG9zdH06JHtwb3J0fWA7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBDaGVjayBpZiBhZ2VudCBleGlzdHMgYW5kIGdldCBpdHMgY2FwYWJpbGl0aWVzXHJcbiAgICAgICAgICBjb25zdCBhZ2VudEluZm8gPSBhd2FpdCB0aGlzLnByb2JlQWdlbnQodXJsKTtcclxuICAgICAgICAgIGlmIChhZ2VudEluZm8pIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudElkLCB7XHJcbiAgICAgICAgICAgICAgaWQ6IGFnZW50SWQsXHJcbiAgICAgICAgICAgICAgbmFtZTogYWdlbnRJbmZvLm5hbWUgfHwgYEFnZW50LSR7YWdlbnRJZH1gLFxyXG4gICAgICAgICAgICAgIHVybCxcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IGFnZW50SW5mby5jYXBhYmlsaXRpZXMgfHwgW10sXHJcbiAgICAgICAgICAgICAgc3RhdHVzOiBcIm9ubGluZVwiLFxyXG4gICAgICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBhZ2VudEluZm8udmVyc2lvbixcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlOiBhZ2VudElkLFxyXG4gICAgICAgICAgICAgICAgdGFnczogW2BlbnY6JHtwcmVmaXh9YF0sXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIC8vIE1hcmsgYXMgb2ZmbGluZSBpZiBwcm9iZSBmYWlsc1xyXG4gICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLmRpc2NvdmVyZWRBZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAgICAgICAgIGV4aXN0aW5nLnN0YXR1cyA9IFwib2ZmbGluZVwiO1xyXG4gICAgICAgICAgICBleGlzdGluZy5sYXN0U2VlbiA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgZnJvbSBDb25zdWwgc2VydmljZSByZWdpc3RyeVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZGlzY292ZXJGcm9tQ29uc3VsKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5jb25zdWwpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCB7IGhvc3QsIHBvcnQsIHNlcnZpY2VOYW1lIH0gPSB0aGlzLmNvbmZpZy5jb25zdWw7XHJcbiAgICBjb25zdCBjb25zdWxVcmwgPSBgaHR0cDovLyR7aG9zdH06JHtwb3J0fWA7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcclxuICAgICAgICBgJHtjb25zdWxVcmx9L3YxL2hlYWx0aC9zZXJ2aWNlLyR7c2VydmljZU5hbWV9YFxyXG4gICAgICApO1xyXG4gICAgICBjb25zdCBzZXJ2aWNlcyA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuXHJcbiAgICAgIGZvciAoY29uc3Qgc2VydmljZSBvZiBzZXJ2aWNlcykge1xyXG4gICAgICAgIGNvbnN0IGFnZW50ID0gc2VydmljZS5TZXJ2aWNlO1xyXG4gICAgICAgIGNvbnN0IGFnZW50SWQgPSBhZ2VudC5JRDtcclxuXHJcbiAgICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudElkLCB7XHJcbiAgICAgICAgICBpZDogYWdlbnRJZCxcclxuICAgICAgICAgIG5hbWU6IGFnZW50LlNlcnZpY2UsXHJcbiAgICAgICAgICB1cmw6IGBodHRwOi8vJHthZ2VudC5BZGRyZXNzfToke2FnZW50LlBvcnR9YCxcclxuICAgICAgICAgIGNhcGFiaWxpdGllczogYWdlbnQuVGFncyB8fCBbXSxcclxuICAgICAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogYWdlbnQuTWV0YT8udmVyc2lvbixcclxuICAgICAgICAgICAgcmVnaW9uOiBzZXJ2aWNlLk5vZGU/LkRhdGFjZW50ZXIsXHJcbiAgICAgICAgICAgIGluc3RhbmNlOiBhZ2VudElkLFxyXG4gICAgICAgICAgICB0YWdzOiBhZ2VudC5UYWdzLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkNvbnN1bCBkaXNjb3ZlcnkgZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgZnJvbSBLdWJlcm5ldGVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBkaXNjb3ZlckZyb21LdWJlcm5ldGVzKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5rdWJlcm5ldGVzKSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgeyBuYW1lc3BhY2UsIGxhYmVsU2VsZWN0b3IgfSA9IHRoaXMuY29uZmlnLmt1YmVybmV0ZXM7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gVGhpcyB3b3VsZCB1c2UgS3ViZXJuZXRlcyBBUEkgdG8gZGlzY292ZXIgc2VydmljZXNcclxuICAgICAgLy8gSW1wbGVtZW50YXRpb24gZGVwZW5kcyBvbiB5b3VyIEs4cyBzZXR1cFxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxyXG4gICAgICAgIGAvYXBpL3YxL25hbWVzcGFjZXMvJHtuYW1lc3BhY2V9L3NlcnZpY2VzP2xhYmVsU2VsZWN0b3I9JHtsYWJlbFNlbGVjdG9yfWBcclxuICAgICAgKTtcclxuICAgICAgY29uc3Qgc2VydmljZXMgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IHNlcnZpY2Ugb2Ygc2VydmljZXMuaXRlbXMpIHtcclxuICAgICAgICBjb25zdCBhZ2VudElkID0gc2VydmljZS5tZXRhZGF0YS5uYW1lO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwOi8vJHtzZXJ2aWNlLnNwZWMuY2x1c3RlcklQfToke3NlcnZpY2Uuc3BlYy5wb3J0c1swXS5wb3J0fWA7XHJcblxyXG4gICAgICAgIHRoaXMuZGlzY292ZXJlZEFnZW50cy5zZXQoYWdlbnRJZCwge1xyXG4gICAgICAgICAgaWQ6IGFnZW50SWQsXHJcbiAgICAgICAgICBuYW1lOiBzZXJ2aWNlLm1ldGFkYXRhLm5hbWUsXHJcbiAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICBjYXBhYmlsaXRpZXM6IHNlcnZpY2UubWV0YWRhdGEubGFiZWxzPy5jYXBhYmlsaXRpZXM/LnNwbGl0KFwiLFwiKSB8fCBbXSxcclxuICAgICAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogc2VydmljZS5tZXRhZGF0YS5sYWJlbHM/LnZlcnNpb24sXHJcbiAgICAgICAgICAgIG5hbWVzcGFjZTogc2VydmljZS5tZXRhZGF0YS5uYW1lc3BhY2UsXHJcbiAgICAgICAgICAgIGluc3RhbmNlOiBhZ2VudElkLFxyXG4gICAgICAgICAgICB0YWdzOiBPYmplY3Qua2V5cyhzZXJ2aWNlLm1ldGFkYXRhLmxhYmVscyB8fCB7fSksXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiS3ViZXJuZXRlcyBkaXNjb3ZlcnkgZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgdXNpbmcgbXVsdGljYXN0XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBkaXNjb3ZlckZyb21NdWx0aWNhc3QoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBpZiAoIXRoaXMuY29uZmlnLm11bHRpY2FzdCkgcmV0dXJuO1xyXG5cclxuICAgIC8vIEltcGxlbWVudGF0aW9uIHdvdWxkIHVzZSBVRFAgbXVsdGljYXN0IHRvIGRpc2NvdmVyIGFnZW50c1xyXG4gICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvblxyXG4gICAgY29uc29sZS5sb2coXCJNdWx0aWNhc3QgZGlzY292ZXJ5IG5vdCBpbXBsZW1lbnRlZCB5ZXRcIik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVc2UgbWFudWFsbHkgY29uZmlndXJlZCBhZ2VudHNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGRpc2NvdmVyRnJvbU1hbnVhbCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGlmICghdGhpcy5jb25maWcubWFudWFsKSByZXR1cm47XHJcblxyXG4gICAgZm9yIChjb25zdCBhZ2VudENvbmZpZyBvZiB0aGlzLmNvbmZpZy5tYW51YWwuYWdlbnRzKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWdlbnRJbmZvID0gYXdhaXQgdGhpcy5wcm9iZUFnZW50KGFnZW50Q29uZmlnLnVybCk7XHJcbiAgICAgICAgaWYgKGFnZW50SW5mbykge1xyXG4gICAgICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudENvbmZpZy5pZCwge1xyXG4gICAgICAgICAgICBpZDogYWdlbnRDb25maWcuaWQsXHJcbiAgICAgICAgICAgIG5hbWU6IGFnZW50SW5mby5uYW1lIHx8IGFnZW50Q29uZmlnLmlkLFxyXG4gICAgICAgICAgICB1cmw6IGFnZW50Q29uZmlnLnVybCxcclxuICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBhZ2VudENvbmZpZy5jYXBhYmlsaXRpZXMsXHJcbiAgICAgICAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgIG1ldGFkYXRhOiBhZ2VudENvbmZpZy5tZXRhZGF0YSxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oYEZhaWxlZCB0byBwcm9iZSBtYW51YWwgYWdlbnQgJHthZ2VudENvbmZpZy5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQcm9iZSBhbiBhZ2VudCB0byBnZXQgaXRzIGluZm9ybWF0aW9uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBwcm9iZUFnZW50KHVybDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XHJcbiAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgNTAwMCk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt1cmx9Ly53ZWxsLWtub3duL2FnZW50LWNhcmQuanNvbmAsIHtcclxuICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxyXG4gICAgICB9KTtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcblxyXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIGRpc2NvdmVyZWQgYWdlbnRzXHJcbiAgICovXHJcbiAgZ2V0QWxsQWdlbnRzKCk6IERpc2NvdmVyZWRBZ2VudFtdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZGlzY292ZXJlZEFnZW50cy52YWx1ZXMoKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWdlbnRzIGJ5IGNhcGFiaWxpdHlcclxuICAgKi9cclxuICBnZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eTogc3RyaW5nKTogRGlzY292ZXJlZEFnZW50W10ge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0QWxsQWdlbnRzKCkuZmlsdGVyKChhZ2VudCkgPT5cclxuICAgICAgYWdlbnQuY2FwYWJpbGl0aWVzLmluY2x1ZGVzKGNhcGFiaWxpdHkpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IG9ubGluZSBhZ2VudHMgb25seVxyXG4gICAqL1xyXG4gIGdldE9ubGluZUFnZW50cygpOiBEaXNjb3ZlcmVkQWdlbnRbXSB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRBbGxBZ2VudHMoKS5maWx0ZXIoKGFnZW50KSA9PiBhZ2VudC5zdGF0dXMgPT09IFwib25saW5lXCIpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFnZW50IGJ5IElEXHJcbiAgICovXHJcbiAgZ2V0QWdlbnQoYWdlbnRJZDogc3RyaW5nKTogRGlzY292ZXJlZEFnZW50IHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiB0aGlzLmRpc2NvdmVyZWRBZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RvcCBkaXNjb3ZlcnlcclxuICAgKi9cclxuICBzdG9wKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuZGlzY292ZXJ5SW50ZXJ2YWwpIHtcclxuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmRpc2NvdmVyeUludGVydmFsKTtcclxuICAgICAgdGhpcy5kaXNjb3ZlcnlJbnRlcnZhbCA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgYWdlbnQgc3RhdHVzXHJcbiAgICovXHJcbiAgdXBkYXRlQWdlbnRTdGF0dXMoYWdlbnRJZDogc3RyaW5nLCBzdGF0dXM6IFwib25saW5lXCIgfCBcIm9mZmxpbmVcIik6IHZvaWQge1xyXG4gICAgY29uc3QgYWdlbnQgPSB0aGlzLmRpc2NvdmVyZWRBZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gICAgaWYgKGFnZW50KSB7XHJcbiAgICAgIGFnZW50LnN0YXR1cyA9IHN0YXR1cztcclxuICAgICAgYWdlbnQubGFzdFNlZW4gPSBuZXcgRGF0ZSgpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRHluYW1pY0FnZW50RGlzY292ZXJ5IiwiY29uc3RydWN0b3IiLCJjb25maWciLCJkaXNjb3ZlcmVkQWdlbnRzIiwiTWFwIiwiZGlzY292ZXJ5SW50ZXJ2YWwiLCJzdGFydERpc2NvdmVyeSIsInBlcmZvcm1EaXNjb3ZlcnkiLCJzZXRJbnRlcnZhbCIsImRpc2NvdmVyeU1ldGhvZCIsImRpc2NvdmVyRnJvbUVudmlyb25tZW50IiwiZGlzY292ZXJGcm9tQ29uc3VsIiwiZGlzY292ZXJGcm9tS3ViZXJuZXRlcyIsImRpc2NvdmVyRnJvbU11bHRpY2FzdCIsImRpc2NvdmVyRnJvbU1hbnVhbCIsImNvbnNvbGUiLCJ3YXJuIiwiZXJyb3IiLCJlbnZpcm9ubWVudCIsInByZWZpeCIsInBvcnRzIiwiaG9zdHMiLCJob3N0IiwicG9ydCIsInVybCIsImFnZW50SWQiLCJhZ2VudEluZm8iLCJwcm9iZUFnZW50Iiwic2V0IiwiaWQiLCJuYW1lIiwiY2FwYWJpbGl0aWVzIiwic3RhdHVzIiwibGFzdFNlZW4iLCJEYXRlIiwibWV0YWRhdGEiLCJ2ZXJzaW9uIiwiaW5zdGFuY2UiLCJ0YWdzIiwiZXhpc3RpbmciLCJnZXQiLCJjb25zdWwiLCJzZXJ2aWNlTmFtZSIsImNvbnN1bFVybCIsInJlc3BvbnNlIiwiZmV0Y2giLCJzZXJ2aWNlcyIsImpzb24iLCJzZXJ2aWNlIiwiYWdlbnQiLCJTZXJ2aWNlIiwiSUQiLCJBZGRyZXNzIiwiUG9ydCIsIlRhZ3MiLCJNZXRhIiwicmVnaW9uIiwiTm9kZSIsIkRhdGFjZW50ZXIiLCJrdWJlcm5ldGVzIiwibmFtZXNwYWNlIiwibGFiZWxTZWxlY3RvciIsIml0ZW1zIiwic3BlYyIsImNsdXN0ZXJJUCIsImxhYmVscyIsInNwbGl0IiwiT2JqZWN0Iiwia2V5cyIsIm11bHRpY2FzdCIsImxvZyIsIm1hbnVhbCIsImFnZW50Q29uZmlnIiwiYWdlbnRzIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInNpZ25hbCIsImNsZWFyVGltZW91dCIsIm9rIiwiZ2V0QWxsQWdlbnRzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwiZ2V0QWdlbnRzQnlDYXBhYmlsaXR5IiwiY2FwYWJpbGl0eSIsImZpbHRlciIsImluY2x1ZGVzIiwiZ2V0T25saW5lQWdlbnRzIiwiZ2V0QWdlbnQiLCJzdG9wIiwiY2xlYXJJbnRlcnZhbCIsInVwZGF0ZUFnZW50U3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/dynamic-agent-discovery.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/enhanced-agent-selector.ts":
/*!********************************************!*\
  !*** ./src/lib/enhanced-agent-selector.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EnhancedAgentSelector: () => (/* binding */ EnhancedAgentSelector)\n/* harmony export */ });\n/**\r\n * Enhanced Agent Selection System\r\n * Provides sophisticated agent routing based on multiple criteria\r\n */ class EnhancedAgentSelector {\n    /**\r\n   * Register an agent with its capabilities\r\n   */ registerAgent(agent) {\n        this.agents.set(agent.id, agent);\n        // Build capability index for faster lookups\n        agent.capabilities.forEach((capability)=>{\n            if (!this.capabilityIndex.has(capability.id)) {\n                this.capabilityIndex.set(capability.id, []);\n            }\n            this.capabilityIndex.get(capability.id).push(agent);\n        });\n    }\n    /**\r\n   * Select the best agent for a given query using multiple criteria\r\n   */ selectAgent(query, context) {\n        const queryLower = query.toLowerCase();\n        const candidates = [];\n        // Score each agent based on multiple criteria\n        for (const agent of Array.from(this.agents.values())){\n            if (agent.status !== \"online\") continue;\n            const { score, reasoning } = this.scoreAgent(agent, queryLower, context);\n            if (score > 0) {\n                candidates.push({\n                    agent,\n                    score,\n                    reasoning\n                });\n            }\n        }\n        // Sort by score (highest first)\n        candidates.sort((a, b)=>b.score - a.score);\n        if (candidates.length === 0) {\n            return {\n                agent: null,\n                confidence: 0,\n                reasoning: \"No suitable agents found\"\n            };\n        }\n        const best = candidates[0];\n        return {\n            agent: best.agent,\n            confidence: best.score,\n            reasoning: best.reasoning\n        };\n    }\n    /**\r\n   * Score an agent based on multiple criteria\r\n   */ scoreAgent(agent, queryLower, context) {\n        let totalScore = 0;\n        const reasons = [];\n        // 1. Capability matching (40% weight)\n        const capabilityScore = this.calculateCapabilityScore(agent, queryLower);\n        totalScore += capabilityScore * 0.4;\n        if (capabilityScore > 0) {\n            reasons.push(`Capability match: ${capabilityScore.toFixed(2)}`);\n        }\n        // 2. Agent availability (20% weight)\n        const availabilityScore = this.calculateAvailabilityScore(agent);\n        totalScore += availabilityScore * 0.2;\n        reasons.push(`Availability: ${availabilityScore.toFixed(2)}`);\n        // 3. Performance metrics (20% weight)\n        const performanceScore = this.calculatePerformanceScore(agent);\n        totalScore += performanceScore * 0.2;\n        reasons.push(`Performance: ${performanceScore.toFixed(2)}`);\n        // 4. Context awareness (20% weight)\n        const contextScore = this.calculateContextScore(agent, context);\n        totalScore += contextScore * 0.2;\n        if (contextScore > 0) {\n            reasons.push(`Context match: ${contextScore.toFixed(2)}`);\n        }\n        return {\n            score: Math.min(totalScore, 1),\n            reasoning: reasons.join(\", \")\n        };\n    }\n    calculateCapabilityScore(agent, queryLower) {\n        let bestMatch = 0;\n        for (const capability of agent.capabilities){\n            let capabilityScore = 0;\n            // Check keyword matches\n            const keywordMatches = capability.keywords.filter((keyword)=>queryLower.includes(keyword.toLowerCase())).length;\n            if (keywordMatches > 0) {\n                capabilityScore = keywordMatches / capability.keywords.length * capability.confidence;\n                bestMatch = Math.max(bestMatch, capabilityScore);\n            }\n        }\n        return bestMatch;\n    }\n    calculateAvailabilityScore(agent) {\n        // Factor in status, load, and recent activity\n        let score = 1.0;\n        if (agent.status === \"busy\") score *= 0.7;\n        if (agent.status === \"maintenance\") score *= 0.1;\n        if (agent.load > 0.8) score *= 0.5;\n        // Check if agent was recently active\n        const timeSinceLastSeen = Date.now() - agent.lastSeen.getTime();\n        if (timeSinceLastSeen > 300000) {\n            // 5 minutes\n            score *= 0.8;\n        }\n        return score;\n    }\n    calculatePerformanceScore(agent) {\n        // Combine response time and reliability\n        const responseScore = Math.max(0, 1 - agent.responseTime / 5000); // 5s max\n        const reliabilityScore = agent.reliability;\n        return (responseScore + reliabilityScore) / 2;\n    }\n    calculateContextScore(agent, context) {\n        if (!context) return 0.5; // Neutral score if no context\n        let score = 0.5; // Base score\n        // Adjust based on urgency\n        if (context.urgency === \"high\" && agent.responseTime < 1000) {\n            score += 0.3;\n        }\n        // Adjust based on complexity\n        if (context.complexity === \"complex\" && agent.capabilities.length > 3) {\n            score += 0.2;\n        }\n        return Math.min(score, 1.0);\n    }\n    /**\r\n   * Get fallback agents if primary selection fails\r\n   */ getFallbackAgents(query, excludeAgentId) {\n        const candidates = Array.from(this.agents.values()).filter((agent)=>agent.status === \"online\" && agent.id !== excludeAgentId).sort((a, b)=>b.reliability - a.reliability);\n        return candidates.slice(0, 3); // Return top 3 fallbacks\n    }\n    /**\r\n   * Update agent metrics after task completion\r\n   */ updateAgentMetrics(agentId, success, responseTime) {\n        const agent = this.agents.get(agentId);\n        if (!agent) return;\n        // Update reliability (exponential moving average)\n        agent.reliability = agent.reliability * 0.9 + (success ? 1 : 0) * 0.1;\n        // Update response time (exponential moving average)\n        agent.responseTime = agent.responseTime * 0.8 + responseTime * 0.2;\n        // Update last seen\n        agent.lastSeen = new Date();\n    }\n    /**\r\n   * Get all registered agents\r\n   */ getAllAgents() {\n        return Array.from(this.agents.values());\n    }\n    /**\r\n   * Get agent by ID\r\n   */ getAgent(agentId) {\n        return this.agents.get(agentId);\n    }\n    constructor(){\n        this.agents = new Map();\n        this.capabilityIndex = new Map();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2VuaGFuY2VkLWFnZW50LXNlbGVjdG9yLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0NBR0MsR0FnQ00sTUFBTUE7SUFJWDs7R0FFQyxHQUNEQyxjQUFjQyxLQUFtQixFQUFRO1FBQ3ZDLElBQUksQ0FBQ0MsTUFBTSxDQUFDQyxHQUFHLENBQUNGLE1BQU1HLEVBQUUsRUFBRUg7UUFFMUIsNENBQTRDO1FBQzVDQSxNQUFNSSxZQUFZLENBQUNDLE9BQU8sQ0FBQyxDQUFDQztZQUMxQixJQUFJLENBQUMsSUFBSSxDQUFDQyxlQUFlLENBQUNDLEdBQUcsQ0FBQ0YsV0FBV0gsRUFBRSxHQUFHO2dCQUM1QyxJQUFJLENBQUNJLGVBQWUsQ0FBQ0wsR0FBRyxDQUFDSSxXQUFXSCxFQUFFLEVBQUUsRUFBRTtZQUM1QztZQUNBLElBQUksQ0FBQ0ksZUFBZSxDQUFDRSxHQUFHLENBQUNILFdBQVdILEVBQUUsRUFBR08sSUFBSSxDQUFDVjtRQUNoRDtJQUNGO0lBRUE7O0dBRUMsR0FDRFcsWUFDRUMsS0FBYSxFQUNiQyxPQUFzQixFQUt0QjtRQUNBLE1BQU1DLGFBQWFGLE1BQU1HLFdBQVc7UUFDcEMsTUFBTUMsYUFJRCxFQUFFO1FBRVAsOENBQThDO1FBQzlDLEtBQUssTUFBTWhCLFNBQVNpQixNQUFNQyxJQUFJLENBQUMsSUFBSSxDQUFDakIsTUFBTSxDQUFDa0IsTUFBTSxJQUFLO1lBQ3BELElBQUluQixNQUFNb0IsTUFBTSxLQUFLLFVBQVU7WUFFL0IsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLFNBQVMsRUFBRSxHQUFHLElBQUksQ0FBQ0MsVUFBVSxDQUFDdkIsT0FBT2MsWUFBWUQ7WUFDaEUsSUFBSVEsUUFBUSxHQUFHO2dCQUNiTCxXQUFXTixJQUFJLENBQUM7b0JBQUVWO29CQUFPcUI7b0JBQU9DO2dCQUFVO1lBQzVDO1FBQ0Y7UUFFQSxnQ0FBZ0M7UUFDaENOLFdBQVdRLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNQSxFQUFFTCxLQUFL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QUFJLENBQUNDLE1BQU0sQ0FBQ1EsR0FBRyxDQUFDMEQ7UUFDOUIsSUFBSSxDQUFDbkUsT0FBTztRQUVaLGtEQUFrRDtRQUNsREEsTUFBTTRELFdBQVcsR0FBRzVELE1BQU00RCxXQUFXLEdBQUcsTUFBTSxDQUFDUSxVQUFVLElBQUksS0FBSztRQUVsRSxvREFBb0Q7UUFDcERwRSxNQUFNMEQsWUFBWSxHQUFHMUQsTUFBTTBELFlBQVksR0FBRyxNQUFNQSxlQUFlO1FBRS9ELG1CQUFtQjtRQUNuQjFELE1BQU11RCxRQUFRLEdBQUcsSUFBSUY7SUFDdkI7SUFFQTs7R0FFQyxHQUNEZ0IsZUFBK0I7UUFDN0IsT0FBT3BELE1BQU1DLElBQUksQ0FBQyxJQUFJLENBQUNqQixNQUFNLENBQUNrQixNQUFNO0lBQ3RDO0lBRUE7O0dBRUMsR0FDRG1ELFNBQVNILE9BQWUsRUFBNEI7UUFDbEQsT0FBTyxJQUFJLENBQUNsRSxNQUFNLENBQUNRLEdBQUcsQ0FBQzBEO0lBQ3pCOzthQS9OUWxFLFNBQW9DLElBQUlzRTthQUN4Q2hFLGtCQUErQyxJQUFJZ0U7O0FBK043RCIsInNvdXJjZXMiOlsid2VicGFjazovL3F1aXotZnJvbnRlbmQvLi9zcmMvbGliL2VuaGFuY2VkLWFnZW50LXNlbGVjdG9yLnRzP2JmOTIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEVuaGFuY2VkIEFnZW50IFNlbGVjdGlvbiBTeXN0ZW1cclxuICogUHJvdmlkZXMgc29waGlzdGljYXRlZCBhZ2VudCByb3V0aW5nIGJhc2VkIG9uIG11bHRpcGxlIGNyaXRlcmlhXHJcbiAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBZ2VudENhcGFiaWxpdHkge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAga2V5d29yZHM6IHN0cmluZ1tdO1xyXG4gIGNvbmZpZGVuY2U6IG51bWJlcjsgLy8gMC0xIHNjb3JlIGZvciBob3cgd2VsbCB0aGlzIGFnZW50IGhhbmRsZXMgdGhpcyBjYXBhYmlsaXR5XHJcbiAgcmVxdWlyZW1lbnRzPzogc3RyaW5nW107IC8vIEFkZGl0aW9uYWwgcmVxdWlyZW1lbnRzIChlLmcuLCBcIm5lZWRzLWF1dGhcIiwgXCJoaWdoLW1lbW9yeVwiKVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFnZW50UHJvZmlsZSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgY2FwYWJpbGl0aWVzOiBBZ2VudENhcGFiaWxpdHlbXTtcclxuICBzdGF0dXM6IFwib25saW5lXCIgfCBcIm9mZmxpbmVcIiB8IFwiYnVzeVwiIHwgXCJtYWludGVuYW5jZVwiO1xyXG4gIGxvYWQ6IG51bWJlcjsgLy8gQ3VycmVudCBsb2FkICgwLTEpXHJcbiAgcmVzcG9uc2VUaW1lOiBudW1iZXI7IC8vIEF2ZXJhZ2UgcmVzcG9uc2UgdGltZSBpbiBtc1xyXG4gIHJlbGlhYmlsaXR5OiBudW1iZXI7IC8vIFN1Y2Nlc3MgcmF0ZSAoMC0xKVxyXG4gIGxhc3RTZWVuOiBEYXRlO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJ5Q29udGV4dCB7XHJcbiAgcXVlcnk6IHN0cmluZztcclxuICB1c2VySW50ZW50Pzogc3RyaW5nO1xyXG4gIHByZXZpb3VzQ29udGV4dD86IGFueTtcclxuICB1c2VyUHJlZmVyZW5jZXM/OiBhbnk7XHJcbiAgdXJnZW5jeT86IFwibG93XCIgfCBcIm1lZGl1bVwiIHwgXCJoaWdoXCI7XHJcbiAgY29tcGxleGl0eT86IFwic2ltcGxlXCIgfCBcIm1vZGVyYXRlXCIgfCBcImNvbXBsZXhcIjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEVuaGFuY2VkQWdlbnRTZWxlY3RvciB7XHJcbiAgcHJpdmF0ZSBhZ2VudHM6IE1hcDxzdHJpbmcsIEFnZW50UHJvZmlsZT4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSBjYXBhYmlsaXR5SW5kZXg6IE1hcDxzdHJpbmcsIEFnZW50UHJvZmlsZVtdPiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXIgYW4gYWdlbnQgd2l0aCBpdHMgY2FwYWJpbGl0aWVzXHJcbiAgICovXHJcbiAgcmVnaXN0ZXJBZ2VudChhZ2VudDogQWdlbnRQcm9maWxlKTogdm9pZCB7XHJcbiAgICB0aGlzLmFnZW50cy5zZXQoYWdlbnQuaWQsIGFnZW50KTtcclxuXHJcbiAgICAvLyBCdWlsZCBjYXBhYmlsaXR5IGluZGV4IGZvciBmYXN0ZXIgbG9va3Vwc1xyXG4gICAgYWdlbnQuY2FwYWJpbGl0aWVzLmZvckVhY2goKGNhcGFiaWxpdHkpID0+IHtcclxuICAgICAgaWYgKCF0aGlzLmNhcGFiaWxpdHlJbmRleC5oYXMoY2FwYWJpbGl0eS5pZCkpIHtcclxuICAgICAgICB0aGlzLmNhcGFiaWxpdHlJbmRleC5zZXQoY2FwYWJpbGl0eS5pZCwgW10pO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuY2FwYWJpbGl0eUluZGV4LmdldChjYXBhYmlsaXR5LmlkKSEucHVzaChhZ2VudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNlbGVjdCB0aGUgYmVzdCBhZ2VudCBmb3IgYSBnaXZlbiBxdWVyeSB1c2luZyBtdWx0aXBsZSBjcml0ZXJpYVxyXG4gICAqL1xyXG4gIHNlbGVjdEFnZW50KFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ/OiBRdWVyeUNvbnRleHRcclxuICApOiB7XHJcbiAgICBhZ2VudDogQWdlbnRQcm9maWxlIHwgbnVsbDtcclxuICAgIGNvbmZpZGVuY2U6IG51bWJlcjtcclxuICAgIHJlYXNvbmluZzogc3RyaW5nO1xyXG4gIH0ge1xyXG4gICAgY29uc3QgcXVlcnlMb3dlciA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBjYW5kaWRhdGVzOiBBcnJheTx7XHJcbiAgICAgIGFnZW50OiBBZ2VudFByb2ZpbGU7XHJcbiAgICAgIHNjb3JlOiBudW1iZXI7XHJcbiAgICAgIHJlYXNvbmluZzogc3RyaW5nO1xyXG4gICAgfT4gPSBbXTtcclxuXHJcbiAgICAvLyBTY29yZSBlYWNoIGFnZW50IGJhc2VkIG9uIG11bHRpcGxlIGNyaXRlcmlhXHJcbiAgICBmb3IgKGNvbnN0IGFnZW50IG9mIEFycmF5LmZyb20odGhpcy5hZ2VudHMudmFsdWVzKCkpKSB7XHJcbiAgICAgIGlmIChhZ2VudC5zdGF0dXMgIT09IFwib25saW5lXCIpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgY29uc3QgeyBzY29yZSwgcmVhc29uaW5nIH0gPSB0aGlzLnNjb3JlQWdlbnQoYWdlbnQsIHF1ZXJ5TG93ZXIsIGNvbnRleHQpO1xyXG4gICAgICBpZiAoc2NvcmUgPiAwKSB7XHJcbiAgICAgICAgY2FuZGlkYXRlcy5wdXNoKHsgYWdlbnQsIHNjb3JlLCByZWFzb25pbmcgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBTb3J0IGJ5IHNjb3JlIChoaWdoZXN0IGZpcnN0KVxyXG4gICAgY2FuZGlkYXRlcy5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSk7XHJcblxyXG4gICAgaWYgKGNhbmRpZGF0ZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgYWdlbnQ6IG51bGwsXHJcbiAgICAgICAgY29uZmlkZW5jZTogMCxcclxuICAgICAgICByZWFzb25pbmc6IFwiTm8gc3VpdGFibGUgYWdlbnRzIGZvdW5kXCIsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYmVzdCA9IGNhbmRpZGF0ZXNbMF07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhZ2VudDogYmVzdC5hZ2VudCxcclxuICAgICAgY29uZmlkZW5jZTogYmVzdC5zY29yZSxcclxuICAgICAgcmVhc29uaW5nOiBiZXN0LnJlYXNvbmluZyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTY29yZSBhbiBhZ2VudCBiYXNlZCBvbiBtdWx0aXBsZSBjcml0ZXJpYVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2NvcmVBZ2VudChcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUsXHJcbiAgICBxdWVyeUxvd2VyOiBzdHJpbmcsXHJcbiAgICBjb250ZXh0PzogUXVlcnlDb250ZXh0XHJcbiAgKTogeyBzY29yZTogbnVtYmVyOyByZWFzb25pbmc6IHN0cmluZyB9IHtcclxuICAgIGxldCB0b3RhbFNjb3JlID0gMDtcclxuICAgIGNvbnN0IHJlYXNvbnM6IHN0cmluZ1tdID0gW107XHJcblxyXG4gICAgLy8gMS4gQ2FwYWJpbGl0eSBtYXRjaGluZyAoNDAlIHdlaWdodClcclxuICAgIGNvbnN0IGNhcGFiaWxpdHlTY29yZSA9IHRoaXMuY2FsY3VsYXRlQ2FwYWJpbGl0eVNjb3JlKGFnZW50LCBxdWVyeUxvd2VyKTtcclxuICAgIHRvdGFsU2NvcmUgKz0gY2FwYWJpbGl0eVNjb3JlICogMC40O1xyXG4gICAgaWYgKGNhcGFiaWxpdHlTY29yZSA+IDApIHtcclxuICAgICAgcmVhc29ucy5wdXNoKGBDYXBhYmlsaXR5IG1hdGNoOiAke2NhcGFiaWxpdHlTY29yZS50b0ZpeGVkKDIpfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDIuIEFnZW50IGF2YWlsYWJpbGl0eSAoMjAlIHdlaWdodClcclxuICAgIGNvbnN0IGF2YWlsYWJpbGl0eVNjb3JlID0gdGhpcy5jYWxjdWxhdGVBdmFpbGFiaWxpdHlTY29yZShhZ2VudCk7XHJcbiAgICB0b3RhbFNjb3JlICs9IGF2YWlsYWJpbGl0eVNjb3JlICogMC4yO1xyXG4gICAgcmVhc29ucy5wdXNoKGBBdmFpbGFiaWxpdHk6ICR7YXZhaWxhYmlsaXR5U2NvcmUudG9GaXhlZCgyKX1gKTtcclxuXHJcbiAgICAvLyAzLiBQZXJmb3JtYW5jZSBtZXRyaWNzICgyMCUgd2VpZ2h0KVxyXG4gICAgY29uc3QgcGVyZm9ybWFuY2VTY29yZSA9IHRoaXMuY2FsY3VsYXRlUGVyZm9ybWFuY2VTY29yZShhZ2VudCk7XHJcbiAgICB0b3RhbFNjb3JlICs9IHBlcmZvcm1hbmNlU2NvcmUgKiAwLjI7XHJcbiAgICByZWFzb25zLnB1c2goYFBlcmZvcm1hbmNlOiAke3BlcmZvcm1hbmNlU2NvcmUudG9GaXhlZCgyKX1gKTtcclxuXHJcbiAgICAvLyA0LiBDb250ZXh0IGF3YXJlbmVzcyAoMjAlIHdlaWdodClcclxuICAgIGNvbnN0IGNvbnRleHRTY29yZSA9IHRoaXMuY2FsY3VsYXRlQ29udGV4dFNjb3JlKGFnZW50LCBjb250ZXh0KTtcclxuICAgIHRvdGFsU2NvcmUgKz0gY29udGV4dFNjb3JlICogMC4yO1xyXG4gICAgaWYgKGNvbnRleHRTY29yZSA+IDApIHtcclxuICAgICAgcmVhc29ucy5wdXNoKGBDb250ZXh0IG1hdGNoOiAke2NvbnRleHRTY29yZS50b0ZpeGVkKDIpfWApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHNjb3JlOiBNYXRoLm1pbih0b3RhbFNjb3JlLCAxKSwgLy8gQ2FwIGF0IDEuMFxyXG4gICAgICByZWFzb25pbmc6IHJlYXNvbnMuam9pbihcIiwgXCIpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlQ2FwYWJpbGl0eVNjb3JlKFxyXG4gICAgYWdlbnQ6IEFnZW50UHJvZmlsZSxcclxuICAgIHF1ZXJ5TG93ZXI6IHN0cmluZ1xyXG4gICk6IG51bWJlciB7XHJcbiAgICBsZXQgYmVzdE1hdGNoID0gMDtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGNhcGFiaWxpdHkgb2YgYWdlbnQuY2FwYWJpbGl0aWVzKSB7XHJcbiAgICAgIGxldCBjYXBhYmlsaXR5U2NvcmUgPSAwO1xyXG5cclxuICAgICAgLy8gQ2hlY2sga2V5d29yZCBtYXRjaGVzXHJcbiAgICAgIGNvbnN0IGtleXdvcmRNYXRjaGVzID0gY2FwYWJpbGl0eS5rZXl3b3Jkcy5maWx0ZXIoKGtleXdvcmQpID0+XHJcbiAgICAgICAgcXVlcnlMb3dlci5pbmNsdWRlcyhrZXl3b3JkLnRvTG93ZXJDYXNlKCkpXHJcbiAgICAgICkubGVuZ3RoO1xyXG5cclxuICAgICAgaWYgKGtleXdvcmRNYXRjaGVzID4gMCkge1xyXG4gICAgICAgIGNhcGFiaWxpdHlTY29yZSA9XHJcbiAgICAgICAgICAoa2V5d29yZE1hdGNoZXMgLyBjYXBhYmlsaXR5LmtleXdvcmRzLmxlbmd0aCkgKiBjYXBhYmlsaXR5LmNvbmZpZGVuY2U7XHJcbiAgICAgICAgYmVzdE1hdGNoID0gTWF0aC5tYXgoYmVzdE1hdGNoLCBjYXBhYmlsaXR5U2NvcmUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGJlc3RNYXRjaDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlQXZhaWxhYmlsaXR5U2NvcmUoYWdlbnQ6IEFnZW50UHJvZmlsZSk6IG51bWJlciB7XHJcbiAgICAvLyBGYWN0b3IgaW4gc3RhdHVzLCBsb2FkLCBhbmQgcmVjZW50IGFjdGl2aXR5XHJcbiAgICBsZXQgc2NvcmUgPSAxLjA7XHJcblxyXG4gICAgaWYgKGFnZW50LnN0YXR1cyA9PT0gXCJidXN5XCIpIHNjb3JlICo9IDAuNztcclxuICAgIGlmIChhZ2VudC5zdGF0dXMgPT09IFwibWFpbnRlbmFuY2VcIikgc2NvcmUgKj0gMC4xO1xyXG4gICAgaWYgKGFnZW50LmxvYWQgPiAwLjgpIHNjb3JlICo9IDAuNTtcclxuXHJcbiAgICAvLyBDaGVjayBpZiBhZ2VudCB3YXMgcmVjZW50bHkgYWN0aXZlXHJcbiAgICBjb25zdCB0aW1lU2luY2VMYXN0U2VlbiA9IERhdGUubm93KCkgLSBhZ2VudC5sYXN0U2Vlbi5nZXRUaW1lKCk7XHJcbiAgICBpZiAodGltZVNpbmNlTGFzdFNlZW4gPiAzMDAwMDApIHtcclxuICAgICAgLy8gNSBtaW51dGVzXHJcbiAgICAgIHNjb3JlICo9IDAuODtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gc2NvcmU7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZVBlcmZvcm1hbmNlU2NvcmUoYWdlbnQ6IEFnZW50UHJvZmlsZSk6IG51bWJlciB7XHJcbiAgICAvLyBDb21iaW5lIHJlc3BvbnNlIHRpbWUgYW5kIHJlbGlhYmlsaXR5XHJcbiAgICBjb25zdCByZXNwb25zZVNjb3JlID0gTWF0aC5tYXgoMCwgMSAtIGFnZW50LnJlc3BvbnNlVGltZSAvIDUwMDApOyAvLyA1cyBtYXhcclxuICAgIGNvbnN0IHJlbGlhYmlsaXR5U2NvcmUgPSBhZ2VudC5yZWxpYWJpbGl0eTtcclxuXHJcbiAgICByZXR1cm4gKHJlc3BvbnNlU2NvcmUgKyByZWxpYWJpbGl0eVNjb3JlKSAvIDI7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZUNvbnRleHRTY29yZShcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUsXHJcbiAgICBjb250ZXh0PzogUXVlcnlDb250ZXh0XHJcbiAgKTogbnVtYmVyIHtcclxuICAgIGlmICghY29udGV4dCkgcmV0dXJuIDAuNTsgLy8gTmV1dHJhbCBzY29yZSBpZiBubyBjb250ZXh0XHJcblxyXG4gICAgbGV0IHNjb3JlID0gMC41OyAvLyBCYXNlIHNjb3JlXHJcblxyXG4gICAgLy8gQWRqdXN0IGJhc2VkIG9uIHVyZ2VuY3lcclxuICAgIGlmIChjb250ZXh0LnVyZ2VuY3kgPT09IFwiaGlnaFwiICYmIGFnZW50LnJlc3BvbnNlVGltZSA8IDEwMDApIHtcclxuICAgICAgc2NvcmUgKz0gMC4zO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiBjb21wbGV4aXR5XHJcbiAgICBpZiAoY29udGV4dC5jb21wbGV4aXR5ID09PSBcImNvbXBsZXhcIiAmJiBhZ2VudC5jYXBhYmlsaXRpZXMubGVuZ3RoID4gMykge1xyXG4gICAgICBzY29yZSArPSAwLjI7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE1hdGgubWluKHNjb3JlLCAxLjApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGZhbGxiYWNrIGFnZW50cyBpZiBwcmltYXJ5IHNlbGVjdGlvbiBmYWlsc1xyXG4gICAqL1xyXG4gIGdldEZhbGxiYWNrQWdlbnRzKHF1ZXJ5OiBzdHJpbmcsIGV4Y2x1ZGVBZ2VudElkPzogc3RyaW5nKTogQWdlbnRQcm9maWxlW10ge1xyXG4gICAgY29uc3QgY2FuZGlkYXRlcyA9IEFycmF5LmZyb20odGhpcy5hZ2VudHMudmFsdWVzKCkpXHJcbiAgICAgIC5maWx0ZXIoXHJcbiAgICAgICAgKGFnZW50KSA9PiBhZ2VudC5zdGF0dXMgPT09IFwib25saW5lXCIgJiYgYWdlbnQuaWQgIT09IGV4Y2x1ZGVBZ2VudElkXHJcbiAgICAgIClcclxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIucmVsaWFiaWxpdHkgLSBhLnJlbGlhYmlsaXR5KTtcclxuXHJcbiAgICByZXR1cm4gY2FuZGlkYXRlcy5zbGljZSgwLCAzKTsgLy8gUmV0dXJuIHRvcCAzIGZhbGxiYWNrc1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGFnZW50IG1ldHJpY3MgYWZ0ZXIgdGFzayBjb21wbGV0aW9uXHJcbiAgICovXHJcbiAgdXBkYXRlQWdlbnRNZXRyaWNzKFxyXG4gICAgYWdlbnRJZDogc3RyaW5nLFxyXG4gICAgc3VjY2VzczogYm9vbGVhbixcclxuICAgIHJlc3BvbnNlVGltZTogbnVtYmVyXHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBhZ2VudCA9IHRoaXMuYWdlbnRzLmdldChhZ2VudElkKTtcclxuICAgIGlmICghYWdlbnQpIHJldHVybjtcclxuXHJcbiAgICAvLyBVcGRhdGUgcmVsaWFiaWxpdHkgKGV4cG9uZW50aWFsIG1vdmluZyBhdmVyYWdlKVxyXG4gICAgYWdlbnQucmVsaWFiaWxpdHkgPSBhZ2VudC5yZWxpYWJpbGl0eSAqIDAuOSArIChzdWNjZXNzID8gMSA6IDApICogMC4xO1xyXG5cclxuICAgIC8vIFVwZGF0ZSByZXNwb25zZSB0aW1lIChleHBvbmVudGlhbCBtb3ZpbmcgYXZlcmFnZSlcclxuICAgIGFnZW50LnJlc3BvbnNlVGltZSA9IGFnZW50LnJlc3BvbnNlVGltZSAqIDAuOCArIHJlc3BvbnNlVGltZSAqIDAuMjtcclxuXHJcbiAgICAvLyBVcGRhdGUgbGFzdCBzZWVuXHJcbiAgICBhZ2VudC5sYXN0U2VlbiA9IG5ldyBEYXRlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIHJlZ2lzdGVyZWQgYWdlbnRzXHJcbiAgICovXHJcbiAgZ2V0QWxsQWdlbnRzKCk6IEFnZW50UHJvZmlsZVtdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuYWdlbnRzLnZhbHVlcygpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhZ2VudCBieSBJRFxyXG4gICAqL1xyXG4gIGdldEFnZW50KGFnZW50SWQ6IHN0cmluZyk6IEFnZW50UHJvZmlsZSB8IHVuZGVmaW5lZCB7XHJcbiAgICByZXR1cm4gdGhpcy5hZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRW5oYW5jZWRBZ2VudFNlbGVjdG9yIiwicmVnaXN0ZXJBZ2VudCIsImFnZW50IiwiYWdlbnRzIiwic2V0IiwiaWQiLCJjYXBhYmlsaXRpZXMiLCJmb3JFYWNoIiwiY2FwYWJpbGl0eSIsImNhcGFiaWxpdHlJbmRleCIsImhhcyIsImdldCIsInB1c2giLCJzZWxlY3RBZ2VudCIsInF1ZXJ5IiwiY29udGV4dCIsInF1ZXJ5TG93ZXIiLCJ0b0xvd2VyQ2FzZSIsImNhbmRpZGF0ZXMiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJzdGF0dXMiLCJzY29yZSIsInJlYXNvbmluZyIsInNjb3JlQWdlbnQiLCJzb3J0IiwiYSIsImIiLCJsZW5ndGgiLCJjb25maWRlbmNlIiwiYmVzdCIsInRvdGFsU2NvcmUiLCJyZWFzb25zIiwiY2FwYWJpbGl0eVNjb3JlIiwiY2FsY3VsYXRlQ2FwYWJpbGl0eVNjb3JlIiwidG9GaXhlZCIsImF2YWlsYWJpbGl0eVNjb3JlIiwiY2FsY3VsYXRlQXZhaWxhYmlsaXR5U2NvcmUiLCJwZXJmb3JtYW5jZVNjb3JlIiwiY2FsY3VsYXRlUGVyZm9ybWFuY2VTY29yZSIsImNvbnRleHRTY29yZSIsImNhbGN1bGF0ZUNvbnRleHRTY29yZSIsIk1hdGgiLCJtaW4iLCJqb2luIiwiYmVzdE1hdGNoIiwia2V5d29yZE1hdGNoZXMiLCJrZXl3b3JkcyIsImZpbHRlciIsImtleXdvcmQiLCJpbmNsdWRlcyIsIm1heCIsImxvYWQiLCJ0aW1lU2luY2VMYXN0U2VlbiIsIkRhdGUiLCJub3ciLCJsYXN0U2VlbiIsImdldFRpbWUiLCJyZXNwb25zZVNjb3JlIiwicmVzcG9uc2VUaW1lIiwicmVsaWFiaWxpdHlTY29yZSIsInJlbGlhYmlsaXR5IiwidXJnZW5jeSIsImNvbXBsZXhpdHkiLCJnZXRGYWxsYmFja0FnZW50cyIsImV4Y2x1ZGVBZ2VudElkIiwic2xpY2UiLCJ1cGRhdGVBZ2VudE1ldHJpY3MiLCJhZ2VudElkIiwic3VjY2VzcyIsImdldEFsbEFnZW50cyIsImdldEFnZW50IiwiTWFwIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/enhanced-agent-selector.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/environment-agent-manager.ts":
/*!**********************************************!*\
  !*** ./src/lib/environment-agent-manager.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EnvironmentAgentManager: () => (/* binding */ EnvironmentAgentManager)\n/* harmony export */ });\n/**\r\n * Environment-based Agent Configuration\r\n * Handles different environments (dev, staging, prod) dynamically\r\n */ class EnvironmentAgentManager {\n    constructor(environment = \"development\"){\n        this.discoveredAgents = new Map();\n        this.config = this.loadEnvironmentConfig(environment);\n        this.discoverAgents();\n    }\n    /**\r\n   * Load configuration based on environment\r\n   */ loadEnvironmentConfig(environment) {\n        const configs = {\n            development: {\n                name: \"development\",\n                agents: {\n                    frontend: {\n                        url: \"http://localhost:3000\",\n                        instances: [\n                            \"http://localhost:3000\",\n                            \"http://localhost:3001\"\n                        ]\n                    },\n                    backend: {\n                        url: \"http://localhost:4001\",\n                        instances: [\n                            \"http://localhost:4001\",\n                            \"http://localhost:4002\"\n                        ]\n                    },\n                    services: [\n                        {\n                            name: \"quiz-generator\",\n                            url: \"http://localhost:4001\",\n                            capabilities: [\n                                \"quiz-generation\",\n                                \"content-analysis\"\n                            ]\n                        },\n                        {\n                            name: \"quiz-display\",\n                            url: \"http://localhost:3000\",\n                            capabilities: [\n                                \"ui-orchestration\",\n                                \"quiz-display\"\n                            ]\n                        }\n                    ]\n                }\n            },\n            staging: {\n                name: \"staging\",\n                agents: {\n                    frontend: {\n                        url: \"https://quiz-frontend-staging.example.com\",\n                        instances: [\n                            \"https://quiz-frontend-staging.example.com\",\n                            \"https://quiz-frontend-staging-2.example.com\"\n                        ]\n                    },\n                    backend: {\n                        url: \"https://quiz-backend-staging.example.com\",\n                        instances: [\n                            \"https://quiz-backend-staging.example.com\",\n                            \"https://quiz-backend-staging-2.example.com\"\n                        ]\n                    },\n                    services: [\n                        {\n                            name: \"quiz-generator\",\n                            url: \"https://quiz-backend-staging.example.com\",\n                            capabilities: [\n                                \"quiz-generation\",\n                                \"content-analysis\"\n                            ]\n                        },\n                        {\n                            name: \"quiz-display\",\n                            url: \"https://quiz-frontend-staging.example.com\",\n                            capabilities: [\n                                \"ui-orchestration\",\n                                \"quiz-display\"\n                            ]\n                        }\n                    ]\n                }\n            },\n            production: {\n                name: \"production\",\n                agents: {\n                    frontend: {\n                        url: \"https://quiz-frontend.example.com\",\n                        instances: [\n                            \"https://quiz-frontend.example.com\",\n                            \"https://quiz-frontend-2.example.com\",\n                            \"https://quiz-frontend-3.example.com\"\n                        ]\n                    },\n                    backend: {\n                        url: \"https://quiz-backend.example.com\",\n                        instances: [\n                            \"https://quiz-backend.example.com\",\n                            \"https://quiz-backend-2.example.com\",\n                            \"https://quiz-backend-3.example.com\"\n                        ]\n                    },\n                    services: [\n                        {\n                            name: \"quiz-generator\",\n                            url: \"https://quiz-backend.example.com\",\n                            capabilities: [\n                                \"quiz-generation\",\n                                \"content-analysis\"\n                            ]\n                        },\n                        {\n                            name: \"quiz-display\",\n                            url: \"https://quiz-frontend.example.com\",\n                            capabilities: [\n                                \"ui-orchestration\",\n                                \"quiz-display\"\n                            ]\n                        }\n                    ]\n                }\n            }\n        };\n        return configs[environment] || configs.development;\n    }\n    /**\r\n   * Discover agents from environment configuration\r\n   */ async discoverAgents() {\n        const { agents } = this.config;\n        // Add frontend agents\n        if (agents.frontend.instances) {\n            for (const url of agents.frontend.instances){\n                await this.addAgent({\n                    id: `frontend-${url}`,\n                    name: \"Frontend Agent\",\n                    url,\n                    capabilities: [\n                        \"ui-orchestration\",\n                        \"quiz-display\"\n                    ],\n                    type: \"frontend\"\n                });\n            }\n        }\n        // Add backend agents\n        if (agents.backend.instances) {\n            for (const url of agents.backend.instances){\n                await this.addAgent({\n                    id: `backend-${url}`,\n                    name: \"Backend Agent\",\n                    url,\n                    capabilities: [\n                        \"quiz-generation\",\n                        \"content-analysis\"\n                    ],\n                    type: \"backend\"\n                });\n            }\n        }\n        // Add additional services\n        if (agents.services) {\n            for (const service of agents.services){\n                if (service.instances) {\n                    for (const url of service.instances){\n                        await this.addAgent({\n                            id: `${service.name}-${url}`,\n                            name: service.name,\n                            url,\n                            capabilities: service.capabilities,\n                            type: \"service\"\n                        });\n                    }\n                } else {\n                    await this.addAgent({\n                        id: service.name,\n                        name: service.name,\n                        url: service.url,\n                        capabilities: service.capabilities,\n                        type: \"service\"\n                    });\n                }\n            }\n        }\n    }\n    /**\r\n   * Add agent to registry\r\n   */ async addAgent(agentInfo) {\n        try {\n            // Probe agent to verify it's online\n            const isOnline = await this.probeAgent(agentInfo.url);\n            this.discoveredAgents.set(agentInfo.id, {\n                ...agentInfo,\n                status: isOnline ? \"online\" : \"offline\",\n                lastSeen: new Date()\n            });\n        } catch (error) {\n            console.warn(`Failed to probe agent ${agentInfo.id}:`, error);\n            this.discoveredAgents.set(agentInfo.id, {\n                ...agentInfo,\n                status: \"offline\",\n                lastSeen: new Date()\n            });\n        }\n    }\n    /**\r\n   * Probe agent to check if it's online\r\n   */ async probeAgent(url) {\n        try {\n            const controller = new AbortController();\n            const timeoutId = setTimeout(()=>controller.abort(), 3000);\n            const response = await fetch(`${url}/health`, {\n                signal: controller.signal\n            });\n            clearTimeout(timeoutId);\n            return response.ok;\n        } catch (error) {\n            return false;\n        }\n    }\n    /**\r\n   * Get all agents\r\n   */ getAllAgents() {\n        return Array.from(this.discoveredAgents.values());\n    }\n    /**\r\n   * Get agents by type\r\n   */ getAgentsByType(type) {\n        return this.getAllAgents().filter((agent)=>agent.type === type);\n    }\n    /**\r\n   * Get agents by capability\r\n   */ getAgentsByCapability(capability) {\n        return this.getAllAgents().filter((agent)=>agent.capabilities.includes(capability));\n    }\n    /**\r\n   * Get load-balanced agent URL\r\n   */ getLoadBalancedAgent(capability) {\n        const agents = this.getAgentsByCapability(capability).filter((agent)=>agent.status === \"online\");\n        if (agents.length === 0) return null;\n        // Simple round-robin load balancing\n        const index = Math.floor(Math.random() * agents.length);\n        return agents[index].url;\n    }\n    /**\r\n   * Get primary agent URL (first available)\r\n   */ getPrimaryAgent(capability) {\n        const agent = this.getAgentsByCapability(capability).find((agent)=>agent.status === \"online\");\n        return agent ? agent.url : null;\n    }\n    /**\r\n   * Get environment name\r\n   */ getEnvironmentName() {\n        return this.config.name;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2Vudmlyb25tZW50LWFnZW50LW1hbmFnZXIudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBOzs7Q0FHQyxHQXNCTSxNQUFNQTtJQUlYQyxZQUFZQyxjQUFzQixhQUFhLENBQUU7YUFGekNDLG1CQUFxQyxJQUFJQztRQUcvQyxJQUFJLENBQUNDLE1BQU0sR0FBRyxJQUFJLENBQUNDLHFCQUFxQixDQUFDSjtRQUN6QyxJQUFJLENBQUNLLGNBQWM7SUFDckI7SUFFQTs7R0FFQyxHQUNELHNCQUE4QkwsV0FBbUIsRUFBcUI7UUFDcEUsTUFBTU0sVUFBNkM7WUFDakRDLGFBQWE7Z0JBQ1hDLE1BQU07Z0JBQ05DLFFBQVE7b0JBQ05DLFVBQVU7d0JBQ1JDLEtBQUs7d0JBQ0xDLFdBQVc7NEJBQUM7NEJBQXlCO3lCQUF3QjtvQkFDL0Q7b0JBQ0FDLFNBQVM7d0JBQ1BGLEtBQUs7d0JBQ0xDLFdBQVc7NEJBQUM7NEJBQXlCO3lCQUF3QjtvQkFDL0Q7b0JBQ0FFLFVBQVU7d0JBQ1I7NEJBQ0VOLE1BQU07NEJBQ05HLEtBQUs7NEJBQ0xJLGNBQWM7Z0NBQUM7Z0NBQW1COzZCQUFtQjt3QkFDdkQ7d0JBQ0E7NEJBQ0VQLE1BQU07NEJBQ05HLEtBQUs7NEJBQ0xJLGNBQWM7Z0NBQUM7Z0NBQW9COzZCQUFlO3dCQUNwRDtxQkFDRDtnQkFDSDtZQUNGO1lBQ0FDLFNBQVM7Z0JBQ1BSLE1BQU07Z0JBQ05DLFFBQVE7b0JBQ05DLFVBQVU7d0JBQ1JDLEtBQUs7d0JBQ0xDLFdBQVc7NEJBQ1Q7NEJBQ0E7eUJBQ0Q7b0JBQ0g7b0JBQ0FDLFNBQVM7d0JBQ1BGLEtBQUs7d0JBQ0xDLFdBQVc7NEJBQ1Q7NEJBQ0E7eUJBQ0Q7b0JBQ0g7b0JBQ0FFLFVBQVU7d0JBQ1I7NEJBQ0VOLE1BQU07NEJBQ05HLEtBQUs7NEJBQ0xJLGNBQWM7Z0NBQUM7Z0NBQW1COzZCQUFtQjt3QkFDdkQ7d0JBQ0E7NEJBQ0VQLE1BQU07NEJBQ05HLEtBQUs7NEJBQ0xJLGNBQWM7Z0NBQUM7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QSxNQUFNdEIsTUFBTSxLQUFLO1FBRzlCLElBQUlqQixPQUFPNEMsTUFBTSxLQUFLLEdBQUcsT0FBTztRQUVoQyxvQ0FBb0M7UUFDcEMsTUFBTUMsUUFBUUMsS0FBS0MsS0FBSyxDQUFDRCxLQUFLRSxNQUFNLEtBQUtoRCxPQUFPNEMsTUFBTTtRQUN0RCxPQUFPNUMsTUFBTSxDQUFDNkMsTUFBTSxDQUFDM0MsR0FBRztJQUMxQjtJQUVBOztHQUVDLEdBQ0QrQyxnQkFBZ0JSLFVBQWtCLEVBQWlCO1FBQ2pELE1BQU1GLFFBQVEsSUFBSSxDQUFDQyxxQkFBcUIsQ0FBQ0MsWUFBWVMsSUFBSSxDQUN2RCxDQUFDWCxRQUFVQSxNQUFNdEIsTUFBTSxLQUFLO1FBRzlCLE9BQU9zQixRQUFRQSxNQUFNckMsR0FBRyxHQUFHO0lBQzdCO0lBRUE7O0dBRUMsR0FDRGlELHFCQUE2QjtRQUMzQixPQUFPLElBQUksQ0FBQ3pELE1BQU0sQ0FBQ0ssSUFBSTtJQUN6QjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcXVpei1mcm9udGVuZC8uL3NyYy9saWIvZW52aXJvbm1lbnQtYWdlbnQtbWFuYWdlci50cz82NmM1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBFbnZpcm9ubWVudC1iYXNlZCBBZ2VudCBDb25maWd1cmF0aW9uXHJcbiAqIEhhbmRsZXMgZGlmZmVyZW50IGVudmlyb25tZW50cyAoZGV2LCBzdGFnaW5nLCBwcm9kKSBkeW5hbWljYWxseVxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRW52aXJvbm1lbnRDb25maWcge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBhZ2VudHM6IHtcclxuICAgIGZyb250ZW5kOiB7XHJcbiAgICAgIHVybDogc3RyaW5nO1xyXG4gICAgICBpbnN0YW5jZXM/OiBzdHJpbmdbXTtcclxuICAgIH07XHJcbiAgICBiYWNrZW5kOiB7XHJcbiAgICAgIHVybDogc3RyaW5nO1xyXG4gICAgICBpbnN0YW5jZXM/OiBzdHJpbmdbXTtcclxuICAgIH07XHJcbiAgICBzZXJ2aWNlcz86IEFycmF5PHtcclxuICAgICAgbmFtZTogc3RyaW5nO1xyXG4gICAgICB1cmw6IHN0cmluZztcclxuICAgICAgY2FwYWJpbGl0aWVzOiBzdHJpbmdbXTtcclxuICAgICAgaW5zdGFuY2VzPzogc3RyaW5nW107XHJcbiAgICB9PjtcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRW52aXJvbm1lbnRBZ2VudE1hbmFnZXIge1xyXG4gIHByaXZhdGUgY29uZmlnOiBFbnZpcm9ubWVudENvbmZpZztcclxuICBwcml2YXRlIGRpc2NvdmVyZWRBZ2VudHM6IE1hcDxzdHJpbmcsIGFueT4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGVudmlyb25tZW50OiBzdHJpbmcgPSBcImRldmVsb3BtZW50XCIpIHtcclxuICAgIHRoaXMuY29uZmlnID0gdGhpcy5sb2FkRW52aXJvbm1lbnRDb25maWcoZW52aXJvbm1lbnQpO1xyXG4gICAgdGhpcy5kaXNjb3ZlckFnZW50cygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9hZCBjb25maWd1cmF0aW9uIGJhc2VkIG9uIGVudmlyb25tZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBsb2FkRW52aXJvbm1lbnRDb25maWcoZW52aXJvbm1lbnQ6IHN0cmluZyk6IEVudmlyb25tZW50Q29uZmlnIHtcclxuICAgIGNvbnN0IGNvbmZpZ3M6IFJlY29yZDxzdHJpbmcsIEVudmlyb25tZW50Q29uZmlnPiA9IHtcclxuICAgICAgZGV2ZWxvcG1lbnQ6IHtcclxuICAgICAgICBuYW1lOiBcImRldmVsb3BtZW50XCIsXHJcbiAgICAgICAgYWdlbnRzOiB7XHJcbiAgICAgICAgICBmcm9udGVuZDoge1xyXG4gICAgICAgICAgICB1cmw6IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsXHJcbiAgICAgICAgICAgIGluc3RhbmNlczogW1wiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsIFwiaHR0cDovL2xvY2FsaG9zdDozMDAxXCJdLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGJhY2tlbmQ6IHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiLFxyXG4gICAgICAgICAgICBpbnN0YW5jZXM6IFtcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiLCBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMlwiXSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzZXJ2aWNlczogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgbmFtZTogXCJxdWl6LWdlbmVyYXRvclwiLFxyXG4gICAgICAgICAgICAgIHVybDogXCJodHRwOi8vbG9jYWxob3N0OjQwMDFcIixcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IFtcInF1aXotZ2VuZXJhdGlvblwiLCBcImNvbnRlbnQtYW5hbHlzaXNcIl0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBuYW1lOiBcInF1aXotZGlzcGxheVwiLFxyXG4gICAgICAgICAgICAgIHVybDogXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIixcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IFtcInVpLW9yY2hlc3RyYXRpb25cIiwgXCJxdWl6LWRpc3BsYXlcIl0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIHN0YWdpbmc6IHtcclxuICAgICAgICBuYW1lOiBcInN0YWdpbmdcIixcclxuICAgICAgICBhZ2VudHM6IHtcclxuICAgICAgICAgIGZyb250ZW5kOiB7XHJcbiAgICAgICAgICAgIHVybDogXCJodHRwczovL3F1aXotZnJvbnRlbmQtc3RhZ2luZy5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBpbnN0YW5jZXM6IFtcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1mcm9udGVuZC1zdGFnaW5nLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgICAgXCJodHRwczovL3F1aXotZnJvbnRlbmQtc3RhZ2luZy0yLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYmFja2VuZDoge1xyXG4gICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQtc3RhZ2luZy5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBpbnN0YW5jZXM6IFtcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1iYWNrZW5kLXN0YWdpbmcuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1iYWNrZW5kLXN0YWdpbmctMi5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNlcnZpY2VzOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBuYW1lOiBcInF1aXotZ2VuZXJhdG9yXCIsXHJcbiAgICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vcXVpei1iYWNrZW5kLXN0YWdpbmcuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IFtcInF1aXotZ2VuZXJhdGlvblwiLCBcImNvbnRlbnQtYW5hbHlzaXNcIl0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBuYW1lOiBcInF1aXotZGlzcGxheVwiLFxyXG4gICAgICAgICAgICAgIHVybDogXCJodHRwczovL3F1aXotZnJvbnRlbmQtc3RhZ2luZy5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIGNhcGFiaWxpdGllczogW1widWktb3JjaGVzdHJhdGlvblwiLCBcInF1aXotZGlzcGxheVwiXSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgcHJvZHVjdGlvbjoge1xyXG4gICAgICAgIG5hbWU6IFwicHJvZHVjdGlvblwiLFxyXG4gICAgICAgIGFnZW50czoge1xyXG4gICAgICAgICAgZnJvbnRlbmQ6IHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vcXVpei1mcm9udGVuZC5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBpbnN0YW5jZXM6IFtcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1mcm9udGVuZC5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWZyb250ZW5kLTIuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1mcm9udGVuZC0zLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYmFja2VuZDoge1xyXG4gICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgaW5zdGFuY2VzOiBbXHJcbiAgICAgICAgICAgICAgXCJodHRwczovL3F1aXotYmFja2VuZC5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQtMi5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQtMy5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNlcnZpY2VzOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBuYW1lOiBcInF1aXotZ2VuZXJhdG9yXCIsXHJcbiAgICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vcXVpei1iYWNrZW5kLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBbXCJxdWl6LWdlbmVyYXRpb25cIiwgXCJjb250ZW50LWFuYWx5c2lzXCJdLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgbmFtZTogXCJxdWl6LWRpc3BsYXlcIixcclxuICAgICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9xdWl6LWZyb250ZW5kLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBbXCJ1aS1vcmNoZXN0cmF0aW9uXCIsIFwicXVpei1kaXNwbGF5XCJdLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gY29uZmlnc1tlbnZpcm9ubWVudF0gfHwgY29uZmlncy5kZXZlbG9wbWVudDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERpc2NvdmVyIGFnZW50cyBmcm9tIGVudmlyb25tZW50IGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGRpc2NvdmVyQWdlbnRzKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgeyBhZ2VudHMgfSA9IHRoaXMuY29uZmlnO1xyXG5cclxuICAgIC8vIEFkZCBmcm9udGVuZCBhZ2VudHNcclxuICAgIGlmIChhZ2VudHMuZnJvbnRlbmQuaW5zdGFuY2VzKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdXJsIG9mIGFnZW50cy5mcm9udGVuZC5pbnN0YW5jZXMpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmFkZEFnZW50KHtcclxuICAgICAgICAgIGlkOiBgZnJvbnRlbmQtJHt1cmx9YCxcclxuICAgICAgICAgIG5hbWU6IFwiRnJvbnRlbmQgQWdlbnRcIixcclxuICAgICAgICAgIHVybCxcclxuICAgICAgICAgIGNhcGFiaWxpdGllczogW1widWktb3JjaGVzdHJhdGlvblwiLCBcInF1aXotZGlzcGxheVwiXSxcclxuICAgICAgICAgIHR5cGU6IFwiZnJvbnRlbmRcIixcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBiYWNrZW5kIGFnZW50c1xyXG4gICAgaWYgKGFnZW50cy5iYWNrZW5kLmluc3RhbmNlcykge1xyXG4gICAgICBmb3IgKGNvbnN0IHVybCBvZiBhZ2VudHMuYmFja2VuZC5pbnN0YW5jZXMpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmFkZEFnZW50KHtcclxuICAgICAgICAgIGlkOiBgYmFja2VuZC0ke3VybH1gLFxyXG4gICAgICAgICAgbmFtZTogXCJCYWNrZW5kIEFnZW50XCIsXHJcbiAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICBjYXBhYmlsaXRpZXM6IFtcInF1aXotZ2VuZXJhdGlvblwiLCBcImNvbnRlbnQtYW5hbHlzaXNcIl0sXHJcbiAgICAgICAgICB0eXBlOiBcImJhY2tlbmRcIixcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBhZGRpdGlvbmFsIHNlcnZpY2VzXHJcbiAgICBpZiAoYWdlbnRzLnNlcnZpY2VzKSB7XHJcbiAgICAgIGZvciAoY29uc3Qgc2VydmljZSBvZiBhZ2VudHMuc2VydmljZXMpIHtcclxuICAgICAgICBpZiAoc2VydmljZS5pbnN0YW5jZXMpIHtcclxuICAgICAgICAgIGZvciAoY29uc3QgdXJsIG9mIHNlcnZpY2UuaW5zdGFuY2VzKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWRkQWdlbnQoe1xyXG4gICAgICAgICAgICAgIGlkOiBgJHtzZXJ2aWNlLm5hbWV9LSR7dXJsfWAsXHJcbiAgICAgICAgICAgICAgbmFtZTogc2VydmljZS5uYW1lLFxyXG4gICAgICAgICAgICAgIHVybCxcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IHNlcnZpY2UuY2FwYWJpbGl0aWVzLFxyXG4gICAgICAgICAgICAgIHR5cGU6IFwic2VydmljZVwiLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGRBZ2VudCh7XHJcbiAgICAgICAgICAgIGlkOiBzZXJ2aWNlLm5hbWUsXHJcbiAgICAgICAgICAgIG5hbWU6IHNlcnZpY2UubmFtZSxcclxuICAgICAgICAgICAgdXJsOiBzZXJ2aWNlLnVybCxcclxuICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBzZXJ2aWNlLmNhcGFiaWxpdGllcyxcclxuICAgICAgICAgICAgdHlwZTogXCJzZXJ2aWNlXCIsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZCBhZ2VudCB0byByZWdpc3RyeVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgYWRkQWdlbnQoYWdlbnRJbmZvOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFByb2JlIGFnZW50IHRvIHZlcmlmeSBpdCdzIG9ubGluZVxyXG4gICAgICBjb25zdCBpc09ubGluZSA9IGF3YWl0IHRoaXMucHJvYmVBZ2VudChhZ2VudEluZm8udXJsKTtcclxuXHJcbiAgICAgIHRoaXMuZGlzY292ZXJlZEFnZW50cy5zZXQoYWdlbnRJbmZvLmlkLCB7XHJcbiAgICAgICAgLi4uYWdlbnRJbmZvLFxyXG4gICAgICAgIHN0YXR1czogaXNPbmxpbmUgPyBcIm9ubGluZVwiIDogXCJvZmZsaW5lXCIsXHJcbiAgICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXHJcbiAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gcHJvYmUgYWdlbnQgJHthZ2VudEluZm8uaWR9OmAsIGVycm9yKTtcclxuICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudEluZm8uaWQsIHtcclxuICAgICAgICAuLi5hZ2VudEluZm8sXHJcbiAgICAgICAgc3RhdHVzOiBcIm9mZmxpbmVcIixcclxuICAgICAgICBsYXN0U2VlbjogbmV3IERhdGUoKSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQcm9iZSBhZ2VudCB0byBjaGVjayBpZiBpdCdzIG9ubGluZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgcHJvYmVBZ2VudCh1cmw6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcclxuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDMwMDApO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt1cmx9L2hlYWx0aGAsIHtcclxuICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxyXG4gICAgICB9KTtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcblxyXG4gICAgICByZXR1cm4gcmVzcG9uc2Uub2s7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIGFnZW50c1xyXG4gICAqL1xyXG4gIGdldEFsbEFnZW50cygpOiBhbnlbXSB7XHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmRpc2NvdmVyZWRBZ2VudHMudmFsdWVzKCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFnZW50cyBieSB0eXBlXHJcbiAgICovXHJcbiAgZ2V0QWdlbnRzQnlUeXBlKHR5cGU6IHN0cmluZyk6IGFueVtdIHtcclxuICAgIHJldHVybiB0aGlzLmdldEFsbEFnZW50cygpLmZpbHRlcigoYWdlbnQpID0+IGFnZW50LnR5cGUgPT09IHR5cGUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFnZW50cyBieSBjYXBhYmlsaXR5XHJcbiAgICovXHJcbiAgZ2V0QWdlbnRzQnlDYXBhYmlsaXR5KGNhcGFiaWxpdHk6IHN0cmluZyk6IGFueVtdIHtcclxuICAgIHJldHVybiB0aGlzLmdldEFsbEFnZW50cygpLmZpbHRlcigoYWdlbnQpID0+XHJcbiAgICAgIGFnZW50LmNhcGFiaWxpdGllcy5pbmNsdWRlcyhjYXBhYmlsaXR5KVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBsb2FkLWJhbGFuY2VkIGFnZW50IFVSTFxyXG4gICAqL1xyXG4gIGdldExvYWRCYWxhbmNlZEFnZW50KGNhcGFiaWxpdHk6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgYWdlbnRzID0gdGhpcy5nZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eSkuZmlsdGVyKFxyXG4gICAgICAoYWdlbnQpID0+IGFnZW50LnN0YXR1cyA9PT0gXCJvbmxpbmVcIlxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoYWdlbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgLy8gU2ltcGxlIHJvdW5kLXJvYmluIGxvYWQgYmFsYW5jaW5nXHJcbiAgICBjb25zdCBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFnZW50cy5sZW5ndGgpO1xyXG4gICAgcmV0dXJuIGFnZW50c1tpbmRleF0udXJsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHByaW1hcnkgYWdlbnQgVVJMIChmaXJzdCBhdmFpbGFibGUpXHJcbiAgICovXHJcbiAgZ2V0UHJpbWFyeUFnZW50KGNhcGFiaWxpdHk6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgYWdlbnQgPSB0aGlzLmdldEFnZW50c0J5Q2FwYWJpbGl0eShjYXBhYmlsaXR5KS5maW5kKFxyXG4gICAgICAoYWdlbnQpID0+IGFnZW50LnN0YXR1cyA9PT0gXCJvbmxpbmVcIlxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gYWdlbnQgPyBhZ2VudC51cmwgOiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGVudmlyb25tZW50IG5hbWVcclxuICAgKi9cclxuICBnZXRFbnZpcm9ubWVudE5hbWUoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLmNvbmZpZy5uYW1lO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRW52aXJvbm1lbnRBZ2VudE1hbmFnZXIiLCJjb25zdHJ1Y3RvciIsImVudmlyb25tZW50IiwiZGlzY292ZXJlZEFnZW50cyIsIk1hcCIsImNvbmZpZyIsImxvYWRFbnZpcm9ubWVudENvbmZpZyIsImRpc2NvdmVyQWdlbnRzIiwiY29uZmlncyIsImRldmVsb3BtZW50IiwibmFtZSIsImFnZW50cyIsImZyb250ZW5kIiwidXJsIiwiaW5zdGFuY2VzIiwiYmFja2VuZCIsInNlcnZpY2VzIiwiY2FwYWJpbGl0aWVzIiwic3RhZ2luZyIsInByb2R1Y3Rpb24iLCJhZGRBZ2VudCIsImlkIiwidHlwZSIsInNlcnZpY2UiLCJhZ2VudEluZm8iLCJpc09ubGluZSIsInByb2JlQWdlbnQiLCJzZXQiLCJzdGF0dXMiLCJsYXN0U2VlbiIsIkRhdGUiLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInJlc3BvbnNlIiwiZmV0Y2giLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJvayIsImdldEFsbEFnZW50cyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImdldEFnZW50c0J5VHlwZSIsImZpbHRlciIsImFnZW50IiwiZ2V0QWdlbnRzQnlDYXBhYmlsaXR5IiwiY2FwYWJpbGl0eSIsImluY2x1ZGVzIiwiZ2V0TG9hZEJhbGFuY2VkQWdlbnQiLCJsZW5ndGgiLCJpbmRleCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImdldFByaW1hcnlBZ2VudCIsImZpbmQiLCJnZXRFbnZpcm9ubWVudE5hbWUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/environment-agent-manager.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/orchestratorService.ts":
/*!****************************************!*\
  !*** ./src/lib/orchestratorService.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NextJSOrchestratorService: () => (/* binding */ NextJSOrchestratorService)\n/* harmony export */ });\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist-node/v4.js\");\n/* harmony import */ var _enhanced_agent_selector__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./enhanced-agent-selector */ \"(rsc)/./src/lib/enhanced-agent-selector.ts\");\n/* harmony import */ var _circuit_breaker__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./circuit-breaker */ \"(rsc)/./src/lib/circuit-breaker.ts\");\n/* harmony import */ var _dynamic_agent_discovery__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dynamic-agent-discovery */ \"(rsc)/./src/lib/dynamic-agent-discovery.ts\");\n/* harmony import */ var _environment_agent_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./environment-agent-manager */ \"(rsc)/./src/lib/environment-agent-manager.ts\");\n\n\n\n\n\nclass NextJSOrchestratorService {\n    constructor(){\n        this.agents = new Map();\n        this.workflows = new Map();\n        this.chatHistory = [];\n        // Legacy hardcoded URLs (for backward compatibility)\n        this.knownAgentUrls = [\n            \"http://localhost:3000\",\n            \"http://localhost:4001\",\n            \"http://localhost:5000\"\n        ];\n        this.retryAttempts = 3;\n        this.timeoutMs = 30000;\n        // Dynamic discovery components\n        this.dynamicDiscovery = null;\n        // Initialize enhanced components\n        this.enhancedAgentSelector = new _enhanced_agent_selector__WEBPACK_IMPORTED_MODULE_0__.EnhancedAgentSelector();\n        this.circuitBreaker = new _circuit_breaker__WEBPACK_IMPORTED_MODULE_1__.AgentCircuitBreaker();\n        // Initialize environment-based agent management\n        const environment = \"development\" || 0;\n        this.environmentManager = new _environment_agent_manager__WEBPACK_IMPORTED_MODULE_3__.EnvironmentAgentManager(environment);\n        this.startAgentDiscovery();\n        this.initializeVirtualAgents();\n        this.initializeEnhancedAgents();\n        this.initializeDynamicDiscovery();\n    }\n    /**\r\n   * Initialize enhanced agent profiles with capabilities\r\n   */ initializeEnhancedAgents() {\n        // Backend Quiz Agent\n        const backendAgent = {\n            id: \"backend-quiz-agent\",\n            name: \"Quiz Generation Agent\",\n            url: \"http://localhost:4001\",\n            capabilities: [\n                {\n                    id: \"quiz-generation\",\n                    name: \"Generate Quiz Questions\",\n                    description: \"Creates quiz questions on any topic\",\n                    keywords: [\n                        \"quiz\",\n                        \"question\",\n                        \"test\",\n                        \"exam\",\n                        \"assessment\",\n                        \"multiple choice\",\n                        \"generate\",\n                        \"create\"\n                    ],\n                    confidence: 0.95,\n                    requirements: [\n                        \"openai-api\"\n                    ]\n                },\n                {\n                    id: \"content-analysis\",\n                    name: \"Content Analysis\",\n                    description: \"Analyzes and processes educational content\",\n                    keywords: [\n                        \"analyze\",\n                        \"content\",\n                        \"educational\",\n                        \"material\",\n                        \"process\"\n                    ],\n                    confidence: 0.85\n                }\n            ],\n            status: \"online\",\n            load: 0.0,\n            responseTime: 2000,\n            reliability: 0.95,\n            lastSeen: new Date()\n        };\n        // Frontend Agent\n        const frontendAgent = {\n            id: \"frontend-agent\",\n            name: \"Frontend Orchestration Agent\",\n            url: \"http://localhost:3000\",\n            capabilities: [\n                {\n                    id: \"ui-orchestration\",\n                    name: \"UI Orchestration\",\n                    description: \"Manages user interface and workflow coordination\",\n                    keywords: [\n                        \"workflow\",\n                        \"orchestrate\",\n                        \"coordinate\",\n                        \"manage\",\n                        \"ui\",\n                        \"interface\",\n                        \"display\",\n                        \"render\"\n                    ],\n                    confidence: 0.9\n                },\n                {\n                    id: \"quiz-display\",\n                    name: \"Quiz Display\",\n                    description: \"Renders and manages quiz interfaces\",\n                    keywords: [\n                        \"display\",\n                        \"render\",\n                        \"show\",\n                        \"present\",\n                        \"quiz interface\"\n                    ],\n                    confidence: 0.88\n                }\n            ],\n            status: \"online\",\n            load: 0.0,\n            responseTime: 500,\n            reliability: 0.98,\n            lastSeen: new Date()\n        };\n        // Virtual MCP Agent\n        const mcpAgent = {\n            id: \"virtual-mcp-agent\",\n            name: \"General MCP Agent\",\n            url: \"virtual://normal-mcp-agent\",\n            capabilities: [\n                {\n                    id: \"general-conversation\",\n                    name: \"General Conversation\",\n                    description: \"Handles general queries and conversations\",\n                    keywords: [\n                        \"help\",\n                        \"explain\",\n                        \"general\",\n                        \"conversation\",\n                        \"chat\",\n                        \"assist\"\n                    ],\n                    confidence: 0.8\n                },\n                {\n                    id: \"information-retrieval\",\n                    name: \"Information Retrieval\",\n                    description: \"Retrieves and provides information\",\n                    keywords: [\n                        \"information\",\n                        \"retrieve\",\n                        \"lookup\",\n                        \"search\",\n                        \"find\"\n                    ],\n                    confidence: 0.75\n                }\n            ],\n            status: \"online\",\n            load: 0.0,\n            responseTime: 1000,\n            reliability: 0.9,\n            lastSeen: new Date()\n        };\n        // Register all agents with enhanced selector\n        this.enhancedAgentSelector.registerAgent(backendAgent);\n        this.enhancedAgentSelector.registerAgent(frontendAgent);\n        this.enhancedAgentSelector.registerAgent(mcpAgent);\n    }\n    /**\r\n   * Initialize dynamic agent discovery based on environment\r\n   */ initializeDynamicDiscovery() {\n        const discoveryMethod = process.env.AGENT_DISCOVERY_METHOD || \"environment\";\n        const discoveryConfig = {\n            discoveryMethod: discoveryMethod,\n            environment: {\n                prefix: process.env.AGENT_PREFIX || \"QUIZ_AGENT\",\n                ports: this.parsePorts(process.env.AGENT_PORTS || \"3000,4001,5000\"),\n                hosts: this.parseHosts(process.env.AGENT_HOSTS || \"localhost\")\n            },\n            manual: {\n                agents: this.environmentManager.getAllAgents().map((agent)=>({\n                        id: agent.id,\n                        url: agent.url,\n                        capabilities: agent.capabilities,\n                        metadata: agent.metadata\n                    }))\n            }\n        };\n        try {\n            this.dynamicDiscovery = new _dynamic_agent_discovery__WEBPACK_IMPORTED_MODULE_2__.DynamicAgentDiscovery(discoveryConfig);\n            console.log(`Dynamic agent discovery initialized with method: ${discoveryMethod}`);\n        } catch (error) {\n            console.warn(\"Failed to initialize dynamic discovery, falling back to environment manager:\", error);\n        }\n    }\n    /**\r\n   * Parse comma-separated ports string\r\n   */ parsePorts(portsString) {\n        return portsString.split(\",\").map((port)=>parseInt(port.trim())).filter((port)=>!isNaN(port));\n    }\n    /**\r\n   * Parse comma-separated hosts string\r\n   */ parseHosts(hostsString) {\n        return hostsString.split(\",\").map((host)=>host.trim()).filter((host)=>host.length > 0);\n    }\n    /**\r\n   * Initialize virtual MCP agents that don't have physical endpoints\r\n   */ initializeVirtualAgents() {\n        // Add the normal MCP agent as a virtual agent\n        const normalMCPAgent = {\n            name: \"General MCP Agent\",\n            url: \"virtual://normal-mcp-agent\",\n            skills: [\n                \"general-conversation\",\n                \"information-retrieval\",\n                \"task-assistance\"\n            ],\n            status: \"online\",\n            lastSeen: new Date(),\n            capabilities: {\n                description: \"Handles general queries, conversations, and non-quiz related tasks\",\n                type: \"virtual\"\n            }\n        };\n        this.agents.set(\"virtual://normal-mcp-agent\", normalMCPAgent);\n    }\n    /**\r\n   * Get all available agents (dynamic + legacy)\r\n   */ getAllAvailableAgents() {\n        const agents = [];\n        // Add dynamically discovered agents\n        if (this.dynamicDiscovery) {\n            agents.push(...this.dynamicDiscovery.getAllAgents());\n        }\n        // Add environment-managed agents\n        agents.push(...this.environmentManager.getAllAgents());\n        // Add legacy agents for backward compatibility\n        const legacyAgents = Array.from(this.agents.values());\n        agents.push(...legacyAgents);\n        // Remove duplicates based on URL\n        const uniqueAgents = agents.filter((agent, index, self)=>index === self.findIndex((a)=>a.url === agent.url));\n        return uniqueAgents;\n    }\n    /**\r\n   * Get agents by capability with load balancing\r\n   */ getAgentsByCapability(capability) {\n        const agents = [];\n        // Get from dynamic discovery\n        if (this.dynamicDiscovery) {\n            agents.push(...this.dynamicDiscovery.getAgentsByCapability(capability));\n        }\n        // Get from environment manager\n        agents.push(...this.environmentManager.getAgentsByCapability(capability));\n        // Get from legacy agents\n        const legacyAgents = Array.from(this.agents.values()).filter((agent)=>agent.skills?.includes(capability));\n        agents.push(...legacyAgents);\n        // Remove duplicates and return online agents only\n        const uniqueAgents = agents.filter((agent, index, self)=>index === self.findIndex((a)=>a.url === agent.url));\n        return uniqueAgents.filter((agent)=>agent.status === \"online\");\n    }\n    /**\r\n   * Get load-balanced agent URL for a capability\r\n   */ getLoadBalancedAgentUrl(capability) {\n        // Try environment manager first (has load balancing)\n        const envAgent = this.environmentManager.getLoadBalancedAgent(capability);\n        if (envAgent) return envAgent;\n        // Fall back to dynamic discovery\n        if (this.dynamicDiscovery) {\n            const dynamicAgents = this.dynamicDiscovery.getAgentsByCapability(capability);\n            if (dynamicAgents.length > 0) {\n                const index = Math.floor(Math.random() * dynamicAgents.length);\n                return dynamicAgents[index].url;\n            }\n        }\n        // Fall back to legacy hardcoded URLs\n        switch(capability){\n            case \"quiz-generation\":\n            case \"content-analysis\":\n                return \"http://localhost:4001\";\n            case \"ui-orchestration\":\n            case \"quiz-display\":\n                return \"http://localhost:3000\";\n            default:\n                return null;\n        }\n    }\n    /**\r\n   * Get primary agent URL for a capability\r\n   */ getPrimaryAgentUrl(capability) {\n        // Try environment manager first\n        const envAgent = this.environmentManager.getPrimaryAgent(capability);\n        if (envAgent) return envAgent;\n        // Fall back to dynamic discovery\n        if (this.dynamicDiscovery) {\n            const dynamicAgents = this.dynamicDiscovery.getAgentsByCapability(capability);\n            if (dynamicAgents.length > 0) {\n                return dynamicAgents[0].url;\n            }\n        }\n        // Fall back to legacy hardcoded URLs\n        switch(capability){\n            case \"quiz-generation\":\n            case \"content-analysis\":\n                return \"http://localhost:4001\";\n            case \"ui-orchestration\":\n            case \"quiz-display\":\n                return \"http://localhost:3000\";\n            default:\n                return null;\n        }\n    }\n    /**\r\n   * Enhanced agent selection using sophisticated scoring\r\n   */ determineAgentForQuery(query, context) {\n        const result = this.enhancedAgentSelector.selectAgent(query, context);\n        // Add to chat history for transparency\n        this.addChatMessage({\n            type: \"system\",\n            content: `Agent selection: ${result.agent?.name || \"None\"} (confidence: ${result.confidence.toFixed(2)}, reasoning: ${result.reasoning})`,\n            metadata: {\n                agentId: result.agent?.id,\n                status: \"selection_complete\"\n            }\n        });\n        return result;\n    }\n    /**\r\n   * Legacy method for backward compatibility\r\n   */ determineAgentForQueryLegacy(query) {\n        const lowerQuery = query.toLowerCase();\n        // Quiz-related queries go to backend agent\n        if (lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"question\") || lowerQuery.includes(\"test\") || lowerQuery.includes(\"exam\") || lowerQuery.includes(\"assessment\") || lowerQuery.includes(\"multiple choice\")) {\n            return this.agents.get(\"http://localhost:4001\") || null;\n        }\n        // Workflow/orchestration queries go to frontend agent\n        if (lowerQuery.includes(\"workflow\") || lowerQuery.includes(\"orchestrate\") || lowerQuery.includes(\"coordinate\") || lowerQuery.includes(\"manage\")) {\n            return this.agents.get(\"http://localhost:3000\") || null;\n        }\n        // All other queries go to normal MCP agent\n        return this.agents.get(\"virtual://normal-mcp-agent\") || null;\n    }\n    /**\r\n   * Enhanced agent execution with circuit breaker and retry logic\r\n   */ async executeAgentWithResilience(query, context) {\n        const startTime = Date.now();\n        let selectionTime = 0;\n        let executionTime = 0;\n        try {\n            // Step 1: Select primary agent using enhanced selector\n            const selectionStart = Date.now();\n            const { agent, confidence, reasoning } = this.enhancedAgentSelector.selectAgent(query, context);\n            selectionTime = Date.now() - selectionStart;\n            if (!agent) {\n                return {\n                    success: false,\n                    agent: null,\n                    error: \"No suitable agent found\",\n                    metrics: {\n                        selectionTime,\n                        executionTime: 0,\n                        totalTime: Date.now() - startTime\n                    }\n                };\n            }\n            // Step 2: Check circuit breaker\n            if (!this.circuitBreaker.isAgentAvailable(agent.id)) {\n                console.warn(`Agent ${agent.id} is circuit-broken, trying fallback`);\n                return await this.tryFallbackExecution(query, context, agent.id, startTime, selectionTime);\n            }\n            // Step 3: Execute with retry logic\n            const executionStart = Date.now();\n            const result = await this.executeWithRetry(agent, query, context);\n            executionTime = Date.now() - executionStart;\n            // Record success\n            this.circuitBreaker.recordSuccess(agent.id);\n            this.enhancedAgentSelector.updateAgentMetrics(agent.id, true, executionTime);\n            return {\n                success: true,\n                agent,\n                result,\n                metrics: {\n                    selectionTime,\n                    executionTime,\n                    totalTime: Date.now() - startTime\n                }\n            };\n        } catch (error) {\n            // Record failure and try fallback\n            const agent = this.enhancedAgentSelector.selectAgent(query, context).agent;\n            if (agent) {\n                this.circuitBreaker.recordFailure(agent.id);\n                this.enhancedAgentSelector.updateAgentMetrics(agent.id, false, executionTime);\n            }\n            return await this.tryFallbackExecution(query, context, agent?.id, startTime, selectionTime);\n        }\n    }\n    /**\r\n   * Execute agent with retry logic\r\n   */ async executeWithRetry(agent, query, context) {\n        let lastError = null;\n        for(let attempt = 1; attempt <= this.retryAttempts; attempt++){\n            try {\n                if (agent.url.startsWith(\"virtual://\")) {\n                    return await this.executeVirtualAgent(agent, query, context);\n                } else {\n                    return await this.executeRealAgent(agent, query, context);\n                }\n            } catch (error) {\n                lastError = error;\n                console.warn(`Attempt ${attempt} failed for agent ${agent.id}:`, error);\n                if (attempt < this.retryAttempts) {\n                    // Exponential backoff\n                    await new Promise((resolve)=>setTimeout(resolve, Math.pow(2, attempt) * 1000));\n                }\n            }\n        }\n        throw lastError || new Error(\"All retry attempts failed\");\n    }\n    /**\r\n   * Try fallback agents if primary fails\r\n   */ async tryFallbackExecution(query, context, excludeAgentId, startTime, selectionTime) {\n        const fallbackAgents = this.enhancedAgentSelector.getFallbackAgents(query, excludeAgentId);\n        for (const agent of fallbackAgents){\n            if (!this.circuitBreaker.isAgentAvailable(agent.id)) continue;\n            try {\n                const executionStart = Date.now();\n                const result = await this.executeWithRetry(agent, query, context);\n                const executionTime = Date.now() - executionStart;\n                this.circuitBreaker.recordSuccess(agent.id);\n                this.enhancedAgentSelector.updateAgentMetrics(agent.id, true, executionTime);\n                return {\n                    success: true,\n                    agent,\n                    result,\n                    fallbackUsed: true,\n                    metrics: {\n                        selectionTime,\n                        executionTime,\n                        totalTime: Date.now() - startTime\n                    }\n                };\n            } catch (error) {\n                this.circuitBreaker.recordFailure(agent.id);\n                console.warn(`Fallback agent ${agent.id} also failed:`, error);\n            }\n        }\n        return {\n            success: false,\n            agent: null,\n            error: \"All agents failed, including fallbacks\",\n            metrics: {\n                selectionTime,\n                executionTime: 0,\n                totalTime: Date.now() - startTime\n            }\n        };\n    }\n    /**\r\n   * Execute virtual agent (like MCP)\r\n   */ async executeVirtualAgent(agent, query, context) {\n        // Use existing handleGeneralMCPQuery logic\n        return await this.handleGeneralMCPQuery({\n            query,\n            context\n        });\n    }\n    /**\r\n   * Execute real agent via A2A\r\n   */ async executeRealAgent(agent, query, context) {\n        // Use existing A2A execution logic from executeStep\n        const step = {\n            id: \"enhanced-step\",\n            agentId: agent.url,\n            skillId: \"enhanced-execution\",\n            input: {\n                query,\n                context\n            },\n            status: \"running\"\n        };\n        return await this.executeStep(step);\n    }\n    /**\r\n   * Centralized decision maker - determines whether to route to Backend or DeepSeek\r\n   */ async handleCentralizedRequest(requestData) {\n        const { query, context } = requestData;\n        // Add query to chat history\n        this.addChatMessage({\n            type: \"user\",\n            content: query,\n            metadata: {\n                status: \"processing\"\n            }\n        });\n        try {\n            // Use DeepSeek AI to classify the request\n            const isQuizRequest = await this.classifyRequest(query);\n            if (isQuizRequest) {\n                // Route to Backend Agent for quiz generation\n                console.log(\"\\uD83C\\uDFAF Orchestrator Decision: Quiz Request → Backend Agent\");\n                return await this.routeToBackendAgent(query, context);\n            } else {\n                // Route to DeepSeek API for general chat\n                console.log(\"\\uD83D\\uDCAC Orchestrator Decision: Chat Request → DeepSeek API\");\n                return await this.routeToDeepSeekAPI(query, context);\n            }\n        } catch (error) {\n            console.error(\"Error in centralized request handling:\", error);\n            // Fallback to simple pattern matching\n            const lowerQuery = query.toLowerCase();\n            const isQuizFallback = lowerQuery.includes(\"create\") && lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"generate\") && lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"make\") && lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"quiz about\") || lowerQuery.includes(\"quiz on\");\n            try {\n                if (isQuizFallback) {\n                    return await this.routeToBackendAgent(query, context);\n                } else {\n                    return await this.routeToDeepSeekAPI(query, context);\n                }\n            } catch (fallbackError) {\n                console.error(\"Fallback routing also failed:\", fallbackError);\n                // Ultimate fallback - return a simple response\n                this.addChatMessage({\n                    type: \"agent\",\n                    content: \"I apologize, but I'm experiencing technical difficulties. Please try again later or rephrase your request.\",\n                    metadata: {\n                        agentId: \"fallback-agent\",\n                        status: \"error\"\n                    }\n                });\n                return {\n                    type: \"error\",\n                    response: \"I apologize, but I'm experiencing technical difficulties. Please try again later or rephrase your request.\",\n                    agentId: \"fallback-agent\",\n                    chatHistory: this.getChatHistory()\n                };\n            }\n        }\n    }\n    /**\r\n   * Classify request using DeepSeek AI\r\n   */ async classifyRequest(query) {\n        try {\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are a classifier that determines if a user message is requesting quiz creation.\r\n\r\nReturn ONLY \"true\" or \"false\" based on whether the user wants to create a quiz.\r\n\r\nExamples of quiz requests:\r\n- \"create a quiz about science\"\r\n- \"generate a quiz on history\"\r\n- \"make a quiz for math\"\r\n- \"quiz about programming\"\r\n- \"create questions about biology\"\r\n\r\nExamples of NOT quiz requests:\r\n- \"hello\"\r\n- \"what is photosynthesis?\"\r\n- \"help me understand calculus\"\r\n- \"tell me about the weather\"\r\n- \"how are you?\"`\n                    },\n                    {\n                        role: \"user\",\n                        content: query\n                    }\n                ],\n                max_tokens: 10,\n                temperature: 0.1,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content?.toLowerCase().trim();\n            return response === \"true\";\n        } catch (error) {\n            console.error(\"DeepSeek classification error:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Route to Backend Agent for quiz generation\r\n   */ async routeToBackendAgent(query, context) {\n        try {\n            // Add routing message to chat\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Routing quiz request to Backend Agent...`,\n                metadata: {\n                    status: \"routing\"\n                }\n            });\n            // Use existing quiz workflow\n            const result = await this.orchestrateQuizWorkflow({\n                query,\n                context: {\n                    type: \"quiz_generation\",\n                    difficulty: \"medium\",\n                    questionCount: 20,\n                    ...context\n                }\n            });\n            // Add completion message\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Quiz generation completed successfully!`,\n                metadata: {\n                    status: \"completed\"\n                }\n            });\n            return {\n                type: \"quiz\",\n                result,\n                agentId: \"backend-quiz-agent\",\n                chatHistory: this.getChatHistory()\n            };\n        } catch (error) {\n            console.error(\"Backend agent routing failed:\", error);\n            // Fallback to DeepSeek API for quiz generation\n            console.log(\"\\uD83D\\uDD04 Falling back to DeepSeek API for quiz generation...\");\n            return await this.routeToDeepSeekAPIForQuiz(query, context);\n        }\n    }\n    /**\r\n   * Route to DeepSeek API for quiz generation (fallback)\r\n   */ async routeToDeepSeekAPIForQuiz(query, context) {\n        try {\n            // Add fallback message to chat\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Backend agent unavailable, using DeepSeek API for quiz generation...`,\n                metadata: {\n                    status: \"fallback\"\n                }\n            });\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are a quiz generation expert. Create a comprehensive quiz based on the user's request.\r\n\r\nGenerate exactly 20 multiple-choice questions with 4 options each (A, B, C, D). Format your response as JSON:\r\n\r\n{\r\n  \"quiz_questions\": [\r\n    {\r\n      \"question\": \"Question text here\",\r\n      \"correct_answer\": \"A\",\r\n      \"answers\": [\r\n        {\"answer\": \"Option A\"},\r\n        {\"answer\": \"Option B\"},\r\n        {\"answer\": \"Option C\"},\r\n        {\"answer\": \"Option D\"}\r\n      ],\r\n      \"difficulty\": \"medium\"\r\n    }\r\n  ]\r\n}\r\n\r\nMake sure the questions are educational, clear, and the correct answers are accurate.`\n                    },\n                    {\n                        role: \"user\",\n                        content: `Create a quiz about: ${query}`\n                    }\n                ],\n                max_tokens: 2000,\n                temperature: 0.7,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content || \"{}\";\n            try {\n                const quizData = JSON.parse(response);\n                // Add completion message\n                this.addChatMessage({\n                    type: \"orchestrator\",\n                    content: `Quiz generated successfully using DeepSeek API!`,\n                    metadata: {\n                        status: \"completed\"\n                    }\n                });\n                return {\n                    type: \"quiz\",\n                    result: {\n                        data: quizData\n                    },\n                    agentId: \"deepseek-quiz-agent\",\n                    chatHistory: this.getChatHistory()\n                };\n            } catch (parseError) {\n                // If JSON parsing fails, create a comprehensive quiz with 20 questions\n                const fallbackQuiz = {\n                    quiz_questions: Array.from({\n                        length: 20\n                    }, (_, i)=>({\n                            question: `Question ${i + 1}: What is the main topic of ${query}?`,\n                            correct_answer: \"A\",\n                            answers: [\n                                {\n                                    answer: \"The primary subject matter\"\n                                },\n                                {\n                                    answer: \"A secondary topic\"\n                                },\n                                {\n                                    answer: \"An unrelated subject\"\n                                },\n                                {\n                                    answer: \"A random topic\"\n                                }\n                            ],\n                            difficulty: \"medium\"\n                        }))\n                };\n                return {\n                    type: \"quiz\",\n                    result: {\n                        data: fallbackQuiz\n                    },\n                    agentId: \"fallback-quiz-agent\",\n                    chatHistory: this.getChatHistory()\n                };\n            }\n        } catch (error) {\n            console.error(\"DeepSeek API quiz generation failed:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Route to DeepSeek API for general chat\r\n   */ async routeToDeepSeekAPI(query, context) {\n        try {\n            // Add routing message to chat\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Routing chat request to DeepSeek API...`,\n                metadata: {\n                    status: \"routing\"\n                }\n            });\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            // Get recent chat history for context\n            const recentHistory = this.chatHistory.filter((msg)=>msg.type !== \"system\").slice(-10).map((msg)=>({\n                    role: msg.type === \"user\" ? \"user\" : \"assistant\",\n                    content: msg.content\n                }));\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are a helpful AI assistant integrated into a quiz application. You can:\r\n\r\n1. **Answer general questions** - Provide helpful, accurate, and friendly responses\r\n2. **Help with quiz creation** - When users ask to create quizzes, guide them on how to do so\r\n3. **Provide educational support** - Help with learning and understanding various topics\r\n\r\nGuidelines:\r\n- Be conversational and friendly\r\n- Keep responses concise but informative\r\n- If someone asks to create a quiz, explain that they should use phrases like \"create a quiz about [topic]\" or \"generate a quiz on [subject]\"\r\n- Always be helpful and encouraging\r\n- If you don't know something, say so honestly\r\n\r\nCurrent context: You're helping a user who is using a quiz application.`\n                    },\n                    ...recentHistory,\n                    {\n                        role: \"user\",\n                        content: query\n                    }\n                ],\n                max_tokens: 500,\n                temperature: 0.7,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content || \"I apologize, but I couldn't generate a response.\";\n            // Add response to chat history\n            this.addChatMessage({\n                type: \"agent\",\n                content: response,\n                metadata: {\n                    agentId: \"deepseek-chat-agent\",\n                    status: \"completed\"\n                }\n            });\n            return {\n                type: \"chat\",\n                response,\n                agentId: \"deepseek-chat-agent\",\n                chatHistory: this.getChatHistory()\n            };\n        } catch (error) {\n            console.error(\"DeepSeek API routing failed:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Handle general MCP queries that don't require specific agent routing\r\n   */ async handleGeneralMCPQuery(requestData) {\n        const { query, context } = requestData;\n        const chatMode = context?.chatMode || \"quiz\"; // Default to quiz mode\n        // Add query to chat history\n        this.addChatMessage({\n            type: \"user\",\n            content: query,\n            metadata: {\n                status: \"processing\"\n            }\n        });\n        let response = \"\";\n        let agentId = \"\";\n        if (chatMode === \"quiz\" || query.toLowerCase().includes(\"quiz\") || query.toLowerCase().includes(\"question\")) {\n            // Quiz-focused responses\n            agentId = \"quiz-agent\";\n            if (query.toLowerCase().includes(\"create quiz\")) {\n                response = `Great! I'd love to help you create a quiz. What topic would you like the quiz to cover? \r\n\r\n**Examples you can try:**\r\n• \"Create a quiz about the solar system\"\r\n• \"Make a science quiz about photosynthesis\" \r\n• \"Generate a history quiz about the Renaissance\"\r\n• \"Create a math quiz about algebra\"\r\n• \"Make a quiz about JavaScript programming\"\r\n\r\nJust tell me the topic and I'll create 20 multiple-choice questions for you!`;\n            } else if (query.toLowerCase().includes(\"science\")) {\n                response = `Perfect! I can create science quizzes on any topic. Here are some examples:\r\n\r\n**Science Quiz Topics:**\r\n• \"Create a quiz about the solar system and planets\"\r\n• \"Make a biology quiz about human anatomy\"\r\n• \"Generate a chemistry quiz about periodic table\"\r\n• \"Create a physics quiz about Newton's laws\"\r\n• \"Make an astronomy quiz about stars and galaxies\"\r\n\r\nWhat specific science topic interests you? I can generate multiple choice questions, true/false, or short answer questions.`;\n            } else if (query.toLowerCase().includes(\"history\")) {\n                response = `Excellent choice! I can create history quizzes covering any time period or region. Here are some examples:\r\n\r\n**History Quiz Topics:**\r\n• \"Create a quiz about World War II\"\r\n• \"Make a quiz about ancient Egypt\"\r\n• \"Generate a quiz about the American Revolution\"\r\n• \"Create a quiz about the Renaissance period\"\r\n• \"Make a quiz about medieval times\"\r\n\r\nWhat historical period or event would you like to focus on?`;\n            } else if (query.toLowerCase().includes(\"math\")) {\n                response = `Math quizzes are my specialty! I can create questions covering any math topic. Here are some examples:\r\n\r\n**Math Quiz Topics:**\r\n• \"Create a quiz about algebra and equations\"\r\n• \"Make a geometry quiz about shapes and angles\"\r\n• \"Generate a calculus quiz about derivatives\"\r\n• \"Create a statistics quiz about probability\"\r\n• \"Make a quiz about fractions and decimals\"\r\n\r\nWhat level and type of math problems would you like? I can make them as easy or challenging as you need.`;\n            } else if (query.toLowerCase().includes(\"general knowledge\")) {\n                response = `General knowledge quizzes are fun! I can create questions covering many topics. Here are some examples:\r\n\r\n**General Knowledge Topics:**\r\n• \"Create a quiz about world capitals\"\r\n• \"Make a quiz about famous landmarks\"\r\n• \"Generate a quiz about literature and authors\"\r\n• \"Create a quiz about sports and athletes\"\r\n• \"Make a quiz about technology and inventions\"\r\n\r\nWhat area of general knowledge would you like to test?`;\n            } else {\n                response = `I'm your Quiz Agent! I can help you create quizzes on any topic. Here's how to get started:\r\n\r\n**Quick Start Options:**\r\n• Click any suggested button above (Create Quiz, Science Topics, etc.)\r\n• Type \"Create a quiz about [your topic]\"\r\n• Paste content and ask me to make a quiz from it\r\n\r\n**Examples:**\r\n• \"Create a quiz about the solar system\"\r\n• \"Make a science quiz about photosynthesis\"\r\n• \"Generate a history quiz about World War II\"\r\n• \"Create a math quiz about algebra\"\r\n\r\nWhat would you like to quiz about?`;\n            }\n        } else if (query.toLowerCase().includes(\"help\") || query.toLowerCase().includes(\"plan\") || query.toLowerCase().includes(\"explain\")) {\n            // Help/planning mode - provide guidance without needing backend\n            agentId = \"quiz-agent\";\n            response = `I'm your Quiz Agent! I can help you plan and design quizzes even when the generation service is temporarily unavailable.\r\n\r\n**I can help you with:**\r\n• Planning quiz topics and structure\r\n• Suggesting question types and formats\r\n• Explaining quiz creation best practices\r\n• Brainstorming quiz content ideas\r\n• Reviewing quiz concepts\r\n\r\n**What would you like help with?**\r\n• \"Help me plan a science quiz about photosynthesis\"\r\n• \"What topics should I include in a history quiz about World War II?\"\r\n• \"Explain how to write good multiple choice questions\"\r\n• \"Suggest quiz formats for different subjects\"\r\n\r\nHow can I assist you with quiz planning today?`;\n        } else {\n            // General chat mode\n            agentId = \"normal-mcp-agent\";\n            response = `I'm your Quiz Agent, but I can also help with general questions! You asked: \"${query}\". \r\n\r\nI'm here to assist with quiz creation, planning, and answering any questions you have. Even if the quiz generation service is temporarily unavailable, I can still help you plan quizzes and answer questions about quiz creation.\r\n\r\nHow can I help you today?`;\n        }\n        this.addChatMessage({\n            type: \"agent\",\n            content: response,\n            metadata: {\n                agentId: agentId,\n                status: \"completed\"\n            }\n        });\n        return {\n            success: true,\n            response,\n            agent: {\n                name: \"Quiz Agent\"\n            },\n            timestamp: new Date().toISOString()\n        };\n    }\n    /**\r\n   * Start periodic agent discovery\r\n   */ startAgentDiscovery() {\n        // Initial discovery\n        this.discoverAgents();\n        // Periodic discovery every 30 seconds\n        setInterval(()=>{\n            this.discoverAgents();\n        }, 30000);\n    }\n    /**\r\n   * Discover agents in the network using A2A protocol\r\n   */ async discoverAgents(requestData = {}) {\n        const discoveredAgents = [];\n        console.log(\"\\uD83D\\uDD0D Starting A2A agent discovery...\");\n        for (const url of this.knownAgentUrls){\n            try {\n                console.log(`🔍 Discovering agent at ${url}...`);\n                const agentCard = await this.getAgentCard(url);\n                const agentInfo = {\n                    name: agentCard.name || `Agent-${url.split(\":\").pop()}`,\n                    url: url,\n                    skills: agentCard.skills?.map((s)=>s.id) || [],\n                    status: \"online\",\n                    lastSeen: new Date(),\n                    capabilities: agentCard.capabilities\n                };\n                this.agents.set(url, agentInfo);\n                discoveredAgents.push(agentInfo);\n                console.log(`✅ Successfully discovered agent: ${agentInfo.name} at ${url}`);\n                // Add discovery message to chat\n                this.addChatMessage({\n                    type: \"system\",\n                    content: `Discovered agent: ${agentInfo.name} at ${url} with ${agentInfo.skills.length} skills`,\n                    metadata: {\n                        agentId: url,\n                        skillId: agentInfo.skills.join(\",\"),\n                        status: \"discovered\"\n                    }\n                });\n            } catch (error) {\n                console.error(`❌ Failed to discover agent at ${url}:`, error);\n                const agentInfo = {\n                    name: `Unknown Agent (${url})`,\n                    url: url,\n                    skills: [],\n                    status: \"offline\",\n                    lastSeen: new Date()\n                };\n                this.agents.set(url, agentInfo);\n                discoveredAgents.push(agentInfo);\n                // Add failure message to chat\n                this.addChatMessage({\n                    type: \"system\",\n                    content: `Failed to discover agent at ${url}: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                    metadata: {\n                        agentId: url,\n                        status: \"offline\"\n                    }\n                });\n            }\n        }\n        console.log(`🎯 Agent discovery completed. Found ${discoveredAgents.length} agents.`);\n        return {\n            agents: discoveredAgents,\n            count: discoveredAgents.length,\n            onlineCount: discoveredAgents.filter((a)=>a.status === \"online\").length,\n            offlineCount: discoveredAgents.filter((a)=>a.status === \"offline\").length,\n            timestamp: new Date().toISOString()\n        };\n    }\n    /**\r\n   * Get agent card from URL using A2A SDK\r\n   */ async getAgentCard(url) {\n        try {\n            // Import A2A client dynamically to avoid SSR issues\n            const { A2AClient } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/@a2a-js\").then(__webpack_require__.bind(__webpack_require__, /*! @a2a-js/sdk/client */ \"(rsc)/./node_modules/@a2a-js/sdk/dist/client/index.js\"));\n            // Create A2A client using fromCardUrl static method\n            const a2aClient = await A2AClient.fromCardUrl(url);\n            // Return the agent card from the client\n            return await a2aClient.getAgentCard();\n        } catch (error) {\n            console.error(\"Failed to get agent card via A2A SDK:\", error);\n            // Fallback to direct fetch if A2A SDK fails\n            const controller = new AbortController();\n            const timeoutId = setTimeout(()=>controller.abort(), 5000);\n            try {\n                const response = await fetch(`${url}/.well-known/agent-card.json`, {\n                    signal: controller.signal\n                });\n                clearTimeout(timeoutId);\n                return response.json();\n            } catch (fetchError) {\n                clearTimeout(timeoutId);\n                throw fetchError;\n            }\n        }\n    }\n    /**\r\n   * Orchestrate complete quiz workflow with chat integration\r\n   *\r\n   * This method coordinates the entire quiz generation process by:\r\n   * 1. Creating a workflow with predefined steps\r\n   * 2. Executing steps in dependency order\r\n   * 3. Providing real-time chat updates throughout the process\r\n   * 4. Handling errors and providing feedback\r\n   *\r\n   * @param requestData - Contains topic, difficulty, and question_count\r\n   * @returns Promise with workflow results and status\r\n   */ async orchestrateQuizWorkflow(requestData) {\n        // Generate unique workflow ID using timestamp for uniqueness\n        const workflowId = `workflow_${Date.now()}`;\n        // Extract and set default values for quiz parameters\n        const { topic, difficulty = \"intermediate\", question_count = 20 } = requestData;\n        try {\n            // Notify chat system that workflow is starting\n            // This provides user feedback and maintains audit trail\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Starting quiz workflow for topic: \"${topic}\"`,\n                metadata: {\n                    workflowId,\n                    status: \"starting\"\n                }\n            });\n            // Define the workflow structure with two sequential steps:\n            // Step 1: Generate quiz questions (backend agent)\n            // Step 2: Display quiz (frontend agent)\n            const workflow = {\n                id: workflowId,\n                name: `Quiz Generation: ${topic}`,\n                steps: [\n                    {\n                        id: \"step_1\",\n                        agentId: \"http://localhost:4001\",\n                        skillId: \"generate-quiz\",\n                        input: {\n                            topic,\n                            difficulty,\n                            question_count\n                        },\n                        status: \"pending\"\n                    },\n                    {\n                        id: \"step_2\",\n                        agentId: \"http://localhost:3000\",\n                        skillId: \"display_quiz\",\n                        input: {},\n                        dependencies: [\n                            \"step_1\"\n                        ],\n                        status: \"pending\"\n                    }\n                ],\n                status: \"running\",\n                createdAt: new Date()\n            };\n            // Store workflow in memory for tracking and management\n            this.workflows.set(workflowId, workflow);\n            // Execute the workflow steps in dependency order with chat integration\n            // This method handles step execution, dependency checking, and chat updates\n            const result = await this.executeWorkflowWithChat(workflowId);\n            // Notify chat system of successful completion\n            // Provides user feedback on the number of questions generated\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Quiz workflow completed successfully! Generated ${result.length} questions.`,\n                metadata: {\n                    workflowId,\n                    status: \"completed\"\n                }\n            });\n            // Return structured response with workflow details\n            return {\n                workflow_id: workflowId,\n                status: \"completed\",\n                result: result,\n                timestamp: new Date().toISOString()\n            };\n        } catch (error) {\n            // Log error for debugging purposes\n            console.error(\"Workflow orchestration failed:\", error);\n            // Notify chat system of workflow failure\n            // Provides user feedback on what went wrong\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Workflow failed: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                metadata: {\n                    workflowId,\n                    status: \"failed\"\n                }\n            });\n            // Re-throw error to be handled by calling code\n            throw error;\n        }\n    }\n    /**\r\n   * Execute workflow with chat integration\r\n   */ async executeWorkflowWithChat(workflowId) {\n        const workflow = this.workflows.get(workflowId);\n        if (!workflow) {\n            throw new Error(`Workflow ${workflowId} not found`);\n        }\n        const results = [];\n        for (const step of workflow.steps){\n            try {\n                // Add step start message to chat\n                this.addChatMessage({\n                    type: \"orchestrator\",\n                    content: `Executing step: ${step.skillId} on ${step.agentId}`,\n                    metadata: {\n                        workflowId,\n                        agentId: step.agentId,\n                        skillId: step.skillId,\n                        status: \"running\"\n                    }\n                });\n                // Check dependencies\n                if (step.dependencies) {\n                    const dependencyResults = step.dependencies.map((depId)=>{\n                        const depStep = workflow.steps.find((s)=>s.id === depId);\n                        return depStep?.result;\n                    });\n                    if (dependencyResults.some((r)=>!r)) {\n                        throw new Error(`Dependencies not met for step ${step.id}`);\n                    }\n                }\n                // Execute step\n                step.status = \"running\";\n                const result = await this.executeStep(step);\n                step.result = result;\n                step.status = \"completed\";\n                results.push(result);\n                // Add step completion message to chat\n                this.addChatMessage({\n                    type: \"agent\",\n                    content: `Step completed: ${step.skillId}`,\n                    metadata: {\n                        workflowId,\n                        agentId: step.agentId,\n                        skillId: step.skillId,\n                        status: \"completed\"\n                    }\n                });\n            } catch (error) {\n                step.status = \"failed\";\n                workflow.status = \"failed\";\n                // Add step failure message to chat\n                this.addChatMessage({\n                    type: \"agent\",\n                    content: `Step failed: ${step.skillId} - ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                    metadata: {\n                        workflowId,\n                        agentId: step.agentId,\n                        skillId: step.skillId,\n                        status: \"failed\"\n                    }\n                });\n                throw error;\n            }\n        }\n        workflow.status = \"completed\";\n        workflow.completedAt = new Date();\n        return results;\n    }\n    /**\r\n   * Execute a single workflow step using real A2A SDK with enhanced error handling\r\n   */ async executeStep(step) {\n        const agent = this.agents.get(step.agentId);\n        if (!agent) {\n            throw new Error(`Agent ${step.agentId} not found`);\n        }\n        try {\n            console.log(`🔄 Executing step ${step.id} on agent ${step.agentId}`);\n            // Import A2A client dynamically to avoid SSR issues\n            const { A2AClient } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/@a2a-js\").then(__webpack_require__.bind(__webpack_require__, /*! @a2a-js/sdk/client */ \"(rsc)/./node_modules/@a2a-js/sdk/dist/client/index.js\"));\n            // Create A2A client using the agent URL\n            const a2aClient = await A2AClient.fromCardUrl(step.agentId);\n            // Create message with task input\n            const message = {\n                kind: \"message\",\n                messageId: (0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(),\n                role: \"user\",\n                parts: [\n                    {\n                        kind: \"text\",\n                        text: JSON.stringify({\n                            skillId: step.skillId,\n                            input: step.input\n                        })\n                    }\n                ]\n            };\n            // Send message using A2A SDK\n            const response = await a2aClient.sendMessage({\n                message,\n                configuration: {\n                    blocking: true\n                }\n            });\n            console.log(`A2A response for step ${step.id}:`, response);\n            // Handle the response with enhanced error handling\n            if (response && typeof response === \"object\" && \"task\" in response) {\n                const task = response.task;\n                // Poll for task completion with timeout\n                let completedTask = task;\n                let attempts = 0;\n                const maxAttempts = 30; // 30 seconds timeout\n                while(completedTask.status && (completedTask.status.state === \"running\" || completedTask.status.state === \"submitted\") && attempts < maxAttempts){\n                    await new Promise((resolve)=>setTimeout(resolve, 1000));\n                    attempts++;\n                    try {\n                        const taskResponse = await a2aClient.getTask({\n                            id: task.id\n                        });\n                        console.log(`A2A task polling attempt ${attempts} for step ${step.id}:`, taskResponse);\n                        if (\"task\" in taskResponse && taskResponse.task) {\n                            completedTask = taskResponse.task;\n                            console.log(`A2A task status for step ${step.id}: ${completedTask.status?.state}`);\n                        }\n                    } catch (pollError) {\n                        console.error(`A2A task polling error for step ${step.id} (attempt ${attempts}):`, pollError);\n                    }\n                }\n                if (attempts >= maxAttempts) {\n                    throw new Error(`A2A task polling timeout for step ${step.id} - task did not complete within 30 seconds`);\n                }\n                console.log(`A2A task completed for step ${step.id}:`, completedTask.status?.state);\n                if (completedTask.status?.state === \"completed\" && completedTask.artifacts) {\n                    // Extract data from A2A artifacts\n                    const artifact = completedTask.artifacts[0];\n                    if (artifact && artifact.parts) {\n                        const result = JSON.parse(artifact.parts[0].text);\n                        console.log(`Step ${step.id} completed successfully:`, result);\n                        return result;\n                    }\n                } else if (completedTask.status?.state === \"failed\") {\n                    console.error(`A2A task failed for step ${step.id}:`, completedTask);\n                    throw new Error(`A2A task execution failed for step ${step.id}`);\n                } else {\n                    console.error(`A2A task not completed for step ${step.id}:`, completedTask);\n                    throw new Error(`A2A task status: ${completedTask.status?.state}, artifacts: ${completedTask.artifacts ? \"present\" : \"missing\"}`);\n                }\n            } else if (response && typeof response === \"object\" && \"message\" in response) {\n                // Handle direct message response\n                const message = response.message;\n                if (message.parts && message.parts.length > 0) {\n                    try {\n                        const result = JSON.parse(message.parts[0].text);\n                        console.log(`Step ${step.id} completed with direct message:`, result);\n                        return result;\n                    } catch (e) {\n                        // If not JSON, return the text as result\n                        console.log(`Step ${step.id} completed with text response:`, message.parts[0].text);\n                        return {\n                            result: message.parts[0].text\n                        };\n                    }\n                }\n            }\n            throw new Error(`No valid response received from A2A agent for step ${step.id}`);\n        } catch (error) {\n            console.error(`A2A task execution failed for step ${step.id}:`, error);\n            throw new Error(`A2A agent call failed for step ${step.id}: ${error instanceof Error ? error.message : \"Unknown error\"}`);\n        }\n    }\n    /**\r\n   * Enhanced system health monitoring with circuit breaker status\r\n   */ async monitorSystemHealth(requestData) {\n        const healthChecks = [];\n        const enhancedAgents = this.enhancedAgentSelector.getAllAgents();\n        // Check enhanced agents\n        for (const agent of enhancedAgents){\n            const breakerStatus = this.circuitBreaker.getStatus(agent.id);\n            healthChecks.push({\n                agent: agent.name,\n                url: agent.url,\n                status: agent.status,\n                load: agent.load,\n                reliability: agent.reliability,\n                responseTime: agent.responseTime,\n                circuitBreaker: breakerStatus,\n                lastSeen: agent.lastSeen\n            });\n        }\n        // Check legacy agents\n        const agentEntries = Array.from(this.agents.entries());\n        for(let i = 0; i < agentEntries.length; i++){\n            const [url, agent] = agentEntries[i];\n            // Skip if already checked in enhanced agents\n            if (enhancedAgents.some((ea)=>ea.url === url)) continue;\n            try {\n                const controller = new AbortController();\n                const timeoutId = setTimeout(()=>controller.abort(), 3000);\n                const response = await fetch(`${url}/health`, {\n                    signal: controller.signal\n                });\n                clearTimeout(timeoutId);\n                healthChecks.push({\n                    agent: agent.name,\n                    url: url,\n                    status: \"healthy\",\n                    response_time: response.headers.get(\"x-response-time\") || \"unknown\",\n                    circuitBreaker: null\n                });\n            } catch (error) {\n                healthChecks.push({\n                    agent: agent.name,\n                    url: url,\n                    status: \"unhealthy\",\n                    error: error instanceof Error ? error.message : \"Unknown error\",\n                    circuitBreaker: null\n                });\n            }\n        }\n        const overallHealth = healthChecks.every((h)=>h.status === \"healthy\") ? \"healthy\" : \"degraded\";\n        return {\n            overall_health: overallHealth,\n            agents: healthChecks,\n            circuitBreakers: this.circuitBreaker.getAllStates(),\n            enhanced_metrics: {\n                totalAgents: enhancedAgents.length,\n                onlineAgents: enhancedAgents.filter((a)=>a.status === \"online\").length,\n                averageReliability: enhancedAgents.reduce((sum, a)=>sum + a.reliability, 0) / enhancedAgents.length,\n                averageResponseTime: enhancedAgents.reduce((sum, a)=>sum + a.responseTime, 0) / enhancedAgents.length\n            },\n            timestamp: new Date().toISOString()\n        };\n    }\n    /**\r\n   * Add message to chat history\r\n   */ addChatMessage(message) {\n        const chatMessage = {\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(),\n            timestamp: new Date(),\n            ...message\n        };\n        this.chatHistory.push(chatMessage);\n        return chatMessage;\n    }\n    /**\r\n   * Get chat history\r\n   */ getChatHistory() {\n        return this.chatHistory;\n    }\n    /**\r\n   * Get chat history for a specific workflow\r\n   */ getWorkflowChatHistory(workflowId) {\n        return this.chatHistory.filter((msg)=>msg.metadata?.workflowId === workflowId);\n    }\n    /**\r\n   * Clear chat history\r\n   */ clearChatHistory() {\n        this.chatHistory = [];\n    }\n    /**\r\n   * Get all workflows\r\n   */ getAllWorkflows() {\n        return Array.from(this.workflows.values());\n    }\n    /**\r\n   * Get workflow by ID\r\n   */ getWorkflow(workflowId) {\n        return this.workflows.get(workflowId);\n    }\n    /**\r\n   * Get all agents\r\n   */ getAllAgents() {\n        return Array.from(this.agents.values());\n    }\n    /**\r\n   * Get agent by URL\r\n   */ getAgent(url) {\n        return this.agents.get(url);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFlQTtJQUUxQztJQUVBOztHQUVDLEdBQ0Q2RCxtQkFBbUI7UUFDakIsSUFBSSxDQUFDbFIsV0FBVyxHQUFHLEVBQUU7SUFDdkI7SUFFQTs7R0FFQyxHQUNEbVIsa0JBQThCO1FBQzVCLE9BQU83TSxNQUFNQyxJQUFJLENBQUMsSUFBSSxDQUFDeEUsU0FBUyxDQUFDeUUsTUFBTTtJQUN6QztJQUVBOztHQUVDLEdBQ0Q0TSxZQUFZL0QsVUFBa0IsRUFBd0I7UUFDcEQsT0FBTyxJQUFJLENBQUN0TixTQUFTLENBQUN3RyxHQUFHLENBQUM4RztJQUM1QjtJQUVBOztHQUVDLEdBQ0R4SyxlQUE0QjtRQUMxQixPQUFPeUIsTUFBTUMsSUFBSSxDQUFDLElBQUksQ0FBQzFFLE1BQU0sQ0FBQzJFLE1BQU07SUFDdEM7SUFFQTs7R0FFQyxHQUNENk0sU0FBU3BRLEdBQVcsRUFBeUI7UUFDM0MsT0FBTyxJQUFJLENBQUNwQixNQUFNLENBQUMwRyxHQUFHLENBQUN0RjtJQUN6QjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcXVpei1mcm9udGVuZC8uL3NyYy9saWIvb3JjaGVzdHJhdG9yU2VydmljZS50cz9jMmI4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gXCJ1dWlkXCI7XHJcbmltcG9ydCB7XHJcbiAgRW5oYW5jZWRBZ2VudFNlbGVjdG9yLFxyXG4gIEFnZW50UHJvZmlsZSxcclxuICBRdWVyeUNvbnRleHQsXHJcbn0gZnJvbSBcIi4vZW5oYW5jZWQtYWdlbnQtc2VsZWN0b3JcIjtcclxuaW1wb3J0IHsgQWdlbnRDaXJjdWl0QnJlYWtlciB9IGZyb20gXCIuL2NpcmN1aXQtYnJlYWtlclwiO1xyXG5pbXBvcnQge1xyXG4gIER5bmFtaWNBZ2VudERpc2NvdmVyeSxcclxuICBBZ2VudERpc2NvdmVyeUNvbmZpZyxcclxufSBmcm9tIFwiLi9keW5hbWljLWFnZW50LWRpc2NvdmVyeVwiO1xyXG5pbXBvcnQgeyBFbnZpcm9ubWVudEFnZW50TWFuYWdlciB9IGZyb20gXCIuL2Vudmlyb25tZW50LWFnZW50LW1hbmFnZXJcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQWdlbnRJbmZvIHtcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgc2tpbGxzOiBzdHJpbmdbXTtcclxuICBzdGF0dXM6IFwib25saW5lXCIgfCBcIm9mZmxpbmVcIiB8IFwidW5rbm93blwiO1xyXG4gIGxhc3RTZWVuOiBEYXRlO1xyXG4gIGNhcGFiaWxpdGllcz86IGFueTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBXb3JrZmxvd1N0ZXAge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgYWdlbnRJZDogc3RyaW5nO1xyXG4gIHNraWxsSWQ6IHN0cmluZztcclxuICBpbnB1dDogYW55O1xyXG4gIGRlcGVuZGVuY2llcz86IHN0cmluZ1tdO1xyXG4gIHN0YXR1czogXCJwZW5kaW5nXCIgfCBcInJ1bm5pbmdcIiB8IFwiY29tcGxldGVkXCIgfCBcImZhaWxlZFwiO1xyXG4gIHJlc3VsdD86IGFueTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBXb3JrZmxvdyB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgc3RlcHM6IFdvcmtmbG93U3RlcFtdO1xyXG4gIHN0YXR1czogXCJwZW5kaW5nXCIgfCBcInJ1bm5pbmdcIiB8IFwiY29tcGxldGVkXCIgfCBcImZhaWxlZFwiO1xyXG4gIGNyZWF0ZWRBdDogRGF0ZTtcclxuICBjb21wbGV0ZWRBdD86IERhdGU7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ2hhdE1lc3NhZ2Uge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgdHlwZTogXCJ1c2VyXCIgfCBcIm9yY2hlc3RyYXRvclwiIHwgXCJhZ2VudFwiIHwgXCJzeXN0ZW1cIjtcclxuICBjb250ZW50OiBzdHJpbmc7XHJcbiAgdGltZXN0YW1wOiBEYXRlO1xyXG4gIG1ldGFkYXRhPzoge1xyXG4gICAgd29ya2Zsb3dJZD86IHN0cmluZztcclxuICAgIGFnZW50SWQ/OiBzdHJpbmc7XHJcbiAgICBza2lsbElkPzogc3RyaW5nO1xyXG4gICAgc3RhdHVzPzogc3RyaW5nO1xyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBOZXh0SlNPcmNoZXN0cmF0b3JTZXJ2aWNlIHtcclxuICBwcml2YXRlIGFnZW50czogTWFwPHN0cmluZywgQWdlbnRJbmZvPiA9IG5ldyBNYXAoKTtcclxuICBwcml2YXRlIHdvcmtmbG93czogTWFwPHN0cmluZywgV29ya2Zsb3c+ID0gbmV3IE1hcCgpO1xyXG4gIHByaXZhdGUgY2hhdEhpc3Rvcnk6IENoYXRNZXNzYWdlW10gPSBbXTtcclxuXHJcbiAgLy8gTGVnYWN5IGhhcmRjb2RlZCBVUkxzIChmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcclxuICBwcml2YXRlIGtub3duQWdlbnRVcmxzOiBzdHJpbmdbXSA9IFtcclxuICAgIFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsIC8vIEZyb250ZW5kIGFnZW50IChzZWxmKVxyXG4gICAgXCJodHRwOi8vbG9jYWxob3N0OjQwMDFcIiwgLy8gQmFja2VuZCBhZ2VudFxyXG4gICAgXCJodHRwOi8vbG9jYWxob3N0OjUwMDBcIiwgLy8gT3JjaGVzdHJhdG9yIGFnZW50IChzZXBhcmF0ZSBwb3J0KVxyXG4gIF07XHJcblxyXG4gIC8vIEVuaGFuY2VkIGNvbXBvbmVudHNcclxuICBwcml2YXRlIGVuaGFuY2VkQWdlbnRTZWxlY3RvcjogRW5oYW5jZWRBZ2VudFNlbGVjdG9yO1xyXG4gIHByaXZhdGUgY2lyY3VpdEJyZWFrZXI6IEFnZW50Q2lyY3VpdEJyZWFrZXI7XHJcbiAgcHJpdmF0ZSByZXRyeUF0dGVtcHRzOiBudW1iZXIgPSAzO1xyXG4gIHByaXZhdGUgdGltZW91dE1zOiBudW1iZXIgPSAzMDAwMDtcclxuXHJcbiAgLy8gRHluYW1pYyBkaXNjb3ZlcnkgY29tcG9uZW50c1xyXG4gIHByaXZhdGUgZHluYW1pY0Rpc2NvdmVyeTogRHluYW1pY0FnZW50RGlzY292ZXJ5IHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBlbnZpcm9ubWVudE1hbmFnZXI6IEVudmlyb25tZW50QWdlbnRNYW5hZ2VyO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIC8vIEluaXRpYWxpemUgZW5oYW5jZWQgY29tcG9uZW50c1xyXG4gICAgdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3IgPSBuZXcgRW5oYW5jZWRBZ2VudFNlbGVjdG9yKCk7XHJcbiAgICB0aGlzLmNpcmN1aXRCcmVha2VyID0gbmV3IEFnZW50Q2lyY3VpdEJyZWFrZXIoKTtcclxuXHJcbiAgICAvLyBJbml0aWFsaXplIGVudmlyb25tZW50LWJhc2VkIGFnZW50IG1hbmFnZW1lbnRcclxuICAgIGNvbnN0IGVudmlyb25tZW50ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgXCJkZXZlbG9wbWVudFwiO1xyXG4gICAgdGhpcy5lbnZpcm9ubWVudE1hbmFnZXIgPSBuZXcgRW52aXJvbm1lbnRBZ2VudE1hbmFnZXIoZW52aXJvbm1lbnQpO1xyXG5cclxuICAgIHRoaXMuc3RhcnRBZ2VudERpc2NvdmVyeSgpO1xyXG4gICAgdGhpcy5pbml0aWFsaXplVmlydHVhbEFnZW50cygpO1xyXG4gICAgdGhpcy5pbml0aWFsaXplRW5oYW5jZWRBZ2VudHMoKTtcclxuICAgIHRoaXMuaW5pdGlhbGl6ZUR5bmFtaWNEaXNjb3ZlcnkoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemUgZW5oYW5jZWQgYWdlbnQgcHJvZmlsZXMgd2l0aCBjYXBhYmlsaXRpZXNcclxuICAgKi9cclxuICBwcml2YXRlIGluaXRpYWxpemVFbmhhbmNlZEFnZW50cygpOiB2b2lkIHtcclxuICAgIC8vIEJhY2tlbmQgUXVpeiBBZ2VudFxyXG4gICAgY29uc3QgYmFja2VuZEFnZW50OiBBZ2VudFByb2ZpbGUgPSB7XHJcbiAgICAgIGlkOiBcImJhY2tlbmQtcXVpei1hZ2VudFwiLFxyXG4gICAgICBuYW1lOiBcIlF1aXogR2VuZXJhdGlvbiBBZ2VudFwiLFxyXG4gICAgICB1cmw6IFwiaHR0cDovL2xvY2FsaG9zdDo0MDAxXCIsXHJcbiAgICAgIGNhcGFiaWxpdGllczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiBcInF1aXotZ2VuZXJhdGlvblwiLFxyXG4gICAgICAgICAgbmFtZTogXCJHZW5lcmF0ZSBRdWl6IFF1ZXN0aW9uc1wiLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiQ3JlYXRlcyBxdWl6IHF1ZXN0aW9ucyBvbiBhbnkgdG9waWNcIixcclxuICAgICAgICAgIGtleXdvcmRzOiBbXHJcbiAgICAgICAgICAgIFwicXVpelwiLFxyXG4gICAgICAgICAgICBcInF1ZXN0aW9uXCIsXHJcbiAgICAgICAgICAgIFwidGVzdFwiLFxyXG4gICAgICAgICAgICBcImV4YW1cIixcclxuICAgICAgICAgICAgXCJhc3Nlc3NtZW50XCIsXHJcbiAgICAgICAgICAgIFwibXVsdGlwbGUgY2hvaWNlXCIsXHJcbiAgICAgICAgICAgIFwiZ2VuZXJhdGVcIixcclxuICAgICAgICAgICAgXCJjcmVhdGVcIixcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjk1LFxyXG4gICAgICAgICAgcmVxdWlyZW1lbnRzOiBbXCJvcGVuYWktYXBpXCJdLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6IFwiY29udGVudC1hbmFseXNpc1wiLFxyXG4gICAgICAgICAgbmFtZTogXCJDb250ZW50IEFuYWx5c2lzXCIsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBbmFseXplcyBhbmQgcHJvY2Vzc2VzIGVkdWNhdGlvbmFsIGNvbnRlbnRcIixcclxuICAgICAgICAgIGtleXdvcmRzOiBbXHJcbiAgICAgICAgICAgIFwiYW5hbHl6ZVwiLFxyXG4gICAgICAgICAgICBcImNvbnRlbnRcIixcclxuICAgICAgICAgICAgXCJlZHVjYXRpb25hbFwiLFxyXG4gICAgICAgICAgICBcIm1hdGVyaWFsXCIsXHJcbiAgICAgICAgICAgIFwicHJvY2Vzc1wiLFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIGNvbmZpZGVuY2U6IDAuODUsXHJcbiAgICAgICAgfSxcclxuICAgICAgXSxcclxuICAgICAgc3RhdHVzOiBcIm9ubGluZVwiLFxyXG4gICAgICBsb2FkOiAwLjAsXHJcbiAgICAgIHJlc3BvbnNlVGltZTogMjAwMCxcclxuICAgICAgcmVsaWFiaWxpdHk6IDAuOTUsXHJcbiAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBGcm9udGVuZCBBZ2VudFxyXG4gICAgY29uc3QgZnJvbnRlbmRBZ2VudDogQWdlbnRQcm9maWxlID0ge1xyXG4gICAgICBpZDogXCJmcm9udGVuZC1hZ2VudFwiLFxyXG4gICAgICBuYW1lOiBcIkZyb250ZW5kIE9yY2hlc3RyYXRpb24gQWdlbnRcIixcclxuICAgICAgdXJsOiBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiLFxyXG4gICAgICBjYXBhYmlsaXRpZXM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogXCJ1aS1vcmNoZXN0cmF0aW9uXCIsXHJcbiAgICAgICAgICBuYW1lOiBcIlVJIE9yY2hlc3RyYXRpb25cIixcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk1hbmFnZXMgdXNlciBpbnRlcmZhY2UgYW5kIHdvcmtmbG93IGNvb3JkaW5hdGlvblwiLFxyXG4gICAgICAgICAga2V5d29yZHM6IFtcclxuICAgICAgICAgICAgXCJ3b3JrZmxvd1wiLFxyXG4gICAgICAgICAgICBcIm9yY2hlc3RyYXRlXCIsXHJcbiAgICAgICAgICAgIFwiY29vcmRpbmF0ZVwiLFxyXG4gICAgICAgICAgICBcIm1hbmFnZVwiLFxyXG4gICAgICAgICAgICBcInVpXCIsXHJcbiAgICAgICAgICAgIFwiaW50ZXJmYWNlXCIsXHJcbiAgICAgICAgICAgIFwiZGlzcGxheVwiLFxyXG4gICAgICAgICAgICBcInJlbmRlclwiLFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIGNvbmZpZGVuY2U6IDAuOSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiBcInF1aXotZGlzcGxheVwiLFxyXG4gICAgICAgICAgbmFtZTogXCJRdWl6IERpc3BsYXlcIixcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlbmRlcnMgYW5kIG1hbmFnZXMgcXVpeiBpbnRlcmZhY2VzXCIsXHJcbiAgICAgICAgICBrZXl3b3JkczogW1wiZGlzcGxheVwiLCBcInJlbmRlclwiLCBcInNob3dcIiwgXCJwcmVzZW50XCIsIFwicXVpeiBpbnRlcmZhY2VcIl0sXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjg4LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF0sXHJcbiAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgbG9hZDogMC4wLFxyXG4gICAgICByZXNwb25zZVRpbWU6IDUwMCxcclxuICAgICAgcmVsaWFiaWxpdHk6IDAuOTgsXHJcbiAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBWaXJ0dWFsIE1DUCBBZ2VudFxyXG4gICAgY29uc3QgbWNwQWdlbnQ6IEFnZW50UHJvZmlsZSA9IHtcclxuICAgICAgaWQ6IFwidmlydHVhbC1tY3AtYWdlbnRcIixcclxuICAgICAgbmFtZTogXCJHZW5lcmFsIE1DUCBBZ2VudFwiLFxyXG4gICAgICB1cmw6IFwidmlydHVhbDovL25vcm1hbC1tY3AtYWdlbnRcIixcclxuICAgICAgY2FwYWJpbGl0aWVzOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6IFwiZ2VuZXJhbC1jb252ZXJzYXRpb25cIixcclxuICAgICAgICAgIG5hbWU6IFwiR2VuZXJhbCBDb252ZXJzYXRpb25cIixcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkhhbmRsZXMgZ2VuZXJhbCBxdWVyaWVzIGFuZCBjb252ZXJzYXRpb25zXCIsXHJcbiAgICAgICAgICBrZXl3b3JkczogW1xyXG4gICAgICAgICAgICBcImhlbHBcIixcclxuICAgICAgICAgICAgXCJleHBsYWluXCIsXHJcbiAgICAgICAgICAgIFwiZ2VuZXJhbFwiLFxyXG4gICAgICAgICAgICBcImNvbnZlcnNhdGlvblwiLFxyXG4gICAgICAgICAgICBcImNoYXRcIixcclxuICAgICAgICAgICAgXCJhc3Npc3RcIixcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjgsXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogXCJpbmZvcm1hdGlvbi1yZXRyaWV2YWxcIixcclxuICAgICAgICAgIG5hbWU6IFwiSW5mb3JtYXRpb24gUmV0cmlldmFsXCIsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXRyaWV2ZXMgYW5kIHByb3ZpZGVzIGluZm9ybWF0aW9uXCIsXHJcbiAgICAgICAgICBrZXl3b3JkczogW1wiaW5mb3JtYXRpb25cIiwgXCJyZXRyaWV2ZVwiLCBcImxvb2t1cFwiLCBcInNlYXJjaFwiLCBcImZpbmRcIl0sXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjc1LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF0sXHJcbiAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgbG9hZDogMC4wLFxyXG4gICAgICByZXNwb25zZVRpbWU6IDEwMDAsXHJcbiAgICAgIHJlbGlhYmlsaXR5OiAwLjksXHJcbiAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBSZWdpc3RlciBhbGwgYWdlbnRzIHdpdGggZW5oYW5jZWQgc2VsZWN0b3JcclxuICAgIHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnJlZ2lzdGVyQWdlbnQoYmFja2VuZEFnZW50KTtcclxuICAgIHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnJlZ2lzdGVyQWdlbnQoZnJvbnRlbmRBZ2VudCk7XHJcbiAgICB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci5yZWdpc3RlckFnZW50KG1jcEFnZW50KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemUgZHluYW1pYyBhZ2VudCBkaXNjb3ZlcnkgYmFzZWQgb24gZW52aXJvbm1lbnRcclxuICAgKi9cclxuICBwcml2YXRlIGluaXRpYWxpemVEeW5hbWljRGlzY292ZXJ5KCk6IHZvaWQge1xyXG4gICAgY29uc3QgZGlzY292ZXJ5TWV0aG9kID0gcHJvY2Vzcy5lbnYuQUdFTlRfRElTQ09WRVJZX01FVEhPRCB8fCBcImVudmlyb25tZW50XCI7XHJcblxyXG4gICAgY29uc3QgZGlzY292ZXJ5Q29uZmlnOiBBZ2VudERpc2NvdmVyeUNvbmZpZyA9IHtcclxuICAgICAgZGlzY292ZXJ5TWV0aG9kOiBkaXNjb3ZlcnlNZXRob2QgYXMgYW55LFxyXG4gICAgICBlbnZpcm9ubWVudDoge1xyXG4gICAgICAgIHByZWZpeDogcHJvY2Vzcy5lbnYuQUdFTlRfUFJFRklYIHx8IFwiUVVJWl9BR0VOVFwiLFxyXG4gICAgICAgIHBvcnRzOiB0aGlzLnBhcnNlUG9ydHMocHJvY2Vzcy5lbnYuQUdFTlRfUE9SVFMgfHwgXCIzMDAwLDQwMDEsNTAwMFwiKSxcclxuICAgICAgICBob3N0czogdGhpcy5wYXJzZUhvc3RzKHByb2Nlc3MuZW52LkFHRU5UX0hPU1RTIHx8IFwibG9jYWxob3N0XCIpLFxyXG4gICAgICB9LFxyXG4gICAgICBtYW51YWw6IHtcclxuICAgICAgICBhZ2VudHM6IHRoaXMuZW52aXJvbm1lbnRNYW5hZ2VyLmdldEFsbEFnZW50cygpLm1hcCgoYWdlbnQpID0+ICh7XHJcbiAgICAgICAgICBpZDogYWdlbnQuaWQsXHJcbiAgICAgICAgICB1cmw6IGFnZW50LnVybCxcclxuICAgICAgICAgIGNhcGFiaWxpdGllczogYWdlbnQuY2FwYWJpbGl0aWVzLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IGFnZW50Lm1ldGFkYXRhLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgfSxcclxuICAgIH07XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5keW5hbWljRGlzY292ZXJ5ID0gbmV3IER5bmFtaWNBZ2VudERpc2NvdmVyeShkaXNjb3ZlcnlDb25maWcpO1xyXG4gICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICBgRHluYW1pYyBhZ2VudCBkaXNjb3ZlcnkgaW5pdGlhbGl6ZWQgd2l0aCBtZXRob2Q6ICR7ZGlzY292ZXJ5TWV0aG9kfWBcclxuICAgICAgKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihcclxuICAgICAgICBcIkZhaWxlZCB0byBpbml0aWFsaXplIGR5bmFtaWMgZGlzY292ZXJ5LCBmYWxsaW5nIGJhY2sgdG8gZW52aXJvbm1lbnQgbWFuYWdlcjpcIixcclxuICAgICAgICBlcnJvclxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUGFyc2UgY29tbWEtc2VwYXJhdGVkIHBvcnRzIHN0cmluZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgcGFyc2VQb3J0cyhwb3J0c1N0cmluZzogc3RyaW5nKTogbnVtYmVyW10ge1xyXG4gICAgcmV0dXJuIHBvcnRzU3RyaW5nXHJcbiAgICAgIC5zcGxpdChcIixcIilcclxuICAgICAgLm1hcCgocG9ydCkgPT4gcGFyc2VJbnQocG9ydC50cmltKCkpKVxyXG4gICAgICAuZmlsdGVyKChwb3J0KSA9PiAhaXNOYU4ocG9ydCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUGFyc2UgY29tbWEtc2VwYXJhdGVkIGhvc3RzIHN0cmluZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgcGFyc2VIb3N0cyhob3N0c1N0cmluZzogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgcmV0dXJuIGhvc3RzU3RyaW5nXHJcbiAgICAgIC5zcGxpdChcIixcIilcclxuICAgICAgLm1hcCgoaG9zdCkgPT4gaG9zdC50cmltKCkpXHJcbiAgICAgIC5maWx0ZXIoKGhvc3QpID0+IGhvc3QubGVuZ3RoID4gMCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbml0aWFsaXplIHZpcnR1YWwgTUNQIGFnZW50cyB0aGF0IGRvbid0IGhhdmUgcGh5c2ljYWwgZW5kcG9pbnRzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplVmlydHVhbEFnZW50cygpIHtcclxuICAgIC8vIEFkZCB0aGUgbm9ybWFsIE1DUCBhZ2VudCBhcyBhIHZpcnR1YWwgYWdlbnRcclxuICAgIGNvbnN0IG5vcm1hbE1DUEFnZW50OiBBZ2VudEluZm8gPSB7XHJcbiAgICAgIG5hbWU6IFwiR2VuZXJhbCBNQ1AgQWdlbnRcIixcclxuICAgICAgdXJsOiBcInZpcnR1YWw6Ly9ub3JtYWwtbWNwLWFnZW50XCIsXHJcbiAgICAgIHNraWxsczogW1xyXG4gICAgICAgIFwiZ2VuZXJhbC1jb252ZXJzYXRpb25cIixcclxuICAgICAgICBcImluZm9ybWF0aW9uLXJldHJpZXZhbFwiLFxyXG4gICAgICAgIFwidGFzay1hc3Npc3RhbmNlXCIsXHJcbiAgICAgIF0sXHJcbiAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXHJcbiAgICAgIGNhcGFiaWxpdGllczoge1xyXG4gICAgICAgIGRlc2NyaXB0aW9uOlxyXG4gICAgICAgICAgXCJIYW5kbGVzIGdlbmVyYWwgcXVlcmllcywgY29udmVyc2F0aW9ucywgYW5kIG5vbi1xdWl6IHJlbGF0ZWQgdGFza3NcIixcclxuICAgICAgICB0eXBlOiBcInZpcnR1YWxcIixcclxuICAgICAgfSxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5hZ2VudHMuc2V0KFwidmlydHVhbDovL25vcm1hbC1tY3AtYWdlbnRcIiwgbm9ybWFsTUNQQWdlbnQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFsbCBhdmFpbGFibGUgYWdlbnRzIChkeW5hbWljICsgbGVnYWN5KVxyXG4gICAqL1xyXG4gIGdldEFsbEF2YWlsYWJsZUFnZW50cygpOiBhbnlbXSB7XHJcbiAgICBjb25zdCBhZ2VudHM6IGFueVtdID0gW107XHJcblxyXG4gICAgLy8gQWRkIGR5bmFtaWNhbGx5IGRpc2NvdmVyZWQgYWdlbnRzXHJcbiAgICBpZiAodGhpcy5keW5hbWljRGlzY292ZXJ5KSB7XHJcbiAgICAgIGFnZW50cy5wdXNoKC4uLnRoaXMuZHluYW1pY0Rpc2NvdmVyeS5nZXRBbGxBZ2VudHMoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIGVudmlyb25tZW50LW1hbmFnZWQgYWdlbnRzXHJcbiAgICBhZ2VudHMucHVzaCguLi50aGlzLmVudmlyb25tZW50TWFuYWdlci5nZXRBbGxBZ2VudHMoKSk7XHJcblxyXG4gICAgLy8gQWRkIGxlZ2FjeSBhZ2VudHMgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuICAgIGNvbnN0IGxlZ2FjeUFnZW50cyA9IEFycmF5LmZyb20odGhpcy5hZ2VudHMudmFsdWVzKCkpO1xyXG4gICAgYWdlbnRzLnB1c2goLi4ubGVnYWN5QWdlbnRzKTtcclxuXHJcbiAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBiYXNlZCBvbiBVUkxcclxuICAgIGNvbnN0IHVuaXF1ZUFnZW50cyA9IGFnZW50cy5maWx0ZXIoXHJcbiAgICAgIChhZ2VudCwgaW5kZXgsIHNlbGYpID0+XHJcbiAgICAgICAgaW5kZXggPT09IHNlbGYuZmluZEluZGV4KChhKSA9PiBhLnVybCA9PT0gYWdlbnQudXJsKVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdW5pcXVlQWdlbnRzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFnZW50cyBieSBjYXBhYmlsaXR5IHdpdGggbG9hZCBiYWxhbmNpbmdcclxuICAgKi9cclxuICBnZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eTogc3RyaW5nKTogYW55W10ge1xyXG4gICAgY29uc3QgYWdlbnRzOiBhbnlbXSA9IFtdO1xyXG5cclxuICAgIC8vIEdldCBmcm9tIGR5bmFtaWMgZGlzY292ZXJ5XHJcbiAgICBpZiAodGhpcy5keW5hbWljRGlzY292ZXJ5KSB7XHJcbiAgICAgIGFnZW50cy5wdXNoKC4uLnRoaXMuZHluYW1pY0Rpc2NvdmVyeS5nZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCBmcm9tIGVudmlyb25tZW50IG1hbmFnZXJcclxuICAgIGFnZW50cy5wdXNoKC4uLnRoaXMuZW52aXJvbm1lbnRNYW5hZ2VyLmdldEFnZW50c0J5Q2FwYWJpbGl0eShjYXBhYmlsaXR5KSk7XHJcblxyXG4gICAgLy8gR2V0IGZyb20gbGVnYWN5IGFnZW50c1xyXG4gICAgY29uc3QgbGVnYWN5QWdlbnRzID0gQXJyYXkuZnJvbSh0aGlzLmFnZW50cy52YWx1ZXMoKSkuZmlsdGVyKChhZ2VudCkgPT5cclxuICAgICAgYWdlbnQuc2tpbGxzPy5pbmNsdWRlcyhjYXBhYmlsaXR5KVxyXG4gICAgKTtcclxuICAgIGFnZW50cy5wdXNoKC4uLmxlZ2FjeUFnZW50cyk7XHJcblxyXG4gICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgYW5kIHJldHVybiBvbmxpbmUgYWdlbnRzIG9ubHlcclxuICAgIGNvbnN0IHVuaXF1ZUFnZW50cyA9IGFnZW50cy5maWx0ZXIoXHJcbiAgICAgIChhZ2VudCwgaW5kZXgsIHNlbGYpID0+XHJcbiAgICAgICAgaW5kZXggPT09IHNlbGYuZmluZEluZGV4KChhKSA9PiBhLnVybCA9PT0gYWdlbnQudXJsKVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdW5pcXVlQWdlbnRzLmZpbHRlcigoYWdlbnQpID0+IGFnZW50LnN0YXR1cyA9PT0gXCJvbmxpbmVcIik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgbG9hZC1iYWxhbmNlZCBhZ2VudCBVUkwgZm9yIGEgY2FwYWJpbGl0eVxyXG4gICAqL1xyXG4gIGdldExvYWRCYWxhbmNlZEFnZW50VXJsKGNhcGFiaWxpdHk6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgLy8gVHJ5IGVudmlyb25tZW50IG1hbmFnZXIgZmlyc3QgKGhhcyBsb2FkIGJhbGFuY2luZylcclxuICAgIGNvbnN0IGVudkFnZW50ID0gdGhpcy5lbnZpcm9ubWVudE1hbmFnZXIuZ2V0TG9hZEJhbGFuY2VkQWdlbnQoY2FwYWJpbGl0eSk7XHJcbiAgICBpZiAoZW52QWdlbnQpIHJldHVybiBlbnZBZ2VudDtcclxuXHJcbiAgICAvLyBGYWxsIGJhY2sgdG8gZHluYW1pYyBkaXNjb3ZlcnlcclxuICAgIGlmICh0aGlzLmR5bmFtaWNEaXNjb3ZlcnkpIHtcclxuICAgICAgY29uc3QgZHluYW1pY0FnZW50cyA9XHJcbiAgICAgICAgdGhpcy5keW5hbWljRGlzY292ZXJ5LmdldEFnZW50c0J5Q2FwYWJpbGl0eShjYXBhYmlsaXR5KTtcclxuICAgICAgaWYgKGR5bmFtaWNBZ2VudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZHluYW1pY0FnZW50cy5sZW5ndGgpO1xyXG4gICAgICAgIHJldHVybiBkeW5hbWljQWdlbnRzW2luZGV4XS51cmw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBGYWxsIGJhY2sgdG8gbGVnYWN5IGhhcmRjb2RlZCBVUkxzXHJcbiAgICBzd2l0Y2ggKGNhcGFiaWxpdHkpIHtcclxuICAgICAgY2FzZSBcInF1aXotZ2VuZXJhdGlvblwiOlxyXG4gICAgICBjYXNlIFwiY29udGVudC1hbmFseXNpc1wiOlxyXG4gICAgICAgIHJldHVybiBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiO1xyXG4gICAgICBjYXNlIFwidWktb3JjaGVzdHJhdGlvblwiOlxyXG4gICAgICBjYXNlIFwicXVpei1kaXNwbGF5XCI6XHJcbiAgICAgICAgcmV0dXJuIFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCI7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgcHJpbWFyeSBhZ2VudCBVUkwgZm9yIGEgY2FwYWJpbGl0eVxyXG4gICAqL1xyXG4gIGdldFByaW1hcnlBZ2VudFVybChjYXBhYmlsaXR5OiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIC8vIFRyeSBlbnZpcm9ubWVudCBtYW5hZ2VyIGZpcnN0XHJcbiAgICBjb25zdCBlbnZBZ2VudCA9IHRoaXMuZW52aXJvbm1lbnRNYW5hZ2VyLmdldFByaW1hcnlBZ2VudChjYXBhYmlsaXR5KTtcclxuICAgIGlmIChlbnZBZ2VudCkgcmV0dXJuIGVudkFnZW50O1xyXG5cclxuICAgIC8vIEZhbGwgYmFjayB0byBkeW5hbWljIGRpc2NvdmVyeVxyXG4gICAgaWYgKHRoaXMuZHluYW1pY0Rpc2NvdmVyeSkge1xyXG4gICAgICBjb25zdCBkeW5hbWljQWdlbnRzID1cclxuICAgICAgICB0aGlzLmR5bmFtaWNEaXNjb3ZlcnkuZ2V0QWdlbnRzQnlDYXBhYmlsaXR5KGNhcGFiaWxpdHkpO1xyXG4gICAgICBpZiAoZHluYW1pY0FnZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGR5bmFtaWNBZ2VudHNbMF0udXJsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmFsbCBiYWNrIHRvIGxlZ2FjeSBoYXJkY29kZWQgVVJMc1xyXG4gICAgc3dpdGNoIChjYXBhYmlsaXR5KSB7XHJcbiAgICAgIGNhc2UgXCJxdWl6LWdlbmVyYXRpb25cIjpcclxuICAgICAgY2FzZSBcImNvbnRlbnQtYW5hbHlzaXNcIjpcclxuICAgICAgICByZXR1cm4gXCJodHRwOi8vbG9jYWxob3N0OjQwMDFcIjtcclxuICAgICAgY2FzZSBcInVpLW9yY2hlc3RyYXRpb25cIjpcclxuICAgICAgY2FzZSBcInF1aXotZGlzcGxheVwiOlxyXG4gICAgICAgIHJldHVybiBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRW5oYW5jZWQgYWdlbnQgc2VsZWN0aW9uIHVzaW5nIHNvcGhpc3RpY2F0ZWQgc2NvcmluZ1xyXG4gICAqL1xyXG4gIGRldGVybWluZUFnZW50Rm9yUXVlcnkoXHJcbiAgICBxdWVyeTogc3RyaW5nLFxyXG4gICAgY29udGV4dD86IFF1ZXJ5Q29udGV4dFxyXG4gICk6IHtcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUgfCBudWxsO1xyXG4gICAgY29uZmlkZW5jZTogbnVtYmVyO1xyXG4gICAgcmVhc29uaW5nOiBzdHJpbmc7XHJcbiAgfSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci5zZWxlY3RBZ2VudChxdWVyeSwgY29udGV4dCk7XHJcblxyXG4gICAgLy8gQWRkIHRvIGNoYXQgaGlzdG9yeSBmb3IgdHJhbnNwYXJlbmN5XHJcbiAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgdHlwZTogXCJzeXN0ZW1cIixcclxuICAgICAgY29udGVudDogYEFnZW50IHNlbGVjdGlvbjogJHtcclxuICAgICAgICByZXN1bHQuYWdlbnQ/Lm5hbWUgfHwgXCJOb25lXCJcclxuICAgICAgfSAoY29uZmlkZW5jZTogJHtyZXN1bHQuY29uZmlkZW5jZS50b0ZpeGVkKDIpfSwgcmVhc29uaW5nOiAke1xyXG4gICAgICAgIHJlc3VsdC5yZWFzb25pbmdcclxuICAgICAgfSlgLFxyXG4gICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgIGFnZW50SWQ6IHJlc3VsdC5hZ2VudD8uaWQsXHJcbiAgICAgICAgc3RhdHVzOiBcInNlbGVjdGlvbl9jb21wbGV0ZVwiLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExlZ2FjeSBtZXRob2QgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuICAgKi9cclxuICBkZXRlcm1pbmVBZ2VudEZvclF1ZXJ5TGVnYWN5KHF1ZXJ5OiBzdHJpbmcpOiBBZ2VudEluZm8gfCBudWxsIHtcclxuICAgIGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICAgIC8vIFF1aXotcmVsYXRlZCBxdWVyaWVzIGdvIHRvIGJhY2tlbmQgYWdlbnRcclxuICAgIGlmIChcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcInF1aXpcIikgfHxcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcInF1ZXN0aW9uXCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJ0ZXN0XCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJleGFtXCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJhc3Nlc3NtZW50XCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtdWx0aXBsZSBjaG9pY2VcIilcclxuICAgICkge1xyXG4gICAgICByZXR1cm4gdGhpcy5hZ2VudHMuZ2V0KFwiaHR0cDovL2xvY2FsaG9zdDo0MDAxXCIpIHx8IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gV29ya2Zsb3cvb3JjaGVzdHJhdGlvbiBxdWVyaWVzIGdvIHRvIGZyb250ZW5kIGFnZW50XHJcbiAgICBpZiAoXHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJ3b3JrZmxvd1wiKSB8fFxyXG4gICAgICBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwib3JjaGVzdHJhdGVcIikgfHxcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcImNvb3JkaW5hdGVcIikgfHxcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcIm1hbmFnZVwiKVxyXG4gICAgKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmFnZW50cy5nZXQoXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIikgfHwgbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBbGwgb3RoZXIgcXVlcmllcyBnbyB0byBub3JtYWwgTUNQIGFnZW50XHJcbiAgICByZXR1cm4gdGhpcy5hZ2VudHMuZ2V0KFwidmlydHVhbDovL25vcm1hbC1tY3AtYWdlbnRcIikgfHwgbnVsbDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEVuaGFuY2VkIGFnZW50IGV4ZWN1dGlvbiB3aXRoIGNpcmN1aXQgYnJlYWtlciBhbmQgcmV0cnkgbG9naWNcclxuICAgKi9cclxuICBhc3luYyBleGVjdXRlQWdlbnRXaXRoUmVzaWxpZW5jZShcclxuICAgIHF1ZXJ5OiBzdHJpbmcsXHJcbiAgICBjb250ZXh0PzogUXVlcnlDb250ZXh0XHJcbiAgKTogUHJvbWlzZTx7XHJcbiAgICBzdWNjZXNzOiBib29sZWFuO1xyXG4gICAgYWdlbnQ6IEFnZW50UHJvZmlsZSB8IG51bGw7XHJcbiAgICByZXN1bHQ/OiBhbnk7XHJcbiAgICBlcnJvcj86IHN0cmluZztcclxuICAgIGZhbGxiYWNrVXNlZD86IGJvb2xlYW47XHJcbiAgICBtZXRyaWNzOiB7XHJcbiAgICAgIHNlbGVjdGlvblRpbWU6IG51bWJlcjtcclxuICAgICAgZXhlY3V0aW9uVGltZTogbnVtYmVyO1xyXG4gICAgICB0b3RhbFRpbWU6IG51bWJlcjtcclxuICAgIH07XHJcbiAgfT4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIGxldCBzZWxlY3Rpb25UaW1lID0gMDtcclxuICAgIGxldCBleGVjdXRpb25UaW1lID0gMDtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBTdGVwIDE6IFNlbGVjdCBwcmltYXJ5IGFnZW50IHVzaW5nIGVuaGFuY2VkIHNlbGVjdG9yXHJcbiAgICAgIGNvbnN0IHNlbGVjdGlvblN0YXJ0ID0gRGF0ZS5ub3coKTtcclxuICAgICAgY29uc3QgeyBhZ2VudCwgY29uZmlkZW5jZSwgcmVhc29uaW5nIH0gPVxyXG4gICAgICAgIHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnNlbGVjdEFnZW50KHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgc2VsZWN0aW9uVGltZSA9IERhdGUubm93KCkgLSBzZWxlY3Rpb25TdGFydDtcclxuXHJcbiAgICAgIGlmICghYWdlbnQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBhZ2VudDogbnVsbCxcclxuICAgICAgICAgIGVycm9yOiBcIk5vIHN1aXRhYmxlIGFnZW50IGZvdW5kXCIsXHJcbiAgICAgICAgICBtZXRyaWNzOiB7XHJcbiAgICAgICAgICAgIHNlbGVjdGlvblRpbWUsXHJcbiAgICAgICAgICAgIGV4ZWN1dGlvblRpbWU6IDAsXHJcbiAgICAgICAgICAgIHRvdGFsVGltZTogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gU3RlcCAyOiBDaGVjayBjaXJjdWl0IGJyZWFrZXJcclxuICAgICAgaWYgKCF0aGlzLmNpcmN1aXRCcmVha2VyLmlzQWdlbnRBdmFpbGFibGUoYWdlbnQuaWQpKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGBBZ2VudCAke2FnZW50LmlkfSBpcyBjaXJjdWl0LWJyb2tlbiwgdHJ5aW5nIGZhbGxiYWNrYCk7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMudHJ5RmFsbGJhY2tFeGVjdXRpb24oXHJcbiAgICAgICAgICBxdWVyeSxcclxuICAgICAgICAgIGNvbnRleHQsXHJcbiAgICAgICAgICBhZ2VudC5pZCxcclxuICAgICAgICAgIHN0YXJ0VGltZSxcclxuICAgICAgICAgIHNlbGVjdGlvblRpbWVcclxuICAgICAgICApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBTdGVwIDM6IEV4ZWN1dGUgd2l0aCByZXRyeSBsb2dpY1xyXG4gICAgICBjb25zdCBleGVjdXRpb25TdGFydCA9IERhdGUubm93KCk7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhSZXRyeShhZ2VudCwgcXVlcnksIGNvbnRleHQpO1xyXG4gICAgICBleGVjdXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIGV4ZWN1dGlvblN0YXJ0O1xyXG5cclxuICAgICAgLy8gUmVjb3JkIHN1Y2Nlc3NcclxuICAgICAgdGhpcy5jaXJjdWl0QnJlYWtlci5yZWNvcmRTdWNjZXNzKGFnZW50LmlkKTtcclxuICAgICAgdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3IudXBkYXRlQWdlbnRNZXRyaWNzKFxyXG4gICAgICAgIGFnZW50LmlkLFxyXG4gICAgICAgIHRydWUsXHJcbiAgICAgICAgZXhlY3V0aW9uVGltZVxyXG4gICAgICApO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGFnZW50LFxyXG4gICAgICAgIHJlc3VsdCxcclxuICAgICAgICBtZXRyaWNzOiB7XHJcbiAgICAgICAgICBzZWxlY3Rpb25UaW1lLFxyXG4gICAgICAgICAgZXhlY3V0aW9uVGltZSxcclxuICAgICAgICAgIHRvdGFsVGltZTogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgICB9LFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgLy8gUmVjb3JkIGZhaWx1cmUgYW5kIHRyeSBmYWxsYmFja1xyXG4gICAgICBjb25zdCBhZ2VudCA9IHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnNlbGVjdEFnZW50KFxyXG4gICAgICAgIHF1ZXJ5LFxyXG4gICAgICAgIGNvbnRleHRcclxuICAgICAgKS5hZ2VudDtcclxuICAgICAgaWYgKGFnZW50KSB7XHJcbiAgICAgICAgdGhpcy5jaXJjdWl0QnJlYWtlci5yZWNvcmRGYWlsdXJlKGFnZW50LmlkKTtcclxuICAgICAgICB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci51cGRhdGVBZ2VudE1ldHJpY3MoXHJcbiAgICAgICAgICBhZ2VudC5pZCxcclxuICAgICAgICAgIGZhbHNlLFxyXG4gICAgICAgICAgZXhlY3V0aW9uVGltZVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnRyeUZhbGxiYWNrRXhlY3V0aW9uKFxyXG4gICAgICAgIHF1ZXJ5LFxyXG4gICAgICAgIGNvbnRleHQsXHJcbiAgICAgICAgYWdlbnQ/LmlkLFxyXG4gICAgICAgIHN0YXJ0VGltZSxcclxuICAgICAgICBzZWxlY3Rpb25UaW1lXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGVjdXRlIGFnZW50IHdpdGggcmV0cnkgbG9naWNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVXaXRoUmV0cnkoXHJcbiAgICBhZ2VudDogQWdlbnRQcm9maWxlLFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ/OiBRdWVyeUNvbnRleHRcclxuICApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgbGV0IGxhc3RFcnJvcjogRXJyb3IgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICBmb3IgKGxldCBhdHRlbXB0ID0gMTsgYXR0ZW1wdCA8PSB0aGlzLnJldHJ5QXR0ZW1wdHM7IGF0dGVtcHQrKykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGlmIChhZ2VudC51cmwuc3RhcnRzV2l0aChcInZpcnR1YWw6Ly9cIikpIHtcclxuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmV4ZWN1dGVWaXJ0dWFsQWdlbnQoYWdlbnQsIHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZVJlYWxBZ2VudChhZ2VudCwgcXVlcnksIGNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBsYXN0RXJyb3IgPSBlcnJvciBhcyBFcnJvcjtcclxuICAgICAgICBjb25zb2xlLndhcm4oYEF0dGVtcHQgJHthdHRlbXB0fSBmYWlsZWQgZm9yIGFnZW50ICR7YWdlbnQuaWR9OmAsIGVycm9yKTtcclxuXHJcbiAgICAgICAgaWYgKGF0dGVtcHQgPCB0aGlzLnJldHJ5QXR0ZW1wdHMpIHtcclxuICAgICAgICAgIC8vIEV4cG9uZW50aWFsIGJhY2tvZmZcclxuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PlxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KHJlc29sdmUsIE1hdGgucG93KDIsIGF0dGVtcHQpICogMTAwMClcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGhyb3cgbGFzdEVycm9yIHx8IG5ldyBFcnJvcihcIkFsbCByZXRyeSBhdHRlbXB0cyBmYWlsZWRcIik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUcnkgZmFsbGJhY2sgYWdlbnRzIGlmIHByaW1hcnkgZmFpbHNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIHRyeUZhbGxiYWNrRXhlY3V0aW9uKFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ6IFF1ZXJ5Q29udGV4dCB8IHVuZGVmaW5lZCxcclxuICAgIGV4Y2x1ZGVBZ2VudElkOiBzdHJpbmcgfCB1bmRlZmluZWQsXHJcbiAgICBzdGFydFRpbWU6IG51bWJlcixcclxuICAgIHNlbGVjdGlvblRpbWU6IG51bWJlclxyXG4gICk6IFByb21pc2U8e1xyXG4gICAgc3VjY2VzczogYm9vbGVhbjtcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUgfCBudWxsO1xyXG4gICAgcmVzdWx0PzogYW55O1xyXG4gICAgZXJyb3I/OiBzdHJpbmc7XHJcbiAgICBmYWxsYmFja1VzZWQ/OiBib29sZWFuO1xyXG4gICAgbWV0cmljczoge1xyXG4gICAgICBzZWxlY3Rpb25UaW1lOiBudW1iZXI7XHJcbiAgICAgIGV4ZWN1dGlvblRpbWU6IG51bWJlcjtcclxuICAgICAgdG90YWxUaW1lOiBudW1iZXI7XHJcbiAgICB9O1xyXG4gIH0+IHtcclxuICAgIGNvbnN0IGZhbGxiYWNrQWdlbnRzID0gdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3IuZ2V0RmFsbGJhY2tBZ2VudHMoXHJcbiAgICAgIHF1ZXJ5LFxyXG4gICAgICBleGNsdWRlQWdlbnRJZFxyXG4gICAgKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGFnZW50IG9mIGZhbGxiYWNrQWdlbnRzKSB7XHJcbiAgICAgIGlmICghdGhpcy5jaXJjdWl0QnJlYWtlci5pc0FnZW50QXZhaWxhYmxlKGFnZW50LmlkKSkgY29udGludWU7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGV4ZWN1dGlvblN0YXJ0ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVXaXRoUmV0cnkoYWdlbnQsIHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgICBjb25zdCBleGVjdXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIGV4ZWN1dGlvblN0YXJ0O1xyXG5cclxuICAgICAgICB0aGlzLmNpcmN1aXRCcmVha2VyLnJlY29yZFN1Y2Nlc3MoYWdlbnQuaWQpO1xyXG4gICAgICAgIHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnVwZGF0ZUFnZW50TWV0cmljcyhcclxuICAgICAgICAgIGFnZW50LmlkLFxyXG4gICAgICAgICAgdHJ1ZSxcclxuICAgICAgICAgIGV4ZWN1dGlvblRpbWVcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgIGFnZW50LFxyXG4gICAgICAgICAgcmVzdWx0LFxyXG4gICAgICAgICAgZmFsbGJhY2tVc2VkOiB0cnVlLFxyXG4gICAgICAgICAgbWV0cmljczoge1xyXG4gICAgICAgICAgICBzZWxlY3Rpb25UaW1lLFxyXG4gICAgICAgICAgICBleGVjdXRpb25UaW1lLFxyXG4gICAgICAgICAgICB0b3RhbFRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH07XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5jaXJjdWl0QnJlYWtlci5yZWNvcmRGYWlsdXJlKGFnZW50LmlkKTtcclxuICAgICAgICBjb25zb2xlLndhcm4oYEZhbGxiYWNrIGFnZW50ICR7YWdlbnQuaWR9IGFsc28gZmFpbGVkOmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBhZ2VudDogbnVsbCxcclxuICAgICAgZXJyb3I6IFwiQWxsIGFnZW50cyBmYWlsZWQsIGluY2x1ZGluZyBmYWxsYmFja3NcIixcclxuICAgICAgbWV0cmljczoge1xyXG4gICAgICAgIHNlbGVjdGlvblRpbWUsXHJcbiAgICAgICAgZXhlY3V0aW9uVGltZTogMCxcclxuICAgICAgICB0b3RhbFRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXhlY3V0ZSB2aXJ0dWFsIGFnZW50IChsaWtlIE1DUClcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVWaXJ0dWFsQWdlbnQoXHJcbiAgICBhZ2VudDogQWdlbnRQcm9maWxlLFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ/OiBRdWVyeUNvbnRleHRcclxuICApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgLy8gVXNlIGV4aXN0aW5nIGhhbmRsZUdlbmVyYWxNQ1BRdWVyeSBsb2dpY1xyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlR2VuZXJhbE1DUFF1ZXJ5KHsgcXVlcnksIGNvbnRleHQgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGVjdXRlIHJlYWwgYWdlbnQgdmlhIEEyQVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVJlYWxBZ2VudChcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUsXHJcbiAgICBxdWVyeTogc3RyaW5nLFxyXG4gICAgY29udGV4dD86IFF1ZXJ5Q29udGV4dFxyXG4gICk6IFByb21pc2U8YW55PiB7XHJcbiAgICAvLyBVc2UgZXhpc3RpbmcgQTJBIGV4ZWN1dGlvbiBsb2dpYyBmcm9tIGV4ZWN1dGVTdGVwXHJcbiAgICBjb25zdCBzdGVwID0ge1xyXG4gICAgICBpZDogXCJlbmhhbmNlZC1zdGVwXCIsXHJcbiAgICAgIGFnZW50SWQ6IGFnZW50LnVybCxcclxuICAgICAgc2tpbGxJZDogXCJlbmhhbmNlZC1leGVjdXRpb25cIixcclxuICAgICAgaW5wdXQ6IHsgcXVlcnksIGNvbnRleHQgfSxcclxuICAgICAgc3RhdHVzOiBcInJ1bm5pbmdcIiBhcyBjb25zdCxcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZVN0ZXAoc3RlcCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDZW50cmFsaXplZCBkZWNpc2lvbiBtYWtlciAtIGRldGVybWluZXMgd2hldGhlciB0byByb3V0ZSB0byBCYWNrZW5kIG9yIERlZXBTZWVrXHJcbiAgICovXHJcbiAgYXN5bmMgaGFuZGxlQ2VudHJhbGl6ZWRSZXF1ZXN0KHJlcXVlc3REYXRhOiBhbnkpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgY29uc3QgeyBxdWVyeSwgY29udGV4dCB9ID0gcmVxdWVzdERhdGE7XHJcblxyXG4gICAgLy8gQWRkIHF1ZXJ5IHRvIGNoYXQgaGlzdG9yeVxyXG4gICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgIHR5cGU6IFwidXNlclwiLFxyXG4gICAgICBjb250ZW50OiBxdWVyeSxcclxuICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcInByb2Nlc3NpbmdcIiB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gVXNlIERlZXBTZWVrIEFJIHRvIGNsYXNzaWZ5IHRoZSByZXF1ZXN0XHJcbiAgICAgIGNvbnN0IGlzUXVpelJlcXVlc3QgPSBhd2FpdCB0aGlzLmNsYXNzaWZ5UmVxdWVzdChxdWVyeSk7XHJcblxyXG4gICAgICBpZiAoaXNRdWl6UmVxdWVzdCkge1xyXG4gICAgICAgIC8vIFJvdXRlIHRvIEJhY2tlbmQgQWdlbnQgZm9yIHF1aXogZ2VuZXJhdGlvblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+OryBPcmNoZXN0cmF0b3IgRGVjaXNpb246IFF1aXogUmVxdWVzdCDihpIgQmFja2VuZCBBZ2VudFwiKTtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5yb3V0ZVRvQmFja2VuZEFnZW50KHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBSb3V0ZSB0byBEZWVwU2VlayBBUEkgZm9yIGdlbmVyYWwgY2hhdFxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+SrCBPcmNoZXN0cmF0b3IgRGVjaXNpb246IENoYXQgUmVxdWVzdCDihpIgRGVlcFNlZWsgQVBJXCIpO1xyXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJvdXRlVG9EZWVwU2Vla0FQSShxdWVyeSwgY29udGV4dCk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbiBjZW50cmFsaXplZCByZXF1ZXN0IGhhbmRsaW5nOlwiLCBlcnJvcik7XHJcblxyXG4gICAgICAvLyBGYWxsYmFjayB0byBzaW1wbGUgcGF0dGVybiBtYXRjaGluZ1xyXG4gICAgICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcclxuICAgICAgY29uc3QgaXNRdWl6RmFsbGJhY2sgPVxyXG4gICAgICAgIChsb3dlclF1ZXJ5LmluY2x1ZGVzKFwiY3JlYXRlXCIpICYmIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJxdWl6XCIpKSB8fFxyXG4gICAgICAgIChsb3dlclF1ZXJ5LmluY2x1ZGVzKFwiZ2VuZXJhdGVcIikgJiYgbG93ZXJRdWVyeS5pbmNsdWRlcyhcInF1aXpcIikpIHx8XHJcbiAgICAgICAgKGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtYWtlXCIpICYmIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJxdWl6XCIpKSB8fFxyXG4gICAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJxdWl6IGFib3V0XCIpIHx8XHJcbiAgICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcInF1aXogb25cIik7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGlmIChpc1F1aXpGYWxsYmFjaykge1xyXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucm91dGVUb0JhY2tlbmRBZ2VudChxdWVyeSwgY29udGV4dCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJvdXRlVG9EZWVwU2Vla0FQSShxdWVyeSwgY29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChmYWxsYmFja0Vycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhbGxiYWNrIHJvdXRpbmcgYWxzbyBmYWlsZWQ6XCIsIGZhbGxiYWNrRXJyb3IpO1xyXG5cclxuICAgICAgICAvLyBVbHRpbWF0ZSBmYWxsYmFjayAtIHJldHVybiBhIHNpbXBsZSByZXNwb25zZVxyXG4gICAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgdHlwZTogXCJhZ2VudFwiLFxyXG4gICAgICAgICAgY29udGVudDpcclxuICAgICAgICAgICAgXCJJIGFwb2xvZ2l6ZSwgYnV0IEknbSBleHBlcmllbmNpbmcgdGVjaG5pY2FsIGRpZmZpY3VsdGllcy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlciBvciByZXBocmFzZSB5b3VyIHJlcXVlc3QuXCIsXHJcbiAgICAgICAgICBtZXRhZGF0YTogeyBhZ2VudElkOiBcImZhbGxiYWNrLWFnZW50XCIsIHN0YXR1czogXCJlcnJvclwiIH0sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXHJcbiAgICAgICAgICByZXNwb25zZTpcclxuICAgICAgICAgICAgXCJJIGFwb2xvZ2l6ZSwgYnV0IEknbSBleHBlcmllbmNpbmcgdGVjaG5pY2FsIGRpZmZpY3VsdGllcy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlciBvciByZXBocmFzZSB5b3VyIHJlcXVlc3QuXCIsXHJcbiAgICAgICAgICBhZ2VudElkOiBcImZhbGxiYWNrLWFnZW50XCIsXHJcbiAgICAgICAgICBjaGF0SGlzdG9yeTogdGhpcy5nZXRDaGF0SGlzdG9yeSgpLFxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsYXNzaWZ5IHJlcXVlc3QgdXNpbmcgRGVlcFNlZWsgQUlcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGNsYXNzaWZ5UmVxdWVzdChxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBJbXBvcnQgT3BlbkFJIGR5bmFtaWNhbGx5XHJcbiAgICAgIGNvbnN0IE9wZW5BSSA9IChhd2FpdCBpbXBvcnQoXCJvcGVuYWlcIikpLmRlZmF1bHQ7XHJcblxyXG4gICAgICBjb25zdCBjbGllbnQgPSBuZXcgT3BlbkFJKHtcclxuICAgICAgICBhcGlLZXk6IFwic2stNjc5NmVhMGYzOGM3NDk5ZGJmNDdjN2ZmMmEwMjY5NjZcIixcclxuICAgICAgICBiYXNlVVJMOiBcImh0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbVwiLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBjbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xyXG4gICAgICAgIG1vZGVsOiBcImRlZXBzZWVrLWNoYXRcIixcclxuICAgICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiBcInN5c3RlbVwiLFxyXG4gICAgICAgICAgICBjb250ZW50OiBgWW91IGFyZSBhIGNsYXNzaWZpZXIgdGhhdCBkZXRlcm1pbmVzIGlmIGEgdXNlciBtZXNzYWdlIGlzIHJlcXVlc3RpbmcgcXVpeiBjcmVhdGlvbi5cclxuXHJcblJldHVybiBPTkxZIFwidHJ1ZVwiIG9yIFwiZmFsc2VcIiBiYXNlZCBvbiB3aGV0aGVyIHRoZSB1c2VyIHdhbnRzIHRvIGNyZWF0ZSBhIHF1aXouXHJcblxyXG5FeGFtcGxlcyBvZiBxdWl6IHJlcXVlc3RzOlxyXG4tIFwiY3JlYXRlIGEgcXVpeiBhYm91dCBzY2llbmNlXCJcclxuLSBcImdlbmVyYXRlIGEgcXVpeiBvbiBoaXN0b3J5XCJcclxuLSBcIm1ha2UgYSBxdWl6IGZvciBtYXRoXCJcclxuLSBcInF1aXogYWJvdXQgcHJvZ3JhbW1pbmdcIlxyXG4tIFwiY3JlYXRlIHF1ZXN0aW9ucyBhYm91dCBiaW9sb2d5XCJcclxuXHJcbkV4YW1wbGVzIG9mIE5PVCBxdWl6IHJlcXVlc3RzOlxyXG4tIFwiaGVsbG9cIlxyXG4tIFwid2hhdCBpcyBwaG90b3N5bnRoZXNpcz9cIlxyXG4tIFwiaGVscCBtZSB1bmRlcnN0YW5kIGNhbGN1bHVzXCJcclxuLSBcInRlbGwgbWUgYWJvdXQgdGhlIHdlYXRoZXJcIlxyXG4tIFwiaG93IGFyZSB5b3U/XCJgLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcm9sZTogXCJ1c2VyXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IHF1ZXJ5LFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICBdLFxyXG4gICAgICAgIG1heF90b2tlbnM6IDEwLFxyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjEsXHJcbiAgICAgICAgc3RyZWFtOiBmYWxzZSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGNvbXBsZXRpb24uY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudFxyXG4gICAgICAgID8udG9Mb3dlckNhc2UoKVxyXG4gICAgICAgIC50cmltKCk7XHJcbiAgICAgIHJldHVybiByZXNwb25zZSA9PT0gXCJ0cnVlXCI7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRGVlcFNlZWsgY2xhc3NpZmljYXRpb24gZXJyb3I6XCIsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSb3V0ZSB0byBCYWNrZW5kIEFnZW50IGZvciBxdWl6IGdlbmVyYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIHJvdXRlVG9CYWNrZW5kQWdlbnQocXVlcnk6IHN0cmluZywgY29udGV4dDogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEFkZCByb3V0aW5nIG1lc3NhZ2UgdG8gY2hhdFxyXG4gICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICB0eXBlOiBcIm9yY2hlc3RyYXRvclwiLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBSb3V0aW5nIHF1aXogcmVxdWVzdCB0byBCYWNrZW5kIEFnZW50Li4uYCxcclxuICAgICAgICBtZXRhZGF0YTogeyBzdGF0dXM6IFwicm91dGluZ1wiIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gVXNlIGV4aXN0aW5nIHF1aXogd29ya2Zsb3dcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5vcmNoZXN0cmF0ZVF1aXpXb3JrZmxvdyh7XHJcbiAgICAgICAgcXVlcnksXHJcbiAgICAgICAgY29udGV4dDoge1xyXG4gICAgICAgICAgdHlwZTogXCJxdWl6X2dlbmVyYXRpb25cIixcclxuICAgICAgICAgIGRpZmZpY3VsdHk6IFwibWVkaXVtXCIsXHJcbiAgICAgICAgICBxdWVzdGlvbkNvdW50OiAyMCxcclxuICAgICAgICAgIC4uLmNvbnRleHQsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBBZGQgY29tcGxldGlvbiBtZXNzYWdlXHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgY29udGVudDogYFF1aXogZ2VuZXJhdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IWAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcImNvbXBsZXRlZFwiIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiBcInF1aXpcIixcclxuICAgICAgICByZXN1bHQsXHJcbiAgICAgICAgYWdlbnRJZDogXCJiYWNrZW5kLXF1aXotYWdlbnRcIixcclxuICAgICAgICBjaGF0SGlzdG9yeTogdGhpcy5nZXRDaGF0SGlzdG9yeSgpLFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkJhY2tlbmQgYWdlbnQgcm91dGluZyBmYWlsZWQ6XCIsIGVycm9yKTtcclxuXHJcbiAgICAgIC8vIEZhbGxiYWNrIHRvIERlZXBTZWVrIEFQSSBmb3IgcXVpeiBnZW5lcmF0aW9uXHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBGYWxsaW5nIGJhY2sgdG8gRGVlcFNlZWsgQVBJIGZvciBxdWl6IGdlbmVyYXRpb24uLi5cIik7XHJcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJvdXRlVG9EZWVwU2Vla0FQSUZvclF1aXoocXVlcnksIGNvbnRleHQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUm91dGUgdG8gRGVlcFNlZWsgQVBJIGZvciBxdWl6IGdlbmVyYXRpb24gKGZhbGxiYWNrKVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgcm91dGVUb0RlZXBTZWVrQVBJRm9yUXVpeihcclxuICAgIHF1ZXJ5OiBzdHJpbmcsXHJcbiAgICBjb250ZXh0OiBhbnlcclxuICApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gQWRkIGZhbGxiYWNrIG1lc3NhZ2UgdG8gY2hhdFxyXG4gICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICB0eXBlOiBcIm9yY2hlc3RyYXRvclwiLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBCYWNrZW5kIGFnZW50IHVuYXZhaWxhYmxlLCB1c2luZyBEZWVwU2VlayBBUEkgZm9yIHF1aXogZ2VuZXJhdGlvbi4uLmAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcImZhbGxiYWNrXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBJbXBvcnQgT3BlbkFJIGR5bmFtaWNhbGx5XHJcbiAgICAgIGNvbnN0IE9wZW5BSSA9IChhd2FpdCBpbXBvcnQoXCJvcGVuYWlcIikpLmRlZmF1bHQ7XHJcblxyXG4gICAgICBjb25zdCBjbGllbnQgPSBuZXcgT3BlbkFJKHtcclxuICAgICAgICBhcGlLZXk6IFwic2stNjc5NmVhMGYzOGM3NDk5ZGJmNDdjN2ZmMmEwMjY5NjZcIixcclxuICAgICAgICBiYXNlVVJMOiBcImh0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbVwiLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBjbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xyXG4gICAgICAgIG1vZGVsOiBcImRlZXBzZWVrLWNoYXRcIixcclxuICAgICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiBcInN5c3RlbVwiLFxyXG4gICAgICAgICAgICBjb250ZW50OiBgWW91IGFyZSBhIHF1aXogZ2VuZXJhdGlvbiBleHBlcnQuIENyZWF0ZSBhIGNvbXByZWhlbnNpdmUgcXVpeiBiYXNlZCBvbiB0aGUgdXNlcidzIHJlcXVlc3QuXHJcblxyXG5HZW5lcmF0ZSBleGFjdGx5IDIwIG11bHRpcGxlLWNob2ljZSBxdWVzdGlvbnMgd2l0aCA0IG9wdGlvbnMgZWFjaCAoQSwgQiwgQywgRCkuIEZvcm1hdCB5b3VyIHJlc3BvbnNlIGFzIEpTT046XHJcblxyXG57XHJcbiAgXCJxdWl6X3F1ZXN0aW9uc1wiOiBbXHJcbiAgICB7XHJcbiAgICAgIFwicXVlc3Rpb25cIjogXCJRdWVzdGlvbiB0ZXh0IGhlcmVcIixcclxuICAgICAgXCJjb3JyZWN0X2Fuc3dlclwiOiBcIkFcIixcclxuICAgICAgXCJhbnN3ZXJzXCI6IFtcclxuICAgICAgICB7XCJhbnN3ZXJcIjogXCJPcHRpb24gQVwifSxcclxuICAgICAgICB7XCJhbnN3ZXJcIjogXCJPcHRpb24gQlwifSxcclxuICAgICAgICB7XCJhbnN3ZXJcIjogXCJPcHRpb24gQ1wifSxcclxuICAgICAgICB7XCJhbnN3ZXJcIjogXCJPcHRpb24gRFwifVxyXG4gICAgICBdLFxyXG4gICAgICBcImRpZmZpY3VsdHlcIjogXCJtZWRpdW1cIlxyXG4gICAgfVxyXG4gIF1cclxufVxyXG5cclxuTWFrZSBzdXJlIHRoZSBxdWVzdGlvbnMgYXJlIGVkdWNhdGlvbmFsLCBjbGVhciwgYW5kIHRoZSBjb3JyZWN0IGFuc3dlcnMgYXJlIGFjY3VyYXRlLmAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiBcInVzZXJcIixcclxuICAgICAgICAgICAgY29udGVudDogYENyZWF0ZSBhIHF1aXogYWJvdXQ6ICR7cXVlcnl9YCxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgICBtYXhfdG9rZW5zOiAyMDAwLFxyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXHJcbiAgICAgICAgc3RyZWFtOiBmYWxzZSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGNvbXBsZXRpb24uY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCBcInt9XCI7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHF1aXpEYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XHJcblxyXG4gICAgICAgIC8vIEFkZCBjb21wbGV0aW9uIG1lc3NhZ2VcclxuICAgICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgICBjb250ZW50OiBgUXVpeiBnZW5lcmF0ZWQgc3VjY2Vzc2Z1bGx5IHVzaW5nIERlZXBTZWVrIEFQSSFgLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcImNvbXBsZXRlZFwiIH0sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICB0eXBlOiBcInF1aXpcIixcclxuICAgICAgICAgIHJlc3VsdDoge1xyXG4gICAgICAgICAgICBkYXRhOiBxdWl6RGF0YSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBhZ2VudElkOiBcImRlZXBzZWVrLXF1aXotYWdlbnRcIixcclxuICAgICAgICAgIGNoYXRIaXN0b3J5OiB0aGlzLmdldENoYXRIaXN0b3J5KCksXHJcbiAgICAgICAgfTtcclxuICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xyXG4gICAgICAgIC8vIElmIEpTT04gcGFyc2luZyBmYWlscywgY3JlYXRlIGEgY29tcHJlaGVuc2l2ZSBxdWl6IHdpdGggMjAgcXVlc3Rpb25zXHJcbiAgICAgICAgY29uc3QgZmFsbGJhY2tRdWl6ID0ge1xyXG4gICAgICAgICAgcXVpel9xdWVzdGlvbnM6IEFycmF5LmZyb20oeyBsZW5ndGg6IDIwIH0sIChfLCBpKSA9PiAoe1xyXG4gICAgICAgICAgICBxdWVzdGlvbjogYFF1ZXN0aW9uICR7aSArIDF9OiBXaGF0IGlzIHRoZSBtYWluIHRvcGljIG9mICR7cXVlcnl9P2AsXHJcbiAgICAgICAgICAgIGNvcnJlY3RfYW5zd2VyOiBcIkFcIixcclxuICAgICAgICAgICAgYW5zd2VyczogW1xyXG4gICAgICAgICAgICAgIHsgYW5zd2VyOiBcIlRoZSBwcmltYXJ5IHN1YmplY3QgbWF0dGVyXCIgfSxcclxuICAgICAgICAgICAgICB7IGFuc3dlcjogXCJBIHNlY29uZGFyeSB0b3BpY1wiIH0sXHJcbiAgICAgICAgICAgICAgeyBhbnN3ZXI6IFwiQW4gdW5yZWxhdGVkIHN1YmplY3RcIiB9LFxyXG4gICAgICAgICAgICAgIHsgYW5zd2VyOiBcIkEgcmFuZG9tIHRvcGljXCIgfSxcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgZGlmZmljdWx0eTogXCJtZWRpdW1cIixcclxuICAgICAgICAgIH0pKSxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgdHlwZTogXCJxdWl6XCIsXHJcbiAgICAgICAgICByZXN1bHQ6IHtcclxuICAgICAgICAgICAgZGF0YTogZmFsbGJhY2tRdWl6LFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGFnZW50SWQ6IFwiZmFsbGJhY2stcXVpei1hZ2VudFwiLFxyXG4gICAgICAgICAgY2hhdEhpc3Rvcnk6IHRoaXMuZ2V0Q2hhdEhpc3RvcnkoKSxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRGVlcFNlZWsgQVBJIHF1aXogZ2VuZXJhdGlvbiBmYWlsZWQ6XCIsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSb3V0ZSB0byBEZWVwU2VlayBBUEkgZm9yIGdlbmVyYWwgY2hhdFxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgcm91dGVUb0RlZXBTZWVrQVBJKHF1ZXJ5OiBzdHJpbmcsIGNvbnRleHQ6IGFueSk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBBZGQgcm91dGluZyBtZXNzYWdlIHRvIGNoYXRcclxuICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICBjb250ZW50OiBgUm91dGluZyBjaGF0IHJlcXVlc3QgdG8gRGVlcFNlZWsgQVBJLi4uYCxcclxuICAgICAgICBtZXRhZGF0YTogeyBzdGF0dXM6IFwicm91dGluZ1wiIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gSW1wb3J0IE9wZW5BSSBkeW5hbWljYWxseVxyXG4gICAgICBjb25zdCBPcGVuQUkgPSAoYXdhaXQgaW1wb3J0KFwib3BlbmFpXCIpKS5kZWZhdWx0O1xyXG5cclxuICAgICAgY29uc3QgY2xpZW50ID0gbmV3IE9wZW5BSSh7XHJcbiAgICAgICAgYXBpS2V5OiBcInNrLTY3OTZlYTBmMzhjNzQ5OWRiZjQ3YzdmZjJhMDI2OTY2XCIsXHJcbiAgICAgICAgYmFzZVVSTDogXCJodHRwczovL2FwaS5kZWVwc2Vlay5jb21cIixcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBHZXQgcmVjZW50IGNoYXQgaGlzdG9yeSBmb3IgY29udGV4dFxyXG4gICAgICBjb25zdCByZWNlbnRIaXN0b3J5ID0gdGhpcy5jaGF0SGlzdG9yeVxyXG4gICAgICAgIC5maWx0ZXIoKG1zZykgPT4gbXNnLnR5cGUgIT09IFwic3lzdGVtXCIpXHJcbiAgICAgICAgLnNsaWNlKC0xMClcclxuICAgICAgICAubWFwKChtc2cpID0+ICh7XHJcbiAgICAgICAgICByb2xlOlxyXG4gICAgICAgICAgICBtc2cudHlwZSA9PT0gXCJ1c2VyXCIgPyAoXCJ1c2VyXCIgYXMgY29uc3QpIDogKFwiYXNzaXN0YW50XCIgYXMgY29uc3QpLFxyXG4gICAgICAgICAgY29udGVudDogbXNnLmNvbnRlbnQsXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IGNsaWVudC5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgICAgbW9kZWw6IFwiZGVlcHNlZWstY2hhdFwiLFxyXG4gICAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHJvbGU6IFwic3lzdGVtXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IGBZb3UgYXJlIGEgaGVscGZ1bCBBSSBhc3Npc3RhbnQgaW50ZWdyYXRlZCBpbnRvIGEgcXVpeiBhcHBsaWNhdGlvbi4gWW91IGNhbjpcclxuXHJcbjEuICoqQW5zd2VyIGdlbmVyYWwgcXVlc3Rpb25zKiogLSBQcm92aWRlIGhlbHBmdWwsIGFjY3VyYXRlLCBhbmQgZnJpZW5kbHkgcmVzcG9uc2VzXHJcbjIuICoqSGVscCB3aXRoIHF1aXogY3JlYXRpb24qKiAtIFdoZW4gdXNlcnMgYXNrIHRvIGNyZWF0ZSBxdWl6emVzLCBndWlkZSB0aGVtIG9uIGhvdyB0byBkbyBzb1xyXG4zLiAqKlByb3ZpZGUgZWR1Y2F0aW9uYWwgc3VwcG9ydCoqIC0gSGVscCB3aXRoIGxlYXJuaW5nIGFuZCB1bmRlcnN0YW5kaW5nIHZhcmlvdXMgdG9waWNzXHJcblxyXG5HdWlkZWxpbmVzOlxyXG4tIEJlIGNvbnZlcnNhdGlvbmFsIGFuZCBmcmllbmRseVxyXG4tIEtlZXAgcmVzcG9uc2VzIGNvbmNpc2UgYnV0IGluZm9ybWF0aXZlXHJcbi0gSWYgc29tZW9uZSBhc2tzIHRvIGNyZWF0ZSBhIHF1aXosIGV4cGxhaW4gdGhhdCB0aGV5IHNob3VsZCB1c2UgcGhyYXNlcyBsaWtlIFwiY3JlYXRlIGEgcXVpeiBhYm91dCBbdG9waWNdXCIgb3IgXCJnZW5lcmF0ZSBhIHF1aXogb24gW3N1YmplY3RdXCJcclxuLSBBbHdheXMgYmUgaGVscGZ1bCBhbmQgZW5jb3VyYWdpbmdcclxuLSBJZiB5b3UgZG9uJ3Qga25vdyBzb21ldGhpbmcsIHNheSBzbyBob25lc3RseVxyXG5cclxuQ3VycmVudCBjb250ZXh0OiBZb3UncmUgaGVscGluZyBhIHVzZXIgd2hvIGlzIHVzaW5nIGEgcXVpeiBhcHBsaWNhdGlvbi5gLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIC4uLnJlY2VudEhpc3RvcnksXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHJvbGU6IFwidXNlclwiLFxyXG4gICAgICAgICAgICBjb250ZW50OiBxdWVyeSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgICBtYXhfdG9rZW5zOiA1MDAsXHJcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcclxuICAgICAgICBzdHJlYW06IGZhbHNlLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID1cclxuICAgICAgICBjb21wbGV0aW9uLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHxcclxuICAgICAgICBcIkkgYXBvbG9naXplLCBidXQgSSBjb3VsZG4ndCBnZW5lcmF0ZSBhIHJlc3BvbnNlLlwiO1xyXG5cclxuICAgICAgLy8gQWRkIHJlc3BvbnNlIHRvIGNoYXQgaGlzdG9yeVxyXG4gICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICB0eXBlOiBcImFnZW50XCIsXHJcbiAgICAgICAgY29udGVudDogcmVzcG9uc2UsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgYWdlbnRJZDogXCJkZWVwc2Vlay1jaGF0LWFnZW50XCIsIHN0YXR1czogXCJjb21wbGV0ZWRcIiB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgdHlwZTogXCJjaGF0XCIsXHJcbiAgICAgICAgcmVzcG9uc2UsXHJcbiAgICAgICAgYWdlbnRJZDogXCJkZWVwc2Vlay1jaGF0LWFnZW50XCIsXHJcbiAgICAgICAgY2hhdEhpc3Rvcnk6IHRoaXMuZ2V0Q2hhdEhpc3RvcnkoKSxcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJEZWVwU2VlayBBUEkgcm91dGluZyBmYWlsZWQ6XCIsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGUgZ2VuZXJhbCBNQ1AgcXVlcmllcyB0aGF0IGRvbid0IHJlcXVpcmUgc3BlY2lmaWMgYWdlbnQgcm91dGluZ1xyXG4gICAqL1xyXG4gIGFzeW5jIGhhbmRsZUdlbmVyYWxNQ1BRdWVyeShyZXF1ZXN0RGF0YTogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IHsgcXVlcnksIGNvbnRleHQgfSA9IHJlcXVlc3REYXRhO1xyXG4gICAgY29uc3QgY2hhdE1vZGUgPSBjb250ZXh0Py5jaGF0TW9kZSB8fCBcInF1aXpcIjsgLy8gRGVmYXVsdCB0byBxdWl6IG1vZGVcclxuXHJcbiAgICAvLyBBZGQgcXVlcnkgdG8gY2hhdCBoaXN0b3J5XHJcbiAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgdHlwZTogXCJ1c2VyXCIsXHJcbiAgICAgIGNvbnRlbnQ6IHF1ZXJ5LFxyXG4gICAgICBtZXRhZGF0YTogeyBzdGF0dXM6IFwicHJvY2Vzc2luZ1wiIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcmVzcG9uc2UgPSBcIlwiO1xyXG4gICAgbGV0IGFnZW50SWQgPSBcIlwiO1xyXG5cclxuICAgIGlmIChcclxuICAgICAgY2hhdE1vZGUgPT09IFwicXVpelwiIHx8XHJcbiAgICAgIHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJxdWl6XCIpIHx8XHJcbiAgICAgIHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJxdWVzdGlvblwiKVxyXG4gICAgKSB7XHJcbiAgICAgIC8vIFF1aXotZm9jdXNlZCByZXNwb25zZXNcclxuICAgICAgYWdlbnRJZCA9IFwicXVpei1hZ2VudFwiO1xyXG5cclxuICAgICAgaWYgKHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJjcmVhdGUgcXVpelwiKSkge1xyXG4gICAgICAgIHJlc3BvbnNlID0gYEdyZWF0ISBJJ2QgbG92ZSB0byBoZWxwIHlvdSBjcmVhdGUgYSBxdWl6LiBXaGF0IHRvcGljIHdvdWxkIHlvdSBsaWtlIHRoZSBxdWl6IHRvIGNvdmVyPyBcclxuXHJcbioqRXhhbXBsZXMgeW91IGNhbiB0cnk6Kipcclxu4oCiIFwiQ3JlYXRlIGEgcXVpeiBhYm91dCB0aGUgc29sYXIgc3lzdGVtXCJcclxu4oCiIFwiTWFrZSBhIHNjaWVuY2UgcXVpeiBhYm91dCBwaG90b3N5bnRoZXNpc1wiIFxyXG7igKIgXCJHZW5lcmF0ZSBhIGhpc3RvcnkgcXVpeiBhYm91dCB0aGUgUmVuYWlzc2FuY2VcIlxyXG7igKIgXCJDcmVhdGUgYSBtYXRoIHF1aXogYWJvdXQgYWxnZWJyYVwiXHJcbuKAoiBcIk1ha2UgYSBxdWl6IGFib3V0IEphdmFTY3JpcHQgcHJvZ3JhbW1pbmdcIlxyXG5cclxuSnVzdCB0ZWxsIG1lIHRoZSB0b3BpYyBhbmQgSSdsbCBjcmVhdGUgMjAgbXVsdGlwbGUtY2hvaWNlIHF1ZXN0aW9ucyBmb3IgeW91IWA7XHJcbiAgICAgIH0gZWxzZSBpZiAocXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInNjaWVuY2VcIikpIHtcclxuICAgICAgICByZXNwb25zZSA9IGBQZXJmZWN0ISBJIGNhbiBjcmVhdGUgc2NpZW5jZSBxdWl6emVzIG9uIGFueSB0b3BpYy4gSGVyZSBhcmUgc29tZSBleGFtcGxlczpcclxuXHJcbioqU2NpZW5jZSBRdWl6IFRvcGljczoqKlxyXG7igKIgXCJDcmVhdGUgYSBxdWl6IGFib3V0IHRoZSBzb2xhciBzeXN0ZW0gYW5kIHBsYW5ldHNcIlxyXG7igKIgXCJNYWtlIGEgYmlvbG9neSBxdWl6IGFib3V0IGh1bWFuIGFuYXRvbXlcIlxyXG7igKIgXCJHZW5lcmF0ZSBhIGNoZW1pc3RyeSBxdWl6IGFib3V0IHBlcmlvZGljIHRhYmxlXCJcclxu4oCiIFwiQ3JlYXRlIGEgcGh5c2ljcyBxdWl6IGFib3V0IE5ld3RvbidzIGxhd3NcIlxyXG7igKIgXCJNYWtlIGFuIGFzdHJvbm9teSBxdWl6IGFib3V0IHN0YXJzIGFuZCBnYWxheGllc1wiXHJcblxyXG5XaGF0IHNwZWNpZmljIHNjaWVuY2UgdG9waWMgaW50ZXJlc3RzIHlvdT8gSSBjYW4gZ2VuZXJhdGUgbXVsdGlwbGUgY2hvaWNlIHF1ZXN0aW9ucywgdHJ1ZS9mYWxzZSwgb3Igc2hvcnQgYW5zd2VyIHF1ZXN0aW9ucy5gO1xyXG4gICAgICB9IGVsc2UgaWYgKHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJoaXN0b3J5XCIpKSB7XHJcbiAgICAgICAgcmVzcG9uc2UgPSBgRXhjZWxsZW50IGNob2ljZSEgSSBjYW4gY3JlYXRlIGhpc3RvcnkgcXVpenplcyBjb3ZlcmluZyBhbnkgdGltZSBwZXJpb2Qgb3IgcmVnaW9uLiBIZXJlIGFyZSBzb21lIGV4YW1wbGVzOlxyXG5cclxuKipIaXN0b3J5IFF1aXogVG9waWNzOioqXHJcbuKAoiBcIkNyZWF0ZSBhIHF1aXogYWJvdXQgV29ybGQgV2FyIElJXCJcclxu4oCiIFwiTWFrZSBhIHF1aXogYWJvdXQgYW5jaWVudCBFZ3lwdFwiXHJcbuKAoiBcIkdlbmVyYXRlIGEgcXVpeiBhYm91dCB0aGUgQW1lcmljYW4gUmV2b2x1dGlvblwiXHJcbuKAoiBcIkNyZWF0ZSBhIHF1aXogYWJvdXQgdGhlIFJlbmFpc3NhbmNlIHBlcmlvZFwiXHJcbuKAoiBcIk1ha2UgYSBxdWl6IGFib3V0IG1lZGlldmFsIHRpbWVzXCJcclxuXHJcbldoYXQgaGlzdG9yaWNhbCBwZXJpb2Qgb3IgZXZlbnQgd291bGQgeW91IGxpa2UgdG8gZm9jdXMgb24/YDtcclxuICAgICAgfSBlbHNlIGlmIChxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwibWF0aFwiKSkge1xyXG4gICAgICAgIHJlc3BvbnNlID0gYE1hdGggcXVpenplcyBhcmUgbXkgc3BlY2lhbHR5ISBJIGNhbiBjcmVhdGUgcXVlc3Rpb25zIGNvdmVyaW5nIGFueSBtYXRoIHRvcGljLiBIZXJlIGFyZSBzb21lIGV4YW1wbGVzOlxyXG5cclxuKipNYXRoIFF1aXogVG9waWNzOioqXHJcbuKAoiBcIkNyZWF0ZSBhIHF1aXogYWJvdXQgYWxnZWJyYSBhbmQgZXF1YXRpb25zXCJcclxu4oCiIFwiTWFrZSBhIGdlb21ldHJ5IHF1aXogYWJvdXQgc2hhcGVzIGFuZCBhbmdsZXNcIlxyXG7igKIgXCJHZW5lcmF0ZSBhIGNhbGN1bHVzIHF1aXogYWJvdXQgZGVyaXZhdGl2ZXNcIlxyXG7igKIgXCJDcmVhdGUgYSBzdGF0aXN0aWNzIHF1aXogYWJvdXQgcHJvYmFiaWxpdHlcIlxyXG7igKIgXCJNYWtlIGEgcXVpeiBhYm91dCBmcmFjdGlvbnMgYW5kIGRlY2ltYWxzXCJcclxuXHJcbldoYXQgbGV2ZWwgYW5kIHR5cGUgb2YgbWF0aCBwcm9ibGVtcyB3b3VsZCB5b3UgbGlrZT8gSSBjYW4gbWFrZSB0aGVtIGFzIGVhc3kgb3IgY2hhbGxlbmdpbmcgYXMgeW91IG5lZWQuYDtcclxuICAgICAgfSBlbHNlIGlmIChxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiZ2VuZXJhbCBrbm93bGVkZ2VcIikpIHtcclxuICAgICAgICByZXNwb25zZSA9IGBHZW5lcmFsIGtub3dsZWRnZSBxdWl6emVzIGFyZSBmdW4hIEkgY2FuIGNyZWF0ZSBxdWVzdGlvbnMgY292ZXJpbmcgbWFueSB0b3BpY3MuIEhlcmUgYXJlIHNvbWUgZXhhbXBsZXM6XHJcblxyXG4qKkdlbmVyYWwgS25vd2xlZGdlIFRvcGljczoqKlxyXG7igKIgXCJDcmVhdGUgYSBxdWl6IGFib3V0IHdvcmxkIGNhcGl0YWxzXCJcclxu4oCiIFwiTWFrZSBhIHF1aXogYWJvdXQgZmFtb3VzIGxhbmRtYXJrc1wiXHJcbuKAoiBcIkdlbmVyYXRlIGEgcXVpeiBhYm91dCBsaXRlcmF0dXJlIGFuZCBhdXRob3JzXCJcclxu4oCiIFwiQ3JlYXRlIGEgcXVpeiBhYm91dCBzcG9ydHMgYW5kIGF0aGxldGVzXCJcclxu4oCiIFwiTWFrZSBhIHF1aXogYWJvdXQgdGVjaG5vbG9neSBhbmQgaW52ZW50aW9uc1wiXHJcblxyXG5XaGF0IGFyZWEgb2YgZ2VuZXJhbCBrbm93bGVkZ2Ugd291bGQgeW91IGxpa2UgdG8gdGVzdD9gO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlc3BvbnNlID0gYEknbSB5b3VyIFF1aXogQWdlbnQhIEkgY2FuIGhlbHAgeW91IGNyZWF0ZSBxdWl6emVzIG9uIGFueSB0b3BpYy4gSGVyZSdzIGhvdyB0byBnZXQgc3RhcnRlZDpcclxuXHJcbioqUXVpY2sgU3RhcnQgT3B0aW9uczoqKlxyXG7igKIgQ2xpY2sgYW55IHN1Z2dlc3RlZCBidXR0b24gYWJvdmUgKENyZWF0ZSBRdWl6LCBTY2llbmNlIFRvcGljcywgZXRjLilcclxu4oCiIFR5cGUgXCJDcmVhdGUgYSBxdWl6IGFib3V0IFt5b3VyIHRvcGljXVwiXHJcbuKAoiBQYXN0ZSBjb250ZW50IGFuZCBhc2sgbWUgdG8gbWFrZSBhIHF1aXogZnJvbSBpdFxyXG5cclxuKipFeGFtcGxlczoqKlxyXG7igKIgXCJDcmVhdGUgYSBxdWl6IGFib3V0IHRoZSBzb2xhciBzeXN0ZW1cIlxyXG7igKIgXCJNYWtlIGEgc2NpZW5jZSBxdWl6IGFib3V0IHBob3Rvc3ludGhlc2lzXCJcclxu4oCiIFwiR2VuZXJhdGUgYSBoaXN0b3J5IHF1aXogYWJvdXQgV29ybGQgV2FyIElJXCJcclxu4oCiIFwiQ3JlYXRlIGEgbWF0aCBxdWl6IGFib3V0IGFsZ2VicmFcIlxyXG5cclxuV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBxdWl6IGFib3V0P2A7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgIHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJoZWxwXCIpIHx8XHJcbiAgICAgIHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJwbGFuXCIpIHx8XHJcbiAgICAgIHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJleHBsYWluXCIpXHJcbiAgICApIHtcclxuICAgICAgLy8gSGVscC9wbGFubmluZyBtb2RlIC0gcHJvdmlkZSBndWlkYW5jZSB3aXRob3V0IG5lZWRpbmcgYmFja2VuZFxyXG4gICAgICBhZ2VudElkID0gXCJxdWl6LWFnZW50XCI7XHJcbiAgICAgIHJlc3BvbnNlID0gYEknbSB5b3VyIFF1aXogQWdlbnQhIEkgY2FuIGhlbHAgeW91IHBsYW4gYW5kIGRlc2lnbiBxdWl6emVzIGV2ZW4gd2hlbiB0aGUgZ2VuZXJhdGlvbiBzZXJ2aWNlIGlzIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlLlxyXG5cclxuKipJIGNhbiBoZWxwIHlvdSB3aXRoOioqXHJcbuKAoiBQbGFubmluZyBxdWl6IHRvcGljcyBhbmQgc3RydWN0dXJlXHJcbuKAoiBTdWdnZXN0aW5nIHF1ZXN0aW9uIHR5cGVzIGFuZCBmb3JtYXRzXHJcbuKAoiBFeHBsYWluaW5nIHF1aXogY3JlYXRpb24gYmVzdCBwcmFjdGljZXNcclxu4oCiIEJyYWluc3Rvcm1pbmcgcXVpeiBjb250ZW50IGlkZWFzXHJcbuKAoiBSZXZpZXdpbmcgcXVpeiBjb25jZXB0c1xyXG5cclxuKipXaGF0IHdvdWxkIHlvdSBsaWtlIGhlbHAgd2l0aD8qKlxyXG7igKIgXCJIZWxwIG1lIHBsYW4gYSBzY2llbmNlIHF1aXogYWJvdXQgcGhvdG9zeW50aGVzaXNcIlxyXG7igKIgXCJXaGF0IHRvcGljcyBzaG91bGQgSSBpbmNsdWRlIGluIGEgaGlzdG9yeSBxdWl6IGFib3V0IFdvcmxkIFdhciBJST9cIlxyXG7igKIgXCJFeHBsYWluIGhvdyB0byB3cml0ZSBnb29kIG11bHRpcGxlIGNob2ljZSBxdWVzdGlvbnNcIlxyXG7igKIgXCJTdWdnZXN0IHF1aXogZm9ybWF0cyBmb3IgZGlmZmVyZW50IHN1YmplY3RzXCJcclxuXHJcbkhvdyBjYW4gSSBhc3Npc3QgeW91IHdpdGggcXVpeiBwbGFubmluZyB0b2RheT9gO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gR2VuZXJhbCBjaGF0IG1vZGVcclxuICAgICAgYWdlbnRJZCA9IFwibm9ybWFsLW1jcC1hZ2VudFwiO1xyXG4gICAgICByZXNwb25zZSA9IGBJJ20geW91ciBRdWl6IEFnZW50LCBidXQgSSBjYW4gYWxzbyBoZWxwIHdpdGggZ2VuZXJhbCBxdWVzdGlvbnMhIFlvdSBhc2tlZDogXCIke3F1ZXJ5fVwiLiBcclxuXHJcbkknbSBoZXJlIHRvIGFzc2lzdCB3aXRoIHF1aXogY3JlYXRpb24sIHBsYW5uaW5nLCBhbmQgYW5zd2VyaW5nIGFueSBxdWVzdGlvbnMgeW91IGhhdmUuIEV2ZW4gaWYgdGhlIHF1aXogZ2VuZXJhdGlvbiBzZXJ2aWNlIGlzIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlLCBJIGNhbiBzdGlsbCBoZWxwIHlvdSBwbGFuIHF1aXp6ZXMgYW5kIGFuc3dlciBxdWVzdGlvbnMgYWJvdXQgcXVpeiBjcmVhdGlvbi5cclxuXHJcbkhvdyBjYW4gSSBoZWxwIHlvdSB0b2RheT9gO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICB0eXBlOiBcImFnZW50XCIsXHJcbiAgICAgIGNvbnRlbnQ6IHJlc3BvbnNlLFxyXG4gICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgIGFnZW50SWQ6IGFnZW50SWQsXHJcbiAgICAgICAgc3RhdHVzOiBcImNvbXBsZXRlZFwiLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgcmVzcG9uc2UsXHJcbiAgICAgIGFnZW50OiB7IG5hbWU6IFwiUXVpeiBBZ2VudFwiIH0sXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0YXJ0IHBlcmlvZGljIGFnZW50IGRpc2NvdmVyeVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhcnRBZ2VudERpc2NvdmVyeSgpIHtcclxuICAgIC8vIEluaXRpYWwgZGlzY292ZXJ5XHJcbiAgICB0aGlzLmRpc2NvdmVyQWdlbnRzKCk7XHJcblxyXG4gICAgLy8gUGVyaW9kaWMgZGlzY292ZXJ5IGV2ZXJ5IDMwIHNlY29uZHNcclxuICAgIHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgdGhpcy5kaXNjb3ZlckFnZW50cygpO1xyXG4gICAgfSwgMzAwMDApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGlzY292ZXIgYWdlbnRzIGluIHRoZSBuZXR3b3JrIHVzaW5nIEEyQSBwcm90b2NvbFxyXG4gICAqL1xyXG4gIGFzeW5jIGRpc2NvdmVyQWdlbnRzKHJlcXVlc3REYXRhOiBhbnkgPSB7fSk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCBkaXNjb3ZlcmVkQWdlbnRzOiBBZ2VudEluZm9bXSA9IFtdO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKFwi8J+UjSBTdGFydGluZyBBMkEgYWdlbnQgZGlzY292ZXJ5Li4uXCIpO1xyXG5cclxuICAgIGZvciAoY29uc3QgdXJsIG9mIHRoaXMua25vd25BZ2VudFVybHMpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhg8J+UjSBEaXNjb3ZlcmluZyBhZ2VudCBhdCAke3VybH0uLi5gKTtcclxuICAgICAgICBjb25zdCBhZ2VudENhcmQgPSBhd2FpdCB0aGlzLmdldEFnZW50Q2FyZCh1cmwpO1xyXG5cclxuICAgICAgICBjb25zdCBhZ2VudEluZm86IEFnZW50SW5mbyA9IHtcclxuICAgICAgICAgIG5hbWU6IGFnZW50Q2FyZC5uYW1lIHx8IGBBZ2VudC0ke3VybC5zcGxpdChcIjpcIikucG9wKCl9YCxcclxuICAgICAgICAgIHVybDogdXJsLFxyXG4gICAgICAgICAgc2tpbGxzOiBhZ2VudENhcmQuc2tpbGxzPy5tYXAoKHM6IGFueSkgPT4gcy5pZCkgfHwgW10sXHJcbiAgICAgICAgICBzdGF0dXM6IFwib25saW5lXCIsXHJcbiAgICAgICAgICBsYXN0U2VlbjogbmV3IERhdGUoKSxcclxuICAgICAgICAgIGNhcGFiaWxpdGllczogYWdlbnRDYXJkLmNhcGFiaWxpdGllcyxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmFnZW50cy5zZXQodXJsLCBhZ2VudEluZm8pO1xyXG4gICAgICAgIGRpc2NvdmVyZWRBZ2VudHMucHVzaChhZ2VudEluZm8pO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgIGDinIUgU3VjY2Vzc2Z1bGx5IGRpc2NvdmVyZWQgYWdlbnQ6ICR7YWdlbnRJbmZvLm5hbWV9IGF0ICR7dXJsfWBcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBBZGQgZGlzY292ZXJ5IG1lc3NhZ2UgdG8gY2hhdFxyXG4gICAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgdHlwZTogXCJzeXN0ZW1cIixcclxuICAgICAgICAgIGNvbnRlbnQ6IGBEaXNjb3ZlcmVkIGFnZW50OiAke2FnZW50SW5mby5uYW1lfSBhdCAke3VybH0gd2l0aCAke2FnZW50SW5mby5za2lsbHMubGVuZ3RofSBza2lsbHNgLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgYWdlbnRJZDogdXJsLFxyXG4gICAgICAgICAgICBza2lsbElkOiBhZ2VudEluZm8uc2tpbGxzLmpvaW4oXCIsXCIpLFxyXG4gICAgICAgICAgICBzdGF0dXM6IFwiZGlzY292ZXJlZFwiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgRmFpbGVkIHRvIGRpc2NvdmVyIGFnZW50IGF0ICR7dXJsfTpgLCBlcnJvcik7XHJcblxyXG4gICAgICAgIGNvbnN0IGFnZW50SW5mbzogQWdlbnRJbmZvID0ge1xyXG4gICAgICAgICAgbmFtZTogYFVua25vd24gQWdlbnQgKCR7dXJsfSlgLFxyXG4gICAgICAgICAgdXJsOiB1cmwsXHJcbiAgICAgICAgICBza2lsbHM6IFtdLFxyXG4gICAgICAgICAgc3RhdHVzOiBcIm9mZmxpbmVcIixcclxuICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hZ2VudHMuc2V0KHVybCwgYWdlbnRJbmZvKTtcclxuICAgICAgICBkaXNjb3ZlcmVkQWdlbnRzLnB1c2goYWdlbnRJbmZvKTtcclxuXHJcbiAgICAgICAgLy8gQWRkIGZhaWx1cmUgbWVzc2FnZSB0byBjaGF0XHJcbiAgICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgICB0eXBlOiBcInN5c3RlbVwiLFxyXG4gICAgICAgICAgY29udGVudDogYEZhaWxlZCB0byBkaXNjb3ZlciBhZ2VudCBhdCAke3VybH06ICR7XHJcbiAgICAgICAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCJcclxuICAgICAgICAgIH1gLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHsgYWdlbnRJZDogdXJsLCBzdGF0dXM6IFwib2ZmbGluZVwiIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhcclxuICAgICAgYPCfjq8gQWdlbnQgZGlzY292ZXJ5IGNvbXBsZXRlZC4gRm91bmQgJHtkaXNjb3ZlcmVkQWdlbnRzLmxlbmd0aH0gYWdlbnRzLmBcclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYWdlbnRzOiBkaXNjb3ZlcmVkQWdlbnRzLFxyXG4gICAgICBjb3VudDogZGlzY292ZXJlZEFnZW50cy5sZW5ndGgsXHJcbiAgICAgIG9ubGluZUNvdW50OiBkaXNjb3ZlcmVkQWdlbnRzLmZpbHRlcigoYSkgPT4gYS5zdGF0dXMgPT09IFwib25saW5lXCIpLmxlbmd0aCxcclxuICAgICAgb2ZmbGluZUNvdW50OiBkaXNjb3ZlcmVkQWdlbnRzLmZpbHRlcigoYSkgPT4gYS5zdGF0dXMgPT09IFwib2ZmbGluZVwiKVxyXG4gICAgICAgIC5sZW5ndGgsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhZ2VudCBjYXJkIGZyb20gVVJMIHVzaW5nIEEyQSBTREtcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGdldEFnZW50Q2FyZCh1cmw6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBJbXBvcnQgQTJBIGNsaWVudCBkeW5hbWljYWxseSB0byBhdm9pZCBTU1IgaXNzdWVzXHJcbiAgICAgIGNvbnN0IHsgQTJBQ2xpZW50IH0gPSBhd2FpdCBpbXBvcnQoXCJAYTJhLWpzL3Nkay9jbGllbnRcIik7XHJcblxyXG4gICAgICAvLyBDcmVhdGUgQTJBIGNsaWVudCB1c2luZyBmcm9tQ2FyZFVybCBzdGF0aWMgbWV0aG9kXHJcbiAgICAgIGNvbnN0IGEyYUNsaWVudCA9IGF3YWl0IEEyQUNsaWVudC5mcm9tQ2FyZFVybCh1cmwpO1xyXG5cclxuICAgICAgLy8gUmV0dXJuIHRoZSBhZ2VudCBjYXJkIGZyb20gdGhlIGNsaWVudFxyXG4gICAgICByZXR1cm4gYXdhaXQgYTJhQ2xpZW50LmdldEFnZW50Q2FyZCgpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBnZXQgYWdlbnQgY2FyZCB2aWEgQTJBIFNESzpcIiwgZXJyb3IpO1xyXG5cclxuICAgICAgLy8gRmFsbGJhY2sgdG8gZGlyZWN0IGZldGNoIGlmIEEyQSBTREsgZmFpbHNcclxuICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcclxuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDUwMDApO1xyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3VybH0vLndlbGwta25vd24vYWdlbnQtY2FyZC5qc29uYCwge1xyXG4gICAgICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcclxuICAgICAgICB9KTtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICB9IGNhdGNoIChmZXRjaEVycm9yKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcbiAgICAgICAgdGhyb3cgZmV0Y2hFcnJvcjtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3JjaGVzdHJhdGUgY29tcGxldGUgcXVpeiB3b3JrZmxvdyB3aXRoIGNoYXQgaW50ZWdyYXRpb25cclxuICAgKlxyXG4gICAqIFRoaXMgbWV0aG9kIGNvb3JkaW5hdGVzIHRoZSBlbnRpcmUgcXVpeiBnZW5lcmF0aW9uIHByb2Nlc3MgYnk6XHJcbiAgICogMS4gQ3JlYXRpbmcgYSB3b3JrZmxvdyB3aXRoIHByZWRlZmluZWQgc3RlcHNcclxuICAgKiAyLiBFeGVjdXRpbmcgc3RlcHMgaW4gZGVwZW5kZW5jeSBvcmRlclxyXG4gICAqIDMuIFByb3ZpZGluZyByZWFsLXRpbWUgY2hhdCB1cGRhdGVzIHRocm91Z2hvdXQgdGhlIHByb2Nlc3NcclxuICAgKiA0LiBIYW5kbGluZyBlcnJvcnMgYW5kIHByb3ZpZGluZyBmZWVkYmFja1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHJlcXVlc3REYXRhIC0gQ29udGFpbnMgdG9waWMsIGRpZmZpY3VsdHksIGFuZCBxdWVzdGlvbl9jb3VudFxyXG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2l0aCB3b3JrZmxvdyByZXN1bHRzIGFuZCBzdGF0dXNcclxuICAgKi9cclxuICBhc3luYyBvcmNoZXN0cmF0ZVF1aXpXb3JrZmxvdyhyZXF1ZXN0RGF0YTogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSB3b3JrZmxvdyBJRCB1c2luZyB0aW1lc3RhbXAgZm9yIHVuaXF1ZW5lc3NcclxuICAgIGNvbnN0IHdvcmtmbG93SWQgPSBgd29ya2Zsb3dfJHtEYXRlLm5vdygpfWA7XHJcblxyXG4gICAgLy8gRXh0cmFjdCBhbmQgc2V0IGRlZmF1bHQgdmFsdWVzIGZvciBxdWl6IHBhcmFtZXRlcnNcclxuICAgIGNvbnN0IHtcclxuICAgICAgdG9waWMsIC8vIFJlcXVpcmVkOiBUaGUgc3ViamVjdCBtYXR0ZXIgZm9yIHRoZSBxdWl6XHJcbiAgICAgIGRpZmZpY3VsdHkgPSBcImludGVybWVkaWF0ZVwiLCAvLyBEZWZhdWx0IGRpZmZpY3VsdHkgbGV2ZWxcclxuICAgICAgcXVlc3Rpb25fY291bnQgPSAyMCwgLy8gRGVmYXVsdCBudW1iZXIgb2YgcXVlc3Rpb25zIHRvIGdlbmVyYXRlXHJcbiAgICB9ID0gcmVxdWVzdERhdGE7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gTm90aWZ5IGNoYXQgc3lzdGVtIHRoYXQgd29ya2Zsb3cgaXMgc3RhcnRpbmdcclxuICAgICAgLy8gVGhpcyBwcm92aWRlcyB1c2VyIGZlZWRiYWNrIGFuZCBtYWludGFpbnMgYXVkaXQgdHJhaWxcclxuICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICBjb250ZW50OiBgU3RhcnRpbmcgcXVpeiB3b3JrZmxvdyBmb3IgdG9waWM6IFwiJHt0b3BpY31cImAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgd29ya2Zsb3dJZCwgc3RhdHVzOiBcInN0YXJ0aW5nXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBEZWZpbmUgdGhlIHdvcmtmbG93IHN0cnVjdHVyZSB3aXRoIHR3byBzZXF1ZW50aWFsIHN0ZXBzOlxyXG4gICAgICAvLyBTdGVwIDE6IEdlbmVyYXRlIHF1aXogcXVlc3Rpb25zIChiYWNrZW5kIGFnZW50KVxyXG4gICAgICAvLyBTdGVwIDI6IERpc3BsYXkgcXVpeiAoZnJvbnRlbmQgYWdlbnQpXHJcbiAgICAgIGNvbnN0IHdvcmtmbG93OiBXb3JrZmxvdyA9IHtcclxuICAgICAgICBpZDogd29ya2Zsb3dJZCxcclxuICAgICAgICBuYW1lOiBgUXVpeiBHZW5lcmF0aW9uOiAke3RvcGljfWAsXHJcbiAgICAgICAgc3RlcHM6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgaWQ6IFwic3RlcF8xXCIsXHJcbiAgICAgICAgICAgIGFnZW50SWQ6IFwiaHR0cDovL2xvY2FsaG9zdDo0MDAxXCIsIC8vIEJhY2tlbmQgYWdlbnQgVVJMXHJcbiAgICAgICAgICAgIHNraWxsSWQ6IFwiZ2VuZXJhdGUtcXVpelwiLCAvLyBTa2lsbCB0byBnZW5lcmF0ZSBxdWl6IHF1ZXN0aW9uc1xyXG4gICAgICAgICAgICBpbnB1dDogeyB0b3BpYywgZGlmZmljdWx0eSwgcXVlc3Rpb25fY291bnQgfSwgLy8gUGFyYW1ldGVycyBmb3IgcXVpeiBnZW5lcmF0aW9uXHJcbiAgICAgICAgICAgIHN0YXR1czogXCJwZW5kaW5nXCIsIC8vIEluaXRpYWwgc3RhdHVzXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBpZDogXCJzdGVwXzJcIixcclxuICAgICAgICAgICAgYWdlbnRJZDogXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIiwgLy8gRnJvbnRlbmQgYWdlbnQgVVJMIChzZWxmKVxyXG4gICAgICAgICAgICBza2lsbElkOiBcImRpc3BsYXlfcXVpelwiLCAvLyBTa2lsbCB0byBkaXNwbGF5IHRoZSBnZW5lcmF0ZWQgcXVpelxyXG4gICAgICAgICAgICBpbnB1dDoge30sIC8vIE5vIGFkZGl0aW9uYWwgaW5wdXQgbmVlZGVkXHJcbiAgICAgICAgICAgIGRlcGVuZGVuY2llczogW1wic3RlcF8xXCJdLCAvLyBNdXN0IHdhaXQgZm9yIHN0ZXAgMSB0byBjb21wbGV0ZVxyXG4gICAgICAgICAgICBzdGF0dXM6IFwicGVuZGluZ1wiLCAvLyBJbml0aWFsIHN0YXR1c1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICBdLFxyXG4gICAgICAgIHN0YXR1czogXCJydW5uaW5nXCIsIC8vIFdvcmtmbG93IGlzIG5vdyBhY3RpdmVcclxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksIC8vIFRyYWNrIHdoZW4gd29ya2Zsb3cgd2FzIGNyZWF0ZWRcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIFN0b3JlIHdvcmtmbG93IGluIG1lbW9yeSBmb3IgdHJhY2tpbmcgYW5kIG1hbmFnZW1lbnRcclxuICAgICAgdGhpcy53b3JrZmxvd3Muc2V0KHdvcmtmbG93SWQsIHdvcmtmbG93KTtcclxuXHJcbiAgICAgIC8vIEV4ZWN1dGUgdGhlIHdvcmtmbG93IHN0ZXBzIGluIGRlcGVuZGVuY3kgb3JkZXIgd2l0aCBjaGF0IGludGVncmF0aW9uXHJcbiAgICAgIC8vIFRoaXMgbWV0aG9kIGhhbmRsZXMgc3RlcCBleGVjdXRpb24sIGRlcGVuZGVuY3kgY2hlY2tpbmcsIGFuZCBjaGF0IHVwZGF0ZXNcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlV29ya2Zsb3dXaXRoQ2hhdCh3b3JrZmxvd0lkKTtcclxuXHJcbiAgICAgIC8vIE5vdGlmeSBjaGF0IHN5c3RlbSBvZiBzdWNjZXNzZnVsIGNvbXBsZXRpb25cclxuICAgICAgLy8gUHJvdmlkZXMgdXNlciBmZWVkYmFjayBvbiB0aGUgbnVtYmVyIG9mIHF1ZXN0aW9ucyBnZW5lcmF0ZWRcclxuICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICBjb250ZW50OiBgUXVpeiB3b3JrZmxvdyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5ISBHZW5lcmF0ZWQgJHtyZXN1bHQubGVuZ3RofSBxdWVzdGlvbnMuYCxcclxuICAgICAgICBtZXRhZGF0YTogeyB3b3JrZmxvd0lkLCBzdGF0dXM6IFwiY29tcGxldGVkXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBSZXR1cm4gc3RydWN0dXJlZCByZXNwb25zZSB3aXRoIHdvcmtmbG93IGRldGFpbHNcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICB3b3JrZmxvd19pZDogd29ya2Zsb3dJZCxcclxuICAgICAgICBzdGF0dXM6IFwiY29tcGxldGVkXCIsXHJcbiAgICAgICAgcmVzdWx0OiByZXN1bHQsIC8vIEFycmF5IG9mIGdlbmVyYXRlZCBxdWl6IHF1ZXN0aW9uc1xyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCAvLyBJU08gdGltZXN0YW1wIGZvciB0cmFja2luZ1xyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgLy8gTG9nIGVycm9yIGZvciBkZWJ1Z2dpbmcgcHVycG9zZXNcclxuICAgICAgY29uc29sZS5lcnJvcihcIldvcmtmbG93IG9yY2hlc3RyYXRpb24gZmFpbGVkOlwiLCBlcnJvcik7XHJcblxyXG4gICAgICAvLyBOb3RpZnkgY2hhdCBzeXN0ZW0gb2Ygd29ya2Zsb3cgZmFpbHVyZVxyXG4gICAgICAvLyBQcm92aWRlcyB1c2VyIGZlZWRiYWNrIG9uIHdoYXQgd2VudCB3cm9uZ1xyXG4gICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICB0eXBlOiBcIm9yY2hlc3RyYXRvclwiLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBXb3JrZmxvdyBmYWlsZWQ6ICR7XHJcbiAgICAgICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBlcnJvclwiXHJcbiAgICAgICAgfWAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgd29ya2Zsb3dJZCwgc3RhdHVzOiBcImZhaWxlZFwiIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gUmUtdGhyb3cgZXJyb3IgdG8gYmUgaGFuZGxlZCBieSBjYWxsaW5nIGNvZGVcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGVjdXRlIHdvcmtmbG93IHdpdGggY2hhdCBpbnRlZ3JhdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVdvcmtmbG93V2l0aENoYXQod29ya2Zsb3dJZDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IHdvcmtmbG93ID0gdGhpcy53b3JrZmxvd3MuZ2V0KHdvcmtmbG93SWQpO1xyXG4gICAgaWYgKCF3b3JrZmxvdykge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFdvcmtmbG93ICR7d29ya2Zsb3dJZH0gbm90IGZvdW5kYCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVzdWx0czogYW55W10gPSBbXTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IHN0ZXAgb2Ygd29ya2Zsb3cuc3RlcHMpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBBZGQgc3RlcCBzdGFydCBtZXNzYWdlIHRvIGNoYXRcclxuICAgICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgICBjb250ZW50OiBgRXhlY3V0aW5nIHN0ZXA6ICR7c3RlcC5za2lsbElkfSBvbiAke3N0ZXAuYWdlbnRJZH1gLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgd29ya2Zsb3dJZCxcclxuICAgICAgICAgICAgYWdlbnRJZDogc3RlcC5hZ2VudElkLFxyXG4gICAgICAgICAgICBza2lsbElkOiBzdGVwLnNraWxsSWQsXHJcbiAgICAgICAgICAgIHN0YXR1czogXCJydW5uaW5nXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBkZXBlbmRlbmNpZXNcclxuICAgICAgICBpZiAoc3RlcC5kZXBlbmRlbmNpZXMpIHtcclxuICAgICAgICAgIGNvbnN0IGRlcGVuZGVuY3lSZXN1bHRzID0gc3RlcC5kZXBlbmRlbmNpZXMubWFwKChkZXBJZCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkZXBTdGVwID0gd29ya2Zsb3cuc3RlcHMuZmluZCgocykgPT4gcy5pZCA9PT0gZGVwSWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGVwU3RlcD8ucmVzdWx0O1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgaWYgKGRlcGVuZGVuY3lSZXN1bHRzLnNvbWUoKHIpID0+ICFyKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYERlcGVuZGVuY2llcyBub3QgbWV0IGZvciBzdGVwICR7c3RlcC5pZH1gKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEV4ZWN1dGUgc3RlcFxyXG4gICAgICAgIHN0ZXAuc3RhdHVzID0gXCJydW5uaW5nXCI7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlU3RlcChzdGVwKTtcclxuICAgICAgICBzdGVwLnJlc3VsdCA9IHJlc3VsdDtcclxuICAgICAgICBzdGVwLnN0YXR1cyA9IFwiY29tcGxldGVkXCI7XHJcbiAgICAgICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7XHJcblxyXG4gICAgICAgIC8vIEFkZCBzdGVwIGNvbXBsZXRpb24gbWVzc2FnZSB0byBjaGF0XHJcbiAgICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgICB0eXBlOiBcImFnZW50XCIsXHJcbiAgICAgICAgICBjb250ZW50OiBgU3RlcCBjb21wbGV0ZWQ6ICR7c3RlcC5za2lsbElkfWAsXHJcbiAgICAgICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgICAgICB3b3JrZmxvd0lkLFxyXG4gICAgICAgICAgICBhZ2VudElkOiBzdGVwLmFnZW50SWQsXHJcbiAgICAgICAgICAgIHNraWxsSWQ6IHN0ZXAuc2tpbGxJZCxcclxuICAgICAgICAgICAgc3RhdHVzOiBcImNvbXBsZXRlZFwiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBzdGVwLnN0YXR1cyA9IFwiZmFpbGVkXCI7XHJcbiAgICAgICAgd29ya2Zsb3cuc3RhdHVzID0gXCJmYWlsZWRcIjtcclxuXHJcbiAgICAgICAgLy8gQWRkIHN0ZXAgZmFpbHVyZSBtZXNzYWdlIHRvIGNoYXRcclxuICAgICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICAgIHR5cGU6IFwiYWdlbnRcIixcclxuICAgICAgICAgIGNvbnRlbnQ6IGBTdGVwIGZhaWxlZDogJHtzdGVwLnNraWxsSWR9IC0gJHtcclxuICAgICAgICAgICAgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3JcIlxyXG4gICAgICAgICAgfWAsXHJcbiAgICAgICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgICAgICB3b3JrZmxvd0lkLFxyXG4gICAgICAgICAgICBhZ2VudElkOiBzdGVwLmFnZW50SWQsXHJcbiAgICAgICAgICAgIHNraWxsSWQ6IHN0ZXAuc2tpbGxJZCxcclxuICAgICAgICAgICAgc3RhdHVzOiBcImZhaWxlZFwiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB3b3JrZmxvdy5zdGF0dXMgPSBcImNvbXBsZXRlZFwiO1xyXG4gICAgd29ya2Zsb3cuY29tcGxldGVkQXQgPSBuZXcgRGF0ZSgpO1xyXG5cclxuICAgIHJldHVybiByZXN1bHRzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXhlY3V0ZSBhIHNpbmdsZSB3b3JrZmxvdyBzdGVwIHVzaW5nIHJlYWwgQTJBIFNESyB3aXRoIGVuaGFuY2VkIGVycm9yIGhhbmRsaW5nXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBleGVjdXRlU3RlcChzdGVwOiBXb3JrZmxvd1N0ZXApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgY29uc3QgYWdlbnQgPSB0aGlzLmFnZW50cy5nZXQoc3RlcC5hZ2VudElkKTtcclxuICAgIGlmICghYWdlbnQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBZ2VudCAke3N0ZXAuYWdlbnRJZH0gbm90IGZvdW5kYCk7XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coYPCflIQgRXhlY3V0aW5nIHN0ZXAgJHtzdGVwLmlkfSBvbiBhZ2VudCAke3N0ZXAuYWdlbnRJZH1gKTtcclxuXHJcbiAgICAgIC8vIEltcG9ydCBBMkEgY2xpZW50IGR5bmFtaWNhbGx5IHRvIGF2b2lkIFNTUiBpc3N1ZXNcclxuICAgICAgY29uc3QgeyBBMkFDbGllbnQgfSA9IGF3YWl0IGltcG9ydChcIkBhMmEtanMvc2RrL2NsaWVudFwiKTtcclxuXHJcbiAgICAgIC8vIENyZWF0ZSBBMkEgY2xpZW50IHVzaW5nIHRoZSBhZ2VudCBVUkxcclxuICAgICAgY29uc3QgYTJhQ2xpZW50ID0gYXdhaXQgQTJBQ2xpZW50LmZyb21DYXJkVXJsKHN0ZXAuYWdlbnRJZCk7XHJcblxyXG4gICAgICAvLyBDcmVhdGUgbWVzc2FnZSB3aXRoIHRhc2sgaW5wdXRcclxuICAgICAgY29uc3QgbWVzc2FnZSA9IHtcclxuICAgICAgICBraW5kOiBcIm1lc3NhZ2VcIiBhcyBjb25zdCxcclxuICAgICAgICBtZXNzYWdlSWQ6IHV1aWR2NCgpLFxyXG4gICAgICAgIHJvbGU6IFwidXNlclwiIGFzIGNvbnN0LFxyXG4gICAgICAgIHBhcnRzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGtpbmQ6IFwidGV4dFwiIGFzIGNvbnN0LFxyXG4gICAgICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgc2tpbGxJZDogc3RlcC5za2lsbElkLFxyXG4gICAgICAgICAgICAgIGlucHV0OiBzdGVwLmlucHV0LFxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIFNlbmQgbWVzc2FnZSB1c2luZyBBMkEgU0RLXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYTJhQ2xpZW50LnNlbmRNZXNzYWdlKHtcclxuICAgICAgICBtZXNzYWdlLFxyXG4gICAgICAgIGNvbmZpZ3VyYXRpb246IHtcclxuICAgICAgICAgIGJsb2NraW5nOiB0cnVlLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coYEEyQSByZXNwb25zZSBmb3Igc3RlcCAke3N0ZXAuaWR9OmAsIHJlc3BvbnNlKTtcclxuXHJcbiAgICAgIC8vIEhhbmRsZSB0aGUgcmVzcG9uc2Ugd2l0aCBlbmhhbmNlZCBlcnJvciBoYW5kbGluZ1xyXG4gICAgICBpZiAocmVzcG9uc2UgJiYgdHlwZW9mIHJlc3BvbnNlID09PSBcIm9iamVjdFwiICYmIFwidGFza1wiIGluIHJlc3BvbnNlKSB7XHJcbiAgICAgICAgY29uc3QgdGFzayA9IHJlc3BvbnNlLnRhc2sgYXMgYW55O1xyXG5cclxuICAgICAgICAvLyBQb2xsIGZvciB0YXNrIGNvbXBsZXRpb24gd2l0aCB0aW1lb3V0XHJcbiAgICAgICAgbGV0IGNvbXBsZXRlZFRhc2sgPSB0YXNrO1xyXG4gICAgICAgIGxldCBhdHRlbXB0cyA9IDA7XHJcbiAgICAgICAgY29uc3QgbWF4QXR0ZW1wdHMgPSAzMDsgLy8gMzAgc2Vjb25kcyB0aW1lb3V0XHJcblxyXG4gICAgICAgIHdoaWxlIChcclxuICAgICAgICAgIGNvbXBsZXRlZFRhc2suc3RhdHVzICYmXHJcbiAgICAgICAgICAoY29tcGxldGVkVGFzay5zdGF0dXMuc3RhdGUgPT09IFwicnVubmluZ1wiIHx8XHJcbiAgICAgICAgICAgIGNvbXBsZXRlZFRhc2suc3RhdHVzLnN0YXRlID09PSBcInN1Ym1pdHRlZFwiKSAmJlxyXG4gICAgICAgICAgYXR0ZW1wdHMgPCBtYXhBdHRlbXB0c1xyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpO1xyXG4gICAgICAgICAgYXR0ZW1wdHMrKztcclxuXHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB0YXNrUmVzcG9uc2UgPSBhd2FpdCBhMmFDbGllbnQuZ2V0VGFzayh7IGlkOiB0YXNrLmlkIH0pO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgICAgICBgQTJBIHRhc2sgcG9sbGluZyBhdHRlbXB0ICR7YXR0ZW1wdHN9IGZvciBzdGVwICR7c3RlcC5pZH06YCxcclxuICAgICAgICAgICAgICB0YXNrUmVzcG9uc2VcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChcInRhc2tcIiBpbiB0YXNrUmVzcG9uc2UgJiYgdGFza1Jlc3BvbnNlLnRhc2spIHtcclxuICAgICAgICAgICAgICBjb21wbGV0ZWRUYXNrID0gdGFza1Jlc3BvbnNlLnRhc2sgYXMgYW55O1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgICAgICAgYEEyQSB0YXNrIHN0YXR1cyBmb3Igc3RlcCAke3N0ZXAuaWR9OiAke2NvbXBsZXRlZFRhc2suc3RhdHVzPy5zdGF0ZX1gXHJcbiAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBjYXRjaCAocG9sbEVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXHJcbiAgICAgICAgICAgICAgYEEyQSB0YXNrIHBvbGxpbmcgZXJyb3IgZm9yIHN0ZXAgJHtzdGVwLmlkfSAoYXR0ZW1wdCAke2F0dGVtcHRzfSk6YCxcclxuICAgICAgICAgICAgICBwb2xsRXJyb3JcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChhdHRlbXB0cyA+PSBtYXhBdHRlbXB0cykge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICBgQTJBIHRhc2sgcG9sbGluZyB0aW1lb3V0IGZvciBzdGVwICR7c3RlcC5pZH0gLSB0YXNrIGRpZCBub3QgY29tcGxldGUgd2l0aGluIDMwIHNlY29uZHNgXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICBgQTJBIHRhc2sgY29tcGxldGVkIGZvciBzdGVwICR7c3RlcC5pZH06YCxcclxuICAgICAgICAgIGNvbXBsZXRlZFRhc2suc3RhdHVzPy5zdGF0ZVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgIGNvbXBsZXRlZFRhc2suc3RhdHVzPy5zdGF0ZSA9PT0gXCJjb21wbGV0ZWRcIiAmJlxyXG4gICAgICAgICAgY29tcGxldGVkVGFzay5hcnRpZmFjdHNcclxuICAgICAgICApIHtcclxuICAgICAgICAgIC8vIEV4dHJhY3QgZGF0YSBmcm9tIEEyQSBhcnRpZmFjdHNcclxuICAgICAgICAgIGNvbnN0IGFydGlmYWN0ID0gY29tcGxldGVkVGFzay5hcnRpZmFjdHNbMF07XHJcbiAgICAgICAgICBpZiAoYXJ0aWZhY3QgJiYgYXJ0aWZhY3QucGFydHMpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5wYXJzZShhcnRpZmFjdC5wYXJ0c1swXS50ZXh0KTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYFN0ZXAgJHtzdGVwLmlkfSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5OmAsIHJlc3VsdCk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChjb21wbGV0ZWRUYXNrLnN0YXR1cz8uc3RhdGUgPT09IFwiZmFpbGVkXCIpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEEyQSB0YXNrIGZhaWxlZCBmb3Igc3RlcCAke3N0ZXAuaWR9OmAsIGNvbXBsZXRlZFRhc2spO1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBMkEgdGFzayBleGVjdXRpb24gZmFpbGVkIGZvciBzdGVwICR7c3RlcC5pZH1gKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihcclxuICAgICAgICAgICAgYEEyQSB0YXNrIG5vdCBjb21wbGV0ZWQgZm9yIHN0ZXAgJHtzdGVwLmlkfTpgLFxyXG4gICAgICAgICAgICBjb21wbGV0ZWRUYXNrXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICBgQTJBIHRhc2sgc3RhdHVzOiAke2NvbXBsZXRlZFRhc2suc3RhdHVzPy5zdGF0ZX0sIGFydGlmYWN0czogJHtcclxuICAgICAgICAgICAgICBjb21wbGV0ZWRUYXNrLmFydGlmYWN0cyA/IFwicHJlc2VudFwiIDogXCJtaXNzaW5nXCJcclxuICAgICAgICAgICAgfWBcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgIHJlc3BvbnNlICYmXHJcbiAgICAgICAgdHlwZW9mIHJlc3BvbnNlID09PSBcIm9iamVjdFwiICYmXHJcbiAgICAgICAgXCJtZXNzYWdlXCIgaW4gcmVzcG9uc2VcclxuICAgICAgKSB7XHJcbiAgICAgICAgLy8gSGFuZGxlIGRpcmVjdCBtZXNzYWdlIHJlc3BvbnNlXHJcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IHJlc3BvbnNlLm1lc3NhZ2UgYXMgYW55O1xyXG4gICAgICAgIGlmIChtZXNzYWdlLnBhcnRzICYmIG1lc3NhZ2UucGFydHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5wYXJzZShtZXNzYWdlLnBhcnRzWzBdLnRleHQpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgICAgICBgU3RlcCAke3N0ZXAuaWR9IGNvbXBsZXRlZCB3aXRoIGRpcmVjdCBtZXNzYWdlOmAsXHJcbiAgICAgICAgICAgICAgcmVzdWx0XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIElmIG5vdCBKU09OLCByZXR1cm4gdGhlIHRleHQgYXMgcmVzdWx0XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgICAgIGBTdGVwICR7c3RlcC5pZH0gY29tcGxldGVkIHdpdGggdGV4dCByZXNwb25zZTpgLFxyXG4gICAgICAgICAgICAgIG1lc3NhZ2UucGFydHNbMF0udGV4dFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG1lc3NhZ2UucGFydHNbMF0udGV4dCB9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgIGBObyB2YWxpZCByZXNwb25zZSByZWNlaXZlZCBmcm9tIEEyQSBhZ2VudCBmb3Igc3RlcCAke3N0ZXAuaWR9YFxyXG4gICAgICApO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgQTJBIHRhc2sgZXhlY3V0aW9uIGZhaWxlZCBmb3Igc3RlcCAke3N0ZXAuaWR9OmAsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgIGBBMkEgYWdlbnQgY2FsbCBmYWlsZWQgZm9yIHN0ZXAgJHtzdGVwLmlkfTogJHtcclxuICAgICAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCJcclxuICAgICAgICB9YFxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRW5oYW5jZWQgc3lzdGVtIGhlYWx0aCBtb25pdG9yaW5nIHdpdGggY2lyY3VpdCBicmVha2VyIHN0YXR1c1xyXG4gICAqL1xyXG4gIGFzeW5jIG1vbml0b3JTeXN0ZW1IZWFsdGgocmVxdWVzdERhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCBoZWFsdGhDaGVja3MgPSBbXTtcclxuICAgIGNvbnN0IGVuaGFuY2VkQWdlbnRzID0gdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3IuZ2V0QWxsQWdlbnRzKCk7XHJcblxyXG4gICAgLy8gQ2hlY2sgZW5oYW5jZWQgYWdlbnRzXHJcbiAgICBmb3IgKGNvbnN0IGFnZW50IG9mIGVuaGFuY2VkQWdlbnRzKSB7XHJcbiAgICAgIGNvbnN0IGJyZWFrZXJTdGF0dXMgPSB0aGlzLmNpcmN1aXRCcmVha2VyLmdldFN0YXR1cyhhZ2VudC5pZCk7XHJcblxyXG4gICAgICBoZWFsdGhDaGVja3MucHVzaCh7XHJcbiAgICAgICAgYWdlbnQ6IGFnZW50Lm5hbWUsXHJcbiAgICAgICAgdXJsOiBhZ2VudC51cmwsXHJcbiAgICAgICAgc3RhdHVzOiBhZ2VudC5zdGF0dXMsXHJcbiAgICAgICAgbG9hZDogYWdlbnQubG9hZCxcclxuICAgICAgICByZWxpYWJpbGl0eTogYWdlbnQucmVsaWFiaWxpdHksXHJcbiAgICAgICAgcmVzcG9uc2VUaW1lOiBhZ2VudC5yZXNwb25zZVRpbWUsXHJcbiAgICAgICAgY2lyY3VpdEJyZWFrZXI6IGJyZWFrZXJTdGF0dXMsXHJcbiAgICAgICAgbGFzdFNlZW46IGFnZW50Lmxhc3RTZWVuLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBsZWdhY3kgYWdlbnRzXHJcbiAgICBjb25zdCBhZ2VudEVudHJpZXMgPSBBcnJheS5mcm9tKHRoaXMuYWdlbnRzLmVudHJpZXMoKSk7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFnZW50RW50cmllcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjb25zdCBbdXJsLCBhZ2VudF0gPSBhZ2VudEVudHJpZXNbaV07XHJcblxyXG4gICAgICAvLyBTa2lwIGlmIGFscmVhZHkgY2hlY2tlZCBpbiBlbmhhbmNlZCBhZ2VudHNcclxuICAgICAgaWYgKGVuaGFuY2VkQWdlbnRzLnNvbWUoKGVhKSA9PiBlYS51cmwgPT09IHVybCkpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xyXG4gICAgICAgIGNvbnN0IHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gY29udHJvbGxlci5hYm9ydCgpLCAzMDAwKTtcclxuXHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt1cmx9L2hlYWx0aGAsIHtcclxuICAgICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWwsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcblxyXG4gICAgICAgIGhlYWx0aENoZWNrcy5wdXNoKHtcclxuICAgICAgICAgIGFnZW50OiBhZ2VudC5uYW1lLFxyXG4gICAgICAgICAgdXJsOiB1cmwsXHJcbiAgICAgICAgICBzdGF0dXM6IFwiaGVhbHRoeVwiLFxyXG4gICAgICAgICAgcmVzcG9uc2VfdGltZTogcmVzcG9uc2UuaGVhZGVycy5nZXQoXCJ4LXJlc3BvbnNlLXRpbWVcIikgfHwgXCJ1bmtub3duXCIsXHJcbiAgICAgICAgICBjaXJjdWl0QnJlYWtlcjogbnVsbCxcclxuICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBoZWFsdGhDaGVja3MucHVzaCh7XHJcbiAgICAgICAgICBhZ2VudDogYWdlbnQubmFtZSxcclxuICAgICAgICAgIHVybDogdXJsLFxyXG4gICAgICAgICAgc3RhdHVzOiBcInVuaGVhbHRoeVwiLFxyXG4gICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCIsXHJcbiAgICAgICAgICBjaXJjdWl0QnJlYWtlcjogbnVsbCxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG92ZXJhbGxIZWFsdGggPSBoZWFsdGhDaGVja3MuZXZlcnkoKGgpID0+IGguc3RhdHVzID09PSBcImhlYWx0aHlcIilcclxuICAgICAgPyBcImhlYWx0aHlcIlxyXG4gICAgICA6IFwiZGVncmFkZWRcIjtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBvdmVyYWxsX2hlYWx0aDogb3ZlcmFsbEhlYWx0aCxcclxuICAgICAgYWdlbnRzOiBoZWFsdGhDaGVja3MsXHJcbiAgICAgIGNpcmN1aXRCcmVha2VyczogdGhpcy5jaXJjdWl0QnJlYWtlci5nZXRBbGxTdGF0ZXMoKSxcclxuICAgICAgZW5oYW5jZWRfbWV0cmljczoge1xyXG4gICAgICAgIHRvdGFsQWdlbnRzOiBlbmhhbmNlZEFnZW50cy5sZW5ndGgsXHJcbiAgICAgICAgb25saW5lQWdlbnRzOiBlbmhhbmNlZEFnZW50cy5maWx0ZXIoKGEpID0+IGEuc3RhdHVzID09PSBcIm9ubGluZVwiKVxyXG4gICAgICAgICAgLmxlbmd0aCxcclxuICAgICAgICBhdmVyYWdlUmVsaWFiaWxpdHk6XHJcbiAgICAgICAgICBlbmhhbmNlZEFnZW50cy5yZWR1Y2UoKHN1bSwgYSkgPT4gc3VtICsgYS5yZWxpYWJpbGl0eSwgMCkgL1xyXG4gICAgICAgICAgZW5oYW5jZWRBZ2VudHMubGVuZ3RoLFxyXG4gICAgICAgIGF2ZXJhZ2VSZXNwb25zZVRpbWU6XHJcbiAgICAgICAgICBlbmhhbmNlZEFnZW50cy5yZWR1Y2UoKHN1bSwgYSkgPT4gc3VtICsgYS5yZXNwb25zZVRpbWUsIDApIC9cclxuICAgICAgICAgIGVuaGFuY2VkQWdlbnRzLmxlbmd0aCxcclxuICAgICAgfSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkIG1lc3NhZ2UgdG8gY2hhdCBoaXN0b3J5XHJcbiAgICovXHJcbiAgYWRkQ2hhdE1lc3NhZ2UobWVzc2FnZTogT21pdDxDaGF0TWVzc2FnZSwgXCJpZFwiIHwgXCJ0aW1lc3RhbXBcIj4pIHtcclxuICAgIGNvbnN0IGNoYXRNZXNzYWdlOiBDaGF0TWVzc2FnZSA9IHtcclxuICAgICAgaWQ6IHV1aWR2NCgpLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICAgIC4uLm1lc3NhZ2UsXHJcbiAgICB9O1xyXG4gICAgdGhpcy5jaGF0SGlzdG9yeS5wdXNoKGNoYXRNZXNzYWdlKTtcclxuICAgIHJldHVybiBjaGF0TWVzc2FnZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBjaGF0IGhpc3RvcnlcclxuICAgKi9cclxuICBnZXRDaGF0SGlzdG9yeSgpOiBDaGF0TWVzc2FnZVtdIHtcclxuICAgIHJldHVybiB0aGlzLmNoYXRIaXN0b3J5O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGNoYXQgaGlzdG9yeSBmb3IgYSBzcGVjaWZpYyB3b3JrZmxvd1xyXG4gICAqL1xyXG4gIGdldFdvcmtmbG93Q2hhdEhpc3Rvcnkod29ya2Zsb3dJZDogc3RyaW5nKTogQ2hhdE1lc3NhZ2VbXSB7XHJcbiAgICByZXR1cm4gdGhpcy5jaGF0SGlzdG9yeS5maWx0ZXIoXHJcbiAgICAgIChtc2cpID0+IG1zZy5tZXRhZGF0YT8ud29ya2Zsb3dJZCA9PT0gd29ya2Zsb3dJZFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFyIGNoYXQgaGlzdG9yeVxyXG4gICAqL1xyXG4gIGNsZWFyQ2hhdEhpc3RvcnkoKSB7XHJcbiAgICB0aGlzLmNoYXRIaXN0b3J5ID0gW107XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIHdvcmtmbG93c1xyXG4gICAqL1xyXG4gIGdldEFsbFdvcmtmbG93cygpOiBXb3JrZmxvd1tdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMud29ya2Zsb3dzLnZhbHVlcygpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB3b3JrZmxvdyBieSBJRFxyXG4gICAqL1xyXG4gIGdldFdvcmtmbG93KHdvcmtmbG93SWQ6IHN0cmluZyk6IFdvcmtmbG93IHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiB0aGlzLndvcmtmbG93cy5nZXQod29ya2Zsb3dJZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIGFnZW50c1xyXG4gICAqL1xyXG4gIGdldEFsbEFnZW50cygpOiBBZ2VudEluZm9bXSB7XHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmFnZW50cy52YWx1ZXMoKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWdlbnQgYnkgVVJMXHJcbiAgICovXHJcbiAgZ2V0QWdlbnQodXJsOiBzdHJpbmcpOiBBZ2VudEluZm8gfCB1bmRlZmluZWQge1xyXG4gICAgcmV0dXJuIHRoaXMuYWdlbnRzLmdldCh1cmwpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsidjQiLCJ1dWlkdjQiLCJFbmhhbmNlZEFnZW50U2VsZWN0b3IiLCJBZ2VudENpcmN1aXRCcmVha2VyIiwiRHluYW1pY0FnZW50RGlzY292ZXJ5IiwiRW52aXJvbm1lbnRBZ2VudE1hbmFnZXIiLCJOZXh0SlNPcmNoZXN0cmF0b3JTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJhZ2VudHMiLCJNYXAiLCJ3b3JrZmxvd3MiLCJjaGF0SGlzdG9yeSIsImtub3duQWdlbnRVcmxzIiwicmV0cnlBdHRlbXB0cyIsInRpbWVvdXRNcyIsImR5bmFtaWNEaXNjb3ZlcnkiLCJlbmhhbmNlZEFnZW50U2VsZWN0b3IiLCJjaXJjdWl0QnJlYWtlciIsImVudmlyb25tZW50IiwicHJvY2VzcyIsImVudmlyb25tZW50TWFuYWdlciIsInN0YXJ0QWdlbnREaXNjb3ZlcnkiLCJpbml0aWFsaXplVmlydHVhbEFnZW50cyIsImluaXRpYWxpemVFbmhhbmNlZEFnZW50cyIsImluaXRpYWxpemVEeW5hbWljRGlzY292ZXJ5IiwiYmFja2VuZEFnZW50IiwiaWQiLCJuYW1lIiwidXJsIiwiY2FwYWJpbGl0aWVzIiwiZGVzY3JpcHRpb24iLCJrZXl3b3JkcyIsImNvbmZpZGVuY2UiLCJyZXF1aXJlbWVudHMiLCJzdGF0dXMiLCJsb2FkIiwicmVzcG9uc2VUaW1lIiwicmVsaWFiaWxpdHkiLCJsYXN0U2VlbiIsIkRhdGUiLCJmcm9udGVuZEFnZW50IiwibWNwQWdlbnQiLCJyZWdpc3RlckFnZW50IiwiZGlzY292ZXJ5TWV0aG9kIiwiZW52IiwiQUdFTlRfRElTQ09WRVJZX01FVEhPRCIsImRpc2NvdmVyeUNvbmZpZyIsInByZWZpeCIsIkFHRU5UX1BSRUZJWCIsInBvcnRzIiwicGFyc2VQb3J0cyIsIkFHRU5UX1BPUlRTIiwiaG9zdHMiLCJwYXJzZUhvc3RzIiwiQUdFTlRfSE9TVFMiLCJtYW51YWwiLCJnZXRBbGxBZ2VudHMiLCJtYXAiLCJhZ2VudCIsIm1ldGFkYXRhIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwid2FybiIsInBvcnRzU3RyaW5nIiwic3BsaXQiLCJwb3J0IiwicGFyc2VJbnQiLCJ0cmltIiwiZmlsdGVyIiwiaXNOYU4iLCJob3N0c1N0cmluZyIsImhvc3QiLCJsZW5ndGgiLCJub3JtYWxNQ1BBZ2VudCIsInNraWxscyIsInR5cGUiLCJzZXQiLCJnZXRBbGxBdmFpbGFibGVBZ2VudHMiLCJwdXNoIiwibGVnYWN5QWdlbnRzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwidW5pcXVlQWdlbnRzIiwiaW5kZXgiLCJzZWxmIiwiZmluZEluZGV4IiwiYSIsImdldEFnZW50c0J5Q2FwYWJpbGl0eSIsImNhcGFiaWxpdHkiLCJpbmNsdWRlcyIsImdldExvYWRCYWxhbmNlZEFnZW50VXJsIiwiZW52QWdlbnQiLCJnZXRMb2FkQmFsYW5jZWRBZ2VudCIsImR5bmFtaWNBZ2VudHMiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJnZXRQcmltYXJ5QWdlbnRVcmwiLCJnZXRQcmltYXJ5QWdlbnQiLCJkZXRlcm1pbmVBZ2VudEZvclF1ZXJ5IiwicXVlcnkiLCJjb250ZXh0IiwicmVzdWx0Iiwic2VsZWN0QWdlbnQiLCJhZGRDaGF0TWVzc2FnZSIsImNvbnRlbnQiLCJ0b0ZpeGVkIiwicmVhc29uaW5nIiwiYWdlbnRJZCIsImRldGVybWluZUFnZW50Rm9yUXVlcnlMZWdhY3kiLCJsb3dlclF1ZXJ5IiwidG9Mb3dlckNhc2UiLCJnZXQiLCJleGVjdXRlQWdlbnRXaXRoUmVzaWxpZW5jZSIsInN0YXJ0VGltZSIsIm5vdyIsInNlbGVjdGlvblRpbWUiLCJleGVjdXRpb25UaW1lIiwic2VsZWN0aW9uU3RhcnQiLCJzdWNjZXNzIiwibWV0cmljcyIsInRvdGFsVGltZSIsImlzQWdlbnRBdmFpbGFibGUiLCJ0cnlGYWxsYmFja0V4ZWN1dGlvbiIsImV4ZWN1dGlvblN0YXJ0IiwiZXhlY3V0ZVdpdGhSZXRyeSIsInJlY29yZFN1Y2Nlc3MiLCJ1cGRhdGVBZ2VudE1ldHJpY3MiLCJyZWNvcmRGYWlsdXJlIiwibGFzdEVycm9yIiwiYXR0ZW1wdCIsInN0YXJ0c1dpdGgiLCJleGVjdXRlVmlydHVhbEFnZW50IiwiZXhlY3V0ZVJlYWxBZ2VudCIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInBvdyIsIkVycm9yIiwiZXhjbHVkZUFnZW50SWQiLCJmYWxsYmFja0FnZW50cyIsImdldEZhbGxiYWNrQWdlbnRzIiwiZmFsbGJhY2tVc2VkIiwiaGFuZGxlR2VuZXJhbE1DUFF1ZXJ5Iiwic3RlcCIsInNraWxsSWQiLCJpbnB1dCIsImV4ZWN1dGVTdGVwIiwiaGFuZGxlQ2VudHJhbGl6ZWRSZXF1ZXN0IiwicmVxdWVzdERhdGEiLCJpc1F1aXpSZXF1ZXN0IiwiY2xhc3NpZnlSZXF1ZXN0Iiwicm91dGVUb0JhY2tlbmRBZ2VudCIsInJvdXRlVG9EZWVwU2Vla0FQSSIsImlzUXVpekZhbGxiYWNrIiwiZmFsbGJhY2tFcnJvciIsInJlc3BvbnNlIiwiZ2V0Q2hhdEhpc3RvcnkiLCJPcGVuQUkiLCJkZWZhdWx0IiwiY2xpZW50IiwiYXBpS2V5IiwiYmFzZVVSTCIsImNvbXBsZXRpb24iLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsIm1lc3NhZ2VzIiwicm9sZSIsIm1heF90b2tlbnMiLCJ0ZW1wZXJhdHVyZSIsInN0cmVhbSIsImNob2ljZXMiLCJtZXNzYWdlIiwib3JjaGVzdHJhdGVRdWl6V29ya2Zsb3ciLCJkaWZmaWN1bHR5IiwicXVlc3Rpb25Db3VudCIsInJvdXRlVG9EZWVwU2Vla0FQSUZvclF1aXoiLCJxdWl6RGF0YSIsIkpTT04iLCJwYXJzZSIsImRhdGEiLCJwYXJzZUVycm9yIiwiZmFsbGJhY2tRdWl6IiwicXVpel9xdWVzdGlvbnMiLCJfIiwiaSIsInF1ZXN0aW9uIiwiY29ycmVjdF9hbnN3ZXIiLCJhbnN3ZXJzIiwiYW5zd2VyIiwicmVjZW50SGlzdG9yeSIsIm1zZyIsInNsaWNlIiwiY2hhdE1vZGUiLCJ0aW1lc3RhbXAiLCJ0b0lTT1N0cmluZyIsImRpc2NvdmVyQWdlbnRzIiwic2V0SW50ZXJ2YWwiLCJkaXNjb3ZlcmVkQWdlbnRzIiwiYWdlbnRDYXJkIiwiZ2V0QWdlbnRDYXJkIiwiYWdlbnRJbmZvIiwicG9wIiwicyIsImpvaW4iLCJjb3VudCIsIm9ubGluZUNvdW50Iiwib2ZmbGluZUNvdW50IiwiQTJBQ2xpZW50IiwiYTJhQ2xpZW50IiwiZnJvbUNhcmRVcmwiLCJjb250cm9sbGVyIiwiQWJvcnRDb250cm9sbGVyIiwidGltZW91dElkIiwiYWJvcnQiLCJmZXRjaCIsInNpZ25hbCIsImNsZWFyVGltZW91dCIsImpzb24iLCJmZXRjaEVycm9yIiwid29ya2Zsb3dJZCIsInRvcGljIiwicXVlc3Rpb25fY291bnQiLCJ3b3JrZmxvdyIsInN0ZXBzIiwiZGVwZW5kZW5jaWVzIiwiY3JlYXRlZEF0IiwiZXhlY3V0ZVdvcmtmbG93V2l0aENoYXQiLCJ3b3JrZmxvd19pZCIsInJlc3VsdHMiLCJkZXBlbmRlbmN5UmVzdWx0cyIsImRlcElkIiwiZGVwU3RlcCIsImZpbmQiLCJzb21lIiwiciIsImNvbXBsZXRlZEF0Iiwia2luZCIsIm1lc3NhZ2VJZCIsInBhcnRzIiwidGV4dCIsInN0cmluZ2lmeSIsInNlbmRNZXNzYWdlIiwiY29uZmlndXJhdGlvbiIsImJsb2NraW5nIiwidGFzayIsImNvbXBsZXRlZFRhc2siLCJhdHRlbXB0cyIsIm1heEF0dGVtcHRzIiwic3RhdGUiLCJ0YXNrUmVzcG9uc2UiLCJnZXRUYXNrIiwicG9sbEVycm9yIiwiYXJ0aWZhY3RzIiwiYXJ0aWZhY3QiLCJlIiwibW9uaXRvclN5c3RlbUhlYWx0aCIsImhlYWx0aENoZWNrcyIsImVuaGFuY2VkQWdlbnRzIiwiYnJlYWtlclN0YXR1cyIsImdldFN0YXR1cyIsImFnZW50RW50cmllcyIsImVudHJpZXMiLCJlYSIsInJlc3BvbnNlX3RpbWUiLCJoZWFkZXJzIiwib3ZlcmFsbEhlYWx0aCIsImV2ZXJ5IiwiaCIsIm92ZXJhbGxfaGVhbHRoIiwiY2lyY3VpdEJyZWFrZXJzIiwiZ2V0QWxsU3RhdGVzIiwiZW5oYW5jZWRfbWV0cmljcyIsInRvdGFsQWdlbnRzIiwib25saW5lQWdlbnRzIiwiYXZlcmFnZVJlbGlhYmlsaXR5IiwicmVkdWNlIiwic3VtIiwiYXZlcmFnZVJlc3BvbnNlVGltZSIsImNoYXRNZXNzYWdlIiwiZ2V0V29ya2Zsb3dDaGF0SGlzdG9yeSIsImNsZWFyQ2hhdEhpc3RvcnkiLCJnZXRBbGxXb3JrZmxvd3MiLCJnZXRXb3JrZmxvdyIsImdldEFnZW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/orchestratorService.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();