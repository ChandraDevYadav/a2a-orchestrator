"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/orchestrator/route";
exports.ids = ["app/api/orchestrator/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_Chan_Dra_Dev_AtoA_Protocol_A2_Quiz_quiz_frontend_src_app_api_orchestrator_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/orchestrator/route.ts */ \"(rsc)/./src/app/api/orchestrator/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/orchestrator/route\",\n        pathname: \"/api/orchestrator\",\n        filename: \"route\",\n        bundlePath: \"app/api/orchestrator/route\"\n    },\n    resolvedPagePath: \"D:\\\\Chan Dra Dev\\\\AtoA_Protocol\\\\A2\\\\Quiz\\\\quiz-frontend\\\\src\\\\app\\\\api\\\\orchestrator\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Chan_Dra_Dev_AtoA_Protocol_A2_Quiz_quiz_frontend_src_app_api_orchestrator_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/orchestrator/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZvcmNoZXN0cmF0b3IlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm9yY2hlc3RyYXRvciUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRm9yY2hlc3RyYXRvciUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDQ2hhbiUyMERyYSUyMERldiU1Q0F0b0FfUHJvdG9jb2wlNUNBMiU1Q1F1aXolNUNxdWl6LWZyb250ZW5kJTVDc3JjJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1EJTNBJTVDQ2hhbiUyMERyYSUyMERldiU1Q0F0b0FfUHJvdG9jb2wlNUNBMiU1Q1F1aXolNUNxdWl6LWZyb250ZW5kJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUMrQztBQUM1SDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3F1aXotZnJvbnRlbmQvP2FhZjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcQ2hhbiBEcmEgRGV2XFxcXEF0b0FfUHJvdG9jb2xcXFxcQTJcXFxcUXVpelxcXFxxdWl6LWZyb250ZW5kXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXG9yY2hlc3RyYXRvclxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvb3JjaGVzdHJhdG9yL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvb3JjaGVzdHJhdG9yXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9vcmNoZXN0cmF0b3Ivcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxDaGFuIERyYSBEZXZcXFxcQXRvQV9Qcm90b2NvbFxcXFxBMlxcXFxRdWl6XFxcXHF1aXotZnJvbnRlbmRcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcb3JjaGVzdHJhdG9yXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9vcmNoZXN0cmF0b3Ivcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/orchestrator/route.ts":
/*!*******************************************!*\
  !*** ./src/app/api/orchestrator/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_orchestratorService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/orchestratorService */ \"(rsc)/./src/lib/orchestratorService.ts\");\n\n\n// Global orchestrator service instance\nlet orchestratorService;\n// Initialize orchestrator service\nfunction getOrchestratorService() {\n    if (!orchestratorService) {\n        orchestratorService = new _lib_orchestratorService__WEBPACK_IMPORTED_MODULE_1__.NextJSOrchestratorService();\n    }\n    return orchestratorService;\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { action, ...data } = body;\n        let result;\n        switch(action){\n            case \"discover_agents\":\n                result = await getOrchestratorService().discoverAgents(data);\n                break;\n            case \"orchestrate_quiz_workflow\":\n                result = await getOrchestratorService().orchestrateQuizWorkflow(data);\n                break;\n            case \"orchestrate-manual-workflow\":\n                result = await getOrchestratorService().orchestrateManualWorkflow(data);\n                break;\n            case \"monitor_system_health\":\n                result = await getOrchestratorService().monitorSystemHealth(data);\n                break;\n            case \"get_chat_history\":\n                result = getOrchestratorService().getChatHistory();\n                break;\n            case \"get_workflow_chat_history\":\n                result = getOrchestratorService().getWorkflowChatHistory(data.workflowId);\n                break;\n            case \"clear_chat_history\":\n                getOrchestratorService().clearChatHistory();\n                result = {\n                    success: true\n                };\n                break;\n            case \"get_workflows\":\n                result = getOrchestratorService().getAllWorkflows();\n                break;\n            case \"get_workflow\":\n                result = getOrchestratorService().getWorkflow(data.workflowId);\n                break;\n            case \"get_agents\":\n                result = getOrchestratorService().getAllAgents();\n                break;\n            case \"get_agent\":\n                result = getOrchestratorService().getAgent(data.url);\n                break;\n            case \"determine_agent_for_query\":\n                result = getOrchestratorService().determineAgentForQuery(data.query, data.context);\n                break;\n            case \"execute_agent_with_resilience\":\n                result = await getOrchestratorService().executeAgentWithResilience(data.query, data.context);\n                break;\n            case \"handle_general_mcp_query\":\n                result = await getOrchestratorService().handleGeneralMCPQuery(data);\n                break;\n            case \"handle_centralized_request\":\n                result = await getOrchestratorService().handleCentralizedRequest(data);\n                break;\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: `Unknown action: ${action}`\n                }, {\n                    status: 400\n                });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error(\"Orchestrator API error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const action = searchParams.get(\"action\");\n        let result;\n        switch(action){\n            case \"health\":\n                result = {\n                    status: \"ok\",\n                    service: \"nextjs-orchestrator\"\n                };\n                break;\n            case \"status\":\n                result = {\n                    orchestrator: {\n                        status: \"running\",\n                        uptime: process.uptime(),\n                        memory: process.memoryUsage(),\n                        version: \"1.0.0\"\n                    },\n                    agents: {\n                        discovered: getOrchestratorService().getAllAgents().length,\n                        active: getOrchestratorService().getAllAgents().filter((a)=>a.status === \"online\").length,\n                        last_discovery: new Date().toISOString()\n                    }\n                };\n                break;\n            case \"chat_history\":\n                result = getOrchestratorService().getChatHistory();\n                break;\n            case \"workflows\":\n                result = getOrchestratorService().getAllWorkflows();\n                break;\n            case \"agents\":\n                result = getOrchestratorService().getAllAgents();\n                break;\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: `Unknown action: ${action}`\n                }, {\n                    status: 400\n                });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error(\"Orchestrator GET API error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9vcmNoZXN0cmF0b3Ivcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUF3RDtBQUNjO0FBRXRFLHVDQUF1QztBQUN2QyxJQUFJRTtBQUVKLGtDQUFrQztBQUNsQyxTQUFTQztJQUNQLElBQUksQ0FBQ0QscUJBQXFCO1FBQ3hCQSxzQkFBc0IsSUFBSUQsK0VBQXlCQTtJQUNyRDtJQUNBLE9BQU9DO0FBQ1Q7QUFFTyxlQUFlRSxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNRCxRQUFRRSxJQUFJO1FBQy9CLE1BQU0sRUFBRUMsTUFBTSxFQUFFLEdBQUdDLE1BQU0sR0FBR0g7UUFFNUIsSUFBSUk7UUFFSixPQUFRRjtZQUNOLEtBQUs7Z0JBQ0hFLFNBQVMsTUFBTVAseUJBQXlCUSxjQUFjLENBQUNGO2dCQUN2RDtZQUVGLEtBQUs7Z0JBQ0hDLFNBQVMsTUFBTVAseUJBQXlCUyx1QkFBdUIsQ0FBQ0g7Z0JBQ2hFO1lBRUYsS0FBSztnQkFDSEMsU0FBUyxNQUFNUCx5QkFBeUJVLHlCQUF5QixDQUFDSjtnQkFDbEU7WUFFRixLQUFLO2dCQUNIQyxTQUFTLE1BQU1QLHlCQUF5QlcsbUJBQW1CLENBQUNMO2dCQUM1RDtZQUVGLEtBQUs7Z0JBQ0hDLFNBQVNQLHlCQUF5QlksY0FBYztnQkFDaEQ7WUFFRixLQUFLO2dCQUNITCxTQUFTUCx5QkFBeUJhLHNCQUFzQixDQUN0RFAsS0FBS1EsVUFBVTtnQkFFakI7WUFFRixLQUFLO2dCQUNIZCx5QkFBeUJlLGdCQUFnQjtnQkFDekNSLFNBQVM7b0JBQUVTLFNBQVM7Z0JBQUs7Z0JBQ3pCO1lBRUYsS0FBSztnQkFDSFQsU0FBU1AseUJBQXlCaUIsZUFBZTtnQkFDakQ7WUFFRixLQUFLO2dCQUNIVixTQUFTUCx5QkFBeUJrQixXQUFXLENBQUNaLEtBQUtRLFVBQVU7Z0JBQzdEO1lBRUYsS0FBSztnQkFDSFAsU0FBU1AseUJBQXlCbUIsWUFBWTtnQkFDOUM7WUFFRixLQUFLO2dCQUNIWixTQUFTUCx5QkFBeUJvQixRQUFRLENBQUNkLEtBQUtlLEdBQUc7Z0JBQ25EO1lBRUYsS0FBSztnQkFDSGQsU0FBU1AseUJBQXlCc0Isc0JBQXNCLENBQ3REaEIsS0FBS2lCLEtBQUssRUFDVmpCLEtBQUtrQixPQUFPO2dCQUVkO1lBRUYsS0FBSztnQkFDSGpCLFNBQVMsTUFBTVAseUJBQXlCeUIsMEJBQTBCLENBQ2hFbkIsS0FBS2lCLEtBQUssRUFDVmpCLEtBQUtrQixPQUFPO2dCQUVkO1lBRUYsS0FBSztnQkFDSGpCLFNBQVMsTUFBTVAseUJBQXlCMEIscUJBQXFCLENBQUNwQjtnQkFDOUQ7WUFFRixLQUFLO2dCQUNIQyxTQUFTLE1BQU1QLHlCQUF5QjJCLHdCQUF3QixDQUFDckI7Z0JBQ2pFO1lBRUY7Z0JBQ0UsT0FBT1QscURBQVlBLENBQUNPLElBQUksQ0FDdEI7b0JBQUV3QixPQUFPLENBQUMsZ0JBQWdCLEVBQUV2QixPQUFPLENBQUM7Z0JBQUMsR0FDckM7b0JBQUV3QixRQUFRO2dCQUFJO1FBRXBCO1FBRUEsT0FBT2hDLHFEQUFZQSxDQUFDTyxJQUFJLENBQUNHO0lBQzNCLEVBQUUsT0FBT3FCLE9BQU87UUFDZEUsUUFBUUYsS0FBSyxDQUFDLDJCQUEyQkE7UUFDekMsT0FBTy9CLHFEQUFZQSxDQUFDTyxJQUFJLENBQ3RCO1lBQ0V3QixPQUFPQSxpQkFBaUJHLFFBQVFILE1BQU1JLE9BQU8sR0FBRztRQUNsRCxHQUNBO1lBQUVILFFBQVE7UUFBSTtJQUVsQjtBQUNGO0FBRU8sZUFBZUksSUFBSS9CLE9BQW9CO0lBQzVDLElBQUk7UUFDRixNQUFNLEVBQUVnQyxZQUFZLEVBQUUsR0FBRyxJQUFJQyxJQUFJakMsUUFBUW1CLEdBQUc7UUFDNUMsTUFBTWhCLFNBQVM2QixhQUFhRSxHQUFHLENBQUM7UUFFaEMsSUFBSTdCO1FBRUosT0FBUUY7WUFDTixLQUFLO2dCQUNIRSxTQUFTO29CQUFFc0IsUUFBUTtvQkFBTVEsU0FBUztnQkFBc0I7Z0JBQ3hEO1lBRUYsS0FBSztnQkFDSDlCLFNBQVM7b0JBQ1ArQixjQUFjO3dCQUNaVCxRQUFRO3dCQUNSVSxRQUFRQyxRQUFRRCxNQUFNO3dCQUN0QkUsUUFBUUQsUUFBUUUsV0FBVzt3QkFDM0JDLFNBQVM7b0JBQ1g7b0JBQ0FDLFFBQVE7d0JBQ05DLFlBQVk3Qyx5QkFBeUJtQixZQUFZLEdBQUcyQixNQUFNO3dCQUMxREMsUUFBUS9DLHlCQUNMbUIsWUFBWSxHQUNaNkIsTUFBTSxDQUFDLENBQUNDLElBQU1BLEVBQUVwQixNQUFNLEtBQUssVUFBVWlCLE1BQU07d0JBQzlDSSxnQkFBZ0IsSUFBSUMsT0FBT0MsV0FBVztvQkFDeEM7Z0JBQ0Y7Z0JBQ0E7WUFFRixLQUFLO2dCQUNIN0MsU0FBU1AseUJBQXlCWSxjQUFjO2dCQUNoRDtZQUVGLEtBQUs7Z0JBQ0hMLFNBQVNQLHlCQUF5QmlCLGVBQWU7Z0JBQ2pEO1lBRUYsS0FBSztnQkFDSFYsU0FBU1AseUJBQXlCbUIsWUFBWTtnQkFDOUM7WUFFRjtnQkFDRSxPQUFPdEIscURBQVlBLENBQUNPLElBQUksQ0FDdEI7b0JBQUV3QixPQUFPLENBQUMsZ0JBQWdCLEVBQUV2QixPQUFPLENBQUM7Z0JBQUMsR0FDckM7b0JBQUV3QixRQUFRO2dCQUFJO1FBRXBCO1FBRUEsT0FBT2hDLHFEQUFZQSxDQUFDTyxJQUFJLENBQUNHO0lBQzNCLEVBQUUsT0FBT3FCLE9BQU87UUFDZEUsUUFBUUYsS0FBSyxDQUFDLCtCQUErQkE7UUFDN0MsT0FBTy9CLHFEQUFZQSxDQUFDTyxJQUFJLENBQ3RCO1lBQ0V3QixPQUFPQSxpQkFBaUJHLFFBQVFILE1BQU1JLE9BQU8sR0FBRztRQUNsRCxHQUNBO1lBQUVILFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcXVpei1mcm9udGVuZC8uL3NyYy9hcHAvYXBpL29yY2hlc3RyYXRvci9yb3V0ZS50cz9iODQwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgTmV4dEpTT3JjaGVzdHJhdG9yU2VydmljZSB9IGZyb20gXCJAL2xpYi9vcmNoZXN0cmF0b3JTZXJ2aWNlXCI7XHJcblxyXG4vLyBHbG9iYWwgb3JjaGVzdHJhdG9yIHNlcnZpY2UgaW5zdGFuY2VcclxubGV0IG9yY2hlc3RyYXRvclNlcnZpY2U6IE5leHRKU09yY2hlc3RyYXRvclNlcnZpY2UgfCB1bmRlZmluZWQ7XHJcblxyXG4vLyBJbml0aWFsaXplIG9yY2hlc3RyYXRvciBzZXJ2aWNlXHJcbmZ1bmN0aW9uIGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKTogTmV4dEpTT3JjaGVzdHJhdG9yU2VydmljZSB7XHJcbiAgaWYgKCFvcmNoZXN0cmF0b3JTZXJ2aWNlKSB7XHJcbiAgICBvcmNoZXN0cmF0b3JTZXJ2aWNlID0gbmV3IE5leHRKU09yY2hlc3RyYXRvclNlcnZpY2UoKTtcclxuICB9XHJcbiAgcmV0dXJuIG9yY2hlc3RyYXRvclNlcnZpY2U7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcclxuICAgIGNvbnN0IHsgYWN0aW9uLCAuLi5kYXRhIH0gPSBib2R5O1xyXG5cclxuICAgIGxldCByZXN1bHQ7XHJcblxyXG4gICAgc3dpdGNoIChhY3Rpb24pIHtcclxuICAgICAgY2FzZSBcImRpc2NvdmVyX2FnZW50c1wiOlxyXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5kaXNjb3ZlckFnZW50cyhkYXRhKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJvcmNoZXN0cmF0ZV9xdWl6X3dvcmtmbG93XCI6XHJcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLm9yY2hlc3RyYXRlUXVpeldvcmtmbG93KGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcIm9yY2hlc3RyYXRlLW1hbnVhbC13b3JrZmxvd1wiOlxyXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5vcmNoZXN0cmF0ZU1hbnVhbFdvcmtmbG93KGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcIm1vbml0b3Jfc3lzdGVtX2hlYWx0aFwiOlxyXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5tb25pdG9yU3lzdGVtSGVhbHRoKGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImdldF9jaGF0X2hpc3RvcnlcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0Q2hhdEhpc3RvcnkoKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJnZXRfd29ya2Zsb3dfY2hhdF9oaXN0b3J5XCI6XHJcbiAgICAgICAgcmVzdWx0ID0gZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmdldFdvcmtmbG93Q2hhdEhpc3RvcnkoXHJcbiAgICAgICAgICBkYXRhLndvcmtmbG93SWRcclxuICAgICAgICApO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImNsZWFyX2NoYXRfaGlzdG9yeVwiOlxyXG4gICAgICAgIGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5jbGVhckNoYXRIaXN0b3J5KCk7XHJcbiAgICAgICAgcmVzdWx0ID0geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiZ2V0X3dvcmtmbG93c1wiOlxyXG4gICAgICAgIHJlc3VsdCA9IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5nZXRBbGxXb3JrZmxvd3MoKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJnZXRfd29ya2Zsb3dcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0V29ya2Zsb3coZGF0YS53b3JrZmxvd0lkKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJnZXRfYWdlbnRzXCI6XHJcbiAgICAgICAgcmVzdWx0ID0gZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmdldEFsbEFnZW50cygpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImdldF9hZ2VudFwiOlxyXG4gICAgICAgIHJlc3VsdCA9IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5nZXRBZ2VudChkYXRhLnVybCk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiZGV0ZXJtaW5lX2FnZW50X2Zvcl9xdWVyeVwiOlxyXG4gICAgICAgIHJlc3VsdCA9IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5kZXRlcm1pbmVBZ2VudEZvclF1ZXJ5KFxyXG4gICAgICAgICAgZGF0YS5xdWVyeSxcclxuICAgICAgICAgIGRhdGEuY29udGV4dFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiZXhlY3V0ZV9hZ2VudF93aXRoX3Jlc2lsaWVuY2VcIjpcclxuICAgICAgICByZXN1bHQgPSBhd2FpdCBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZXhlY3V0ZUFnZW50V2l0aFJlc2lsaWVuY2UoXHJcbiAgICAgICAgICBkYXRhLnF1ZXJ5LFxyXG4gICAgICAgICAgZGF0YS5jb250ZXh0XHJcbiAgICAgICAgKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJoYW5kbGVfZ2VuZXJhbF9tY3BfcXVlcnlcIjpcclxuICAgICAgICByZXN1bHQgPSBhd2FpdCBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuaGFuZGxlR2VuZXJhbE1DUFF1ZXJ5KGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImhhbmRsZV9jZW50cmFsaXplZF9yZXF1ZXN0XCI6XHJcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmhhbmRsZUNlbnRyYWxpemVkUmVxdWVzdChkYXRhKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgeyBlcnJvcjogYFVua25vd24gYWN0aW9uOiAke2FjdGlvbn1gIH0sXHJcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXN1bHQpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiT3JjaGVzdHJhdG9yIEFQSSBlcnJvcjpcIiwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7XHJcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xyXG4gICAgY29uc3QgYWN0aW9uID0gc2VhcmNoUGFyYW1zLmdldChcImFjdGlvblwiKTtcclxuXHJcbiAgICBsZXQgcmVzdWx0O1xyXG5cclxuICAgIHN3aXRjaCAoYWN0aW9uKSB7XHJcbiAgICAgIGNhc2UgXCJoZWFsdGhcIjpcclxuICAgICAgICByZXN1bHQgPSB7IHN0YXR1czogXCJva1wiLCBzZXJ2aWNlOiBcIm5leHRqcy1vcmNoZXN0cmF0b3JcIiB9O1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcInN0YXR1c1wiOlxyXG4gICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgIG9yY2hlc3RyYXRvcjoge1xyXG4gICAgICAgICAgICBzdGF0dXM6IFwicnVubmluZ1wiLFxyXG4gICAgICAgICAgICB1cHRpbWU6IHByb2Nlc3MudXB0aW1lKCksXHJcbiAgICAgICAgICAgIG1lbW9yeTogcHJvY2Vzcy5tZW1vcnlVc2FnZSgpLFxyXG4gICAgICAgICAgICB2ZXJzaW9uOiBcIjEuMC4wXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYWdlbnRzOiB7XHJcbiAgICAgICAgICAgIGRpc2NvdmVyZWQ6IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5nZXRBbGxBZ2VudHMoKS5sZW5ndGgsXHJcbiAgICAgICAgICAgIGFjdGl2ZTogZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpXHJcbiAgICAgICAgICAgICAgLmdldEFsbEFnZW50cygpXHJcbiAgICAgICAgICAgICAgLmZpbHRlcigoYSkgPT4gYS5zdGF0dXMgPT09IFwib25saW5lXCIpLmxlbmd0aCxcclxuICAgICAgICAgICAgbGFzdF9kaXNjb3Zlcnk6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJjaGF0X2hpc3RvcnlcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0Q2hhdEhpc3RvcnkoKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJ3b3JrZmxvd3NcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0QWxsV29ya2Zsb3dzKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiYWdlbnRzXCI6XHJcbiAgICAgICAgcmVzdWx0ID0gZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmdldEFsbEFnZW50cygpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgICB7IGVycm9yOiBgVW5rbm93biBhY3Rpb246ICR7YWN0aW9ufWAgfSxcclxuICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3VsdCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJPcmNoZXN0cmF0b3IgR0VUIEFQSSBlcnJvcjpcIiwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7XHJcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIk5leHRKU09yY2hlc3RyYXRvclNlcnZpY2UiLCJvcmNoZXN0cmF0b3JTZXJ2aWNlIiwiZ2V0T3JjaGVzdHJhdG9yU2VydmljZSIsIlBPU1QiLCJyZXF1ZXN0IiwiYm9keSIsImpzb24iLCJhY3Rpb24iLCJkYXRhIiwicmVzdWx0IiwiZGlzY292ZXJBZ2VudHMiLCJvcmNoZXN0cmF0ZVF1aXpXb3JrZmxvdyIsIm9yY2hlc3RyYXRlTWFudWFsV29ya2Zsb3ciLCJtb25pdG9yU3lzdGVtSGVhbHRoIiwiZ2V0Q2hhdEhpc3RvcnkiLCJnZXRXb3JrZmxvd0NoYXRIaXN0b3J5Iiwid29ya2Zsb3dJZCIsImNsZWFyQ2hhdEhpc3RvcnkiLCJzdWNjZXNzIiwiZ2V0QWxsV29ya2Zsb3dzIiwiZ2V0V29ya2Zsb3ciLCJnZXRBbGxBZ2VudHMiLCJnZXRBZ2VudCIsInVybCIsImRldGVybWluZUFnZW50Rm9yUXVlcnkiLCJxdWVyeSIsImNvbnRleHQiLCJleGVjdXRlQWdlbnRXaXRoUmVzaWxpZW5jZSIsImhhbmRsZUdlbmVyYWxNQ1BRdWVyeSIsImhhbmRsZUNlbnRyYWxpemVkUmVxdWVzdCIsImVycm9yIiwic3RhdHVzIiwiY29uc29sZSIsIkVycm9yIiwibWVzc2FnZSIsIkdFVCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsImdldCIsInNlcnZpY2UiLCJvcmNoZXN0cmF0b3IiLCJ1cHRpbWUiLCJwcm9jZXNzIiwibWVtb3J5IiwibWVtb3J5VXNhZ2UiLCJ2ZXJzaW9uIiwiYWdlbnRzIiwiZGlzY292ZXJlZCIsImxlbmd0aCIsImFjdGl2ZSIsImZpbHRlciIsImEiLCJsYXN0X2Rpc2NvdmVyeSIsIkRhdGUiLCJ0b0lTT1N0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/orchestrator/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/circuit-breaker.ts":
/*!************************************!*\
  !*** ./src/lib/circuit-breaker.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AgentCircuitBreaker: () => (/* binding */ AgentCircuitBreaker)\n/* harmony export */ });\n/**\r\n * Circuit Breaker Pattern for Agent Resilience\r\n * Prevents cascading failures and provides graceful degradation\r\n */ class AgentCircuitBreaker {\n    constructor(failureThreshold = 5, timeoutMs = 60000, successThreshold = 3){\n        this.breakers = new Map();\n        this.failureThreshold = failureThreshold;\n        this.timeoutMs = timeoutMs;\n        this.successThreshold = successThreshold;\n    }\n    /**\r\n   * Check if agent is available (circuit breaker allows)\r\n   */ isAgentAvailable(agentId) {\n        const breaker = this.breakers.get(agentId);\n        if (!breaker) return true; // No breaker = available\n        switch(breaker.state){\n            case \"closed\":\n                return true;\n            case \"open\":\n                // Check if timeout has passed\n                if (breaker.lastFailureTime && Date.now() - breaker.lastFailureTime.getTime() > this.timeoutMs) {\n                    breaker.state = \"half-open\";\n                    breaker.successCount = 0;\n                    return true;\n                }\n                return false;\n            case \"half-open\":\n                return true;\n            default:\n                return true;\n        }\n    }\n    /**\r\n   * Record a successful operation\r\n   */ recordSuccess(agentId) {\n        const breaker = this.breakers.get(agentId) || this.createBreaker(agentId);\n        breaker.successCount++;\n        breaker.failureCount = 0;\n        if (breaker.state === \"half-open\" && breaker.successCount >= this.successThreshold) {\n            breaker.state = \"closed\";\n        }\n    }\n    /**\r\n   * Record a failed operation\r\n   */ recordFailure(agentId) {\n        const breaker = this.breakers.get(agentId) || this.createBreaker(agentId);\n        breaker.failureCount++;\n        breaker.lastFailureTime = new Date();\n        if (breaker.failureCount >= this.failureThreshold) {\n            breaker.state = \"open\";\n        }\n    }\n    createBreaker(agentId) {\n        const breaker = {\n            state: \"closed\",\n            failureCount: 0,\n            successCount: 0\n        };\n        this.breakers.set(agentId, breaker);\n        return breaker;\n    }\n    /**\r\n   * Get circuit breaker status for monitoring\r\n   */ getStatus(agentId) {\n        return this.breakers.get(agentId) || null;\n    }\n    /**\r\n   * Reset circuit breaker (for manual intervention)\r\n   */ reset(agentId) {\n        this.breakers.delete(agentId);\n    }\n    /**\r\n   * Get all circuit breaker states\r\n   */ getAllStates() {\n        return new Map(this.breakers);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NpcmN1aXQtYnJlYWtlci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7OztDQUdDLEdBU00sTUFBTUE7SUFNWEMsWUFDRUMsbUJBQTJCLENBQUMsRUFDNUJDLFlBQW9CLEtBQUssRUFDekJDLG1CQUEyQixDQUFDLENBQzVCO2FBVE1DLFdBQTZDLElBQUlDO1FBVXZELElBQUksQ0FBQ0osZ0JBQWdCLEdBQUdBO1FBQ3hCLElBQUksQ0FBQ0MsU0FBUyxHQUFHQTtRQUNqQixJQUFJLENBQUNDLGdCQUFnQixHQUFHQTtJQUMxQjtJQUVBOztHQUVDLEdBQ0RHLGlCQUFpQkMsT0FBZSxFQUFXO1FBQ3pDLE1BQU1DLFVBQVUsSUFBSSxDQUFDSixRQUFRLENBQUNLLEdBQUcsQ0FBQ0Y7UUFDbEMsSUFBSSxDQUFDQyxTQUFTLE9BQU8sTUFBTSx5QkFBeUI7UUFFcEQsT0FBUUEsUUFBUUUsS0FBSztZQUNuQixLQUFLO2dCQUNILE9BQU87WUFDVCxLQUFLO2dCQUNILDhCQUE4QjtnQkFDOUIsSUFDRUYsUUFBUUcsZUFBZSxJQUN2QkMsS0FBS0MsR0FBRyxLQUFLTCxRQUFRRyxlQUFlLENBQUNHLE9BQU8sS0FBSyxJQUFJLENBQUNaLFNBQVMsRUFDL0Q7b0JBQ0FNLFFBQVFFLEtBQUssR0FBRztvQkFDaEJGLFFBQVFPLFlBQVksR0FBRztvQkFDdkIsT0FBTztnQkFDVDtnQkFDQSxPQUFPO1lBQ1QsS0FBSztnQkFDSCxPQUFPO1lBQ1Q7Z0JBQ0UsT0FBTztRQUNYO0lBQ0Y7SUFFQTs7R0FFQyxHQUNEQyxjQUFjVCxPQUFlLEVBQVE7UUFDbkMsTUFBTUMsVUFBVSxJQUFJLENBQUNKLFFBQVEsQ0FBQ0ssR0FBRyxDQUFDRixZQUFZLElBQUksQ0FBQ1UsYUFBYSxDQUFDVjtRQUVqRUMsUUFBUU8sWUFBWTtRQUNwQlAsUUFBUVUsWUFBWSxHQUFHO1FBRXZCLElBQ0VWLFFBQVFFLEtBQUssS0FBSyxlQUNsQkYsUUFBUU8sWUFBWSxJQUFJLElBQUksQ0FBQ1osZ0JBQWdCLEVBQzdDO1lBQ0FLLFFBQVFFLEtBQUssR0FBRztRQUNsQjtJQUNGO0lBRUE7O0dBRUMsR0FDRFMsY0FBY1osT0FBZSxFQUFRO1FBQ25DLE1BQU1DLFVBQVUsSUFBSSxDQUFDSixRQUFRLENBQUNLLEdBQUcsQ0FBQ0YsWUFBWSxJQUFJLENBQUNVLGFBQWEsQ0FBQ1Y7UUFFakVDLFFBQVFVLFlBQVk7UUFDcEJWLFFBQVFHLGVBQWUsR0FBRyxJQUFJQztRQUU5QixJQUFJSixRQUFRVSxZQUFZLElBQUksSUFBSSxDQUFDakIsZ0JBQWdCLEVBQUU7WUFDakRPLFFBQVFFLEtBQUssR0FBRztRQUNsQjtJQUNGO0lBRVFPLGNBQWNWLE9BQWUsRUFBdUI7UUFDMUQsTUFBTUMsVUFBK0I7WUFDbkNFLE9BQU87WUFDUFEsY0FBYztZQUNkSCxjQUFjO1FBQ2hCO1FBQ0EsSUFBSSxDQUFDWCxRQUFRLENBQUNnQixHQUFHLENBQUNiLFNBQVNDO1FBQzNCLE9BQU9BO0lBQ1Q7SUFFQTs7R0FFQyxHQUNEYSxVQUFVZCxPQUFlLEVBQThCO1FBQ3JELE9BQU8sSUFBSSxDQUFDSCxRQUFRLENBQUNLLEdBQUcsQ0FBQ0YsWUFBWTtJQUN2QztJQUVBOztHQUVDLEdBQ0RlLE1BQU1mLE9BQWUsRUFBUTtRQUMzQixJQUFJLENBQUNILFFBQVEsQ0FBQ21CLE1BQU0sQ0FBQ2hCO0lBQ3ZCO0lBRUE7O0dBRUMsR0FDRGlCLGVBQWlEO1FBQy9DLE9BQU8sSUFBSW5CLElBQUksSUFBSSxDQUFDRCxRQUFRO0lBQzlCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6LWZyb250ZW5kLy4vc3JjL2xpYi9jaXJjdWl0LWJyZWFrZXIudHM/MTJkNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ2lyY3VpdCBCcmVha2VyIFBhdHRlcm4gZm9yIEFnZW50IFJlc2lsaWVuY2VcclxuICogUHJldmVudHMgY2FzY2FkaW5nIGZhaWx1cmVzIGFuZCBwcm92aWRlcyBncmFjZWZ1bCBkZWdyYWRhdGlvblxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ2lyY3VpdEJyZWFrZXJTdGF0ZSB7XHJcbiAgc3RhdGU6IFwiY2xvc2VkXCIgfCBcIm9wZW5cIiB8IFwiaGFsZi1vcGVuXCI7XHJcbiAgZmFpbHVyZUNvdW50OiBudW1iZXI7XHJcbiAgbGFzdEZhaWx1cmVUaW1lPzogRGF0ZTtcclxuICBzdWNjZXNzQ291bnQ6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFnZW50Q2lyY3VpdEJyZWFrZXIge1xyXG4gIHByaXZhdGUgYnJlYWtlcnM6IE1hcDxzdHJpbmcsIENpcmN1aXRCcmVha2VyU3RhdGU+ID0gbmV3IE1hcCgpO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgZmFpbHVyZVRocmVzaG9sZDogbnVtYmVyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgdGltZW91dE1zOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBzdWNjZXNzVGhyZXNob2xkOiBudW1iZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZmFpbHVyZVRocmVzaG9sZDogbnVtYmVyID0gNSxcclxuICAgIHRpbWVvdXRNczogbnVtYmVyID0gNjAwMDAsIC8vIDEgbWludXRlXHJcbiAgICBzdWNjZXNzVGhyZXNob2xkOiBudW1iZXIgPSAzXHJcbiAgKSB7XHJcbiAgICB0aGlzLmZhaWx1cmVUaHJlc2hvbGQgPSBmYWlsdXJlVGhyZXNob2xkO1xyXG4gICAgdGhpcy50aW1lb3V0TXMgPSB0aW1lb3V0TXM7XHJcbiAgICB0aGlzLnN1Y2Nlc3NUaHJlc2hvbGQgPSBzdWNjZXNzVGhyZXNob2xkO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgYWdlbnQgaXMgYXZhaWxhYmxlIChjaXJjdWl0IGJyZWFrZXIgYWxsb3dzKVxyXG4gICAqL1xyXG4gIGlzQWdlbnRBdmFpbGFibGUoYWdlbnRJZDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBicmVha2VyID0gdGhpcy5icmVha2Vycy5nZXQoYWdlbnRJZCk7XHJcbiAgICBpZiAoIWJyZWFrZXIpIHJldHVybiB0cnVlOyAvLyBObyBicmVha2VyID0gYXZhaWxhYmxlXHJcblxyXG4gICAgc3dpdGNoIChicmVha2VyLnN0YXRlKSB7XHJcbiAgICAgIGNhc2UgXCJjbG9zZWRcIjpcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgY2FzZSBcIm9wZW5cIjpcclxuICAgICAgICAvLyBDaGVjayBpZiB0aW1lb3V0IGhhcyBwYXNzZWRcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICBicmVha2VyLmxhc3RGYWlsdXJlVGltZSAmJlxyXG4gICAgICAgICAgRGF0ZS5ub3coKSAtIGJyZWFrZXIubGFzdEZhaWx1cmVUaW1lLmdldFRpbWUoKSA+IHRoaXMudGltZW91dE1zXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICBicmVha2VyLnN0YXRlID0gXCJoYWxmLW9wZW5cIjtcclxuICAgICAgICAgIGJyZWFrZXIuc3VjY2Vzc0NvdW50ID0gMDtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGNhc2UgXCJoYWxmLW9wZW5cIjpcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlY29yZCBhIHN1Y2Nlc3NmdWwgb3BlcmF0aW9uXHJcbiAgICovXHJcbiAgcmVjb3JkU3VjY2VzcyhhZ2VudElkOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGNvbnN0IGJyZWFrZXIgPSB0aGlzLmJyZWFrZXJzLmdldChhZ2VudElkKSB8fCB0aGlzLmNyZWF0ZUJyZWFrZXIoYWdlbnRJZCk7XHJcblxyXG4gICAgYnJlYWtlci5zdWNjZXNzQ291bnQrKztcclxuICAgIGJyZWFrZXIuZmFpbHVyZUNvdW50ID0gMDtcclxuXHJcbiAgICBpZiAoXHJcbiAgICAgIGJyZWFrZXIuc3RhdGUgPT09IFwiaGFsZi1vcGVuXCIgJiZcclxuICAgICAgYnJlYWtlci5zdWNjZXNzQ291bnQgPj0gdGhpcy5zdWNjZXNzVGhyZXNob2xkXHJcbiAgICApIHtcclxuICAgICAgYnJlYWtlci5zdGF0ZSA9IFwiY2xvc2VkXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWNvcmQgYSBmYWlsZWQgb3BlcmF0aW9uXHJcbiAgICovXHJcbiAgcmVjb3JkRmFpbHVyZShhZ2VudElkOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGNvbnN0IGJyZWFrZXIgPSB0aGlzLmJyZWFrZXJzLmdldChhZ2VudElkKSB8fCB0aGlzLmNyZWF0ZUJyZWFrZXIoYWdlbnRJZCk7XHJcblxyXG4gICAgYnJlYWtlci5mYWlsdXJlQ291bnQrKztcclxuICAgIGJyZWFrZXIubGFzdEZhaWx1cmVUaW1lID0gbmV3IERhdGUoKTtcclxuXHJcbiAgICBpZiAoYnJlYWtlci5mYWlsdXJlQ291bnQgPj0gdGhpcy5mYWlsdXJlVGhyZXNob2xkKSB7XHJcbiAgICAgIGJyZWFrZXIuc3RhdGUgPSBcIm9wZW5cIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlQnJlYWtlcihhZ2VudElkOiBzdHJpbmcpOiBDaXJjdWl0QnJlYWtlclN0YXRlIHtcclxuICAgIGNvbnN0IGJyZWFrZXI6IENpcmN1aXRCcmVha2VyU3RhdGUgPSB7XHJcbiAgICAgIHN0YXRlOiBcImNsb3NlZFwiLFxyXG4gICAgICBmYWlsdXJlQ291bnQ6IDAsXHJcbiAgICAgIHN1Y2Nlc3NDb3VudDogMCxcclxuICAgIH07XHJcbiAgICB0aGlzLmJyZWFrZXJzLnNldChhZ2VudElkLCBicmVha2VyKTtcclxuICAgIHJldHVybiBicmVha2VyO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGNpcmN1aXQgYnJlYWtlciBzdGF0dXMgZm9yIG1vbml0b3JpbmdcclxuICAgKi9cclxuICBnZXRTdGF0dXMoYWdlbnRJZDogc3RyaW5nKTogQ2lyY3VpdEJyZWFrZXJTdGF0ZSB8IG51bGwge1xyXG4gICAgcmV0dXJuIHRoaXMuYnJlYWtlcnMuZ2V0KGFnZW50SWQpIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXNldCBjaXJjdWl0IGJyZWFrZXIgKGZvciBtYW51YWwgaW50ZXJ2ZW50aW9uKVxyXG4gICAqL1xyXG4gIHJlc2V0KGFnZW50SWQ6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgdGhpcy5icmVha2Vycy5kZWxldGUoYWdlbnRJZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIGNpcmN1aXQgYnJlYWtlciBzdGF0ZXNcclxuICAgKi9cclxuICBnZXRBbGxTdGF0ZXMoKTogTWFwPHN0cmluZywgQ2lyY3VpdEJyZWFrZXJTdGF0ZT4ge1xyXG4gICAgcmV0dXJuIG5ldyBNYXAodGhpcy5icmVha2Vycyk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJBZ2VudENpcmN1aXRCcmVha2VyIiwiY29uc3RydWN0b3IiLCJmYWlsdXJlVGhyZXNob2xkIiwidGltZW91dE1zIiwic3VjY2Vzc1RocmVzaG9sZCIsImJyZWFrZXJzIiwiTWFwIiwiaXNBZ2VudEF2YWlsYWJsZSIsImFnZW50SWQiLCJicmVha2VyIiwiZ2V0Iiwic3RhdGUiLCJsYXN0RmFpbHVyZVRpbWUiLCJEYXRlIiwibm93IiwiZ2V0VGltZSIsInN1Y2Nlc3NDb3VudCIsInJlY29yZFN1Y2Nlc3MiLCJjcmVhdGVCcmVha2VyIiwiZmFpbHVyZUNvdW50IiwicmVjb3JkRmFpbHVyZSIsInNldCIsImdldFN0YXR1cyIsInJlc2V0IiwiZGVsZXRlIiwiZ2V0QWxsU3RhdGVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/circuit-breaker.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/dynamic-agent-discovery.ts":
/*!********************************************!*\
  !*** ./src/lib/dynamic-agent-discovery.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DynamicAgentDiscovery: () => (/* binding */ DynamicAgentDiscovery)\n/* harmony export */ });\n/**\r\n * Dynamic Agent Discovery and Service Registry\r\n * Handles multiple agents dynamically without hardcoded URLs\r\n */ class DynamicAgentDiscovery {\n    constructor(config){\n        this.discoveredAgents = new Map();\n        this.discoveryInterval = null;\n        this.config = config;\n        this.startDiscovery();\n    }\n    /**\r\n   * Start agent discovery based on configuration\r\n   */ startDiscovery() {\n        // Initial discovery\n        this.performDiscovery();\n        // Periodic discovery every 30 seconds\n        this.discoveryInterval = setInterval(()=>{\n            this.performDiscovery();\n        }, 30000);\n    }\n    /**\r\n   * Perform discovery based on configured method\r\n   */ async performDiscovery() {\n        try {\n            switch(this.config.discoveryMethod){\n                case \"environment\":\n                    await this.discoverFromEnvironment();\n                    break;\n                case \"consul\":\n                    await this.discoverFromConsul();\n                    break;\n                case \"kubernetes\":\n                    await this.discoverFromKubernetes();\n                    break;\n                case \"multicast\":\n                    await this.discoverFromMulticast();\n                    break;\n                case \"manual\":\n                    await this.discoverFromManual();\n                    break;\n                default:\n                    console.warn(`Unknown discovery method: ${this.config.discoveryMethod}`);\n            }\n        } catch (error) {\n            console.error(\"Agent discovery failed:\", error);\n        }\n    }\n    /**\r\n   * Discover agents from environment variables\r\n   */ async discoverFromEnvironment() {\n        if (!this.config.environment) return;\n        const { prefix, ports = [\n            3000,\n            4001\n        ], hosts = [\n            \"localhost\"\n        ] } = this.config.environment;\n        for (const host of hosts){\n            for (const port of ports){\n                const url = `http://${host}:${port}`;\n                const agentId = `${host}:${port}`;\n                try {\n                    // Check if agent exists and get its capabilities\n                    const agentInfo = await this.probeAgent(url);\n                    if (agentInfo) {\n                        this.discoveredAgents.set(agentId, {\n                            id: agentId,\n                            name: agentInfo.name || `Agent-${agentId}`,\n                            url,\n                            capabilities: agentInfo.capabilities || [],\n                            status: \"online\",\n                            lastSeen: new Date(),\n                            metadata: {\n                                version: agentInfo.version,\n                                instance: agentId,\n                                tags: [\n                                    `env:${prefix}`\n                                ]\n                            }\n                        });\n                    }\n                } catch (error) {\n                    // Mark as offline if probe fails\n                    const existing = this.discoveredAgents.get(agentId);\n                    if (existing) {\n                        existing.status = \"offline\";\n                        existing.lastSeen = new Date();\n                    }\n                }\n            }\n        }\n    }\n    /**\r\n   * Discover agents from Consul service registry\r\n   */ async discoverFromConsul() {\n        if (!this.config.consul) return;\n        const { host, port, serviceName } = this.config.consul;\n        const consulUrl = `http://${host}:${port}`;\n        try {\n            const response = await fetch(`${consulUrl}/v1/health/service/${serviceName}`);\n            const services = await response.json();\n            for (const service of services){\n                const agent = service.Service;\n                const agentId = agent.ID;\n                this.discoveredAgents.set(agentId, {\n                    id: agentId,\n                    name: agent.Service,\n                    url: `http://${agent.Address}:${agent.Port}`,\n                    capabilities: agent.Tags || [],\n                    status: \"online\",\n                    lastSeen: new Date(),\n                    metadata: {\n                        version: agent.Meta?.version,\n                        region: service.Node?.Datacenter,\n                        instance: agentId,\n                        tags: agent.Tags\n                    }\n                });\n            }\n        } catch (error) {\n            console.error(\"Consul discovery failed:\", error);\n        }\n    }\n    /**\r\n   * Discover agents from Kubernetes\r\n   */ async discoverFromKubernetes() {\n        if (!this.config.kubernetes) return;\n        const { namespace, labelSelector } = this.config.kubernetes;\n        try {\n            // This would use Kubernetes API to discover services\n            // Implementation depends on your K8s setup\n            const response = await fetch(`/api/v1/namespaces/${namespace}/services?labelSelector=${labelSelector}`);\n            const services = await response.json();\n            for (const service of services.items){\n                const agentId = service.metadata.name;\n                const url = `http://${service.spec.clusterIP}:${service.spec.ports[0].port}`;\n                this.discoveredAgents.set(agentId, {\n                    id: agentId,\n                    name: service.metadata.name,\n                    url,\n                    capabilities: service.metadata.labels?.capabilities?.split(\",\") || [],\n                    status: \"online\",\n                    lastSeen: new Date(),\n                    metadata: {\n                        version: service.metadata.labels?.version,\n                        namespace: service.metadata.namespace,\n                        instance: agentId,\n                        tags: Object.keys(service.metadata.labels || {})\n                    }\n                });\n            }\n        } catch (error) {\n            console.error(\"Kubernetes discovery failed:\", error);\n        }\n    }\n    /**\r\n   * Discover agents using multicast\r\n   */ async discoverFromMulticast() {\n        if (!this.config.multicast) return;\n        // Implementation would use UDP multicast to discover agents\n        // This is a simplified version\n        console.log(\"Multicast discovery not implemented yet\");\n    }\n    /**\r\n   * Use manually configured agents\r\n   */ async discoverFromManual() {\n        if (!this.config.manual) return;\n        for (const agentConfig of this.config.manual.agents){\n            try {\n                const agentInfo = await this.probeAgent(agentConfig.url);\n                if (agentInfo) {\n                    this.discoveredAgents.set(agentConfig.id, {\n                        id: agentConfig.id,\n                        name: agentInfo.name || agentConfig.id,\n                        url: agentConfig.url,\n                        capabilities: agentConfig.capabilities,\n                        status: \"online\",\n                        lastSeen: new Date(),\n                        metadata: agentConfig.metadata\n                    });\n                }\n            } catch (error) {\n                console.warn(`Failed to probe manual agent ${agentConfig.id}:`, error);\n            }\n        }\n    }\n    /**\r\n   * Probe an agent to get its information\r\n   */ async probeAgent(url) {\n        const controller = new AbortController();\n        const timeoutId = setTimeout(()=>controller.abort(), 5000);\n        try {\n            const response = await fetch(`${url}/.well-known/agent-card.json`, {\n                signal: controller.signal\n            });\n            clearTimeout(timeoutId);\n            if (response.ok) {\n                return await response.json();\n            }\n        } catch (error) {\n            clearTimeout(timeoutId);\n            throw error;\n        }\n        return null;\n    }\n    /**\r\n   * Get all discovered agents\r\n   */ getAllAgents() {\n        return Array.from(this.discoveredAgents.values());\n    }\n    /**\r\n   * Get agents by capability\r\n   */ getAgentsByCapability(capability) {\n        return this.getAllAgents().filter((agent)=>agent.capabilities.includes(capability));\n    }\n    /**\r\n   * Get online agents only\r\n   */ getOnlineAgents() {\n        return this.getAllAgents().filter((agent)=>agent.status === \"online\");\n    }\n    /**\r\n   * Get agent by ID\r\n   */ getAgent(agentId) {\n        return this.discoveredAgents.get(agentId);\n    }\n    /**\r\n   * Stop discovery\r\n   */ stop() {\n        if (this.discoveryInterval) {\n            clearInterval(this.discoveryInterval);\n            this.discoveryInterval = null;\n        }\n    }\n    /**\r\n   * Update agent status\r\n   */ updateAgentStatus(agentId, status) {\n        const agent = this.discoveredAgents.get(agentId);\n        if (agent) {\n            agent.status = status;\n            agent.lastSeen = new Date();\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2R5bmFtaWMtYWdlbnQtZGlzY292ZXJ5LnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0NBR0MsR0F1RE0sTUFBTUE7SUFLWEMsWUFBWUMsTUFBNEIsQ0FBRTthQUpsQ0MsbUJBQWlELElBQUlDO2FBQ3JEQyxvQkFBMkM7UUFJakQsSUFBSSxDQUFDSCxNQUFNLEdBQUdBO1FBQ2QsSUFBSSxDQUFDSSxjQUFjO0lBQ3JCO0lBRUE7O0dBRUMsR0FDRCxpQkFBK0I7UUFDN0Isb0JBQW9CO1FBQ3BCLElBQUksQ0FBQ0MsZ0JBQWdCO1FBRXJCLHNDQUFzQztRQUN0QyxJQUFJLENBQUNGLGlCQUFpQixHQUFHRyxZQUFZO1lBQ25DLElBQUksQ0FBQ0QsZ0JBQWdCO1FBQ3ZCLEdBQUc7SUFDTDtJQUVBOztHQUVDLEdBQ0QsTUFBY0EsbUJBQWtDO1FBQzlDLElBQUk7WUFDRixPQUFRLElBQUksQ0FBQ0wsTUFBTSxDQUFDTyxlQUFlO2dCQUNqQyxLQUFLO29CQUNILE1BQU0sSUFBSSxDQUFDQyx1QkFBdUI7b0JBQ2xDO2dCQUNGLEtBQUs7b0JBQ0gsTUFBTSxJQUFJLENBQUNDLGtCQUFrQjtvQkFDN0I7Z0JBQ0YsS0FBSztvQkFDSCxNQUFNLElBQUksQ0FBQ0Msc0JBQXNCO29CQUNqQztnQkFDRixLQUFLO29CQUNILE1BQU0sSUFBSSxDQUFDQyxxQkFBcUI7b0JBQ2hDO2dCQUNGLEtBQUs7b0JBQ0gsTUFBTSxJQUFJLENBQUNDLGtCQUFrQjtvQkFDN0I7Z0JBQ0Y7b0JBQ0VDLFFBQVFDLElBQUksQ0FDVixDQUFDLDBCQUEwQixFQUFFLElBQUksQ0FBQ2QsTUFBTSxDQUFDTyxlQUFlLENBQUMsQ0FBQztZQUVoRTtRQUNGLEVBQUUsT0FBT1EsT0FBTztZQUNkRixRQUFRRSxLQUFLLENBQUMsMkJBQTJCQTtRQUMzQztJQUNGO0lBRUE7O0dBRUMsR0FDRCxNQUFjUCwwQkFBeUM7UUFDckQsSUFBSSxDQUFDLElBQUksQ0FBQ1IsTUFBTSxDQUFDZ0IsV0FBVyxFQUFFO1FBRTlCLE1BQU0sRUFDSkMsTUFBTSxFQUNOQyxRQUFRO1lBQUM7WUFBTTtTQUFLLEVBQ3BCQyxRQUFRO1lBQUM7U0FBWSxFQUN0QixHQUFHLElBQUksQ0FBQ25CLE1BQU0sQ0FBQ2dCLFdBQVc7UUFFM0IsS0FBSyxNQUFNSSxRQUFRRCxNQUFPO1lBQ3hCLEtBQUssTUFBTUUsUUFBUUgsTUFBTztnQkFDeEIsTUFBTUksTUFBTSxDQUFDLE9BQU8sRUFBRUYsS0FBSyxDQUFDLEVBQUVDLEtBQUssQ0FBQztnQkFDcEMsTUFBTUUsVUFBVSxDQUFDLEVBQUVILEtBQUssQ0FBQyxFQUFFQyxLQUFLLENBQUM7Z0JBRWpDLElBQUk7b0JBQ0YsaURBQWlEO29CQUNqRCxNQUFNRyxZQUFZLE1BQU0sSUFBSSxDQUFDQyxVQUFVLENBQUNIO29CQUN4QyxJQUFJRSxXQUFXO3dCQUNiLElBQUksQ0FBQ3ZCLGdCQUFnQixDQUFDeUIsR0FBRyxDQUFDSCxTQUFTOzRCQUNqQ0ksSUFBSUo7NEJBQ0pLLE1BQU1KLFVBQVVJLElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRUwsUUFBUSxDQUFDOzRCQUMxQ0Q7NEJBQ0FPLGNBQWNMLFVBQVVLLFlBQVksSUFBSSxFQUFFOzRCQUMxQ0MsUUFBUTs0QkFDUkMsVUFBVSxJQUFJQzs0QkFDZEMsVUFBVTtnQ0FDUkMsU0FBU1YsVUFBVVUsT0FBTztnQ0FDMUJDLFVBQVVaO2dDQUNWYSxNQUFNO29DQUFDLENBQUMsSUFBSSxFQUFFbkIsT0FBTyxDQUFDO2lDQUFDOzRCQUN6Qjt3QkFDRjtvQkFDRjtnQkFDRixFQUFFLE9BQU9GLE9BQU87b0JBQ2QsaUNBQWlDO29CQUNqQyxNQUFNc0IsV0FBVyxJQUFJLENBQUNwQyxnQkFBZ0IsQ0FBQ3FDLEdBQUcsQ0FBQ2Y7b0JBQzNDLElBQUljLFVBQVU7d0JBQ1pBLFNBQVNQLE1BQU0sR0FBRzt3QkFDbEJPLFNBQVNOLFFBQVEsR0FBRyxJQUFJQztvQkFDMUI7Z0JBQ0Y7WUFDRjtRQUNGO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQWN2QixxQkFBb0M7UUFDaEQsSUFBSSxDQUFDLElBQUksQ0FBQ1QsTUFBTSxDQUFDdUMsTUFBTSxFQUFFO1FBRXpCLE1BQU0sRUFBRW5CLElBQUksRUFBRUMsSUFBSSxFQUFFbUIsV0FBVyxFQUFFLEdBQUcsSUFBSSxDQUFDeEMsTUFBTSxDQUFDdUMsTUFBTTtRQUN0RCxNQUFNRSxZQUFZLENBQUMsT0FBTyxFQUFFckIsS0FBSyxDQUFDLEVBQUVDLEtBQUssQ0FBQztRQUUxQyxJQUFJO1lBQ0YsTUFBTXFCLFdBQVcsTUFBTUMsTUFDckIsQ0FBQyxFQUFFRixVQUFVLG1CQUFtQixFQUFFRCxZQUFZLENBQUM7WUFFakQsTUFBTUksV0FBVyxNQUFNRixTQUFTRyxJQUFJO1lBRXBDLEtBQUssTUFBTUMsV0FBV0YsU0FBVTtnQkFDOUIsTUFBTUcsUUFBUUQsUUFBUUUsT0FBTztnQkFDN0IsTUFBTXpCLFVBQVV3QixNQUFNRSxFQUFFO2dCQUV4QixJQUFJLENBQUNoRCxnQkFBZ0IsQ0FBQ3lCLEdBQUcsQ0FBQ0gsU0FBUztvQkFDakNJLElBQUlKO29CQUNKSyxNQUFNbUIsTUFBTUMsT0FBTztvQkFDbkIxQixLQUFLLENBQUMsT0FBTyxFQUFFeUIsTUFBTUcsT0FBTyxDQUFDLENBQUMsRUFBRUgsTUFBTUksSUFBSSxDQUFDLENBQUM7b0JBQzVDdEIsY0FBY2tCLE1BQU1LLElBQUksSUFBSSxFQUFFO29CQUM5QnRCLFFBQVE7b0JBQ1JDLFVBQVUsSUFBSUM7b0JBQ2RDLFVBQVU7d0JBQ1JDLFNBQVNhLE1BQU1NLElBQUksRUFBRW5CO3dCQUNyQm9CLFFBQVFSLFFBQVFTLElBQUksRUFBRUM7d0JBQ3RCckIsVUFBVVo7d0JBQ1ZhLE1BQU1XLE1BQU1LLElBQUk7b0JBQ2xCO2dCQUNGO1lBQ0Y7UUFDRixFQUFFLE9BQU9yQyxPQUFPO1lBQ2RGLFFBQVFFLEtBQUssQ0FBQyw0QkFBNEJBO1FBQzVDO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQWNMLHlCQUF3QztRQUNwRCxJQUFJLENBQUMsSUFBSSxDQUFDVixNQUFNLENBQUN5RCxVQUFVLEVBQUU7UUFFN0IsTUFBTSxFQUFFQyxTQUFTLEVBQUVDLGFBQWEsRUFBRSxHQUFHLElBQUksQ0FBQzNELE1BQU0sQ0FBQ3lELFVBQVU7UUFFM0QsSUFBSTtZQUNGLHFEQUFxRDtZQUNyRCwyQ0FBMkM7WUFDM0MsTUFBTWYsV0FBVyxNQUFNQyxNQUNyQixDQUFDLG1CQUFtQixFQUFFZSxVQUFVLHdCQUF3QixFQUFFQyxjQUFjLENBQUM7WUFFM0UsTUFBTWYsV0FBVyxNQUFNRixTQUFTRyxJQUFJO1lBRXBDLEtBQUssTUFBTUMsV0FBV0YsU0FBU2dCLEtBQUssQ0FBRTtnQkFDcEMsTUFBTXJDLFVBQVV1QixRQUFRYixRQUFRLENBQUNMLElBQUk7Z0JBQ3JDLE1BQU1OLE1BQU0sQ0FBQyxPQUFPLEVBQUV3QixRQUFRZSxJQUFJLENBQUNDLFNBQVMsQ0FBQyxDQUFDLEVBQUVoQixRQUFRZSxJQUFJLENBQUMzQyxLQUFLLENBQUMsRUFBRSxDQUFDRyxJQUFJLENBQUMsQ0FBQztnQkFFNUUsSUFBSSxDQUFDcEIsZ0JBQWdCLENBQUN5QixHQUFHLENBQUNILFNBQVM7b0JBQ2pDSSxJQUFJSjtvQkFDSkssTUFBTWtCLFFBQVFiLFFBQVEsQ0FBQ0wsSUFBSTtvQkFDM0JOO29CQUNBTyxjQUFjaUIsUUFBUWIsUUFBUSxDQUFDOEIsTUFBTSxFQUFFbEMsY0FBY21DLE1BQU0sUUFBUSxFQUFFO29CQUNyRWxDLFFBQVE7b0JBQ1JDLFVBQVUsSUFBSUM7b0JBQ2RDLFVBQVU7d0JBQ1JDLFNBQVNZLFFBQVFiLFFBQVEsQ0FBQzhCLE1BQU0sRUFBRTdCO3dCQUNsQ3dCLFdBQVdaLFFBQVFiLFFBQVEsQ0FBQ3lCLFNBQVM7d0JBQ3JDdkIsVUFBVVo7d0JBQ1ZhLE1BQU02QixPQUFPQyxJQUFJLENBQUNwQixRQUFRYixRQUFRLENBQUM4QixNQUFNLElBQUksQ0FBQztvQkFDaEQ7Z0JBQ0Y7WUFDRjtRQUNGLEVBQUUsT0FBT2hELE9BQU87WUFDZEYsUUFBUUUsS0FBSyxDQUFDLGdDQUFnQ0E7UUFDaEQ7SUFDRjtJQUVBOztHQUVDLEdBQ0QsTUFBY0osd0JBQXVDO1FBQ25ELElBQUksQ0FBQyxJQUFJLENBQUNYLE1BQU0sQ0FBQ21FLFNBQVMsRUFBRTtRQUU1Qiw0REFBNEQ7UUFDNUQsK0JBQStCO1FBQy9CdEQsUUFBUXVELEdBQUcsQ0FBQztJQUNkO0lBRUE7O0dBRUMsR0FDRCxNQUFjeEQscUJBQW9DO1FBQ2hELElBQUksQ0FBQyxJQUFJLENBQUNaLE1BQU0sQ0FBQ3FFLE1BQU0sRUFBRTtRQUV6QixLQUFLLE1BQU1DLGVBQWUsSUFBSSxDQUFDdEUsTUFBTSxDQUFDcUUsTUFBTSxDQUFDRSxNQUFNLENBQUU7WUFDbkQsSUFBSTtnQkFDRixNQUFNL0MsWUFBWSxNQUFNLElBQUksQ0FBQ0MsVUFBVSxDQUFDNkMsWUFBWWhELEdBQUc7Z0JBQ3ZELElBQUlFLFdBQVc7b0JBQ2IsSUFBSSxDQUFDdkIsZ0JBQWdCLENBQUN5QixHQUFHLENBQUM0QyxZQUFZM0MsRUFBRSxFQUFFO3dCQUN4Q0EsSUFBSTJDLFlBQVkzQyxFQUFFO3dCQUNsQkMsTUFBTUosVUFBVUksSUFBSSxJQUFJMEMsWUFBWTNDLEVBQUU7d0JBQ3RDTCxLQUFLZ0QsWUFBWWhELEdBQUc7d0JBQ3BCTyxjQUFjeUMsWUFBWXpDLFlBQVk7d0JBQ3RDQyxRQUFRO3dCQUNSQyxVQUFVLElBQUlDO3dCQUNkQyxVQUFVcUMsWUFBWXJDLFFBQVE7b0JBQ2hDO2dCQUNGO1lBQ0YsRUFBRSxPQUFPbEIsT0FBTztnQkFDZEYsUUFBUUMsSUFBSSxDQUFDLENBQUMsNkJBQTZCLEVBQUV3RCxZQUFZM0MsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFWjtZQUNsRTtRQUNGO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE1BQWNVLFdBQVdILEdBQVcsRUFBZ0I7UUFDbEQsTUFBTWtELGFBQWEsSUFBSUM7UUFDdkIsTUFBTUMsWUFBWUMsV0FBVyxJQUFNSCxXQUFXSSxLQUFLLElBQUk7UUFFdkQsSUFBSTtZQUNGLE1BQU1sQyxXQUFXLE1BQU1DLE1BQU0sQ0FBQyxFQUFFckIsSUFBSSw0QkFBNEIsQ0FBQyxFQUFFO2dCQUNqRXVELFFBQVFMLFdBQVdLLE1BQU07WUFDM0I7WUFDQUMsYUFBYUo7WUFFYixJQUFJaEMsU0FBU3FDLEVBQUUsRUFBRTtnQkFDZixPQUFPLE1BQU1yQyxTQUFTRyxJQUFJO1lBQzVCO1FBQ0YsRUFBRSxPQUFPOUIsT0FBTztZQUNkK0QsYUFBYUo7WUFDYixNQUFNM0Q7UUFDUjtRQUVBLE9BQU87SUFDVDtJQUVBOztHQUVDLEdBQ0RpRSxlQUFrQztRQUNoQyxPQUFPQyxNQUFNQyxJQUFJLENBQUMsSUFBSSxDQUFDakYsZ0JBQWdCLENBQUNrRixNQUFNO0lBQ2hEO0lBRUE7O0dBRUMsR0FDREMsc0JBQXNCQyxVQUFrQixFQUFxQjtRQUMzRCxPQUFPLElBQUksQ0FBQ0wsWUFBWSxHQUFHTSxNQUFNLENBQUMsQ0FBQ3ZDLFFBQ2pDQSxNQUFNbEIsWUFBWSxDQUFDMEQsUUFBUSxDQUFDRjtJQUVoQztJQUVBOztHQUVDLEdBQ0RHLGtCQUFxQztRQUNuQyxPQUFPLElBQUksQ0FBQ1IsWUFBWSxHQUFHTSxNQUFNLENBQUMsQ0FBQ3ZDLFFBQVVBLE1BQU1qQixNQUFNLEtBQUs7SUFDaEU7SUFFQTs7R0FFQyxHQUNEMkQsU0FBU2xFLE9BQWUsRUFBK0I7UUFDckQsT0FBTyxJQUFJLENBQUN0QixnQkFBZ0IsQ0FBQ3FDLEdBQUcsQ0FBQ2Y7SUFDbkM7SUFFQTs7R0FFQyxHQUNEbUUsT0FBYTtRQUNYLElBQUksSUFBSSxDQUFDdkYsaUJBQWlCLEVBQUU7WUFDMUJ3RixjQUFjLElBQUksQ0FBQ3hGLGlCQUFpQjtZQUNwQyxJQUFJLENBQUNBLGlCQUFpQixHQUFHO1FBQzNCO0lBQ0Y7SUFFQTs7R0FFQyxHQUNEeUYsa0JBQWtCckUsT0FBZSxFQUFFTyxNQUE0QixFQUFRO1FBQ3JFLE1BQU1pQixRQUFRLElBQUksQ0FBQzlDLGdCQUFnQixDQUFDcUMsR0FBRyxDQUFDZjtRQUN4QyxJQUFJd0IsT0FBTztZQUNUQSxNQUFNakIsTUFBTSxHQUFHQTtZQUNmaUIsTUFBTWhCLFFBQVEsR0FBRyxJQUFJQztRQUN2QjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6LWZyb250ZW5kLy4vc3JjL2xpYi9keW5hbWljLWFnZW50LWRpc2NvdmVyeS50cz8xZWE5Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBEeW5hbWljIEFnZW50IERpc2NvdmVyeSBhbmQgU2VydmljZSBSZWdpc3RyeVxyXG4gKiBIYW5kbGVzIG11bHRpcGxlIGFnZW50cyBkeW5hbWljYWxseSB3aXRob3V0IGhhcmRjb2RlZCBVUkxzXHJcbiAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBZ2VudERpc2NvdmVyeUNvbmZpZyB7XHJcbiAgZGlzY292ZXJ5TWV0aG9kOlxyXG4gICAgfCBcImVudmlyb25tZW50XCJcclxuICAgIHwgXCJjb25zdWxcIlxyXG4gICAgfCBcImV0Y2RcIlxyXG4gICAgfCBcImt1YmVybmV0ZXNcIlxyXG4gICAgfCBcIm11bHRpY2FzdFwiXHJcbiAgICB8IFwibWFudWFsXCI7XHJcbiAgZW52aXJvbm1lbnQ/OiB7XHJcbiAgICBwcmVmaXg6IHN0cmluZzsgLy8gZS5nLiwgXCJRVUlaX0FHRU5UXCJcclxuICAgIHBvcnRzPzogbnVtYmVyW107IC8vIGUuZy4sIFszMDAwLCA0MDAxLCA0MDAyXVxyXG4gICAgaG9zdHM/OiBzdHJpbmdbXTsgLy8gZS5nLiwgW1wibG9jYWxob3N0XCIsIFwiYWdlbnQxLmV4YW1wbGUuY29tXCJdXHJcbiAgfTtcclxuICBjb25zdWw/OiB7XHJcbiAgICBob3N0OiBzdHJpbmc7XHJcbiAgICBwb3J0OiBudW1iZXI7XHJcbiAgICBzZXJ2aWNlTmFtZTogc3RyaW5nO1xyXG4gIH07XHJcbiAga3ViZXJuZXRlcz86IHtcclxuICAgIG5hbWVzcGFjZTogc3RyaW5nO1xyXG4gICAgbGFiZWxTZWxlY3Rvcjogc3RyaW5nO1xyXG4gIH07XHJcbiAgbXVsdGljYXN0Pzoge1xyXG4gICAgcG9ydDogbnVtYmVyO1xyXG4gICAgZ3JvdXA6IHN0cmluZztcclxuICB9O1xyXG4gIG1hbnVhbD86IHtcclxuICAgIGFnZW50czogQXJyYXk8e1xyXG4gICAgICBpZDogc3RyaW5nO1xyXG4gICAgICB1cmw6IHN0cmluZztcclxuICAgICAgY2FwYWJpbGl0aWVzOiBzdHJpbmdbXTtcclxuICAgICAgbWV0YWRhdGE/OiBhbnk7XHJcbiAgICB9PjtcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERpc2NvdmVyZWRBZ2VudCB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgY2FwYWJpbGl0aWVzOiBzdHJpbmdbXTtcclxuICBzdGF0dXM6IFwib25saW5lXCIgfCBcIm9mZmxpbmVcIiB8IFwidW5rbm93blwiO1xyXG4gIGxhc3RTZWVuOiBEYXRlO1xyXG4gIG1ldGFkYXRhPzoge1xyXG4gICAgdmVyc2lvbj86IHN0cmluZztcclxuICAgIHJlZ2lvbj86IHN0cmluZztcclxuICAgIGluc3RhbmNlPzogc3RyaW5nO1xyXG4gICAgbG9hZD86IG51bWJlcjtcclxuICAgIHRhZ3M/OiBzdHJpbmdbXTtcclxuICAgIG5hbWVzcGFjZT86IHN0cmluZztcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRHluYW1pY0FnZW50RGlzY292ZXJ5IHtcclxuICBwcml2YXRlIGRpc2NvdmVyZWRBZ2VudHM6IE1hcDxzdHJpbmcsIERpc2NvdmVyZWRBZ2VudD4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSBkaXNjb3ZlcnlJbnRlcnZhbDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcclxuICBwcml2YXRlIGNvbmZpZzogQWdlbnREaXNjb3ZlcnlDb25maWc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogQWdlbnREaXNjb3ZlcnlDb25maWcpIHtcclxuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG4gICAgdGhpcy5zdGFydERpc2NvdmVyeSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhcnQgYWdlbnQgZGlzY292ZXJ5IGJhc2VkIG9uIGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIHN0YXJ0RGlzY292ZXJ5KCk6IHZvaWQge1xyXG4gICAgLy8gSW5pdGlhbCBkaXNjb3ZlcnlcclxuICAgIHRoaXMucGVyZm9ybURpc2NvdmVyeSgpO1xyXG5cclxuICAgIC8vIFBlcmlvZGljIGRpc2NvdmVyeSBldmVyeSAzMCBzZWNvbmRzXHJcbiAgICB0aGlzLmRpc2NvdmVyeUludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICB0aGlzLnBlcmZvcm1EaXNjb3ZlcnkoKTtcclxuICAgIH0sIDMwMDAwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBlcmZvcm0gZGlzY292ZXJ5IGJhc2VkIG9uIGNvbmZpZ3VyZWQgbWV0aG9kXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBwZXJmb3JtRGlzY292ZXJ5KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgc3dpdGNoICh0aGlzLmNvbmZpZy5kaXNjb3ZlcnlNZXRob2QpIHtcclxuICAgICAgICBjYXNlIFwiZW52aXJvbm1lbnRcIjpcclxuICAgICAgICAgIGF3YWl0IHRoaXMuZGlzY292ZXJGcm9tRW52aXJvbm1lbnQoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJjb25zdWxcIjpcclxuICAgICAgICAgIGF3YWl0IHRoaXMuZGlzY292ZXJGcm9tQ29uc3VsKCk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwia3ViZXJuZXRlc1wiOlxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5kaXNjb3ZlckZyb21LdWJlcm5ldGVzKCk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwibXVsdGljYXN0XCI6XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLmRpc2NvdmVyRnJvbU11bHRpY2FzdCgpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIm1hbnVhbFwiOlxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5kaXNjb3ZlckZyb21NYW51YWwoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oXHJcbiAgICAgICAgICAgIGBVbmtub3duIGRpc2NvdmVyeSBtZXRob2Q6ICR7dGhpcy5jb25maWcuZGlzY292ZXJ5TWV0aG9kfWBcclxuICAgICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJBZ2VudCBkaXNjb3ZlcnkgZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgZnJvbSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGRpc2NvdmVyRnJvbUVudmlyb25tZW50KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5lbnZpcm9ubWVudCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IHtcclxuICAgICAgcHJlZml4LFxyXG4gICAgICBwb3J0cyA9IFszMDAwLCA0MDAxXSxcclxuICAgICAgaG9zdHMgPSBbXCJsb2NhbGhvc3RcIl0sXHJcbiAgICB9ID0gdGhpcy5jb25maWcuZW52aXJvbm1lbnQ7XHJcblxyXG4gICAgZm9yIChjb25zdCBob3N0IG9mIGhvc3RzKSB7XHJcbiAgICAgIGZvciAoY29uc3QgcG9ydCBvZiBwb3J0cykge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwOi8vJHtob3N0fToke3BvcnR9YDtcclxuICAgICAgICBjb25zdCBhZ2VudElkID0gYCR7aG9zdH06JHtwb3J0fWA7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBDaGVjayBpZiBhZ2VudCBleGlzdHMgYW5kIGdldCBpdHMgY2FwYWJpbGl0aWVzXHJcbiAgICAgICAgICBjb25zdCBhZ2VudEluZm8gPSBhd2FpdCB0aGlzLnByb2JlQWdlbnQodXJsKTtcclxuICAgICAgICAgIGlmIChhZ2VudEluZm8pIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudElkLCB7XHJcbiAgICAgICAgICAgICAgaWQ6IGFnZW50SWQsXHJcbiAgICAgICAgICAgICAgbmFtZTogYWdlbnRJbmZvLm5hbWUgfHwgYEFnZW50LSR7YWdlbnRJZH1gLFxyXG4gICAgICAgICAgICAgIHVybCxcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IGFnZW50SW5mby5jYXBhYmlsaXRpZXMgfHwgW10sXHJcbiAgICAgICAgICAgICAgc3RhdHVzOiBcIm9ubGluZVwiLFxyXG4gICAgICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBhZ2VudEluZm8udmVyc2lvbixcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlOiBhZ2VudElkLFxyXG4gICAgICAgICAgICAgICAgdGFnczogW2BlbnY6JHtwcmVmaXh9YF0sXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIC8vIE1hcmsgYXMgb2ZmbGluZSBpZiBwcm9iZSBmYWlsc1xyXG4gICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLmRpc2NvdmVyZWRBZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAgICAgICAgIGV4aXN0aW5nLnN0YXR1cyA9IFwib2ZmbGluZVwiO1xyXG4gICAgICAgICAgICBleGlzdGluZy5sYXN0U2VlbiA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgZnJvbSBDb25zdWwgc2VydmljZSByZWdpc3RyeVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZGlzY292ZXJGcm9tQ29uc3VsKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5jb25zdWwpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCB7IGhvc3QsIHBvcnQsIHNlcnZpY2VOYW1lIH0gPSB0aGlzLmNvbmZpZy5jb25zdWw7XHJcbiAgICBjb25zdCBjb25zdWxVcmwgPSBgaHR0cDovLyR7aG9zdH06JHtwb3J0fWA7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcclxuICAgICAgICBgJHtjb25zdWxVcmx9L3YxL2hlYWx0aC9zZXJ2aWNlLyR7c2VydmljZU5hbWV9YFxyXG4gICAgICApO1xyXG4gICAgICBjb25zdCBzZXJ2aWNlcyA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuXHJcbiAgICAgIGZvciAoY29uc3Qgc2VydmljZSBvZiBzZXJ2aWNlcykge1xyXG4gICAgICAgIGNvbnN0IGFnZW50ID0gc2VydmljZS5TZXJ2aWNlO1xyXG4gICAgICAgIGNvbnN0IGFnZW50SWQgPSBhZ2VudC5JRDtcclxuXHJcbiAgICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudElkLCB7XHJcbiAgICAgICAgICBpZDogYWdlbnRJZCxcclxuICAgICAgICAgIG5hbWU6IGFnZW50LlNlcnZpY2UsXHJcbiAgICAgICAgICB1cmw6IGBodHRwOi8vJHthZ2VudC5BZGRyZXNzfToke2FnZW50LlBvcnR9YCxcclxuICAgICAgICAgIGNhcGFiaWxpdGllczogYWdlbnQuVGFncyB8fCBbXSxcclxuICAgICAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogYWdlbnQuTWV0YT8udmVyc2lvbixcclxuICAgICAgICAgICAgcmVnaW9uOiBzZXJ2aWNlLk5vZGU/LkRhdGFjZW50ZXIsXHJcbiAgICAgICAgICAgIGluc3RhbmNlOiBhZ2VudElkLFxyXG4gICAgICAgICAgICB0YWdzOiBhZ2VudC5UYWdzLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkNvbnN1bCBkaXNjb3ZlcnkgZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgZnJvbSBLdWJlcm5ldGVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBkaXNjb3ZlckZyb21LdWJlcm5ldGVzKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5rdWJlcm5ldGVzKSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgeyBuYW1lc3BhY2UsIGxhYmVsU2VsZWN0b3IgfSA9IHRoaXMuY29uZmlnLmt1YmVybmV0ZXM7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gVGhpcyB3b3VsZCB1c2UgS3ViZXJuZXRlcyBBUEkgdG8gZGlzY292ZXIgc2VydmljZXNcclxuICAgICAgLy8gSW1wbGVtZW50YXRpb24gZGVwZW5kcyBvbiB5b3VyIEs4cyBzZXR1cFxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxyXG4gICAgICAgIGAvYXBpL3YxL25hbWVzcGFjZXMvJHtuYW1lc3BhY2V9L3NlcnZpY2VzP2xhYmVsU2VsZWN0b3I9JHtsYWJlbFNlbGVjdG9yfWBcclxuICAgICAgKTtcclxuICAgICAgY29uc3Qgc2VydmljZXMgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IHNlcnZpY2Ugb2Ygc2VydmljZXMuaXRlbXMpIHtcclxuICAgICAgICBjb25zdCBhZ2VudElkID0gc2VydmljZS5tZXRhZGF0YS5uYW1lO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwOi8vJHtzZXJ2aWNlLnNwZWMuY2x1c3RlcklQfToke3NlcnZpY2Uuc3BlYy5wb3J0c1swXS5wb3J0fWA7XHJcblxyXG4gICAgICAgIHRoaXMuZGlzY292ZXJlZEFnZW50cy5zZXQoYWdlbnRJZCwge1xyXG4gICAgICAgICAgaWQ6IGFnZW50SWQsXHJcbiAgICAgICAgICBuYW1lOiBzZXJ2aWNlLm1ldGFkYXRhLm5hbWUsXHJcbiAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICBjYXBhYmlsaXRpZXM6IHNlcnZpY2UubWV0YWRhdGEubGFiZWxzPy5jYXBhYmlsaXRpZXM/LnNwbGl0KFwiLFwiKSB8fCBbXSxcclxuICAgICAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogc2VydmljZS5tZXRhZGF0YS5sYWJlbHM/LnZlcnNpb24sXHJcbiAgICAgICAgICAgIG5hbWVzcGFjZTogc2VydmljZS5tZXRhZGF0YS5uYW1lc3BhY2UsXHJcbiAgICAgICAgICAgIGluc3RhbmNlOiBhZ2VudElkLFxyXG4gICAgICAgICAgICB0YWdzOiBPYmplY3Qua2V5cyhzZXJ2aWNlLm1ldGFkYXRhLmxhYmVscyB8fCB7fSksXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiS3ViZXJuZXRlcyBkaXNjb3ZlcnkgZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgdXNpbmcgbXVsdGljYXN0XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBkaXNjb3ZlckZyb21NdWx0aWNhc3QoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBpZiAoIXRoaXMuY29uZmlnLm11bHRpY2FzdCkgcmV0dXJuO1xyXG5cclxuICAgIC8vIEltcGxlbWVudGF0aW9uIHdvdWxkIHVzZSBVRFAgbXVsdGljYXN0IHRvIGRpc2NvdmVyIGFnZW50c1xyXG4gICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvblxyXG4gICAgY29uc29sZS5sb2coXCJNdWx0aWNhc3QgZGlzY292ZXJ5IG5vdCBpbXBsZW1lbnRlZCB5ZXRcIik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVc2UgbWFudWFsbHkgY29uZmlndXJlZCBhZ2VudHNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGRpc2NvdmVyRnJvbU1hbnVhbCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGlmICghdGhpcy5jb25maWcubWFudWFsKSByZXR1cm47XHJcblxyXG4gICAgZm9yIChjb25zdCBhZ2VudENvbmZpZyBvZiB0aGlzLmNvbmZpZy5tYW51YWwuYWdlbnRzKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWdlbnRJbmZvID0gYXdhaXQgdGhpcy5wcm9iZUFnZW50KGFnZW50Q29uZmlnLnVybCk7XHJcbiAgICAgICAgaWYgKGFnZW50SW5mbykge1xyXG4gICAgICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudENvbmZpZy5pZCwge1xyXG4gICAgICAgICAgICBpZDogYWdlbnRDb25maWcuaWQsXHJcbiAgICAgICAgICAgIG5hbWU6IGFnZW50SW5mby5uYW1lIHx8IGFnZW50Q29uZmlnLmlkLFxyXG4gICAgICAgICAgICB1cmw6IGFnZW50Q29uZmlnLnVybCxcclxuICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBhZ2VudENvbmZpZy5jYXBhYmlsaXRpZXMsXHJcbiAgICAgICAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgIG1ldGFkYXRhOiBhZ2VudENvbmZpZy5tZXRhZGF0YSxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oYEZhaWxlZCB0byBwcm9iZSBtYW51YWwgYWdlbnQgJHthZ2VudENvbmZpZy5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQcm9iZSBhbiBhZ2VudCB0byBnZXQgaXRzIGluZm9ybWF0aW9uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBwcm9iZUFnZW50KHVybDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XHJcbiAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgNTAwMCk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt1cmx9Ly53ZWxsLWtub3duL2FnZW50LWNhcmQuanNvbmAsIHtcclxuICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxyXG4gICAgICB9KTtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcblxyXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIGRpc2NvdmVyZWQgYWdlbnRzXHJcbiAgICovXHJcbiAgZ2V0QWxsQWdlbnRzKCk6IERpc2NvdmVyZWRBZ2VudFtdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZGlzY292ZXJlZEFnZW50cy52YWx1ZXMoKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWdlbnRzIGJ5IGNhcGFiaWxpdHlcclxuICAgKi9cclxuICBnZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eTogc3RyaW5nKTogRGlzY292ZXJlZEFnZW50W10ge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0QWxsQWdlbnRzKCkuZmlsdGVyKChhZ2VudCkgPT5cclxuICAgICAgYWdlbnQuY2FwYWJpbGl0aWVzLmluY2x1ZGVzKGNhcGFiaWxpdHkpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IG9ubGluZSBhZ2VudHMgb25seVxyXG4gICAqL1xyXG4gIGdldE9ubGluZUFnZW50cygpOiBEaXNjb3ZlcmVkQWdlbnRbXSB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRBbGxBZ2VudHMoKS5maWx0ZXIoKGFnZW50KSA9PiBhZ2VudC5zdGF0dXMgPT09IFwib25saW5lXCIpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFnZW50IGJ5IElEXHJcbiAgICovXHJcbiAgZ2V0QWdlbnQoYWdlbnRJZDogc3RyaW5nKTogRGlzY292ZXJlZEFnZW50IHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiB0aGlzLmRpc2NvdmVyZWRBZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RvcCBkaXNjb3ZlcnlcclxuICAgKi9cclxuICBzdG9wKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuZGlzY292ZXJ5SW50ZXJ2YWwpIHtcclxuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmRpc2NvdmVyeUludGVydmFsKTtcclxuICAgICAgdGhpcy5kaXNjb3ZlcnlJbnRlcnZhbCA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgYWdlbnQgc3RhdHVzXHJcbiAgICovXHJcbiAgdXBkYXRlQWdlbnRTdGF0dXMoYWdlbnRJZDogc3RyaW5nLCBzdGF0dXM6IFwib25saW5lXCIgfCBcIm9mZmxpbmVcIik6IHZvaWQge1xyXG4gICAgY29uc3QgYWdlbnQgPSB0aGlzLmRpc2NvdmVyZWRBZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gICAgaWYgKGFnZW50KSB7XHJcbiAgICAgIGFnZW50LnN0YXR1cyA9IHN0YXR1cztcclxuICAgICAgYWdlbnQubGFzdFNlZW4gPSBuZXcgRGF0ZSgpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRHluYW1pY0FnZW50RGlzY292ZXJ5IiwiY29uc3RydWN0b3IiLCJjb25maWciLCJkaXNjb3ZlcmVkQWdlbnRzIiwiTWFwIiwiZGlzY292ZXJ5SW50ZXJ2YWwiLCJzdGFydERpc2NvdmVyeSIsInBlcmZvcm1EaXNjb3ZlcnkiLCJzZXRJbnRlcnZhbCIsImRpc2NvdmVyeU1ldGhvZCIsImRpc2NvdmVyRnJvbUVudmlyb25tZW50IiwiZGlzY292ZXJGcm9tQ29uc3VsIiwiZGlzY292ZXJGcm9tS3ViZXJuZXRlcyIsImRpc2NvdmVyRnJvbU11bHRpY2FzdCIsImRpc2NvdmVyRnJvbU1hbnVhbCIsImNvbnNvbGUiLCJ3YXJuIiwiZXJyb3IiLCJlbnZpcm9ubWVudCIsInByZWZpeCIsInBvcnRzIiwiaG9zdHMiLCJob3N0IiwicG9ydCIsInVybCIsImFnZW50SWQiLCJhZ2VudEluZm8iLCJwcm9iZUFnZW50Iiwic2V0IiwiaWQiLCJuYW1lIiwiY2FwYWJpbGl0aWVzIiwic3RhdHVzIiwibGFzdFNlZW4iLCJEYXRlIiwibWV0YWRhdGEiLCJ2ZXJzaW9uIiwiaW5zdGFuY2UiLCJ0YWdzIiwiZXhpc3RpbmciLCJnZXQiLCJjb25zdWwiLCJzZXJ2aWNlTmFtZSIsImNvbnN1bFVybCIsInJlc3BvbnNlIiwiZmV0Y2giLCJzZXJ2aWNlcyIsImpzb24iLCJzZXJ2aWNlIiwiYWdlbnQiLCJTZXJ2aWNlIiwiSUQiLCJBZGRyZXNzIiwiUG9ydCIsIlRhZ3MiLCJNZXRhIiwicmVnaW9uIiwiTm9kZSIsIkRhdGFjZW50ZXIiLCJrdWJlcm5ldGVzIiwibmFtZXNwYWNlIiwibGFiZWxTZWxlY3RvciIsIml0ZW1zIiwic3BlYyIsImNsdXN0ZXJJUCIsImxhYmVscyIsInNwbGl0IiwiT2JqZWN0Iiwia2V5cyIsIm11bHRpY2FzdCIsImxvZyIsIm1hbnVhbCIsImFnZW50Q29uZmlnIiwiYWdlbnRzIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInNpZ25hbCIsImNsZWFyVGltZW91dCIsIm9rIiwiZ2V0QWxsQWdlbnRzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwiZ2V0QWdlbnRzQnlDYXBhYmlsaXR5IiwiY2FwYWJpbGl0eSIsImZpbHRlciIsImluY2x1ZGVzIiwiZ2V0T25saW5lQWdlbnRzIiwiZ2V0QWdlbnQiLCJzdG9wIiwiY2xlYXJJbnRlcnZhbCIsInVwZGF0ZUFnZW50U3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/dynamic-agent-discovery.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/enhanced-agent-selector.ts":
/*!********************************************!*\
  !*** ./src/lib/enhanced-agent-selector.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EnhancedAgentSelector: () => (/* binding */ EnhancedAgentSelector)\n/* harmony export */ });\n/**\r\n * Enhanced Agent Selection System\r\n * Provides sophisticated agent routing based on multiple criteria\r\n */ class EnhancedAgentSelector {\n    /**\r\n   * Register an agent with its capabilities\r\n   */ registerAgent(agent) {\n        this.agents.set(agent.id, agent);\n        // Build capability index for faster lookups\n        agent.capabilities.forEach((capability)=>{\n            if (!this.capabilityIndex.has(capability.id)) {\n                this.capabilityIndex.set(capability.id, []);\n            }\n            this.capabilityIndex.get(capability.id).push(agent);\n        });\n    }\n    /**\r\n   * Select the best agent for a given query using multiple criteria\r\n   */ selectAgent(query, context) {\n        const queryLower = query.toLowerCase();\n        const candidates = [];\n        // Score each agent based on multiple criteria\n        for (const agent of Array.from(this.agents.values())){\n            if (agent.status !== \"online\") continue;\n            const { score, reasoning } = this.scoreAgent(agent, queryLower, context);\n            if (score > 0) {\n                candidates.push({\n                    agent,\n                    score,\n                    reasoning\n                });\n            }\n        }\n        // Sort by score (highest first)\n        candidates.sort((a, b)=>b.score - a.score);\n        if (candidates.length === 0) {\n            return {\n                agent: null,\n                confidence: 0,\n                reasoning: \"No suitable agents found\"\n            };\n        }\n        const best = candidates[0];\n        return {\n            agent: best.agent,\n            confidence: best.score,\n            reasoning: best.reasoning\n        };\n    }\n    /**\r\n   * Score an agent based on multiple criteria\r\n   */ scoreAgent(agent, queryLower, context) {\n        let totalScore = 0;\n        const reasons = [];\n        // 1. Capability matching (40% weight)\n        const capabilityScore = this.calculateCapabilityScore(agent, queryLower);\n        totalScore += capabilityScore * 0.4;\n        if (capabilityScore > 0) {\n            reasons.push(`Capability match: ${capabilityScore.toFixed(2)}`);\n        }\n        // 2. Agent availability (20% weight)\n        const availabilityScore = this.calculateAvailabilityScore(agent);\n        totalScore += availabilityScore * 0.2;\n        reasons.push(`Availability: ${availabilityScore.toFixed(2)}`);\n        // 3. Performance metrics (20% weight)\n        const performanceScore = this.calculatePerformanceScore(agent);\n        totalScore += performanceScore * 0.2;\n        reasons.push(`Performance: ${performanceScore.toFixed(2)}`);\n        // 4. Context awareness (20% weight)\n        const contextScore = this.calculateContextScore(agent, context);\n        totalScore += contextScore * 0.2;\n        if (contextScore > 0) {\n            reasons.push(`Context match: ${contextScore.toFixed(2)}`);\n        }\n        return {\n            score: Math.min(totalScore, 1),\n            reasoning: reasons.join(\", \")\n        };\n    }\n    calculateCapabilityScore(agent, queryLower) {\n        let bestMatch = 0;\n        for (const capability of agent.capabilities){\n            let capabilityScore = 0;\n            // Check keyword matches\n            const keywordMatches = capability.keywords.filter((keyword)=>queryLower.includes(keyword.toLowerCase())).length;\n            if (keywordMatches > 0) {\n                capabilityScore = keywordMatches / capability.keywords.length * capability.confidence;\n                bestMatch = Math.max(bestMatch, capabilityScore);\n            }\n        }\n        return bestMatch;\n    }\n    calculateAvailabilityScore(agent) {\n        // Factor in status, load, and recent activity\n        let score = 1.0;\n        if (agent.status === \"busy\") score *= 0.7;\n        if (agent.status === \"maintenance\") score *= 0.1;\n        if (agent.load > 0.8) score *= 0.5;\n        // Check if agent was recently active\n        const timeSinceLastSeen = Date.now() - agent.lastSeen.getTime();\n        if (timeSinceLastSeen > 300000) {\n            // 5 minutes\n            score *= 0.8;\n        }\n        return score;\n    }\n    calculatePerformanceScore(agent) {\n        // Combine response time and reliability\n        const responseScore = Math.max(0, 1 - agent.responseTime / 5000); // 5s max\n        const reliabilityScore = agent.reliability;\n        return (responseScore + reliabilityScore) / 2;\n    }\n    calculateContextScore(agent, context) {\n        if (!context) return 0.5; // Neutral score if no context\n        let score = 0.5; // Base score\n        // Adjust based on urgency\n        if (context.urgency === \"high\" && agent.responseTime < 1000) {\n            score += 0.3;\n        }\n        // Adjust based on complexity\n        if (context.complexity === \"complex\" && agent.capabilities.length > 3) {\n            score += 0.2;\n        }\n        return Math.min(score, 1.0);\n    }\n    /**\r\n   * Get fallback agents if primary selection fails\r\n   */ getFallbackAgents(query, excludeAgentId) {\n        const candidates = Array.from(this.agents.values()).filter((agent)=>agent.status === \"online\" && agent.id !== excludeAgentId).sort((a, b)=>b.reliability - a.reliability);\n        return candidates.slice(0, 3); // Return top 3 fallbacks\n    }\n    /**\r\n   * Update agent metrics after task completion\r\n   */ updateAgentMetrics(agentId, success, responseTime) {\n        const agent = this.agents.get(agentId);\n        if (!agent) return;\n        // Update reliability (exponential moving average)\n        agent.reliability = agent.reliability * 0.9 + (success ? 1 : 0) * 0.1;\n        // Update response time (exponential moving average)\n        agent.responseTime = agent.responseTime * 0.8 + responseTime * 0.2;\n        // Update last seen\n        agent.lastSeen = new Date();\n    }\n    /**\r\n   * Get all registered agents\r\n   */ getAllAgents() {\n        return Array.from(this.agents.values());\n    }\n    /**\r\n   * Get agent by ID\r\n   */ getAgent(agentId) {\n        return this.agents.get(agentId);\n    }\n    constructor(){\n        this.agents = new Map();\n        this.capabilityIndex = new Map();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2VuaGFuY2VkLWFnZW50LXNlbGVjdG9yLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0NBR0MsR0FnQ00sTUFBTUE7SUFJWDs7R0FFQyxHQUNEQyxjQUFjQyxLQUFtQixFQUFRO1FBQ3ZDLElBQUksQ0FBQ0MsTUFBTSxDQUFDQyxHQUFHLENBQUNGLE1BQU1HLEVBQUUsRUFBRUg7UUFFMUIsNENBQTRDO1FBQzVDQSxNQUFNSSxZQUFZLENBQUNDLE9BQU8sQ0FBQyxDQUFDQztZQUMxQixJQUFJLENBQUMsSUFBSSxDQUFDQyxlQUFlLENBQUNDLEdBQUcsQ0FBQ0YsV0FBV0gsRUFBRSxHQUFHO2dCQUM1QyxJQUFJLENBQUNJLGVBQWUsQ0FBQ0wsR0FBRyxDQUFDSSxXQUFXSCxFQUFFLEVBQUUsRUFBRTtZQUM1QztZQUNBLElBQUksQ0FBQ0ksZUFBZSxDQUFDRSxHQUFHLENBQUNILFdBQVdILEVBQUUsRUFBR08sSUFBSSxDQUFDVjtRQUNoRDtJQUNGO0lBRUE7O0dBRUMsR0FDRFcsWUFDRUMsS0FBYSxFQUNiQyxPQUFzQixFQUt0QjtRQUNBLE1BQU1DLGFBQWFGLE1BQU1HLFdBQVc7UUFDcEMsTUFBTUMsYUFJRCxFQUFFO1FBRVAsOENBQThDO1FBQzlDLEtBQUssTUFBTWhCLFNBQVNpQixNQUFNQyxJQUFJLENBQUMsSUFBSSxDQUFDakIsTUFBTSxDQUFDa0IsTUFBTSxJQUFLO1lBQ3BELElBQUluQixNQUFNb0IsTUFBTSxLQUFLLFVBQVU7WUFFL0IsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLFNBQVMsRUFBRSxHQUFHLElBQUksQ0FBQ0MsVUFBVSxDQUFDdkIsT0FBT2MsWUFBWUQ7WUFDaEUsSUFBSVEsUUFBUSxHQUFHO2dCQUNiTCxXQUFXTixJQUFJLENBQUM7b0JBQUVWO29CQUFPcUI7b0JBQU9DO2dCQUFVO1lBQzVDO1FBQ0Y7UUFFQSxnQ0FBZ0M7UUFDaENOLFdBQVdRLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNQSxFQUFFTCxLQUFL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QUFJLENBQUNDLE1BQU0sQ0FBQ1EsR0FBRyxDQUFDMEQ7UUFDOUIsSUFBSSxDQUFDbkUsT0FBTztRQUVaLGtEQUFrRDtRQUNsREEsTUFBTTRELFdBQVcsR0FBRzVELE1BQU00RCxXQUFXLEdBQUcsTUFBTSxDQUFDUSxVQUFVLElBQUksS0FBSztRQUVsRSxvREFBb0Q7UUFDcERwRSxNQUFNMEQsWUFBWSxHQUFHMUQsTUFBTTBELFlBQVksR0FBRyxNQUFNQSxlQUFlO1FBRS9ELG1CQUFtQjtRQUNuQjFELE1BQU11RCxRQUFRLEdBQUcsSUFBSUY7SUFDdkI7SUFFQTs7R0FFQyxHQUNEZ0IsZUFBK0I7UUFDN0IsT0FBT3BELE1BQU1DLElBQUksQ0FBQyxJQUFJLENBQUNqQixNQUFNLENBQUNrQixNQUFNO0lBQ3RDO0lBRUE7O0dBRUMsR0FDRG1ELFNBQVNILE9BQWUsRUFBNEI7UUFDbEQsT0FBTyxJQUFJLENBQUNsRSxNQUFNLENBQUNRLEdBQUcsQ0FBQzBEO0lBQ3pCOzthQS9OUWxFLFNBQW9DLElBQUlzRTthQUN4Q2hFLGtCQUErQyxJQUFJZ0U7O0FBK043RCIsInNvdXJjZXMiOlsid2VicGFjazovL3F1aXotZnJvbnRlbmQvLi9zcmMvbGliL2VuaGFuY2VkLWFnZW50LXNlbGVjdG9yLnRzP2JmOTIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEVuaGFuY2VkIEFnZW50IFNlbGVjdGlvbiBTeXN0ZW1cclxuICogUHJvdmlkZXMgc29waGlzdGljYXRlZCBhZ2VudCByb3V0aW5nIGJhc2VkIG9uIG11bHRpcGxlIGNyaXRlcmlhXHJcbiAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBZ2VudENhcGFiaWxpdHkge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAga2V5d29yZHM6IHN0cmluZ1tdO1xyXG4gIGNvbmZpZGVuY2U6IG51bWJlcjsgLy8gMC0xIHNjb3JlIGZvciBob3cgd2VsbCB0aGlzIGFnZW50IGhhbmRsZXMgdGhpcyBjYXBhYmlsaXR5XHJcbiAgcmVxdWlyZW1lbnRzPzogc3RyaW5nW107IC8vIEFkZGl0aW9uYWwgcmVxdWlyZW1lbnRzIChlLmcuLCBcIm5lZWRzLWF1dGhcIiwgXCJoaWdoLW1lbW9yeVwiKVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFnZW50UHJvZmlsZSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgY2FwYWJpbGl0aWVzOiBBZ2VudENhcGFiaWxpdHlbXTtcclxuICBzdGF0dXM6IFwib25saW5lXCIgfCBcIm9mZmxpbmVcIiB8IFwiYnVzeVwiIHwgXCJtYWludGVuYW5jZVwiO1xyXG4gIGxvYWQ6IG51bWJlcjsgLy8gQ3VycmVudCBsb2FkICgwLTEpXHJcbiAgcmVzcG9uc2VUaW1lOiBudW1iZXI7IC8vIEF2ZXJhZ2UgcmVzcG9uc2UgdGltZSBpbiBtc1xyXG4gIHJlbGlhYmlsaXR5OiBudW1iZXI7IC8vIFN1Y2Nlc3MgcmF0ZSAoMC0xKVxyXG4gIGxhc3RTZWVuOiBEYXRlO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJ5Q29udGV4dCB7XHJcbiAgcXVlcnk6IHN0cmluZztcclxuICB1c2VySW50ZW50Pzogc3RyaW5nO1xyXG4gIHByZXZpb3VzQ29udGV4dD86IGFueTtcclxuICB1c2VyUHJlZmVyZW5jZXM/OiBhbnk7XHJcbiAgdXJnZW5jeT86IFwibG93XCIgfCBcIm1lZGl1bVwiIHwgXCJoaWdoXCI7XHJcbiAgY29tcGxleGl0eT86IFwic2ltcGxlXCIgfCBcIm1vZGVyYXRlXCIgfCBcImNvbXBsZXhcIjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEVuaGFuY2VkQWdlbnRTZWxlY3RvciB7XHJcbiAgcHJpdmF0ZSBhZ2VudHM6IE1hcDxzdHJpbmcsIEFnZW50UHJvZmlsZT4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSBjYXBhYmlsaXR5SW5kZXg6IE1hcDxzdHJpbmcsIEFnZW50UHJvZmlsZVtdPiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXIgYW4gYWdlbnQgd2l0aCBpdHMgY2FwYWJpbGl0aWVzXHJcbiAgICovXHJcbiAgcmVnaXN0ZXJBZ2VudChhZ2VudDogQWdlbnRQcm9maWxlKTogdm9pZCB7XHJcbiAgICB0aGlzLmFnZW50cy5zZXQoYWdlbnQuaWQsIGFnZW50KTtcclxuXHJcbiAgICAvLyBCdWlsZCBjYXBhYmlsaXR5IGluZGV4IGZvciBmYXN0ZXIgbG9va3Vwc1xyXG4gICAgYWdlbnQuY2FwYWJpbGl0aWVzLmZvckVhY2goKGNhcGFiaWxpdHkpID0+IHtcclxuICAgICAgaWYgKCF0aGlzLmNhcGFiaWxpdHlJbmRleC5oYXMoY2FwYWJpbGl0eS5pZCkpIHtcclxuICAgICAgICB0aGlzLmNhcGFiaWxpdHlJbmRleC5zZXQoY2FwYWJpbGl0eS5pZCwgW10pO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuY2FwYWJpbGl0eUluZGV4LmdldChjYXBhYmlsaXR5LmlkKSEucHVzaChhZ2VudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNlbGVjdCB0aGUgYmVzdCBhZ2VudCBmb3IgYSBnaXZlbiBxdWVyeSB1c2luZyBtdWx0aXBsZSBjcml0ZXJpYVxyXG4gICAqL1xyXG4gIHNlbGVjdEFnZW50KFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ/OiBRdWVyeUNvbnRleHRcclxuICApOiB7XHJcbiAgICBhZ2VudDogQWdlbnRQcm9maWxlIHwgbnVsbDtcclxuICAgIGNvbmZpZGVuY2U6IG51bWJlcjtcclxuICAgIHJlYXNvbmluZzogc3RyaW5nO1xyXG4gIH0ge1xyXG4gICAgY29uc3QgcXVlcnlMb3dlciA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBjYW5kaWRhdGVzOiBBcnJheTx7XHJcbiAgICAgIGFnZW50OiBBZ2VudFByb2ZpbGU7XHJcbiAgICAgIHNjb3JlOiBudW1iZXI7XHJcbiAgICAgIHJlYXNvbmluZzogc3RyaW5nO1xyXG4gICAgfT4gPSBbXTtcclxuXHJcbiAgICAvLyBTY29yZSBlYWNoIGFnZW50IGJhc2VkIG9uIG11bHRpcGxlIGNyaXRlcmlhXHJcbiAgICBmb3IgKGNvbnN0IGFnZW50IG9mIEFycmF5LmZyb20odGhpcy5hZ2VudHMudmFsdWVzKCkpKSB7XHJcbiAgICAgIGlmIChhZ2VudC5zdGF0dXMgIT09IFwib25saW5lXCIpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgY29uc3QgeyBzY29yZSwgcmVhc29uaW5nIH0gPSB0aGlzLnNjb3JlQWdlbnQoYWdlbnQsIHF1ZXJ5TG93ZXIsIGNvbnRleHQpO1xyXG4gICAgICBpZiAoc2NvcmUgPiAwKSB7XHJcbiAgICAgICAgY2FuZGlkYXRlcy5wdXNoKHsgYWdlbnQsIHNjb3JlLCByZWFzb25pbmcgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBTb3J0IGJ5IHNjb3JlIChoaWdoZXN0IGZpcnN0KVxyXG4gICAgY2FuZGlkYXRlcy5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSk7XHJcblxyXG4gICAgaWYgKGNhbmRpZGF0ZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgYWdlbnQ6IG51bGwsXHJcbiAgICAgICAgY29uZmlkZW5jZTogMCxcclxuICAgICAgICByZWFzb25pbmc6IFwiTm8gc3VpdGFibGUgYWdlbnRzIGZvdW5kXCIsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYmVzdCA9IGNhbmRpZGF0ZXNbMF07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhZ2VudDogYmVzdC5hZ2VudCxcclxuICAgICAgY29uZmlkZW5jZTogYmVzdC5zY29yZSxcclxuICAgICAgcmVhc29uaW5nOiBiZXN0LnJlYXNvbmluZyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTY29yZSBhbiBhZ2VudCBiYXNlZCBvbiBtdWx0aXBsZSBjcml0ZXJpYVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2NvcmVBZ2VudChcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUsXHJcbiAgICBxdWVyeUxvd2VyOiBzdHJpbmcsXHJcbiAgICBjb250ZXh0PzogUXVlcnlDb250ZXh0XHJcbiAgKTogeyBzY29yZTogbnVtYmVyOyByZWFzb25pbmc6IHN0cmluZyB9IHtcclxuICAgIGxldCB0b3RhbFNjb3JlID0gMDtcclxuICAgIGNvbnN0IHJlYXNvbnM6IHN0cmluZ1tdID0gW107XHJcblxyXG4gICAgLy8gMS4gQ2FwYWJpbGl0eSBtYXRjaGluZyAoNDAlIHdlaWdodClcclxuICAgIGNvbnN0IGNhcGFiaWxpdHlTY29yZSA9IHRoaXMuY2FsY3VsYXRlQ2FwYWJpbGl0eVNjb3JlKGFnZW50LCBxdWVyeUxvd2VyKTtcclxuICAgIHRvdGFsU2NvcmUgKz0gY2FwYWJpbGl0eVNjb3JlICogMC40O1xyXG4gICAgaWYgKGNhcGFiaWxpdHlTY29yZSA+IDApIHtcclxuICAgICAgcmVhc29ucy5wdXNoKGBDYXBhYmlsaXR5IG1hdGNoOiAke2NhcGFiaWxpdHlTY29yZS50b0ZpeGVkKDIpfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDIuIEFnZW50IGF2YWlsYWJpbGl0eSAoMjAlIHdlaWdodClcclxuICAgIGNvbnN0IGF2YWlsYWJpbGl0eVNjb3JlID0gdGhpcy5jYWxjdWxhdGVBdmFpbGFiaWxpdHlTY29yZShhZ2VudCk7XHJcbiAgICB0b3RhbFNjb3JlICs9IGF2YWlsYWJpbGl0eVNjb3JlICogMC4yO1xyXG4gICAgcmVhc29ucy5wdXNoKGBBdmFpbGFiaWxpdHk6ICR7YXZhaWxhYmlsaXR5U2NvcmUudG9GaXhlZCgyKX1gKTtcclxuXHJcbiAgICAvLyAzLiBQZXJmb3JtYW5jZSBtZXRyaWNzICgyMCUgd2VpZ2h0KVxyXG4gICAgY29uc3QgcGVyZm9ybWFuY2VTY29yZSA9IHRoaXMuY2FsY3VsYXRlUGVyZm9ybWFuY2VTY29yZShhZ2VudCk7XHJcbiAgICB0b3RhbFNjb3JlICs9IHBlcmZvcm1hbmNlU2NvcmUgKiAwLjI7XHJcbiAgICByZWFzb25zLnB1c2goYFBlcmZvcm1hbmNlOiAke3BlcmZvcm1hbmNlU2NvcmUudG9GaXhlZCgyKX1gKTtcclxuXHJcbiAgICAvLyA0LiBDb250ZXh0IGF3YXJlbmVzcyAoMjAlIHdlaWdodClcclxuICAgIGNvbnN0IGNvbnRleHRTY29yZSA9IHRoaXMuY2FsY3VsYXRlQ29udGV4dFNjb3JlKGFnZW50LCBjb250ZXh0KTtcclxuICAgIHRvdGFsU2NvcmUgKz0gY29udGV4dFNjb3JlICogMC4yO1xyXG4gICAgaWYgKGNvbnRleHRTY29yZSA+IDApIHtcclxuICAgICAgcmVhc29ucy5wdXNoKGBDb250ZXh0IG1hdGNoOiAke2NvbnRleHRTY29yZS50b0ZpeGVkKDIpfWApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHNjb3JlOiBNYXRoLm1pbih0b3RhbFNjb3JlLCAxKSwgLy8gQ2FwIGF0IDEuMFxyXG4gICAgICByZWFzb25pbmc6IHJlYXNvbnMuam9pbihcIiwgXCIpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlQ2FwYWJpbGl0eVNjb3JlKFxyXG4gICAgYWdlbnQ6IEFnZW50UHJvZmlsZSxcclxuICAgIHF1ZXJ5TG93ZXI6IHN0cmluZ1xyXG4gICk6IG51bWJlciB7XHJcbiAgICBsZXQgYmVzdE1hdGNoID0gMDtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGNhcGFiaWxpdHkgb2YgYWdlbnQuY2FwYWJpbGl0aWVzKSB7XHJcbiAgICAgIGxldCBjYXBhYmlsaXR5U2NvcmUgPSAwO1xyXG5cclxuICAgICAgLy8gQ2hlY2sga2V5d29yZCBtYXRjaGVzXHJcbiAgICAgIGNvbnN0IGtleXdvcmRNYXRjaGVzID0gY2FwYWJpbGl0eS5rZXl3b3Jkcy5maWx0ZXIoKGtleXdvcmQpID0+XHJcbiAgICAgICAgcXVlcnlMb3dlci5pbmNsdWRlcyhrZXl3b3JkLnRvTG93ZXJDYXNlKCkpXHJcbiAgICAgICkubGVuZ3RoO1xyXG5cclxuICAgICAgaWYgKGtleXdvcmRNYXRjaGVzID4gMCkge1xyXG4gICAgICAgIGNhcGFiaWxpdHlTY29yZSA9XHJcbiAgICAgICAgICAoa2V5d29yZE1hdGNoZXMgLyBjYXBhYmlsaXR5LmtleXdvcmRzLmxlbmd0aCkgKiBjYXBhYmlsaXR5LmNvbmZpZGVuY2U7XHJcbiAgICAgICAgYmVzdE1hdGNoID0gTWF0aC5tYXgoYmVzdE1hdGNoLCBjYXBhYmlsaXR5U2NvcmUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGJlc3RNYXRjaDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlQXZhaWxhYmlsaXR5U2NvcmUoYWdlbnQ6IEFnZW50UHJvZmlsZSk6IG51bWJlciB7XHJcbiAgICAvLyBGYWN0b3IgaW4gc3RhdHVzLCBsb2FkLCBhbmQgcmVjZW50IGFjdGl2aXR5XHJcbiAgICBsZXQgc2NvcmUgPSAxLjA7XHJcblxyXG4gICAgaWYgKGFnZW50LnN0YXR1cyA9PT0gXCJidXN5XCIpIHNjb3JlICo9IDAuNztcclxuICAgIGlmIChhZ2VudC5zdGF0dXMgPT09IFwibWFpbnRlbmFuY2VcIikgc2NvcmUgKj0gMC4xO1xyXG4gICAgaWYgKGFnZW50LmxvYWQgPiAwLjgpIHNjb3JlICo9IDAuNTtcclxuXHJcbiAgICAvLyBDaGVjayBpZiBhZ2VudCB3YXMgcmVjZW50bHkgYWN0aXZlXHJcbiAgICBjb25zdCB0aW1lU2luY2VMYXN0U2VlbiA9IERhdGUubm93KCkgLSBhZ2VudC5sYXN0U2Vlbi5nZXRUaW1lKCk7XHJcbiAgICBpZiAodGltZVNpbmNlTGFzdFNlZW4gPiAzMDAwMDApIHtcclxuICAgICAgLy8gNSBtaW51dGVzXHJcbiAgICAgIHNjb3JlICo9IDAuODtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gc2NvcmU7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZVBlcmZvcm1hbmNlU2NvcmUoYWdlbnQ6IEFnZW50UHJvZmlsZSk6IG51bWJlciB7XHJcbiAgICAvLyBDb21iaW5lIHJlc3BvbnNlIHRpbWUgYW5kIHJlbGlhYmlsaXR5XHJcbiAgICBjb25zdCByZXNwb25zZVNjb3JlID0gTWF0aC5tYXgoMCwgMSAtIGFnZW50LnJlc3BvbnNlVGltZSAvIDUwMDApOyAvLyA1cyBtYXhcclxuICAgIGNvbnN0IHJlbGlhYmlsaXR5U2NvcmUgPSBhZ2VudC5yZWxpYWJpbGl0eTtcclxuXHJcbiAgICByZXR1cm4gKHJlc3BvbnNlU2NvcmUgKyByZWxpYWJpbGl0eVNjb3JlKSAvIDI7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZUNvbnRleHRTY29yZShcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUsXHJcbiAgICBjb250ZXh0PzogUXVlcnlDb250ZXh0XHJcbiAgKTogbnVtYmVyIHtcclxuICAgIGlmICghY29udGV4dCkgcmV0dXJuIDAuNTsgLy8gTmV1dHJhbCBzY29yZSBpZiBubyBjb250ZXh0XHJcblxyXG4gICAgbGV0IHNjb3JlID0gMC41OyAvLyBCYXNlIHNjb3JlXHJcblxyXG4gICAgLy8gQWRqdXN0IGJhc2VkIG9uIHVyZ2VuY3lcclxuICAgIGlmIChjb250ZXh0LnVyZ2VuY3kgPT09IFwiaGlnaFwiICYmIGFnZW50LnJlc3BvbnNlVGltZSA8IDEwMDApIHtcclxuICAgICAgc2NvcmUgKz0gMC4zO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiBjb21wbGV4aXR5XHJcbiAgICBpZiAoY29udGV4dC5jb21wbGV4aXR5ID09PSBcImNvbXBsZXhcIiAmJiBhZ2VudC5jYXBhYmlsaXRpZXMubGVuZ3RoID4gMykge1xyXG4gICAgICBzY29yZSArPSAwLjI7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE1hdGgubWluKHNjb3JlLCAxLjApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGZhbGxiYWNrIGFnZW50cyBpZiBwcmltYXJ5IHNlbGVjdGlvbiBmYWlsc1xyXG4gICAqL1xyXG4gIGdldEZhbGxiYWNrQWdlbnRzKHF1ZXJ5OiBzdHJpbmcsIGV4Y2x1ZGVBZ2VudElkPzogc3RyaW5nKTogQWdlbnRQcm9maWxlW10ge1xyXG4gICAgY29uc3QgY2FuZGlkYXRlcyA9IEFycmF5LmZyb20odGhpcy5hZ2VudHMudmFsdWVzKCkpXHJcbiAgICAgIC5maWx0ZXIoXHJcbiAgICAgICAgKGFnZW50KSA9PiBhZ2VudC5zdGF0dXMgPT09IFwib25saW5lXCIgJiYgYWdlbnQuaWQgIT09IGV4Y2x1ZGVBZ2VudElkXHJcbiAgICAgIClcclxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIucmVsaWFiaWxpdHkgLSBhLnJlbGlhYmlsaXR5KTtcclxuXHJcbiAgICByZXR1cm4gY2FuZGlkYXRlcy5zbGljZSgwLCAzKTsgLy8gUmV0dXJuIHRvcCAzIGZhbGxiYWNrc1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGFnZW50IG1ldHJpY3MgYWZ0ZXIgdGFzayBjb21wbGV0aW9uXHJcbiAgICovXHJcbiAgdXBkYXRlQWdlbnRNZXRyaWNzKFxyXG4gICAgYWdlbnRJZDogc3RyaW5nLFxyXG4gICAgc3VjY2VzczogYm9vbGVhbixcclxuICAgIHJlc3BvbnNlVGltZTogbnVtYmVyXHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBhZ2VudCA9IHRoaXMuYWdlbnRzLmdldChhZ2VudElkKTtcclxuICAgIGlmICghYWdlbnQpIHJldHVybjtcclxuXHJcbiAgICAvLyBVcGRhdGUgcmVsaWFiaWxpdHkgKGV4cG9uZW50aWFsIG1vdmluZyBhdmVyYWdlKVxyXG4gICAgYWdlbnQucmVsaWFiaWxpdHkgPSBhZ2VudC5yZWxpYWJpbGl0eSAqIDAuOSArIChzdWNjZXNzID8gMSA6IDApICogMC4xO1xyXG5cclxuICAgIC8vIFVwZGF0ZSByZXNwb25zZSB0aW1lIChleHBvbmVudGlhbCBtb3ZpbmcgYXZlcmFnZSlcclxuICAgIGFnZW50LnJlc3BvbnNlVGltZSA9IGFnZW50LnJlc3BvbnNlVGltZSAqIDAuOCArIHJlc3BvbnNlVGltZSAqIDAuMjtcclxuXHJcbiAgICAvLyBVcGRhdGUgbGFzdCBzZWVuXHJcbiAgICBhZ2VudC5sYXN0U2VlbiA9IG5ldyBEYXRlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIHJlZ2lzdGVyZWQgYWdlbnRzXHJcbiAgICovXHJcbiAgZ2V0QWxsQWdlbnRzKCk6IEFnZW50UHJvZmlsZVtdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuYWdlbnRzLnZhbHVlcygpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhZ2VudCBieSBJRFxyXG4gICAqL1xyXG4gIGdldEFnZW50KGFnZW50SWQ6IHN0cmluZyk6IEFnZW50UHJvZmlsZSB8IHVuZGVmaW5lZCB7XHJcbiAgICByZXR1cm4gdGhpcy5hZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRW5oYW5jZWRBZ2VudFNlbGVjdG9yIiwicmVnaXN0ZXJBZ2VudCIsImFnZW50IiwiYWdlbnRzIiwic2V0IiwiaWQiLCJjYXBhYmlsaXRpZXMiLCJmb3JFYWNoIiwiY2FwYWJpbGl0eSIsImNhcGFiaWxpdHlJbmRleCIsImhhcyIsImdldCIsInB1c2giLCJzZWxlY3RBZ2VudCIsInF1ZXJ5IiwiY29udGV4dCIsInF1ZXJ5TG93ZXIiLCJ0b0xvd2VyQ2FzZSIsImNhbmRpZGF0ZXMiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJzdGF0dXMiLCJzY29yZSIsInJlYXNvbmluZyIsInNjb3JlQWdlbnQiLCJzb3J0IiwiYSIsImIiLCJsZW5ndGgiLCJjb25maWRlbmNlIiwiYmVzdCIsInRvdGFsU2NvcmUiLCJyZWFzb25zIiwiY2FwYWJpbGl0eVNjb3JlIiwiY2FsY3VsYXRlQ2FwYWJpbGl0eVNjb3JlIiwidG9GaXhlZCIsImF2YWlsYWJpbGl0eVNjb3JlIiwiY2FsY3VsYXRlQXZhaWxhYmlsaXR5U2NvcmUiLCJwZXJmb3JtYW5jZVNjb3JlIiwiY2FsY3VsYXRlUGVyZm9ybWFuY2VTY29yZSIsImNvbnRleHRTY29yZSIsImNhbGN1bGF0ZUNvbnRleHRTY29yZSIsIk1hdGgiLCJtaW4iLCJqb2luIiwiYmVzdE1hdGNoIiwia2V5d29yZE1hdGNoZXMiLCJrZXl3b3JkcyIsImZpbHRlciIsImtleXdvcmQiLCJpbmNsdWRlcyIsIm1heCIsImxvYWQiLCJ0aW1lU2luY2VMYXN0U2VlbiIsIkRhdGUiLCJub3ciLCJsYXN0U2VlbiIsImdldFRpbWUiLCJyZXNwb25zZVNjb3JlIiwicmVzcG9uc2VUaW1lIiwicmVsaWFiaWxpdHlTY29yZSIsInJlbGlhYmlsaXR5IiwidXJnZW5jeSIsImNvbXBsZXhpdHkiLCJnZXRGYWxsYmFja0FnZW50cyIsImV4Y2x1ZGVBZ2VudElkIiwic2xpY2UiLCJ1cGRhdGVBZ2VudE1ldHJpY3MiLCJhZ2VudElkIiwic3VjY2VzcyIsImdldEFsbEFnZW50cyIsImdldEFnZW50IiwiTWFwIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/enhanced-agent-selector.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/environment-agent-manager.ts":
/*!**********************************************!*\
  !*** ./src/lib/environment-agent-manager.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EnvironmentAgentManager: () => (/* binding */ EnvironmentAgentManager)\n/* harmony export */ });\n/**\r\n * Environment-based Agent Configuration\r\n * Handles different environments (dev, staging, prod) dynamically\r\n */ class EnvironmentAgentManager {\n    constructor(environment = \"development\"){\n        this.discoveredAgents = new Map();\n        this.config = this.loadEnvironmentConfig(environment);\n        this.discoverAgents();\n    }\n    /**\r\n   * Load configuration based on environment\r\n   */ loadEnvironmentConfig(environment) {\n        const configs = {\n            development: {\n                name: \"development\",\n                agents: {\n                    frontend: {\n                        url: \"http://localhost:3000\",\n                        instances: [\n                            \"http://localhost:3000\",\n                            \"http://localhost:3001\"\n                        ]\n                    },\n                    backend: {\n                        url: \"http://localhost:4001\",\n                        instances: [\n                            \"http://localhost:4001\",\n                            \"http://localhost:4002\"\n                        ]\n                    },\n                    services: [\n                        {\n                            name: \"quiz-generator\",\n                            url: \"http://localhost:4001\",\n                            capabilities: [\n                                \"quiz-generation\",\n                                \"content-analysis\"\n                            ]\n                        },\n                        {\n                            name: \"quiz-display\",\n                            url: \"http://localhost:3000\",\n                            capabilities: [\n                                \"ui-orchestration\",\n                                \"quiz-display\"\n                            ]\n                        }\n                    ]\n                }\n            },\n            staging: {\n                name: \"staging\",\n                agents: {\n                    frontend: {\n                        url: \"https://quiz-frontend-staging.example.com\",\n                        instances: [\n                            \"https://quiz-frontend-staging.example.com\",\n                            \"https://quiz-frontend-staging-2.example.com\"\n                        ]\n                    },\n                    backend: {\n                        url: \"https://quiz-backend-staging.example.com\",\n                        instances: [\n                            \"https://quiz-backend-staging.example.com\",\n                            \"https://quiz-backend-staging-2.example.com\"\n                        ]\n                    },\n                    services: [\n                        {\n                            name: \"quiz-generator\",\n                            url: \"https://quiz-backend-staging.example.com\",\n                            capabilities: [\n                                \"quiz-generation\",\n                                \"content-analysis\"\n                            ]\n                        },\n                        {\n                            name: \"quiz-display\",\n                            url: \"https://quiz-frontend-staging.example.com\",\n                            capabilities: [\n                                \"ui-orchestration\",\n                                \"quiz-display\"\n                            ]\n                        }\n                    ]\n                }\n            },\n            production: {\n                name: \"production\",\n                agents: {\n                    frontend: {\n                        url: \"https://quiz-frontend.example.com\",\n                        instances: [\n                            \"https://quiz-frontend.example.com\",\n                            \"https://quiz-frontend-2.example.com\",\n                            \"https://quiz-frontend-3.example.com\"\n                        ]\n                    },\n                    backend: {\n                        url: \"https://quiz-backend.example.com\",\n                        instances: [\n                            \"https://quiz-backend.example.com\",\n                            \"https://quiz-backend-2.example.com\",\n                            \"https://quiz-backend-3.example.com\"\n                        ]\n                    },\n                    services: [\n                        {\n                            name: \"quiz-generator\",\n                            url: \"https://quiz-backend.example.com\",\n                            capabilities: [\n                                \"quiz-generation\",\n                                \"content-analysis\"\n                            ]\n                        },\n                        {\n                            name: \"quiz-display\",\n                            url: \"https://quiz-frontend.example.com\",\n                            capabilities: [\n                                \"ui-orchestration\",\n                                \"quiz-display\"\n                            ]\n                        }\n                    ]\n                }\n            }\n        };\n        return configs[environment] || configs.development;\n    }\n    /**\r\n   * Discover agents from environment configuration\r\n   */ async discoverAgents() {\n        const { agents } = this.config;\n        // Add frontend agents\n        if (agents.frontend.instances) {\n            for (const url of agents.frontend.instances){\n                await this.addAgent({\n                    id: `frontend-${url}`,\n                    name: \"Frontend Agent\",\n                    url,\n                    capabilities: [\n                        \"ui-orchestration\",\n                        \"quiz-display\"\n                    ],\n                    type: \"frontend\"\n                });\n            }\n        }\n        // Add backend agents\n        if (agents.backend.instances) {\n            for (const url of agents.backend.instances){\n                await this.addAgent({\n                    id: `backend-${url}`,\n                    name: \"Backend Agent\",\n                    url,\n                    capabilities: [\n                        \"quiz-generation\",\n                        \"content-analysis\"\n                    ],\n                    type: \"backend\"\n                });\n            }\n        }\n        // Add additional services\n        if (agents.services) {\n            for (const service of agents.services){\n                if (service.instances) {\n                    for (const url of service.instances){\n                        await this.addAgent({\n                            id: `${service.name}-${url}`,\n                            name: service.name,\n                            url,\n                            capabilities: service.capabilities,\n                            type: \"service\"\n                        });\n                    }\n                } else {\n                    await this.addAgent({\n                        id: service.name,\n                        name: service.name,\n                        url: service.url,\n                        capabilities: service.capabilities,\n                        type: \"service\"\n                    });\n                }\n            }\n        }\n    }\n    /**\r\n   * Add agent to registry\r\n   */ async addAgent(agentInfo) {\n        try {\n            // Probe agent to verify it's online\n            const isOnline = await this.probeAgent(agentInfo.url);\n            this.discoveredAgents.set(agentInfo.id, {\n                ...agentInfo,\n                status: isOnline ? \"online\" : \"offline\",\n                lastSeen: new Date()\n            });\n        } catch (error) {\n            console.warn(`Failed to probe agent ${agentInfo.id}:`, error);\n            this.discoveredAgents.set(agentInfo.id, {\n                ...agentInfo,\n                status: \"offline\",\n                lastSeen: new Date()\n            });\n        }\n    }\n    /**\r\n   * Probe agent to check if it's online\r\n   */ async probeAgent(url) {\n        try {\n            const controller = new AbortController();\n            const timeoutId = setTimeout(()=>controller.abort(), 3000);\n            const response = await fetch(`${url}/health`, {\n                signal: controller.signal\n            });\n            clearTimeout(timeoutId);\n            return response.ok;\n        } catch (error) {\n            return false;\n        }\n    }\n    /**\r\n   * Get all agents\r\n   */ getAllAgents() {\n        return Array.from(this.discoveredAgents.values());\n    }\n    /**\r\n   * Get agents by type\r\n   */ getAgentsByType(type) {\n        return this.getAllAgents().filter((agent)=>agent.type === type);\n    }\n    /**\r\n   * Get agents by capability\r\n   */ getAgentsByCapability(capability) {\n        return this.getAllAgents().filter((agent)=>agent.capabilities.includes(capability));\n    }\n    /**\r\n   * Get load-balanced agent URL\r\n   */ getLoadBalancedAgent(capability) {\n        const agents = this.getAgentsByCapability(capability).filter((agent)=>agent.status === \"online\");\n        if (agents.length === 0) return null;\n        // Simple round-robin load balancing\n        const index = Math.floor(Math.random() * agents.length);\n        return agents[index].url;\n    }\n    /**\r\n   * Get primary agent URL (first available)\r\n   */ getPrimaryAgent(capability) {\n        const agent = this.getAgentsByCapability(capability).find((agent)=>agent.status === \"online\");\n        return agent ? agent.url : null;\n    }\n    /**\r\n   * Get environment name\r\n   */ getEnvironmentName() {\n        return this.config.name;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2Vudmlyb25tZW50LWFnZW50LW1hbmFnZXIudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBOzs7Q0FHQyxHQXNCTSxNQUFNQTtJQUlYQyxZQUFZQyxjQUFzQixhQUFhLENBQUU7YUFGekNDLG1CQUFxQyxJQUFJQztRQUcvQyxJQUFJLENBQUNDLE1BQU0sR0FBRyxJQUFJLENBQUNDLHFCQUFxQixDQUFDSjtRQUN6QyxJQUFJLENBQUNLLGNBQWM7SUFDckI7SUFFQTs7R0FFQyxHQUNELHNCQUE4QkwsV0FBbUIsRUFBcUI7UUFDcEUsTUFBTU0sVUFBNkM7WUFDakRDLGFBQWE7Z0JBQ1hDLE1BQU07Z0JBQ05DLFFBQVE7b0JBQ05DLFVBQVU7d0JBQ1JDLEtBQUs7d0JBQ0xDLFdBQVc7NEJBQUM7NEJBQXlCO3lCQUF3QjtvQkFDL0Q7b0JBQ0FDLFNBQVM7d0JBQ1BGLEtBQUs7d0JBQ0xDLFdBQVc7NEJBQUM7NEJBQXlCO3lCQUF3QjtvQkFDL0Q7b0JBQ0FFLFVBQVU7d0JBQ1I7NEJBQ0VOLE1BQU07NEJBQ05HLEtBQUs7NEJBQ0xJLGNBQWM7Z0NBQUM7Z0NBQW1COzZCQUFtQjt3QkFDdkQ7d0JBQ0E7NEJBQ0VQLE1BQU07NEJBQ05HLEtBQUs7NEJBQ0xJLGNBQWM7Z0NBQUM7Z0NBQW9COzZCQUFlO3dCQUNwRDtxQkFDRDtnQkFDSDtZQUNGO1lBQ0FDLFNBQVM7Z0JBQ1BSLE1BQU07Z0JBQ05DLFFBQVE7b0JBQ05DLFVBQVU7d0JBQ1JDLEtBQUs7d0JBQ0xDLFdBQVc7NEJBQ1Q7NEJBQ0E7eUJBQ0Q7b0JBQ0g7b0JBQ0FDLFNBQVM7d0JBQ1BGLEtBQUs7d0JBQ0xDLFdBQVc7NEJBQ1Q7NEJBQ0E7eUJBQ0Q7b0JBQ0g7b0JBQ0FFLFVBQVU7d0JBQ1I7NEJBQ0VOLE1BQU07NEJBQ05HLEtBQUs7NEJBQ0xJLGNBQWM7Z0NBQUM7Z0NBQW1COzZCQUFtQjt3QkFDdkQ7d0JBQ0E7NEJBQ0VQLE1BQU07NEJBQ05HLEtBQUs7NEJBQ0xJLGNBQWM7Z0NBQUM7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QSxNQUFNdEIsTUFBTSxLQUFLO1FBRzlCLElBQUlqQixPQUFPNEMsTUFBTSxLQUFLLEdBQUcsT0FBTztRQUVoQyxvQ0FBb0M7UUFDcEMsTUFBTUMsUUFBUUMsS0FBS0MsS0FBSyxDQUFDRCxLQUFLRSxNQUFNLEtBQUtoRCxPQUFPNEMsTUFBTTtRQUN0RCxPQUFPNUMsTUFBTSxDQUFDNkMsTUFBTSxDQUFDM0MsR0FBRztJQUMxQjtJQUVBOztHQUVDLEdBQ0QrQyxnQkFBZ0JSLFVBQWtCLEVBQWlCO1FBQ2pELE1BQU1GLFFBQVEsSUFBSSxDQUFDQyxxQkFBcUIsQ0FBQ0MsWUFBWVMsSUFBSSxDQUN2RCxDQUFDWCxRQUFVQSxNQUFNdEIsTUFBTSxLQUFLO1FBRzlCLE9BQU9zQixRQUFRQSxNQUFNckMsR0FBRyxHQUFHO0lBQzdCO0lBRUE7O0dBRUMsR0FDRGlELHFCQUE2QjtRQUMzQixPQUFPLElBQUksQ0FBQ3pELE1BQU0sQ0FBQ0ssSUFBSTtJQUN6QjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcXVpei1mcm9udGVuZC8uL3NyYy9saWIvZW52aXJvbm1lbnQtYWdlbnQtbWFuYWdlci50cz82NmM1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBFbnZpcm9ubWVudC1iYXNlZCBBZ2VudCBDb25maWd1cmF0aW9uXHJcbiAqIEhhbmRsZXMgZGlmZmVyZW50IGVudmlyb25tZW50cyAoZGV2LCBzdGFnaW5nLCBwcm9kKSBkeW5hbWljYWxseVxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRW52aXJvbm1lbnRDb25maWcge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBhZ2VudHM6IHtcclxuICAgIGZyb250ZW5kOiB7XHJcbiAgICAgIHVybDogc3RyaW5nO1xyXG4gICAgICBpbnN0YW5jZXM/OiBzdHJpbmdbXTtcclxuICAgIH07XHJcbiAgICBiYWNrZW5kOiB7XHJcbiAgICAgIHVybDogc3RyaW5nO1xyXG4gICAgICBpbnN0YW5jZXM/OiBzdHJpbmdbXTtcclxuICAgIH07XHJcbiAgICBzZXJ2aWNlcz86IEFycmF5PHtcclxuICAgICAgbmFtZTogc3RyaW5nO1xyXG4gICAgICB1cmw6IHN0cmluZztcclxuICAgICAgY2FwYWJpbGl0aWVzOiBzdHJpbmdbXTtcclxuICAgICAgaW5zdGFuY2VzPzogc3RyaW5nW107XHJcbiAgICB9PjtcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRW52aXJvbm1lbnRBZ2VudE1hbmFnZXIge1xyXG4gIHByaXZhdGUgY29uZmlnOiBFbnZpcm9ubWVudENvbmZpZztcclxuICBwcml2YXRlIGRpc2NvdmVyZWRBZ2VudHM6IE1hcDxzdHJpbmcsIGFueT4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGVudmlyb25tZW50OiBzdHJpbmcgPSBcImRldmVsb3BtZW50XCIpIHtcclxuICAgIHRoaXMuY29uZmlnID0gdGhpcy5sb2FkRW52aXJvbm1lbnRDb25maWcoZW52aXJvbm1lbnQpO1xyXG4gICAgdGhpcy5kaXNjb3ZlckFnZW50cygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9hZCBjb25maWd1cmF0aW9uIGJhc2VkIG9uIGVudmlyb25tZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBsb2FkRW52aXJvbm1lbnRDb25maWcoZW52aXJvbm1lbnQ6IHN0cmluZyk6IEVudmlyb25tZW50Q29uZmlnIHtcclxuICAgIGNvbnN0IGNvbmZpZ3M6IFJlY29yZDxzdHJpbmcsIEVudmlyb25tZW50Q29uZmlnPiA9IHtcclxuICAgICAgZGV2ZWxvcG1lbnQ6IHtcclxuICAgICAgICBuYW1lOiBcImRldmVsb3BtZW50XCIsXHJcbiAgICAgICAgYWdlbnRzOiB7XHJcbiAgICAgICAgICBmcm9udGVuZDoge1xyXG4gICAgICAgICAgICB1cmw6IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsXHJcbiAgICAgICAgICAgIGluc3RhbmNlczogW1wiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsIFwiaHR0cDovL2xvY2FsaG9zdDozMDAxXCJdLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGJhY2tlbmQ6IHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiLFxyXG4gICAgICAgICAgICBpbnN0YW5jZXM6IFtcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiLCBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMlwiXSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzZXJ2aWNlczogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgbmFtZTogXCJxdWl6LWdlbmVyYXRvclwiLFxyXG4gICAgICAgICAgICAgIHVybDogXCJodHRwOi8vbG9jYWxob3N0OjQwMDFcIixcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IFtcInF1aXotZ2VuZXJhdGlvblwiLCBcImNvbnRlbnQtYW5hbHlzaXNcIl0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBuYW1lOiBcInF1aXotZGlzcGxheVwiLFxyXG4gICAgICAgICAgICAgIHVybDogXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIixcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IFtcInVpLW9yY2hlc3RyYXRpb25cIiwgXCJxdWl6LWRpc3BsYXlcIl0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIHN0YWdpbmc6IHtcclxuICAgICAgICBuYW1lOiBcInN0YWdpbmdcIixcclxuICAgICAgICBhZ2VudHM6IHtcclxuICAgICAgICAgIGZyb250ZW5kOiB7XHJcbiAgICAgICAgICAgIHVybDogXCJodHRwczovL3F1aXotZnJvbnRlbmQtc3RhZ2luZy5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBpbnN0YW5jZXM6IFtcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1mcm9udGVuZC1zdGFnaW5nLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgICAgXCJodHRwczovL3F1aXotZnJvbnRlbmQtc3RhZ2luZy0yLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYmFja2VuZDoge1xyXG4gICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQtc3RhZ2luZy5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBpbnN0YW5jZXM6IFtcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1iYWNrZW5kLXN0YWdpbmcuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1iYWNrZW5kLXN0YWdpbmctMi5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNlcnZpY2VzOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBuYW1lOiBcInF1aXotZ2VuZXJhdG9yXCIsXHJcbiAgICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vcXVpei1iYWNrZW5kLXN0YWdpbmcuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IFtcInF1aXotZ2VuZXJhdGlvblwiLCBcImNvbnRlbnQtYW5hbHlzaXNcIl0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBuYW1lOiBcInF1aXotZGlzcGxheVwiLFxyXG4gICAgICAgICAgICAgIHVybDogXCJodHRwczovL3F1aXotZnJvbnRlbmQtc3RhZ2luZy5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIGNhcGFiaWxpdGllczogW1widWktb3JjaGVzdHJhdGlvblwiLCBcInF1aXotZGlzcGxheVwiXSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgcHJvZHVjdGlvbjoge1xyXG4gICAgICAgIG5hbWU6IFwicHJvZHVjdGlvblwiLFxyXG4gICAgICAgIGFnZW50czoge1xyXG4gICAgICAgICAgZnJvbnRlbmQ6IHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vcXVpei1mcm9udGVuZC5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBpbnN0YW5jZXM6IFtcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1mcm9udGVuZC5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWZyb250ZW5kLTIuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1mcm9udGVuZC0zLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYmFja2VuZDoge1xyXG4gICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgaW5zdGFuY2VzOiBbXHJcbiAgICAgICAgICAgICAgXCJodHRwczovL3F1aXotYmFja2VuZC5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQtMi5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQtMy5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNlcnZpY2VzOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBuYW1lOiBcInF1aXotZ2VuZXJhdG9yXCIsXHJcbiAgICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vcXVpei1iYWNrZW5kLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBbXCJxdWl6LWdlbmVyYXRpb25cIiwgXCJjb250ZW50LWFuYWx5c2lzXCJdLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgbmFtZTogXCJxdWl6LWRpc3BsYXlcIixcclxuICAgICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9xdWl6LWZyb250ZW5kLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBbXCJ1aS1vcmNoZXN0cmF0aW9uXCIsIFwicXVpei1kaXNwbGF5XCJdLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gY29uZmlnc1tlbnZpcm9ubWVudF0gfHwgY29uZmlncy5kZXZlbG9wbWVudDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERpc2NvdmVyIGFnZW50cyBmcm9tIGVudmlyb25tZW50IGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGRpc2NvdmVyQWdlbnRzKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgeyBhZ2VudHMgfSA9IHRoaXMuY29uZmlnO1xyXG5cclxuICAgIC8vIEFkZCBmcm9udGVuZCBhZ2VudHNcclxuICAgIGlmIChhZ2VudHMuZnJvbnRlbmQuaW5zdGFuY2VzKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdXJsIG9mIGFnZW50cy5mcm9udGVuZC5pbnN0YW5jZXMpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmFkZEFnZW50KHtcclxuICAgICAgICAgIGlkOiBgZnJvbnRlbmQtJHt1cmx9YCxcclxuICAgICAgICAgIG5hbWU6IFwiRnJvbnRlbmQgQWdlbnRcIixcclxuICAgICAgICAgIHVybCxcclxuICAgICAgICAgIGNhcGFiaWxpdGllczogW1widWktb3JjaGVzdHJhdGlvblwiLCBcInF1aXotZGlzcGxheVwiXSxcclxuICAgICAgICAgIHR5cGU6IFwiZnJvbnRlbmRcIixcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBiYWNrZW5kIGFnZW50c1xyXG4gICAgaWYgKGFnZW50cy5iYWNrZW5kLmluc3RhbmNlcykge1xyXG4gICAgICBmb3IgKGNvbnN0IHVybCBvZiBhZ2VudHMuYmFja2VuZC5pbnN0YW5jZXMpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmFkZEFnZW50KHtcclxuICAgICAgICAgIGlkOiBgYmFja2VuZC0ke3VybH1gLFxyXG4gICAgICAgICAgbmFtZTogXCJCYWNrZW5kIEFnZW50XCIsXHJcbiAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICBjYXBhYmlsaXRpZXM6IFtcInF1aXotZ2VuZXJhdGlvblwiLCBcImNvbnRlbnQtYW5hbHlzaXNcIl0sXHJcbiAgICAgICAgICB0eXBlOiBcImJhY2tlbmRcIixcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBhZGRpdGlvbmFsIHNlcnZpY2VzXHJcbiAgICBpZiAoYWdlbnRzLnNlcnZpY2VzKSB7XHJcbiAgICAgIGZvciAoY29uc3Qgc2VydmljZSBvZiBhZ2VudHMuc2VydmljZXMpIHtcclxuICAgICAgICBpZiAoc2VydmljZS5pbnN0YW5jZXMpIHtcclxuICAgICAgICAgIGZvciAoY29uc3QgdXJsIG9mIHNlcnZpY2UuaW5zdGFuY2VzKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWRkQWdlbnQoe1xyXG4gICAgICAgICAgICAgIGlkOiBgJHtzZXJ2aWNlLm5hbWV9LSR7dXJsfWAsXHJcbiAgICAgICAgICAgICAgbmFtZTogc2VydmljZS5uYW1lLFxyXG4gICAgICAgICAgICAgIHVybCxcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IHNlcnZpY2UuY2FwYWJpbGl0aWVzLFxyXG4gICAgICAgICAgICAgIHR5cGU6IFwic2VydmljZVwiLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGRBZ2VudCh7XHJcbiAgICAgICAgICAgIGlkOiBzZXJ2aWNlLm5hbWUsXHJcbiAgICAgICAgICAgIG5hbWU6IHNlcnZpY2UubmFtZSxcclxuICAgICAgICAgICAgdXJsOiBzZXJ2aWNlLnVybCxcclxuICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBzZXJ2aWNlLmNhcGFiaWxpdGllcyxcclxuICAgICAgICAgICAgdHlwZTogXCJzZXJ2aWNlXCIsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZCBhZ2VudCB0byByZWdpc3RyeVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgYWRkQWdlbnQoYWdlbnRJbmZvOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFByb2JlIGFnZW50IHRvIHZlcmlmeSBpdCdzIG9ubGluZVxyXG4gICAgICBjb25zdCBpc09ubGluZSA9IGF3YWl0IHRoaXMucHJvYmVBZ2VudChhZ2VudEluZm8udXJsKTtcclxuXHJcbiAgICAgIHRoaXMuZGlzY292ZXJlZEFnZW50cy5zZXQoYWdlbnRJbmZvLmlkLCB7XHJcbiAgICAgICAgLi4uYWdlbnRJbmZvLFxyXG4gICAgICAgIHN0YXR1czogaXNPbmxpbmUgPyBcIm9ubGluZVwiIDogXCJvZmZsaW5lXCIsXHJcbiAgICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXHJcbiAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gcHJvYmUgYWdlbnQgJHthZ2VudEluZm8uaWR9OmAsIGVycm9yKTtcclxuICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudEluZm8uaWQsIHtcclxuICAgICAgICAuLi5hZ2VudEluZm8sXHJcbiAgICAgICAgc3RhdHVzOiBcIm9mZmxpbmVcIixcclxuICAgICAgICBsYXN0U2VlbjogbmV3IERhdGUoKSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQcm9iZSBhZ2VudCB0byBjaGVjayBpZiBpdCdzIG9ubGluZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgcHJvYmVBZ2VudCh1cmw6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcclxuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDMwMDApO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt1cmx9L2hlYWx0aGAsIHtcclxuICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxyXG4gICAgICB9KTtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcblxyXG4gICAgICByZXR1cm4gcmVzcG9uc2Uub2s7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIGFnZW50c1xyXG4gICAqL1xyXG4gIGdldEFsbEFnZW50cygpOiBhbnlbXSB7XHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmRpc2NvdmVyZWRBZ2VudHMudmFsdWVzKCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFnZW50cyBieSB0eXBlXHJcbiAgICovXHJcbiAgZ2V0QWdlbnRzQnlUeXBlKHR5cGU6IHN0cmluZyk6IGFueVtdIHtcclxuICAgIHJldHVybiB0aGlzLmdldEFsbEFnZW50cygpLmZpbHRlcigoYWdlbnQpID0+IGFnZW50LnR5cGUgPT09IHR5cGUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFnZW50cyBieSBjYXBhYmlsaXR5XHJcbiAgICovXHJcbiAgZ2V0QWdlbnRzQnlDYXBhYmlsaXR5KGNhcGFiaWxpdHk6IHN0cmluZyk6IGFueVtdIHtcclxuICAgIHJldHVybiB0aGlzLmdldEFsbEFnZW50cygpLmZpbHRlcigoYWdlbnQpID0+XHJcbiAgICAgIGFnZW50LmNhcGFiaWxpdGllcy5pbmNsdWRlcyhjYXBhYmlsaXR5KVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBsb2FkLWJhbGFuY2VkIGFnZW50IFVSTFxyXG4gICAqL1xyXG4gIGdldExvYWRCYWxhbmNlZEFnZW50KGNhcGFiaWxpdHk6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgYWdlbnRzID0gdGhpcy5nZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eSkuZmlsdGVyKFxyXG4gICAgICAoYWdlbnQpID0+IGFnZW50LnN0YXR1cyA9PT0gXCJvbmxpbmVcIlxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoYWdlbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgLy8gU2ltcGxlIHJvdW5kLXJvYmluIGxvYWQgYmFsYW5jaW5nXHJcbiAgICBjb25zdCBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFnZW50cy5sZW5ndGgpO1xyXG4gICAgcmV0dXJuIGFnZW50c1tpbmRleF0udXJsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHByaW1hcnkgYWdlbnQgVVJMIChmaXJzdCBhdmFpbGFibGUpXHJcbiAgICovXHJcbiAgZ2V0UHJpbWFyeUFnZW50KGNhcGFiaWxpdHk6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgYWdlbnQgPSB0aGlzLmdldEFnZW50c0J5Q2FwYWJpbGl0eShjYXBhYmlsaXR5KS5maW5kKFxyXG4gICAgICAoYWdlbnQpID0+IGFnZW50LnN0YXR1cyA9PT0gXCJvbmxpbmVcIlxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gYWdlbnQgPyBhZ2VudC51cmwgOiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGVudmlyb25tZW50IG5hbWVcclxuICAgKi9cclxuICBnZXRFbnZpcm9ubWVudE5hbWUoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLmNvbmZpZy5uYW1lO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRW52aXJvbm1lbnRBZ2VudE1hbmFnZXIiLCJjb25zdHJ1Y3RvciIsImVudmlyb25tZW50IiwiZGlzY292ZXJlZEFnZW50cyIsIk1hcCIsImNvbmZpZyIsImxvYWRFbnZpcm9ubWVudENvbmZpZyIsImRpc2NvdmVyQWdlbnRzIiwiY29uZmlncyIsImRldmVsb3BtZW50IiwibmFtZSIsImFnZW50cyIsImZyb250ZW5kIiwidXJsIiwiaW5zdGFuY2VzIiwiYmFja2VuZCIsInNlcnZpY2VzIiwiY2FwYWJpbGl0aWVzIiwic3RhZ2luZyIsInByb2R1Y3Rpb24iLCJhZGRBZ2VudCIsImlkIiwidHlwZSIsInNlcnZpY2UiLCJhZ2VudEluZm8iLCJpc09ubGluZSIsInByb2JlQWdlbnQiLCJzZXQiLCJzdGF0dXMiLCJsYXN0U2VlbiIsIkRhdGUiLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInJlc3BvbnNlIiwiZmV0Y2giLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJvayIsImdldEFsbEFnZW50cyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImdldEFnZW50c0J5VHlwZSIsImZpbHRlciIsImFnZW50IiwiZ2V0QWdlbnRzQnlDYXBhYmlsaXR5IiwiY2FwYWJpbGl0eSIsImluY2x1ZGVzIiwiZ2V0TG9hZEJhbGFuY2VkQWdlbnQiLCJsZW5ndGgiLCJpbmRleCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImdldFByaW1hcnlBZ2VudCIsImZpbmQiLCJnZXRFbnZpcm9ubWVudE5hbWUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/environment-agent-manager.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/orchestratorService.ts":
/*!****************************************!*\
  !*** ./src/lib/orchestratorService.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NextJSOrchestratorService: () => (/* binding */ NextJSOrchestratorService)\n/* harmony export */ });\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist-node/v4.js\");\n/* harmony import */ var _enhanced_agent_selector__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./enhanced-agent-selector */ \"(rsc)/./src/lib/enhanced-agent-selector.ts\");\n/* harmony import */ var _circuit_breaker__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./circuit-breaker */ \"(rsc)/./src/lib/circuit-breaker.ts\");\n/* harmony import */ var _dynamic_agent_discovery__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dynamic-agent-discovery */ \"(rsc)/./src/lib/dynamic-agent-discovery.ts\");\n/* harmony import */ var _environment_agent_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./environment-agent-manager */ \"(rsc)/./src/lib/environment-agent-manager.ts\");\n\n\n\n\n\nclass NextJSOrchestratorService {\n    constructor(){\n        this.agents = new Map();\n        this.workflows = new Map();\n        this.chatHistory = [];\n        // Legacy hardcoded URLs (for backward compatibility)\n        this.knownAgentUrls = [\n            \"http://localhost:3000/.well-known/agent-card.json\",\n            \"http://localhost:4001/.well-known/agent-card.json\",\n            \"http://localhost:4002/.well-known/agent-card.json\"\n        ];\n        this.retryAttempts = 3;\n        this.timeoutMs = 30000;\n        // Dynamic discovery components\n        this.dynamicDiscovery = null;\n        // Initialize enhanced components\n        this.enhancedAgentSelector = new _enhanced_agent_selector__WEBPACK_IMPORTED_MODULE_0__.EnhancedAgentSelector();\n        this.circuitBreaker = new _circuit_breaker__WEBPACK_IMPORTED_MODULE_1__.AgentCircuitBreaker();\n        // Initialize environment-based agent management\n        const environment = \"development\" || 0;\n        this.environmentManager = new _environment_agent_manager__WEBPACK_IMPORTED_MODULE_3__.EnvironmentAgentManager(environment);\n        this.startAgentDiscovery();\n        this.initializeVirtualAgents();\n        this.initializeEnhancedAgents();\n        this.initializeDynamicDiscovery();\n    }\n    /**\r\n   * Initialize enhanced agent profiles with capabilities\r\n   */ initializeEnhancedAgents() {\n        // Backend Quiz Agent\n        const backendAgent = {\n            id: \"backend-quiz-agent\",\n            name: \"Quiz Generation Agent\",\n            url: \"http://localhost:4001\",\n            capabilities: [\n                {\n                    id: \"quiz-generation\",\n                    name: \"Generate Quiz Questions\",\n                    description: \"Creates quiz questions on any topic\",\n                    keywords: [\n                        \"quiz\",\n                        \"question\",\n                        \"test\",\n                        \"exam\",\n                        \"assessment\",\n                        \"multiple choice\",\n                        \"generate\",\n                        \"create\"\n                    ],\n                    confidence: 0.95,\n                    requirements: [\n                        \"openai-api\"\n                    ]\n                },\n                {\n                    id: \"content-analysis\",\n                    name: \"Content Analysis\",\n                    description: \"Analyzes and processes educational content\",\n                    keywords: [\n                        \"analyze\",\n                        \"content\",\n                        \"educational\",\n                        \"material\",\n                        \"process\"\n                    ],\n                    confidence: 0.85\n                }\n            ],\n            status: \"online\",\n            load: 0.0,\n            responseTime: 2000,\n            reliability: 0.95,\n            lastSeen: new Date()\n        };\n        // Frontend Agent\n        const frontendAgent = {\n            id: \"frontend-agent\",\n            name: \"Frontend Orchestration Agent\",\n            url: \"http://localhost:3000\",\n            capabilities: [\n                {\n                    id: \"ui-orchestration\",\n                    name: \"UI Orchestration\",\n                    description: \"Manages user interface and workflow coordination\",\n                    keywords: [\n                        \"workflow\",\n                        \"orchestrate\",\n                        \"coordinate\",\n                        \"manage\",\n                        \"ui\",\n                        \"interface\",\n                        \"display\",\n                        \"render\"\n                    ],\n                    confidence: 0.9\n                },\n                {\n                    id: \"quiz-display\",\n                    name: \"Quiz Display\",\n                    description: \"Renders and manages quiz interfaces\",\n                    keywords: [\n                        \"display\",\n                        \"render\",\n                        \"show\",\n                        \"present\",\n                        \"quiz interface\"\n                    ],\n                    confidence: 0.88\n                }\n            ],\n            status: \"online\",\n            load: 0.0,\n            responseTime: 500,\n            reliability: 0.98,\n            lastSeen: new Date()\n        };\n        // Virtual MCP Agent\n        const mcpAgent = {\n            id: \"virtual-mcp-agent\",\n            name: \"General MCP Agent\",\n            url: \"virtual://normal-mcp-agent\",\n            capabilities: [\n                {\n                    id: \"general-conversation\",\n                    name: \"General Conversation\",\n                    description: \"Handles general queries and conversations\",\n                    keywords: [\n                        \"help\",\n                        \"explain\",\n                        \"general\",\n                        \"conversation\",\n                        \"chat\",\n                        \"assist\"\n                    ],\n                    confidence: 0.8\n                },\n                {\n                    id: \"information-retrieval\",\n                    name: \"Information Retrieval\",\n                    description: \"Retrieves and provides information\",\n                    keywords: [\n                        \"information\",\n                        \"retrieve\",\n                        \"lookup\",\n                        \"search\",\n                        \"find\"\n                    ],\n                    confidence: 0.75\n                }\n            ],\n            status: \"online\",\n            load: 0.0,\n            responseTime: 1000,\n            reliability: 0.9,\n            lastSeen: new Date()\n        };\n        // Register all agents with enhanced selector\n        this.enhancedAgentSelector.registerAgent(backendAgent);\n        this.enhancedAgentSelector.registerAgent(frontendAgent);\n        this.enhancedAgentSelector.registerAgent(mcpAgent);\n    }\n    /**\r\n   * Initialize dynamic agent discovery based on environment\r\n   */ initializeDynamicDiscovery() {\n        const discoveryMethod = process.env.AGENT_DISCOVERY_METHOD || \"environment\";\n        const discoveryConfig = {\n            discoveryMethod: discoveryMethod,\n            environment: {\n                prefix: process.env.AGENT_PREFIX || \"QUIZ_AGENT\",\n                ports: this.parsePorts(process.env.AGENT_PORTS || \"3000,4001,5000\"),\n                hosts: this.parseHosts(process.env.AGENT_HOSTS || \"localhost\")\n            },\n            manual: {\n                agents: this.environmentManager.getAllAgents().map((agent)=>({\n                        id: agent.id,\n                        url: agent.url,\n                        capabilities: agent.capabilities,\n                        metadata: agent.metadata\n                    }))\n            }\n        };\n        try {\n            this.dynamicDiscovery = new _dynamic_agent_discovery__WEBPACK_IMPORTED_MODULE_2__.DynamicAgentDiscovery(discoveryConfig);\n            console.log(`Dynamic agent discovery initialized with method: ${discoveryMethod}`);\n        } catch (error) {\n            console.warn(\"Failed to initialize dynamic discovery, falling back to environment manager:\", error);\n        }\n    }\n    /**\r\n   * Parse comma-separated ports string\r\n   */ parsePorts(portsString) {\n        return portsString.split(\",\").map((port)=>parseInt(port.trim())).filter((port)=>!isNaN(port));\n    }\n    /**\r\n   * Parse comma-separated hosts string\r\n   */ parseHosts(hostsString) {\n        return hostsString.split(\",\").map((host)=>host.trim()).filter((host)=>host.length > 0);\n    }\n    /**\r\n   * Initialize virtual MCP agents that don't have physical endpoints\r\n   */ initializeVirtualAgents() {\n        // Add the normal MCP agent as a virtual agent\n        const normalMCPAgent = {\n            name: \"General MCP Agent\",\n            url: \"virtual://normal-mcp-agent\",\n            skills: [\n                \"general-conversation\",\n                \"information-retrieval\",\n                \"task-assistance\"\n            ],\n            status: \"online\",\n            lastSeen: new Date(),\n            capabilities: {\n                description: \"Handles general queries, conversations, and non-quiz related tasks\",\n                type: \"virtual\"\n            }\n        };\n        this.agents.set(\"virtual://normal-mcp-agent\", normalMCPAgent);\n    }\n    /**\r\n   * Get all available agents (dynamic + legacy)\r\n   */ getAllAvailableAgents() {\n        const agents = [];\n        // Add dynamically discovered agents\n        if (this.dynamicDiscovery) {\n            agents.push(...this.dynamicDiscovery.getAllAgents());\n        }\n        // Add environment-managed agents\n        agents.push(...this.environmentManager.getAllAgents());\n        // Add legacy agents for backward compatibility\n        const legacyAgents = Array.from(this.agents.values());\n        agents.push(...legacyAgents);\n        // Remove duplicates based on URL\n        const uniqueAgents = agents.filter((agent, index, self)=>index === self.findIndex((a)=>a.url === agent.url));\n        return uniqueAgents;\n    }\n    /**\r\n   * Get agents by capability with load balancing\r\n   */ getAgentsByCapability(capability) {\n        const agents = [];\n        // Get from dynamic discovery\n        if (this.dynamicDiscovery) {\n            agents.push(...this.dynamicDiscovery.getAgentsByCapability(capability));\n        }\n        // Get from environment manager\n        agents.push(...this.environmentManager.getAgentsByCapability(capability));\n        // Get from legacy agents\n        const legacyAgents = Array.from(this.agents.values()).filter((agent)=>agent.skills?.includes(capability));\n        agents.push(...legacyAgents);\n        // Remove duplicates and return online agents only\n        const uniqueAgents = agents.filter((agent, index, self)=>index === self.findIndex((a)=>a.url === agent.url));\n        return uniqueAgents.filter((agent)=>agent.status === \"online\");\n    }\n    /**\r\n   * Get load-balanced agent URL for a capability\r\n   */ getLoadBalancedAgentUrl(capability) {\n        // Try environment manager first (has load balancing)\n        const envAgent = this.environmentManager.getLoadBalancedAgent(capability);\n        if (envAgent) return envAgent;\n        // Fall back to dynamic discovery\n        if (this.dynamicDiscovery) {\n            const dynamicAgents = this.dynamicDiscovery.getAgentsByCapability(capability);\n            if (dynamicAgents.length > 0) {\n                const index = Math.floor(Math.random() * dynamicAgents.length);\n                return dynamicAgents[index].url;\n            }\n        }\n        // Fall back to legacy hardcoded URLs\n        switch(capability){\n            case \"quiz-generation\":\n            case \"content-analysis\":\n                return \"http://localhost:4001\";\n            case \"ui-orchestration\":\n            case \"quiz-display\":\n                return \"http://localhost:3000\";\n            default:\n                return null;\n        }\n    }\n    /**\r\n   * Get primary agent URL for a capability\r\n   */ getPrimaryAgentUrl(capability) {\n        // Try environment manager first\n        const envAgent = this.environmentManager.getPrimaryAgent(capability);\n        if (envAgent) return envAgent;\n        // Fall back to dynamic discovery\n        if (this.dynamicDiscovery) {\n            const dynamicAgents = this.dynamicDiscovery.getAgentsByCapability(capability);\n            if (dynamicAgents.length > 0) {\n                return dynamicAgents[0].url;\n            }\n        }\n        // Fall back to legacy hardcoded URLs\n        switch(capability){\n            case \"quiz-generation\":\n            case \"content-analysis\":\n                return \"http://localhost:4001\";\n            case \"ui-orchestration\":\n            case \"quiz-display\":\n                return \"http://localhost:3000\";\n            default:\n                return null;\n        }\n    }\n    /**\r\n   * Enhanced agent selection using sophisticated scoring\r\n   */ determineAgentForQuery(query, context) {\n        const result = this.enhancedAgentSelector.selectAgent(query, context);\n        // Add to chat history for transparency\n        this.addChatMessage({\n            type: \"system\",\n            content: `Agent selection: ${result.agent?.name || \"None\"} (confidence: ${result.confidence.toFixed(2)}, reasoning: ${result.reasoning})`,\n            metadata: {\n                agentId: result.agent?.id,\n                status: \"selection_complete\"\n            }\n        });\n        return result;\n    }\n    /**\r\n   * Legacy method for backward compatibility\r\n   */ determineAgentForQueryLegacy(query) {\n        const lowerQuery = query.toLowerCase();\n        // Quiz-related queries go to backend agent\n        if (lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"question\") || lowerQuery.includes(\"test\") || lowerQuery.includes(\"exam\") || lowerQuery.includes(\"assessment\") || lowerQuery.includes(\"multiple choice\")) {\n            return this.agents.get(\"http://localhost:4001\") || null;\n        }\n        // Workflow/orchestration queries go to frontend agent\n        if (lowerQuery.includes(\"workflow\") || lowerQuery.includes(\"orchestrate\") || lowerQuery.includes(\"coordinate\") || lowerQuery.includes(\"manage\")) {\n            return this.agents.get(\"http://localhost:3000\") || null;\n        }\n        // All other queries go to normal MCP agent\n        return this.agents.get(\"virtual://normal-mcp-agent\") || null;\n    }\n    /**\r\n   * Enhanced agent execution with circuit breaker and retry logic\r\n   */ async executeAgentWithResilience(query, context) {\n        const startTime = Date.now();\n        let selectionTime = 0;\n        let executionTime = 0;\n        try {\n            // Step 1: Select primary agent using enhanced selector\n            const selectionStart = Date.now();\n            const { agent, confidence, reasoning } = this.enhancedAgentSelector.selectAgent(query, context);\n            selectionTime = Date.now() - selectionStart;\n            if (!agent) {\n                return {\n                    success: false,\n                    agent: null,\n                    error: \"No suitable agent found\",\n                    metrics: {\n                        selectionTime,\n                        executionTime: 0,\n                        totalTime: Date.now() - startTime\n                    }\n                };\n            }\n            // Step 2: Check circuit breaker\n            if (!this.circuitBreaker.isAgentAvailable(agent.id)) {\n                console.warn(`Agent ${agent.id} is circuit-broken, trying fallback`);\n                return await this.tryFallbackExecution(query, context, agent.id, startTime, selectionTime);\n            }\n            // Step 3: Execute with retry logic\n            const executionStart = Date.now();\n            const result = await this.executeWithRetry(agent, query, context);\n            executionTime = Date.now() - executionStart;\n            // Record success\n            this.circuitBreaker.recordSuccess(agent.id);\n            this.enhancedAgentSelector.updateAgentMetrics(agent.id, true, executionTime);\n            return {\n                success: true,\n                agent,\n                result,\n                metrics: {\n                    selectionTime,\n                    executionTime,\n                    totalTime: Date.now() - startTime\n                }\n            };\n        } catch (error) {\n            // Record failure and try fallback\n            const agent = this.enhancedAgentSelector.selectAgent(query, context).agent;\n            if (agent) {\n                this.circuitBreaker.recordFailure(agent.id);\n                this.enhancedAgentSelector.updateAgentMetrics(agent.id, false, executionTime);\n            }\n            return await this.tryFallbackExecution(query, context, agent?.id, startTime, selectionTime);\n        }\n    }\n    /**\r\n   * Execute agent with retry logic\r\n   */ async executeWithRetry(agent, query, context) {\n        let lastError = null;\n        for(let attempt = 1; attempt <= this.retryAttempts; attempt++){\n            try {\n                if (agent.url.startsWith(\"virtual://\")) {\n                    return await this.executeVirtualAgent(agent, query, context);\n                } else {\n                    return await this.executeRealAgent(agent, query, context);\n                }\n            } catch (error) {\n                lastError = error;\n                console.warn(`Attempt ${attempt} failed for agent ${agent.id}:`, error);\n                if (attempt < this.retryAttempts) {\n                    // Exponential backoff\n                    await new Promise((resolve)=>setTimeout(resolve, Math.pow(2, attempt) * 1000));\n                }\n            }\n        }\n        throw lastError || new Error(\"All retry attempts failed\");\n    }\n    /**\r\n   * Try fallback agents if primary fails\r\n   */ async tryFallbackExecution(query, context, excludeAgentId, startTime, selectionTime) {\n        const fallbackAgents = this.enhancedAgentSelector.getFallbackAgents(query, excludeAgentId);\n        for (const agent of fallbackAgents){\n            if (!this.circuitBreaker.isAgentAvailable(agent.id)) continue;\n            try {\n                const executionStart = Date.now();\n                const result = await this.executeWithRetry(agent, query, context);\n                const executionTime = Date.now() - executionStart;\n                this.circuitBreaker.recordSuccess(agent.id);\n                this.enhancedAgentSelector.updateAgentMetrics(agent.id, true, executionTime);\n                return {\n                    success: true,\n                    agent,\n                    result,\n                    fallbackUsed: true,\n                    metrics: {\n                        selectionTime,\n                        executionTime,\n                        totalTime: Date.now() - startTime\n                    }\n                };\n            } catch (error) {\n                this.circuitBreaker.recordFailure(agent.id);\n                console.warn(`Fallback agent ${agent.id} also failed:`, error);\n            }\n        }\n        return {\n            success: false,\n            agent: null,\n            error: \"All agents failed, including fallbacks\",\n            metrics: {\n                selectionTime,\n                executionTime: 0,\n                totalTime: Date.now() - startTime\n            }\n        };\n    }\n    /**\r\n   * Execute virtual agent (like MCP)\r\n   */ async executeVirtualAgent(agent, query, context) {\n        // Use existing handleGeneralMCPQuery logic\n        return await this.handleGeneralMCPQuery({\n            query,\n            context\n        });\n    }\n    /**\r\n   * Execute real agent via A2A\r\n   */ async executeRealAgent(agent, query, context) {\n        // Use existing A2A execution logic from executeStep\n        const step = {\n            id: \"enhanced-step\",\n            agentId: agent.url,\n            skillId: \"enhanced-execution\",\n            input: {\n                query,\n                context\n            },\n            status: \"running\"\n        };\n        return await this.executeStep(step);\n    }\n    /**\r\n   * Most important function in the orchestrator service\r\n   * Centralized decision maker - determines whether to route to Backend or DeepSeek\r\n   */ async handleCentralizedRequest(requestData) {\n        const { query, context } = requestData;\n        // Add query to chat history\n        this.addChatMessage({\n            type: \"user\",\n            content: query,\n            metadata: {\n                status: \"processing\"\n            }\n        });\n        try {\n            // Use DeepSeek AI to classify the request\n            const requestType = await this.classifyRequestType(query);\n            if (requestType === \"quiz\") {\n                // Route to Backend Agent for quiz generation\n                console.log(\"\\uD83C\\uDFAF Orchestrator Decision: Quiz Request → Backend Agent\");\n                return await this.routeToBackendAgent(query, context);\n            } else if (requestType === \"manual\") {\n                // Route to Manual Generation\n                console.log(\"\\uD83D\\uDCD6 Orchestrator Decision: Manual Request → Manual Generator\");\n                return await this.routeToManualGenerator(query, context);\n            } else {\n                // Route to DeepSeek API for general chat\n                console.log(\"\\uD83D\\uDCAC Orchestrator Decision: Chat Request → DeepSeek API\");\n                return await this.routeToDeepSeekAPI(query, context);\n            }\n        } catch (error) {\n            console.error(\"Error in centralized request handling:\", error);\n            // Fallback to simple pattern matching\n            const lowerQuery = query.toLowerCase();\n            const isQuizFallback = lowerQuery.includes(\"create\") && lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"generate\") && lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"make\") && lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"quiz about\") || lowerQuery.includes(\"quiz on\");\n            const isManualFallback = lowerQuery.includes(\"create\") && lowerQuery.includes(\"manual\") || lowerQuery.includes(\"generate\") && lowerQuery.includes(\"manual\") || lowerQuery.includes(\"make\") && lowerQuery.includes(\"manual\") || lowerQuery.includes(\"write\") && lowerQuery.includes(\"manual\") || lowerQuery.includes(\"manual about\") || lowerQuery.includes(\"manual on\") || lowerQuery.includes(\"documentation about\") || lowerQuery.includes(\"guide about\");\n            try {\n                if (isQuizFallback) {\n                    return await this.routeToBackendAgent(query, context);\n                } else if (isManualFallback) {\n                    return await this.routeToManualGenerator(query, context);\n                } else {\n                    return await this.routeToDeepSeekAPI(query, context);\n                }\n            } catch (fallbackError) {\n                console.error(\"Fallback routing also failed:\", fallbackError);\n                // Ultimate fallback - return a simple response\n                this.addChatMessage({\n                    type: \"agent\",\n                    content: \"I apologize, but I'm experiencing technical difficulties. Please try again later or rephrase your request.\",\n                    metadata: {\n                        agentId: \"fallback-agent\",\n                        status: \"error\"\n                    }\n                });\n                return {\n                    type: \"error\",\n                    response: \"I apologize, but I'm experiencing technical difficulties. Please try again later or rephrase your request.\",\n                    agentId: \"fallback-agent\",\n                    chatHistory: this.getChatHistory()\n                };\n            }\n        }\n    }\n    /**\r\n   * Classify request type using DeepSeek AI\r\n   */ async classifyRequestType(query) {\n        try {\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are a classifier that determines the type of user request. Return ONLY one of these three options: \"quiz\", \"manual\", or \"chat\".\r\n\r\nExamples of quiz requests:\r\n- \"create a quiz about science\"\r\n- \"generate a quiz on history\"\r\n- \"make a quiz for math\"\r\n- \"quiz about programming\"\r\n- \"create questions about biology\"\r\n\r\nExamples of manual requests:\r\n- \"create a manual about React\"\r\n- \"generate documentation for Python\"\r\n- \"write a guide about cooking\"\r\n- \"manual about JavaScript\"\r\n- \"documentation about machine learning\"\r\n\r\nExamples of chat requests:\r\n- \"hello\"\r\n- \"what is photosynthesis?\"\r\n- \"help me understand calculus\"\r\n- \"tell me about the weather\"\r\n- \"how are you?\"`\n                    },\n                    {\n                        role: \"user\",\n                        content: query\n                    }\n                ],\n                max_tokens: 10,\n                temperature: 0.1,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content?.toLowerCase().trim();\n            if (response === \"quiz\") return \"quiz\";\n            if (response === \"manual\") return \"manual\";\n            return \"chat\";\n        } catch (error) {\n            console.error(\"DeepSeek classification error:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Classify request using DeepSeek AI (legacy method for backward compatibility)\r\n   */ async classifyRequest(query) {\n        try {\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are a classifier that determines if a user message is requesting quiz creation.\r\n\r\nReturn ONLY \"true\" or \"false\" based on whether the user wants to create a quiz.\r\n\r\nExamples of quiz requests:\r\n- \"create a quiz about science\"\r\n- \"generate a quiz on history\"\r\n- \"make a quiz for math\"\r\n- \"quiz about programming\"\r\n- \"create questions about biology\"\r\n\r\nExamples of NOT quiz requests:\r\n- \"hello\"\r\n- \"what is photosynthesis?\"\r\n- \"help me understand calculus\"\r\n- \"tell me about the weather\"\r\n- \"how are you?\"`\n                    },\n                    {\n                        role: \"user\",\n                        content: query\n                    }\n                ],\n                max_tokens: 10,\n                temperature: 0.1,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content?.toLowerCase().trim();\n            console.log(\"DeepSeek classification response:\", response);\n            return response === \"true\";\n        } catch (error) {\n            console.error(\"DeepSeek classification error:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Route to Backend Agent for quiz generation\r\n   */ async routeToBackendAgent(query, context) {\n        // Temporarily skip backend agent due to complexity issues\n        // Go directly to DeepSeek API for quiz generation\n        console.log(\"\\uD83D\\uDD04 Using DeepSeek API for quiz generation (backend agent temporarily disabled)...\");\n        return await this.routeToDeepSeekAPIForQuiz(query, context);\n    }\n    /**\r\n   * Route to Manual Generator\r\n   */ async routeToManualGenerator(query, context) {\n        try {\n            // Add routing message to chat\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Routing manual request to Manual Creator Agent...`,\n                metadata: {\n                    status: \"routing\"\n                }\n            });\n            // Use DeepSeek API directly for manual generation (manual-creator-agent integration pending)\n            console.log(\"Using DeepSeek API for manual generation...\");\n            const manual = await this.generateManualWithDeepSeek(query, \"\");\n            // Add completion message\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Manual generation completed successfully!`,\n                metadata: {\n                    status: \"completed\"\n                }\n            });\n            return {\n                type: \"manual\",\n                result: {\n                    data: manual\n                },\n                agentId: \"manual-generator-agent\",\n                chatHistory: this.getChatHistory()\n            };\n        } catch (error) {\n            console.error(\"Manual generator routing failed:\", error);\n            // Fallback to general chat\n            console.log(\"\\uD83D\\uDD04 Falling back to general chat...\");\n            return await this.routeToDeepSeekAPI(query, context);\n        }\n    }\n    /**\r\n   * Route to DeepSeek API for quiz generation (fallback)\r\n   */ async routeToDeepSeekAPIForQuiz(query, context) {\n        try {\n            // Add fallback message to chat\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Backend agent unavailable, using DeepSeek API for quiz generation...`,\n                metadata: {\n                    status: \"fallback\"\n                }\n            });\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are an expert quiz creator specializing in educational content. Create a comprehensive quiz based on the user's request.\r\n\r\nGenerate exactly 20 multiple-choice questions with 4 options each (A, B, C, D). Format your response as JSON:\r\n\r\n{\r\n  \"quiz_questions\": [\r\n    {\r\n      \"question\": \"Question text here\",\r\n      \"correct_answer\": \"A\",\r\n      \"answers\": [\r\n        {\"answer\": \"Option A\"},\r\n        {\"answer\": \"Option B\"},\r\n        {\"answer\": \"Option C\"},\r\n        {\"answer\": \"Option D\"}\r\n      ],\r\n      \"difficulty\": \"medium\"\r\n    }\r\n  ]\r\n}\r\n\r\nCRITICAL REQUIREMENTS:\r\n- Create diverse, educational questions about the specific topic requested\r\n- Do NOT repeat the same question or similar questions\r\n- Each question should test different aspects of the topic\r\n- Questions should be factually accurate and educational\r\n- Vary the difficulty levels (easy, medium, hard)\r\n- Make sure correct answers are distributed randomly across A, B, C, D positions\r\n- Questions should be clear, concise, and well-written\r\n- Focus on important concepts, not trivial details\r\n- IMPORTANT: Return ONLY valid JSON, no additional text or explanations`\n                    },\n                    {\n                        role: \"user\",\n                        content: `Create a quiz about: ${query}`\n                    }\n                ],\n                max_tokens: 4000,\n                temperature: 0.7,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content || \"{}\";\n            console.log(\"DeepSeek API response:\", response);\n            try {\n                // Try to extract JSON from the response if it contains extra text\n                let jsonString = response.trim();\n                // Look for JSON object boundaries\n                const jsonStart = jsonString.indexOf(\"{\");\n                const jsonEnd = jsonString.lastIndexOf(\"}\");\n                if (jsonStart !== -1 && jsonEnd !== -1 && jsonEnd > jsonStart) {\n                    jsonString = jsonString.substring(jsonStart, jsonEnd + 1);\n                }\n                const quizData = JSON.parse(jsonString);\n                // Add completion message\n                this.addChatMessage({\n                    type: \"orchestrator\",\n                    content: `Quiz generated successfully using DeepSeek API!`,\n                    metadata: {\n                        status: \"completed\"\n                    }\n                });\n                return {\n                    type: \"quiz\",\n                    result: {\n                        data: quizData\n                    },\n                    agentId: \"deepseek-quiz-agent\",\n                    chatHistory: this.getChatHistory()\n                };\n            } catch (parseError) {\n                // If JSON parsing fails, try to generate a better fallback quiz\n                console.log(\"JSON parsing failed, attempting to generate fallback quiz...\");\n                const topic = query.toLowerCase().replace(/create a quiz about|quiz about|generate.*quiz.*about|make.*quiz.*about/gi, \"\").trim() || \"general knowledge\";\n                // Try to generate a better quiz using a simpler prompt\n                try {\n                    const fallbackCompletion = await client.chat.completions.create({\n                        model: \"deepseek-chat\",\n                        messages: [\n                            {\n                                role: \"system\",\n                                content: `Create 20 educational multiple-choice questions about \"${topic}\". Each question should have 4 options (A, B, C, D). Return ONLY valid JSON in this exact format:\r\n\r\n{\r\n  \"quiz_questions\": [\r\n    {\r\n      \"question\": \"What is...?\",\r\n      \"correct_answer\": \"A\",\r\n      \"answers\": [\r\n        {\"answer\": \"Option A\"},\r\n        {\"answer\": \"Option B\"},\r\n        {\"answer\": \"Option C\"},\r\n        {\"answer\": \"Option D\"}\r\n      ],\r\n      \"difficulty\": \"medium\"\r\n    }\r\n  ]\r\n}\r\n\r\nMake questions educational and factually accurate about ${topic}.`\n                            },\n                            {\n                                role: \"user\",\n                                content: `Create a quiz about ${topic}`\n                            }\n                        ],\n                        max_tokens: 3000,\n                        temperature: 0.5,\n                        stream: false\n                    });\n                    const fallbackResponse = fallbackCompletion.choices[0]?.message?.content || \"{}\";\n                    console.log(\"Fallback API response:\", fallbackResponse);\n                    // Try to parse the fallback response\n                    let fallbackJsonString = fallbackResponse.trim();\n                    const fallbackJsonStart = fallbackJsonString.indexOf(\"{\");\n                    const fallbackJsonEnd = fallbackJsonString.lastIndexOf(\"}\");\n                    if (fallbackJsonStart !== -1 && fallbackJsonEnd !== -1 && fallbackJsonEnd > fallbackJsonStart) {\n                        fallbackJsonString = fallbackJsonString.substring(fallbackJsonStart, fallbackJsonEnd + 1);\n                    }\n                    const fallbackQuiz = JSON.parse(fallbackJsonString);\n                    return {\n                        type: \"quiz\",\n                        result: {\n                            data: fallbackQuiz\n                        },\n                        agentId: \"deepseek-fallback-agent\",\n                        chatHistory: this.getChatHistory()\n                    };\n                } catch (fallbackError) {\n                    console.error(\"Fallback quiz generation also failed:\", fallbackError);\n                }\n                // Ultimate fallback - return error message\n                this.addChatMessage({\n                    type: \"orchestrator\",\n                    content: `Failed to generate quiz for \"${topic}\". Please try again with a different topic.`,\n                    metadata: {\n                        status: \"error\"\n                    }\n                });\n                return {\n                    type: \"error\",\n                    response: `I apologize, but I couldn't generate a quiz about \"${topic}\". Please try again with a different topic or rephrase your request.`,\n                    agentId: \"error-agent\",\n                    chatHistory: this.getChatHistory()\n                };\n            }\n        } catch (error) {\n            console.error(\"DeepSeek API quiz generation failed:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Route to DeepSeek API for general chat\r\n   */ async routeToDeepSeekAPI(query, context) {\n        try {\n            // Add routing message to chat\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Routing chat request to DeepSeek API...`,\n                metadata: {\n                    status: \"routing\"\n                }\n            });\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            // Get recent chat history for context\n            const recentHistory = this.chatHistory.filter((msg)=>msg.type !== \"system\").slice(-10).map((msg)=>({\n                    role: msg.type === \"user\" ? \"user\" : \"assistant\",\n                    content: msg.content\n                }));\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are a helpful AI assistant integrated into a quiz application. You can:\r\n\r\n1. **Answer general questions** - Provide helpful, accurate, and friendly responses\r\n2. **Help with quiz creation** - When users ask to create quizzes, guide them on how to do so\r\n3. **Provide educational support** - Help with learning and understanding various topics\r\n\r\nGuidelines:\r\n- Be conversational and friendly\r\n- Keep responses concise but informative\r\n- If someone asks to create a quiz, explain that they should use phrases like \"create a quiz about [topic]\" or \"generate a quiz on [subject]\"\r\n- Always be helpful and encouraging\r\n- If you don't know something, say so honestly\r\n\r\nCurrent context: You're helping a user who is using a quiz application.`\n                    },\n                    ...recentHistory,\n                    {\n                        role: \"user\",\n                        content: query\n                    }\n                ],\n                max_tokens: 500,\n                temperature: 0.7,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content || \"I apologize, but I couldn't generate a response.\";\n            // Add response to chat history\n            this.addChatMessage({\n                type: \"agent\",\n                content: response,\n                metadata: {\n                    agentId: \"deepseek-chat-agent\",\n                    status: \"completed\"\n                }\n            });\n            return {\n                type: \"chat\",\n                response,\n                agentId: \"deepseek-chat-agent\",\n                chatHistory: this.getChatHistory()\n            };\n        } catch (error) {\n            console.error(\"DeepSeek API routing failed:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Handle general MCP queries that don't require specific agent routing\r\n   */ async handleGeneralMCPQuery(requestData) {\n        const { query, context } = requestData;\n        const chatMode = context?.chatMode || \"quiz\"; // Default to quiz mode\n        // Add query to chat history\n        this.addChatMessage({\n            type: \"user\",\n            content: query,\n            metadata: {\n                status: \"processing\"\n            }\n        });\n        let response = \"\";\n        let agentId = \"\";\n        if (chatMode === \"quiz\" || query.toLowerCase().includes(\"quiz\") || query.toLowerCase().includes(\"question\")) {\n            // Quiz-focused responses\n            agentId = \"quiz-agent\";\n            if (query.toLowerCase().includes(\"create quiz\")) {\n                response = `Great! I'd love to help you create a quiz. What topic would you like the quiz to cover? \r\n\r\n**Examples you can try:**\r\n• \"Create a quiz about the solar system\"\r\n• \"Make a science quiz about photosynthesis\" \r\n• \"Generate a history quiz about the Renaissance\"\r\n• \"Create a math quiz about algebra\"\r\n• \"Make a quiz about JavaScript programming\"\r\n\r\nJust tell me the topic and I'll create 20 multiple-choice questions for you!`;\n            } else if (query.toLowerCase().includes(\"science\")) {\n                response = `Perfect! I can create science quizzes on any topic. Here are some examples:\r\n\r\n**Science Quiz Topics:**\r\n• \"Create a quiz about the solar system and planets\"\r\n• \"Make a biology quiz about human anatomy\"\r\n• \"Generate a chemistry quiz about periodic table\"\r\n• \"Create a physics quiz about Newton's laws\"\r\n• \"Make an astronomy quiz about stars and galaxies\"\r\n\r\nWhat specific science topic interests you? I can generate multiple choice questions, true/false, or short answer questions.`;\n            } else if (query.toLowerCase().includes(\"history\")) {\n                response = `Excellent choice! I can create history quizzes covering any time period or region. Here are some examples:\r\n\r\n**History Quiz Topics:**\r\n• \"Create a quiz about World War II\"\r\n• \"Make a quiz about ancient Egypt\"\r\n• \"Generate a quiz about the American Revolution\"\r\n• \"Create a quiz about the Renaissance period\"\r\n• \"Make a quiz about medieval times\"\r\n\r\nWhat historical period or event would you like to focus on?`;\n            } else if (query.toLowerCase().includes(\"math\")) {\n                response = `Math quizzes are my specialty! I can create questions covering any math topic. Here are some examples:\r\n\r\n**Math Quiz Topics:**\r\n• \"Create a quiz about algebra and equations\"\r\n• \"Make a geometry quiz about shapes and angles\"\r\n• \"Generate a calculus quiz about derivatives\"\r\n• \"Create a statistics quiz about probability\"\r\n• \"Make a quiz about fractions and decimals\"\r\n\r\nWhat level and type of math problems would you like? I can make them as easy or challenging as you need.`;\n            } else if (query.toLowerCase().includes(\"general knowledge\")) {\n                response = `General knowledge quizzes are fun! I can create questions covering many topics. Here are some examples:\r\n\r\n**General Knowledge Topics:**\r\n• \"Create a quiz about world capitals\"\r\n• \"Make a quiz about famous landmarks\"\r\n• \"Generate a quiz about literature and authors\"\r\n• \"Create a quiz about sports and athletes\"\r\n• \"Make a quiz about technology and inventions\"\r\n\r\nWhat area of general knowledge would you like to test?`;\n            } else {\n                response = `I'm your Quiz Agent! I can help you create quizzes on any topic. Here's how to get started:\r\n\r\n**Quick Start Options:**\r\n• Click any suggested button above (Create Quiz, Science Topics, etc.)\r\n• Type \"Create a quiz about [your topic]\"\r\n• Paste content and ask me to make a quiz from it\r\n\r\n**Examples:**\r\n• \"Create a quiz about the solar system\"\r\n• \"Make a science quiz about photosynthesis\"\r\n• \"Generate a history quiz about World War II\"\r\n• \"Create a math quiz about algebra\"\r\n\r\nWhat would you like to quiz about?`;\n            }\n        } else if (query.toLowerCase().includes(\"help\") || query.toLowerCase().includes(\"plan\") || query.toLowerCase().includes(\"explain\")) {\n            // Help/planning mode - provide guidance without needing backend\n            agentId = \"quiz-agent\";\n            response = `I'm your Quiz Agent! I can help you plan and design quizzes even when the generation service is temporarily unavailable.\r\n\r\n**I can help you with:**\r\n• Planning quiz topics and structure\r\n• Suggesting question types and formats\r\n• Explaining quiz creation best practices\r\n• Brainstorming quiz content ideas\r\n• Reviewing quiz concepts\r\n\r\n**What would you like help with?**\r\n• \"Help me plan a science quiz about photosynthesis\"\r\n• \"What topics should I include in a history quiz about World War II?\"\r\n• \"Explain how to write good multiple choice questions\"\r\n• \"Suggest quiz formats for different subjects\"\r\n\r\nHow can I assist you with quiz planning today?`;\n        } else {\n            // General chat mode\n            agentId = \"normal-mcp-agent\";\n            response = `I'm your Quiz Agent, but I can also help with general questions! You asked: \"${query}\". \r\n\r\nI'm here to assist with quiz creation, planning, and answering any questions you have. Even if the quiz generation service is temporarily unavailable, I can still help you plan quizzes and answer questions about quiz creation.\r\n\r\nHow can I help you today?`;\n        }\n        this.addChatMessage({\n            type: \"agent\",\n            content: response,\n            metadata: {\n                agentId: agentId,\n                status: \"completed\"\n            }\n        });\n        return {\n            success: true,\n            response,\n            agent: {\n                name: \"Quiz Agent\"\n            },\n            timestamp: new Date().toISOString()\n        };\n    }\n    /**\r\n   * Start periodic agent discovery\r\n   */ startAgentDiscovery() {\n        // Initial discovery\n        this.discoverAgents();\n        // Periodic discovery every 30 seconds\n        setInterval(()=>{\n            this.discoverAgents();\n        }, 30000);\n    }\n    /**\r\n   * Discover agents in the network using A2A protocol\r\n   */ async discoverAgents(requestData = {}) {\n        const discoveredAgents = [];\n        console.log(\"\\uD83D\\uDD0D Starting A2A agent discovery...\");\n        for (const agentCardUrl of this.knownAgentUrls){\n            try {\n                console.log(`🔍 Discovering agent at ${agentCardUrl}...`);\n                const agentCard = await this.getAgentCard(agentCardUrl);\n                // Extract base URL from agent card URL\n                const baseUrl = agentCardUrl.replace(\"/.well-known/agent-card.json\", \"\");\n                const agentInfo = {\n                    name: agentCard.name || `Agent-${baseUrl.split(\":\").pop()}`,\n                    url: baseUrl,\n                    skills: agentCard.skills?.map((s)=>s.id) || [],\n                    status: \"online\",\n                    lastSeen: new Date(),\n                    capabilities: agentCard.capabilities\n                };\n                this.agents.set(baseUrl, agentInfo);\n                discoveredAgents.push(agentInfo);\n                console.log(`✅ Successfully discovered agent: ${agentInfo.name} at ${baseUrl}`);\n                // Add discovery message to chat\n                this.addChatMessage({\n                    type: \"system\",\n                    content: `Discovered agent: ${agentInfo.name} at ${baseUrl} with ${agentInfo.skills.length} skills`,\n                    metadata: {\n                        agentId: baseUrl,\n                        skillId: agentInfo.skills.join(\",\"),\n                        status: \"discovered\"\n                    }\n                });\n            } catch (error) {\n                console.error(`❌ Failed to discover agent at ${agentCardUrl}:`, error);\n                // Extract base URL from agent card URL\n                const baseUrl = agentCardUrl.replace(\"/.well-known/agent-card.json\", \"\");\n                const agentInfo = {\n                    name: `Unknown Agent (${baseUrl})`,\n                    url: baseUrl,\n                    skills: [],\n                    status: \"offline\",\n                    lastSeen: new Date()\n                };\n                this.agents.set(baseUrl, agentInfo);\n                discoveredAgents.push(agentInfo);\n                // Add failure message to chat\n                this.addChatMessage({\n                    type: \"system\",\n                    content: `Failed to discover agent at ${baseUrl}: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                    metadata: {\n                        agentId: baseUrl,\n                        status: \"offline\"\n                    }\n                });\n            }\n        }\n        console.log(`🎯 Agent discovery completed. Found ${discoveredAgents.length} agents.`);\n        return {\n            agents: discoveredAgents,\n            count: discoveredAgents.length,\n            onlineCount: discoveredAgents.filter((a)=>a.status === \"online\").length,\n            offlineCount: discoveredAgents.filter((a)=>a.status === \"offline\").length,\n            timestamp: new Date().toISOString()\n        };\n    }\n    /**\r\n   * Get agent card from URL using A2A SDK\r\n   */ async getAgentCard(url) {\n        try {\n            // Import A2A client dynamically to avoid SSR issues\n            const { A2AClient } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/@a2a-js\").then(__webpack_require__.bind(__webpack_require__, /*! @a2a-js/sdk/client */ \"(rsc)/./node_modules/@a2a-js/sdk/dist/client/index.js\"));\n            // Create A2A client using fromCardUrl static method\n            const a2aClient = await A2AClient.fromCardUrl(url);\n            // Return the agent card from the client\n            return await a2aClient.getAgentCard();\n        } catch (error) {\n            console.error(\"Failed to get agent card via A2A SDK:\", error);\n            // Fallback to direct fetch if A2A SDK fails\n            const controller = new AbortController();\n            const timeoutId = setTimeout(()=>controller.abort(), 5000);\n            try {\n                const response = await fetch(`${url}/.well-known/agent-card.json`, {\n                    signal: controller.signal\n                });\n                clearTimeout(timeoutId);\n                return response.json();\n            } catch (fetchError) {\n                clearTimeout(timeoutId);\n                throw fetchError;\n            }\n        }\n    }\n    /**\r\n   * Orchestrate complete quiz workflow with chat integration\r\n   *\r\n   * This method coordinates the entire quiz generation process by:\r\n   * 1. Creating a workflow with predefined steps\r\n   * 2. Executing steps in dependency order\r\n   * 3. Providing real-time chat updates throughout the process\r\n   * 4. Handling errors and providing feedback\r\n   *\r\n   * @param requestData - Contains topic, difficulty, and question_count\r\n   * @returns Promise with workflow results and status\r\n   */ async orchestrateQuizWorkflow(requestData) {\n        // Generate unique workflow ID using timestamp for uniqueness\n        const workflowId = `workflow_${Date.now()}`;\n        // Extract and set default values for quiz parameters\n        const { topic, difficulty = \"intermediate\", question_count = 20 } = requestData;\n        try {\n            // Notify chat system that workflow is starting\n            // This provides user feedback and maintains audit trail\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Starting quiz workflow for topic: \"${topic}\"`,\n                metadata: {\n                    workflowId,\n                    status: \"starting\"\n                }\n            });\n            // Define the workflow structure with two sequential steps:\n            // Step 1: Generate quiz questions (backend agent)\n            // Step 2: Display quiz (frontend agent)\n            const workflow = {\n                id: workflowId,\n                name: `Quiz Generation: ${topic}`,\n                steps: [\n                    {\n                        id: \"step_1\",\n                        agentId: \"http://localhost:4001\",\n                        skillId: \"generate-quiz\",\n                        input: {\n                            topic,\n                            difficulty,\n                            question_count\n                        },\n                        status: \"pending\"\n                    },\n                    {\n                        id: \"step_2\",\n                        agentId: \"http://localhost:3000\",\n                        skillId: \"display_quiz\",\n                        input: {},\n                        dependencies: [\n                            \"step_1\"\n                        ],\n                        status: \"pending\"\n                    }\n                ],\n                status: \"running\",\n                createdAt: new Date()\n            };\n            // Store workflow in memory for tracking and management\n            this.workflows.set(workflowId, workflow);\n            // Execute the workflow steps in dependency order with chat integration\n            // This method handles step execution, dependency checking, and chat updates\n            const result = await this.executeWorkflowWithChat(workflowId);\n            // Notify chat system of successful completion\n            // Provides user feedback on the number of questions generated\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Quiz workflow completed successfully! Generated ${result.length} questions.`,\n                metadata: {\n                    workflowId,\n                    status: \"completed\"\n                }\n            });\n            // Return structured response with workflow details\n            return {\n                workflow_id: workflowId,\n                status: \"completed\",\n                result: result,\n                timestamp: new Date().toISOString()\n            };\n        } catch (error) {\n            // Log error for debugging purposes\n            console.error(\"Workflow orchestration failed:\", error);\n            // Notify chat system of workflow failure\n            // Provides user feedback on what went wrong\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Workflow failed: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                metadata: {\n                    workflowId,\n                    status: \"failed\"\n                }\n            });\n            // Re-throw error to be handled by calling code\n            throw error;\n        }\n    }\n    /**\r\n   * Orchestrate manual generation workflow\r\n   */ async orchestrateManualWorkflow(requestData) {\n        // Generate unique workflow ID using timestamp for uniqueness\n        const workflowId = `manual_workflow_${Date.now()}`;\n        // Extract and set default values for manual parameters\n        const { topic, prompt = \"\" } = requestData;\n        try {\n            // Notify chat system that workflow is starting\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Starting manual workflow for topic: \"${topic}\"`,\n                metadata: {\n                    workflowId,\n                    status: \"starting\"\n                }\n            });\n            // Use DeepSeek API directly for manual generation\n            const manual = await this.generateManualWithDeepSeek(topic, prompt);\n            // Notify chat system of successful completion\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Manual workflow completed successfully! Generated comprehensive manual for \"${topic}\".`,\n                metadata: {\n                    workflowId,\n                    status: \"completed\"\n                }\n            });\n            // Return structured response with workflow details\n            return {\n                workflow_id: workflowId,\n                status: \"completed\",\n                result: {\n                    data: manual\n                },\n                timestamp: new Date().toISOString()\n            };\n        } catch (error) {\n            // Log error for debugging purposes\n            console.error(\"Manual workflow orchestration failed:\", error);\n            // Notify chat system of workflow failure\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Manual workflow failed: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                metadata: {\n                    workflowId,\n                    status: \"failed\"\n                }\n            });\n            // Re-throw error to be handled by calling code\n            throw error;\n        }\n    }\n    /**\r\n   * Call the actual manual-creator-agent using A2A protocol\r\n   */ async callManualCreatorAgent(topic, prompt) {\n        try {\n            console.log(`📚 Calling manual-creator-agent for topic: ${topic}`);\n            // Call the manual-creator-agent directly\n            const response = await fetch(\"http://localhost:4002/api/actions/generate-manual\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    topic: topic,\n                    prompt: prompt\n                })\n            });\n            if (!response.ok) {\n                throw new Error(`Manual creator agent responded with status: ${response.status}`);\n            }\n            const result = await response.json();\n            console.log(\"Manual creator agent response:\", result);\n            // Extract the manual data from the response\n            if (result.data && result.data.content) {\n                // The response contains markdown content, parse it\n                const markdownContent = result.data.content;\n                // Extract title from markdown\n                const titleMatch = markdownContent.match(/^# (.+)$/m);\n                const title = titleMatch ? titleMatch[1] : `Manual: ${topic}`;\n                // Extract introduction\n                const introMatch = markdownContent.match(/## Introduction\\n([\\s\\S]*?)(?=\\n## |\\n### |$)/);\n                const introduction = introMatch ? introMatch[1].trim() : `This manual provides comprehensive information about ${topic}`;\n                // Extract sections\n                const sections = [];\n                const sectionRegex = /### Section \\d+: ([^\\n]+)\\n([\\s\\S]*?)(?=\\n### Section |\\n## |$)/g;\n                let sectionMatch;\n                while((sectionMatch = sectionRegex.exec(markdownContent)) !== null){\n                    const sectionTitle = sectionMatch[1].trim();\n                    const sectionContent = sectionMatch[2].trim();\n                    // Extract subsections if any\n                    const subsections = [];\n                    const subsectionRegex = /\\*\\*([^*]+):\\*\\*([^*]+)/g;\n                    let subsectionMatch;\n                    while((subsectionMatch = subsectionRegex.exec(sectionContent)) !== null){\n                        subsections.push({\n                            title: subsectionMatch[1].trim(),\n                            content: subsectionMatch[2].trim()\n                        });\n                    }\n                    sections.push({\n                        title: sectionTitle,\n                        content: sectionContent,\n                        subsections: subsections\n                    });\n                }\n                // Extract conclusion\n                const conclusionMatch = markdownContent.match(/## Collaborative Review\\n([\\s\\S]*?)(?=\\n---|\\*|$)/);\n                const conclusion = conclusionMatch ? conclusionMatch[1].trim() : `This manual has provided comprehensive coverage of ${topic}.`;\n                // Extract glossary and references\n                const glossaryMatch = markdownContent.match(/\\*\\*Glossary:\\*\\*\\n([\\s\\S]*?)(?=\\n\\*\\*References:\\*\\*|$)/);\n                const referencesMatch = markdownContent.match(/\\*\\*References:\\*\\*\\n([\\s\\S]*?)(?=\\n---|\\*|$)/);\n                return {\n                    title: title,\n                    introduction: {\n                        purpose: introduction,\n                        audience: \"General users\",\n                        prerequisites: \"Basic understanding of the topic\"\n                    },\n                    sections: sections.length > 0 ? sections : [\n                        {\n                            title: \"Overview\",\n                            content: `This section provides an overview of ${topic}.`,\n                            subsections: []\n                        },\n                        {\n                            title: \"Getting Started\",\n                            content: `This section covers the basics of ${topic}.`,\n                            subsections: []\n                        },\n                        {\n                            title: \"Advanced Topics\",\n                            content: `This section covers advanced concepts related to ${topic}.`,\n                            subsections: []\n                        }\n                    ],\n                    conclusion: conclusion,\n                    appendix: {\n                        glossary: glossaryMatch ? glossaryMatch[1].trim() : \"Key terms and definitions\",\n                        resources: referencesMatch ? referencesMatch[1].trim() : \"Additional resources and references\"\n                    }\n                };\n            } else {\n                throw new Error(\"Invalid response format from manual creator agent\");\n            }\n        } catch (error) {\n            console.error(\"Error calling manual creator agent:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Generate manual using DeepSeek API\r\n   */ async generateManualWithDeepSeek(topic, prompt) {\n        try {\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are an expert technical writer specializing in creating comprehensive manuals and documentation. Create a detailed manual based on the user's request.\r\n\r\nGenerate a comprehensive manual in JSON format:\r\n\r\n{\r\n  \"title\": \"Manual Title\",\r\n  \"introduction\": {\r\n    \"purpose\": \"Purpose of the manual\",\r\n    \"audience\": \"Target audience\",\r\n    \"prerequisites\": \"Required knowledge or skills\"\r\n  },\r\n  \"sections\": [\r\n    {\r\n      \"title\": \"Section Title\",\r\n      \"content\": \"Detailed content for this section\",\r\n      \"subsections\": [\r\n        {\r\n          \"title\": \"Subsection Title\",\r\n          \"content\": \"Subsection content\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"conclusion\": \"Summary and next steps\",\r\n  \"appendix\": {\r\n    \"glossary\": \"Key terms and definitions\",\r\n    \"resources\": \"Additional resources and references\"\r\n  }\r\n}\r\n\r\nREQUIREMENTS:\r\n- Create a comprehensive, well-structured manual\r\n- Include practical examples and step-by-step instructions\r\n- Make content educational and easy to follow\r\n- Organize information logically with clear sections\r\n- Include relevant details and context\r\n- Ensure content is accurate and professional`\n                    },\n                    {\n                        role: \"user\",\n                        content: `Create a comprehensive manual about: ${topic}${prompt ? `\\n\\nAdditional requirements: ${prompt}` : \"\"}`\n                    }\n                ],\n                max_tokens: 4000,\n                temperature: 0.7,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content || \"{}\";\n            try {\n                // First try to parse as JSON directly\n                const manualData = JSON.parse(response);\n                return manualData;\n            } catch (parseError) {\n                console.log(\"JSON parsing failed, trying to extract JSON from markdown:\", parseError);\n                // Try to extract JSON from markdown code blocks\n                const jsonMatch = response.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n                if (jsonMatch) {\n                    try {\n                        const extractedJson = jsonMatch[1].trim();\n                        const manualData = JSON.parse(extractedJson);\n                        return manualData;\n                    } catch (extractError) {\n                        console.log(\"Failed to parse extracted JSON:\", extractError);\n                    }\n                }\n                // Try to extract JSON without code block markers\n                const jsonStart = response.indexOf(\"{\");\n                const jsonEnd = response.lastIndexOf(\"}\");\n                if (jsonStart !== -1 && jsonEnd !== -1 && jsonEnd > jsonStart) {\n                    try {\n                        const jsonString = response.substring(jsonStart, jsonEnd + 1);\n                        const manualData = JSON.parse(jsonString);\n                        return manualData;\n                    } catch (extractError) {\n                        console.log(\"Failed to parse extracted JSON string:\", extractError);\n                    }\n                }\n                console.log(\"All JSON extraction attempts failed, processing as markdown content\");\n                // If JSON parsing fails, process the markdown content\n                const markdownContent = response;\n                // Extract title from markdown\n                const titleMatch = markdownContent.match(/^# (.+)$/m);\n                const title = titleMatch ? titleMatch[1] : `Manual: ${topic}`;\n                // Extract introduction\n                const introMatch = markdownContent.match(/## Introduction\\n([\\s\\S]*?)(?=\\n## |\\n### |$)/);\n                const introduction = introMatch ? introMatch[1].trim() : `This manual provides comprehensive information about ${topic}`;\n                // Extract sections\n                const sections = [];\n                const sectionRegex = /### Section \\d+: ([^\\n]+)\\n([\\s\\S]*?)(?=\\n### Section |\\n## |$)/g;\n                let sectionMatch;\n                while((sectionMatch = sectionRegex.exec(markdownContent)) !== null){\n                    const sectionTitle = sectionMatch[1].trim();\n                    const sectionContent = sectionMatch[2].trim();\n                    // Extract subsections if any\n                    const subsections = [];\n                    const subsectionRegex = /\\*\\*([^*]+):\\*\\*([^*]+)/g;\n                    let subsectionMatch;\n                    while((subsectionMatch = subsectionRegex.exec(sectionContent)) !== null){\n                        subsections.push({\n                            title: subsectionMatch[1].trim(),\n                            content: subsectionMatch[2].trim()\n                        });\n                    }\n                    sections.push({\n                        title: sectionTitle,\n                        content: sectionContent,\n                        subsections: subsections\n                    });\n                }\n                // Extract conclusion\n                const conclusionMatch = markdownContent.match(/## Collaborative Review\\n([\\s\\S]*?)(?=\\n---|\\*|$)/);\n                const conclusion = conclusionMatch ? conclusionMatch[1].trim() : `This manual has provided comprehensive coverage of ${topic}.`;\n                // Extract glossary and references\n                const glossaryMatch = markdownContent.match(/\\*\\*Glossary:\\*\\*\\n([\\s\\S]*?)(?=\\n\\*\\*References:\\*\\*|$)/);\n                const referencesMatch = markdownContent.match(/\\*\\*References:\\*\\*\\n([\\s\\S]*?)(?=\\n---|\\*|$)/);\n                return {\n                    title: title,\n                    introduction: {\n                        purpose: introduction,\n                        audience: \"General users\",\n                        prerequisites: \"Basic understanding of the topic\"\n                    },\n                    sections: sections.length > 0 ? sections : [\n                        {\n                            title: \"Overview\",\n                            content: `This section provides an overview of ${topic}.`,\n                            subsections: []\n                        },\n                        {\n                            title: \"Getting Started\",\n                            content: `This section covers the basics of ${topic}.`,\n                            subsections: []\n                        },\n                        {\n                            title: \"Advanced Topics\",\n                            content: `This section covers advanced concepts related to ${topic}.`,\n                            subsections: []\n                        }\n                    ],\n                    conclusion: conclusion,\n                    appendix: {\n                        glossary: glossaryMatch ? glossaryMatch[1].trim() : \"Key terms and definitions\",\n                        resources: referencesMatch ? referencesMatch[1].trim() : \"Additional resources and references\"\n                    }\n                };\n            }\n        } catch (error) {\n            console.error(\"DeepSeek manual generation error:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Execute workflow with chat integration\r\n   */ async executeWorkflowWithChat(workflowId) {\n        const workflow = this.workflows.get(workflowId);\n        if (!workflow) {\n            throw new Error(`Workflow ${workflowId} not found`);\n        }\n        const results = [];\n        for (const step of workflow.steps){\n            try {\n                // Add step start message to chat\n                this.addChatMessage({\n                    type: \"orchestrator\",\n                    content: `Executing step: ${step.skillId} on ${step.agentId}`,\n                    metadata: {\n                        workflowId,\n                        agentId: step.agentId,\n                        skillId: step.skillId,\n                        status: \"running\"\n                    }\n                });\n                // Check dependencies\n                if (step.dependencies) {\n                    const dependencyResults = step.dependencies.map((depId)=>{\n                        const depStep = workflow.steps.find((s)=>s.id === depId);\n                        return depStep?.result;\n                    });\n                    if (dependencyResults.some((r)=>!r)) {\n                        throw new Error(`Dependencies not met for step ${step.id}`);\n                    }\n                }\n                // Execute step\n                step.status = \"running\";\n                const result = await this.executeStep(step);\n                step.result = result;\n                step.status = \"completed\";\n                results.push(result);\n                // Add step completion message to chat\n                this.addChatMessage({\n                    type: \"agent\",\n                    content: `Step completed: ${step.skillId}`,\n                    metadata: {\n                        workflowId,\n                        agentId: step.agentId,\n                        skillId: step.skillId,\n                        status: \"completed\"\n                    }\n                });\n            } catch (error) {\n                step.status = \"failed\";\n                workflow.status = \"failed\";\n                // Add step failure message to chat\n                this.addChatMessage({\n                    type: \"agent\",\n                    content: `Step failed: ${step.skillId} - ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                    metadata: {\n                        workflowId,\n                        agentId: step.agentId,\n                        skillId: step.skillId,\n                        status: \"failed\"\n                    }\n                });\n                throw error;\n            }\n        }\n        workflow.status = \"completed\";\n        workflow.completedAt = new Date();\n        return results;\n    }\n    /**\r\n   * Execute a single workflow step using real A2A SDK with enhanced error handling\r\n   */ async executeStep(step) {\n        const agent = this.agents.get(step.agentId);\n        if (!agent) {\n            throw new Error(`Agent ${step.agentId} not found`);\n        }\n        try {\n            console.log(`🔄 Executing step ${step.id} on agent ${step.agentId}`);\n            // Use direct HTTP call instead of A2A SDK to avoid agent card fetching issues\n            const message = {\n                messageId: (0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(),\n                parts: [\n                    {\n                        kind: \"text\",\n                        text: step.input.topic || JSON.stringify({\n                            skillId: step.skillId,\n                            input: step.input\n                        })\n                    }\n                ]\n            };\n            // Send direct HTTP request to backend agent\n            const response = await fetch(`${step.agentId}/a2a/tasks`, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    message: message,\n                    configuration: {\n                        blocking: true\n                    }\n                })\n            });\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status}`);\n            }\n            const result = await response.json();\n            console.log(`A2A response for step ${step.id}:`, result);\n            // Handle the response - the backend agent returns the quiz data directly\n            if (result && typeof result === \"object\") {\n                // Extract quiz data from the response\n                let quizData = null;\n                if (result.task && result.task.artifacts) {\n                    // If response has task with artifacts, extract quiz from artifacts\n                    const quizArtifact = result.task.artifacts.find((artifact)=>artifact.name === \"quiz.json\" || artifact.name === \"quiz\");\n                    if (quizArtifact && quizArtifact.parts) {\n                        const quizText = quizArtifact.parts.find((part)=>part.kind === \"text\")?.text;\n                        if (quizText) {\n                            quizData = JSON.parse(quizText);\n                        }\n                    }\n                } else if (result.data) {\n                    // If response has data directly\n                    quizData = result.data;\n                } else if (result.quiz_questions) {\n                    // If response has quiz_questions directly\n                    quizData = result;\n                }\n                if (quizData && quizData.quiz_questions) {\n                    console.log(`✅ Step ${step.id} completed successfully with ${quizData.quiz_questions.length} questions`);\n                    return quizData.quiz_questions;\n                } else {\n                    console.log(`⚠️ Step ${step.id} completed but no quiz data found in response`);\n                    return [];\n                }\n            } else {\n                console.log(`⚠️ Step ${step.id} completed with unexpected response format`);\n                return [];\n            }\n        } catch (error) {\n            console.error(`A2A task execution failed for step ${step.id}:`, error);\n            throw new Error(`A2A agent call failed for step ${step.id}: ${error instanceof Error ? error.message : \"Unknown error\"}`);\n        }\n    }\n    /**\r\n   * Enhanced system health monitoring with circuit breaker status\r\n   */ async monitorSystemHealth(requestData) {\n        const healthChecks = [];\n        const enhancedAgents = this.enhancedAgentSelector.getAllAgents();\n        // Check enhanced agents\n        for (const agent of enhancedAgents){\n            const breakerStatus = this.circuitBreaker.getStatus(agent.id);\n            healthChecks.push({\n                agent: agent.name,\n                url: agent.url,\n                status: agent.status,\n                load: agent.load,\n                reliability: agent.reliability,\n                responseTime: agent.responseTime,\n                circuitBreaker: breakerStatus,\n                lastSeen: agent.lastSeen\n            });\n        }\n        // Check legacy agents\n        const agentEntries = Array.from(this.agents.entries());\n        for(let i = 0; i < agentEntries.length; i++){\n            const [url, agent] = agentEntries[i];\n            // Skip if already checked in enhanced agents\n            if (enhancedAgents.some((ea)=>ea.url === url)) continue;\n            try {\n                const controller = new AbortController();\n                const timeoutId = setTimeout(()=>controller.abort(), 3000);\n                const response = await fetch(`${url}/health`, {\n                    signal: controller.signal\n                });\n                clearTimeout(timeoutId);\n                healthChecks.push({\n                    agent: agent.name,\n                    url: url,\n                    status: \"healthy\",\n                    response_time: response.headers.get(\"x-response-time\") || \"unknown\",\n                    circuitBreaker: null\n                });\n            } catch (error) {\n                healthChecks.push({\n                    agent: agent.name,\n                    url: url,\n                    status: \"unhealthy\",\n                    error: error instanceof Error ? error.message : \"Unknown error\",\n                    circuitBreaker: null\n                });\n            }\n        }\n        const overallHealth = healthChecks.every((h)=>h.status === \"healthy\") ? \"healthy\" : \"degraded\";\n        return {\n            overall_health: overallHealth,\n            agents: healthChecks,\n            circuitBreakers: this.circuitBreaker.getAllStates(),\n            enhanced_metrics: {\n                totalAgents: enhancedAgents.length,\n                onlineAgents: enhancedAgents.filter((a)=>a.status === \"online\").length,\n                averageReliability: enhancedAgents.reduce((sum, a)=>sum + a.reliability, 0) / enhancedAgents.length,\n                averageResponseTime: enhancedAgents.reduce((sum, a)=>sum + a.responseTime, 0) / enhancedAgents.length\n            },\n            timestamp: new Date().toISOString()\n        };\n    }\n    /**\r\n   * Add message to chat history\r\n   */ addChatMessage(message) {\n        const chatMessage = {\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(),\n            timestamp: new Date(),\n            ...message\n        };\n        this.chatHistory.push(chatMessage);\n        return chatMessage;\n    }\n    /**\r\n   * Get chat history\r\n   */ getChatHistory() {\n        return this.chatHistory;\n    }\n    /**\r\n   * Get chat history for a specific workflow\r\n   */ getWorkflowChatHistory(workflowId) {\n        return this.chatHistory.filter((msg)=>msg.metadata?.workflowId === workflowId);\n    }\n    /**\r\n   * Clear chat history\r\n   */ clearChatHistory() {\n        this.chatHistory = [];\n    }\n    /**\r\n   * Get all workflows\r\n   */ getAllWorkflows() {\n        return Array.from(this.workflows.values());\n    }\n    /**\r\n   * Get workflow by ID\r\n   */ getWorkflow(workflowId) {\n        return this.workflows.get(workflowId);\n    }\n    /**\r\n   * Get all agents\r\n   */ getAllAgents() {\n        return Array.from(this.agents.values());\n    }\n    /**\r\n   * Get agent by URL\r\n   */ getAgent(url) {\n        return this.agents.get(url);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUU7UUFDN0QsTUFBTWtKLGNBQTJCO1lBQy9CMVMsSUFBSXpCLGdEQUFNQTtZQUNWNE0sV0FBVyxJQUFJdEs7WUFDZixHQUFHMkksT0FBTztRQUNaO1FBQ0EsSUFBSSxDQUFDdkssV0FBVyxDQUFDb0UsSUFBSSxDQUFDcVA7UUFDdEIsT0FBT0E7SUFDVDtJQUVBOztHQUVDLEdBQ0RuSyxpQkFBZ0M7UUFDOUIsT0FBTyxJQUFJLENBQUN0SixXQUFXO0lBQ3pCO0lBRUE7O0dBRUMsR0FDRDBULHVCQUF1QjNGLFVBQWtCLEVBQWlCO1FBQ3hELE9BQU8sSUFBSSxDQUFDL04sV0FBVyxDQUFDMEQsTUFBTSxDQUM1QixDQUFDcUksTUFBUUEsSUFBSS9JLFFBQVEsRUFBRStLLGVBQWVBO0lBRTFDO0lBRUE7O0dBRUMsR0FDRDRGLG1CQUFtQjtRQUNqQixJQUFJLENBQUMzVCxXQUFXLEdBQUcsRUFBRTtJQUN2QjtJQUVBOztHQUVDLEdBQ0Q0VCxrQkFBOEI7UUFDNUIsT0FBT3RQLE1BQU1DLElBQUksQ0FBQyxJQUFJLENBQUN4RSxTQUFTLENBQUN5RSxNQUFNO0lBQ3pDO0lBRUE7O0dBRUMsR0FDRHFQLFlBQVk5RixVQUFrQixFQUF3QjtRQUNwRCxPQUFPLElBQUksQ0FBQ2hPLFNBQVMsQ0FBQ3dHLEdBQUcsQ0FBQ3dIO0lBQzVCO0lBRUE7O0dBRUMsR0FDRGxMLGVBQTRCO1FBQzFCLE9BQU95QixNQUFNQyxJQUFJLENBQUMsSUFBSSxDQUFDMUUsTUFBTSxDQUFDMkUsTUFBTTtJQUN0QztJQUVBOztHQUVDLEdBQ0RzUCxTQUFTN1MsR0FBVyxFQUF5QjtRQUMzQyxPQUFPLElBQUksQ0FBQ3BCLE1BQU0sQ0FBQzBHLEdBQUcsQ0FBQ3RGO0lBQ3pCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6LWZyb250ZW5kLy4vc3JjL2xpYi9vcmNoZXN0cmF0b3JTZXJ2aWNlLnRzP2MyYjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSBcInV1aWRcIjtcclxuaW1wb3J0IHtcclxuICBFbmhhbmNlZEFnZW50U2VsZWN0b3IsXHJcbiAgQWdlbnRQcm9maWxlLFxyXG4gIFF1ZXJ5Q29udGV4dCxcclxufSBmcm9tIFwiLi9lbmhhbmNlZC1hZ2VudC1zZWxlY3RvclwiO1xyXG5pbXBvcnQgeyBBZ2VudENpcmN1aXRCcmVha2VyIH0gZnJvbSBcIi4vY2lyY3VpdC1icmVha2VyXCI7XHJcbmltcG9ydCB7XHJcbiAgRHluYW1pY0FnZW50RGlzY292ZXJ5LFxyXG4gIEFnZW50RGlzY292ZXJ5Q29uZmlnLFxyXG59IGZyb20gXCIuL2R5bmFtaWMtYWdlbnQtZGlzY292ZXJ5XCI7XHJcbmltcG9ydCB7IEVudmlyb25tZW50QWdlbnRNYW5hZ2VyIH0gZnJvbSBcIi4vZW52aXJvbm1lbnQtYWdlbnQtbWFuYWdlclwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBZ2VudEluZm8ge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxuICBza2lsbHM6IHN0cmluZ1tdO1xyXG4gIHN0YXR1czogXCJvbmxpbmVcIiB8IFwib2ZmbGluZVwiIHwgXCJ1bmtub3duXCI7XHJcbiAgbGFzdFNlZW46IERhdGU7XHJcbiAgY2FwYWJpbGl0aWVzPzogYW55O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFdvcmtmbG93U3RlcCB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBhZ2VudElkOiBzdHJpbmc7XHJcbiAgc2tpbGxJZDogc3RyaW5nO1xyXG4gIGlucHV0OiBhbnk7XHJcbiAgZGVwZW5kZW5jaWVzPzogc3RyaW5nW107XHJcbiAgc3RhdHVzOiBcInBlbmRpbmdcIiB8IFwicnVubmluZ1wiIHwgXCJjb21wbGV0ZWRcIiB8IFwiZmFpbGVkXCI7XHJcbiAgcmVzdWx0PzogYW55O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFdvcmtmbG93IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBzdGVwczogV29ya2Zsb3dTdGVwW107XHJcbiAgc3RhdHVzOiBcInBlbmRpbmdcIiB8IFwicnVubmluZ1wiIHwgXCJjb21wbGV0ZWRcIiB8IFwiZmFpbGVkXCI7XHJcbiAgY3JlYXRlZEF0OiBEYXRlO1xyXG4gIGNvbXBsZXRlZEF0PzogRGF0ZTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDaGF0TWVzc2FnZSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICB0eXBlOiBcInVzZXJcIiB8IFwib3JjaGVzdHJhdG9yXCIgfCBcImFnZW50XCIgfCBcInN5c3RlbVwiO1xyXG4gIGNvbnRlbnQ6IHN0cmluZztcclxuICB0aW1lc3RhbXA6IERhdGU7XHJcbiAgbWV0YWRhdGE/OiB7XHJcbiAgICB3b3JrZmxvd0lkPzogc3RyaW5nO1xyXG4gICAgYWdlbnRJZD86IHN0cmluZztcclxuICAgIHNraWxsSWQ/OiBzdHJpbmc7XHJcbiAgICBzdGF0dXM/OiBzdHJpbmc7XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE5leHRKU09yY2hlc3RyYXRvclNlcnZpY2Uge1xyXG4gIHByaXZhdGUgYWdlbnRzOiBNYXA8c3RyaW5nLCBBZ2VudEluZm8+ID0gbmV3IE1hcCgpO1xyXG4gIHByaXZhdGUgd29ya2Zsb3dzOiBNYXA8c3RyaW5nLCBXb3JrZmxvdz4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSBjaGF0SGlzdG9yeTogQ2hhdE1lc3NhZ2VbXSA9IFtdO1xyXG5cclxuICAvLyBMZWdhY3kgaGFyZGNvZGVkIFVSTHMgKGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5KVxyXG4gIHByaXZhdGUga25vd25BZ2VudFVybHM6IHN0cmluZ1tdID0gW1xyXG4gICAgXCJodHRwOi8vbG9jYWxob3N0OjMwMDAvLndlbGwta25vd24vYWdlbnQtY2FyZC5qc29uXCIsIC8vIEZyb250ZW5kIGFnZW50IChzZWxmKVxyXG4gICAgXCJodHRwOi8vbG9jYWxob3N0OjQwMDEvLndlbGwta25vd24vYWdlbnQtY2FyZC5qc29uXCIsIC8vIEJhY2tlbmQgYWdlbnRcclxuICAgIFwiaHR0cDovL2xvY2FsaG9zdDo0MDAyLy53ZWxsLWtub3duL2FnZW50LWNhcmQuanNvblwiLCAvLyBNYW51YWwtY3JlYXRvciBhZ2VudFxyXG4gIF07XHJcblxyXG4gIC8vIEVuaGFuY2VkIGNvbXBvbmVudHNcclxuICBwcml2YXRlIGVuaGFuY2VkQWdlbnRTZWxlY3RvcjogRW5oYW5jZWRBZ2VudFNlbGVjdG9yO1xyXG4gIHByaXZhdGUgY2lyY3VpdEJyZWFrZXI6IEFnZW50Q2lyY3VpdEJyZWFrZXI7XHJcbiAgcHJpdmF0ZSByZXRyeUF0dGVtcHRzOiBudW1iZXIgPSAzO1xyXG4gIHByaXZhdGUgdGltZW91dE1zOiBudW1iZXIgPSAzMDAwMDtcclxuXHJcbiAgLy8gRHluYW1pYyBkaXNjb3ZlcnkgY29tcG9uZW50c1xyXG4gIHByaXZhdGUgZHluYW1pY0Rpc2NvdmVyeTogRHluYW1pY0FnZW50RGlzY292ZXJ5IHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBlbnZpcm9ubWVudE1hbmFnZXI6IEVudmlyb25tZW50QWdlbnRNYW5hZ2VyO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIC8vIEluaXRpYWxpemUgZW5oYW5jZWQgY29tcG9uZW50c1xyXG4gICAgdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3IgPSBuZXcgRW5oYW5jZWRBZ2VudFNlbGVjdG9yKCk7XHJcbiAgICB0aGlzLmNpcmN1aXRCcmVha2VyID0gbmV3IEFnZW50Q2lyY3VpdEJyZWFrZXIoKTtcclxuXHJcbiAgICAvLyBJbml0aWFsaXplIGVudmlyb25tZW50LWJhc2VkIGFnZW50IG1hbmFnZW1lbnRcclxuICAgIGNvbnN0IGVudmlyb25tZW50ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgXCJkZXZlbG9wbWVudFwiO1xyXG4gICAgdGhpcy5lbnZpcm9ubWVudE1hbmFnZXIgPSBuZXcgRW52aXJvbm1lbnRBZ2VudE1hbmFnZXIoZW52aXJvbm1lbnQpO1xyXG5cclxuICAgIHRoaXMuc3RhcnRBZ2VudERpc2NvdmVyeSgpO1xyXG4gICAgdGhpcy5pbml0aWFsaXplVmlydHVhbEFnZW50cygpO1xyXG4gICAgdGhpcy5pbml0aWFsaXplRW5oYW5jZWRBZ2VudHMoKTtcclxuICAgIHRoaXMuaW5pdGlhbGl6ZUR5bmFtaWNEaXNjb3ZlcnkoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemUgZW5oYW5jZWQgYWdlbnQgcHJvZmlsZXMgd2l0aCBjYXBhYmlsaXRpZXNcclxuICAgKi9cclxuICBwcml2YXRlIGluaXRpYWxpemVFbmhhbmNlZEFnZW50cygpOiB2b2lkIHtcclxuICAgIC8vIEJhY2tlbmQgUXVpeiBBZ2VudFxyXG4gICAgY29uc3QgYmFja2VuZEFnZW50OiBBZ2VudFByb2ZpbGUgPSB7XHJcbiAgICAgIGlkOiBcImJhY2tlbmQtcXVpei1hZ2VudFwiLFxyXG4gICAgICBuYW1lOiBcIlF1aXogR2VuZXJhdGlvbiBBZ2VudFwiLFxyXG4gICAgICB1cmw6IFwiaHR0cDovL2xvY2FsaG9zdDo0MDAxXCIsXHJcbiAgICAgIGNhcGFiaWxpdGllczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiBcInF1aXotZ2VuZXJhdGlvblwiLFxyXG4gICAgICAgICAgbmFtZTogXCJHZW5lcmF0ZSBRdWl6IFF1ZXN0aW9uc1wiLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiQ3JlYXRlcyBxdWl6IHF1ZXN0aW9ucyBvbiBhbnkgdG9waWNcIixcclxuICAgICAgICAgIGtleXdvcmRzOiBbXHJcbiAgICAgICAgICAgIFwicXVpelwiLFxyXG4gICAgICAgICAgICBcInF1ZXN0aW9uXCIsXHJcbiAgICAgICAgICAgIFwidGVzdFwiLFxyXG4gICAgICAgICAgICBcImV4YW1cIixcclxuICAgICAgICAgICAgXCJhc3Nlc3NtZW50XCIsXHJcbiAgICAgICAgICAgIFwibXVsdGlwbGUgY2hvaWNlXCIsXHJcbiAgICAgICAgICAgIFwiZ2VuZXJhdGVcIixcclxuICAgICAgICAgICAgXCJjcmVhdGVcIixcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjk1LFxyXG4gICAgICAgICAgcmVxdWlyZW1lbnRzOiBbXCJvcGVuYWktYXBpXCJdLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6IFwiY29udGVudC1hbmFseXNpc1wiLFxyXG4gICAgICAgICAgbmFtZTogXCJDb250ZW50IEFuYWx5c2lzXCIsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBbmFseXplcyBhbmQgcHJvY2Vzc2VzIGVkdWNhdGlvbmFsIGNvbnRlbnRcIixcclxuICAgICAgICAgIGtleXdvcmRzOiBbXHJcbiAgICAgICAgICAgIFwiYW5hbHl6ZVwiLFxyXG4gICAgICAgICAgICBcImNvbnRlbnRcIixcclxuICAgICAgICAgICAgXCJlZHVjYXRpb25hbFwiLFxyXG4gICAgICAgICAgICBcIm1hdGVyaWFsXCIsXHJcbiAgICAgICAgICAgIFwicHJvY2Vzc1wiLFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIGNvbmZpZGVuY2U6IDAuODUsXHJcbiAgICAgICAgfSxcclxuICAgICAgXSxcclxuICAgICAgc3RhdHVzOiBcIm9ubGluZVwiLFxyXG4gICAgICBsb2FkOiAwLjAsXHJcbiAgICAgIHJlc3BvbnNlVGltZTogMjAwMCxcclxuICAgICAgcmVsaWFiaWxpdHk6IDAuOTUsXHJcbiAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBGcm9udGVuZCBBZ2VudFxyXG4gICAgY29uc3QgZnJvbnRlbmRBZ2VudDogQWdlbnRQcm9maWxlID0ge1xyXG4gICAgICBpZDogXCJmcm9udGVuZC1hZ2VudFwiLFxyXG4gICAgICBuYW1lOiBcIkZyb250ZW5kIE9yY2hlc3RyYXRpb24gQWdlbnRcIixcclxuICAgICAgdXJsOiBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiLFxyXG4gICAgICBjYXBhYmlsaXRpZXM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogXCJ1aS1vcmNoZXN0cmF0aW9uXCIsXHJcbiAgICAgICAgICBuYW1lOiBcIlVJIE9yY2hlc3RyYXRpb25cIixcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk1hbmFnZXMgdXNlciBpbnRlcmZhY2UgYW5kIHdvcmtmbG93IGNvb3JkaW5hdGlvblwiLFxyXG4gICAgICAgICAga2V5d29yZHM6IFtcclxuICAgICAgICAgICAgXCJ3b3JrZmxvd1wiLFxyXG4gICAgICAgICAgICBcIm9yY2hlc3RyYXRlXCIsXHJcbiAgICAgICAgICAgIFwiY29vcmRpbmF0ZVwiLFxyXG4gICAgICAgICAgICBcIm1hbmFnZVwiLFxyXG4gICAgICAgICAgICBcInVpXCIsXHJcbiAgICAgICAgICAgIFwiaW50ZXJmYWNlXCIsXHJcbiAgICAgICAgICAgIFwiZGlzcGxheVwiLFxyXG4gICAgICAgICAgICBcInJlbmRlclwiLFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICAgIGNvbmZpZGVuY2U6IDAuOSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiBcInF1aXotZGlzcGxheVwiLFxyXG4gICAgICAgICAgbmFtZTogXCJRdWl6IERpc3BsYXlcIixcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlbmRlcnMgYW5kIG1hbmFnZXMgcXVpeiBpbnRlcmZhY2VzXCIsXHJcbiAgICAgICAgICBrZXl3b3JkczogW1wiZGlzcGxheVwiLCBcInJlbmRlclwiLCBcInNob3dcIiwgXCJwcmVzZW50XCIsIFwicXVpeiBpbnRlcmZhY2VcIl0sXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjg4LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF0sXHJcbiAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgbG9hZDogMC4wLFxyXG4gICAgICByZXNwb25zZVRpbWU6IDUwMCxcclxuICAgICAgcmVsaWFiaWxpdHk6IDAuOTgsXHJcbiAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBWaXJ0dWFsIE1DUCBBZ2VudFxyXG4gICAgY29uc3QgbWNwQWdlbnQ6IEFnZW50UHJvZmlsZSA9IHtcclxuICAgICAgaWQ6IFwidmlydHVhbC1tY3AtYWdlbnRcIixcclxuICAgICAgbmFtZTogXCJHZW5lcmFsIE1DUCBBZ2VudFwiLFxyXG4gICAgICB1cmw6IFwidmlydHVhbDovL25vcm1hbC1tY3AtYWdlbnRcIixcclxuICAgICAgY2FwYWJpbGl0aWVzOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6IFwiZ2VuZXJhbC1jb252ZXJzYXRpb25cIixcclxuICAgICAgICAgIG5hbWU6IFwiR2VuZXJhbCBDb252ZXJzYXRpb25cIixcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkhhbmRsZXMgZ2VuZXJhbCBxdWVyaWVzIGFuZCBjb252ZXJzYXRpb25zXCIsXHJcbiAgICAgICAgICBrZXl3b3JkczogW1xyXG4gICAgICAgICAgICBcImhlbHBcIixcclxuICAgICAgICAgICAgXCJleHBsYWluXCIsXHJcbiAgICAgICAgICAgIFwiZ2VuZXJhbFwiLFxyXG4gICAgICAgICAgICBcImNvbnZlcnNhdGlvblwiLFxyXG4gICAgICAgICAgICBcImNoYXRcIixcclxuICAgICAgICAgICAgXCJhc3Npc3RcIixcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjgsXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogXCJpbmZvcm1hdGlvbi1yZXRyaWV2YWxcIixcclxuICAgICAgICAgIG5hbWU6IFwiSW5mb3JtYXRpb24gUmV0cmlldmFsXCIsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXRyaWV2ZXMgYW5kIHByb3ZpZGVzIGluZm9ybWF0aW9uXCIsXHJcbiAgICAgICAgICBrZXl3b3JkczogW1wiaW5mb3JtYXRpb25cIiwgXCJyZXRyaWV2ZVwiLCBcImxvb2t1cFwiLCBcInNlYXJjaFwiLCBcImZpbmRcIl0sXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjc1LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF0sXHJcbiAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgbG9hZDogMC4wLFxyXG4gICAgICByZXNwb25zZVRpbWU6IDEwMDAsXHJcbiAgICAgIHJlbGlhYmlsaXR5OiAwLjksXHJcbiAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBSZWdpc3RlciBhbGwgYWdlbnRzIHdpdGggZW5oYW5jZWQgc2VsZWN0b3JcclxuICAgIHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnJlZ2lzdGVyQWdlbnQoYmFja2VuZEFnZW50KTtcclxuICAgIHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnJlZ2lzdGVyQWdlbnQoZnJvbnRlbmRBZ2VudCk7XHJcbiAgICB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci5yZWdpc3RlckFnZW50KG1jcEFnZW50KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemUgZHluYW1pYyBhZ2VudCBkaXNjb3ZlcnkgYmFzZWQgb24gZW52aXJvbm1lbnRcclxuICAgKi9cclxuICBwcml2YXRlIGluaXRpYWxpemVEeW5hbWljRGlzY292ZXJ5KCk6IHZvaWQge1xyXG4gICAgY29uc3QgZGlzY292ZXJ5TWV0aG9kID0gcHJvY2Vzcy5lbnYuQUdFTlRfRElTQ09WRVJZX01FVEhPRCB8fCBcImVudmlyb25tZW50XCI7XHJcblxyXG4gICAgY29uc3QgZGlzY292ZXJ5Q29uZmlnOiBBZ2VudERpc2NvdmVyeUNvbmZpZyA9IHtcclxuICAgICAgZGlzY292ZXJ5TWV0aG9kOiBkaXNjb3ZlcnlNZXRob2QgYXMgYW55LFxyXG4gICAgICBlbnZpcm9ubWVudDoge1xyXG4gICAgICAgIHByZWZpeDogcHJvY2Vzcy5lbnYuQUdFTlRfUFJFRklYIHx8IFwiUVVJWl9BR0VOVFwiLFxyXG4gICAgICAgIHBvcnRzOiB0aGlzLnBhcnNlUG9ydHMocHJvY2Vzcy5lbnYuQUdFTlRfUE9SVFMgfHwgXCIzMDAwLDQwMDEsNTAwMFwiKSxcclxuICAgICAgICBob3N0czogdGhpcy5wYXJzZUhvc3RzKHByb2Nlc3MuZW52LkFHRU5UX0hPU1RTIHx8IFwibG9jYWxob3N0XCIpLFxyXG4gICAgICB9LFxyXG4gICAgICBtYW51YWw6IHtcclxuICAgICAgICBhZ2VudHM6IHRoaXMuZW52aXJvbm1lbnRNYW5hZ2VyLmdldEFsbEFnZW50cygpLm1hcCgoYWdlbnQpID0+ICh7XHJcbiAgICAgICAgICBpZDogYWdlbnQuaWQsXHJcbiAgICAgICAgICB1cmw6IGFnZW50LnVybCxcclxuICAgICAgICAgIGNhcGFiaWxpdGllczogYWdlbnQuY2FwYWJpbGl0aWVzLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IGFnZW50Lm1ldGFkYXRhLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgfSxcclxuICAgIH07XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5keW5hbWljRGlzY292ZXJ5ID0gbmV3IER5bmFtaWNBZ2VudERpc2NvdmVyeShkaXNjb3ZlcnlDb25maWcpO1xyXG4gICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICBgRHluYW1pYyBhZ2VudCBkaXNjb3ZlcnkgaW5pdGlhbGl6ZWQgd2l0aCBtZXRob2Q6ICR7ZGlzY292ZXJ5TWV0aG9kfWBcclxuICAgICAgKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihcclxuICAgICAgICBcIkZhaWxlZCB0byBpbml0aWFsaXplIGR5bmFtaWMgZGlzY292ZXJ5LCBmYWxsaW5nIGJhY2sgdG8gZW52aXJvbm1lbnQgbWFuYWdlcjpcIixcclxuICAgICAgICBlcnJvclxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUGFyc2UgY29tbWEtc2VwYXJhdGVkIHBvcnRzIHN0cmluZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgcGFyc2VQb3J0cyhwb3J0c1N0cmluZzogc3RyaW5nKTogbnVtYmVyW10ge1xyXG4gICAgcmV0dXJuIHBvcnRzU3RyaW5nXHJcbiAgICAgIC5zcGxpdChcIixcIilcclxuICAgICAgLm1hcCgocG9ydCkgPT4gcGFyc2VJbnQocG9ydC50cmltKCkpKVxyXG4gICAgICAuZmlsdGVyKChwb3J0KSA9PiAhaXNOYU4ocG9ydCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUGFyc2UgY29tbWEtc2VwYXJhdGVkIGhvc3RzIHN0cmluZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgcGFyc2VIb3N0cyhob3N0c1N0cmluZzogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgcmV0dXJuIGhvc3RzU3RyaW5nXHJcbiAgICAgIC5zcGxpdChcIixcIilcclxuICAgICAgLm1hcCgoaG9zdCkgPT4gaG9zdC50cmltKCkpXHJcbiAgICAgIC5maWx0ZXIoKGhvc3QpID0+IGhvc3QubGVuZ3RoID4gMCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbml0aWFsaXplIHZpcnR1YWwgTUNQIGFnZW50cyB0aGF0IGRvbid0IGhhdmUgcGh5c2ljYWwgZW5kcG9pbnRzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplVmlydHVhbEFnZW50cygpIHtcclxuICAgIC8vIEFkZCB0aGUgbm9ybWFsIE1DUCBhZ2VudCBhcyBhIHZpcnR1YWwgYWdlbnRcclxuICAgIGNvbnN0IG5vcm1hbE1DUEFnZW50OiBBZ2VudEluZm8gPSB7XHJcbiAgICAgIG5hbWU6IFwiR2VuZXJhbCBNQ1AgQWdlbnRcIixcclxuICAgICAgdXJsOiBcInZpcnR1YWw6Ly9ub3JtYWwtbWNwLWFnZW50XCIsXHJcbiAgICAgIHNraWxsczogW1xyXG4gICAgICAgIFwiZ2VuZXJhbC1jb252ZXJzYXRpb25cIixcclxuICAgICAgICBcImluZm9ybWF0aW9uLXJldHJpZXZhbFwiLFxyXG4gICAgICAgIFwidGFzay1hc3Npc3RhbmNlXCIsXHJcbiAgICAgIF0sXHJcbiAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXHJcbiAgICAgIGNhcGFiaWxpdGllczoge1xyXG4gICAgICAgIGRlc2NyaXB0aW9uOlxyXG4gICAgICAgICAgXCJIYW5kbGVzIGdlbmVyYWwgcXVlcmllcywgY29udmVyc2F0aW9ucywgYW5kIG5vbi1xdWl6IHJlbGF0ZWQgdGFza3NcIixcclxuICAgICAgICB0eXBlOiBcInZpcnR1YWxcIixcclxuICAgICAgfSxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5hZ2VudHMuc2V0KFwidmlydHVhbDovL25vcm1hbC1tY3AtYWdlbnRcIiwgbm9ybWFsTUNQQWdlbnQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFsbCBhdmFpbGFibGUgYWdlbnRzIChkeW5hbWljICsgbGVnYWN5KVxyXG4gICAqL1xyXG4gIGdldEFsbEF2YWlsYWJsZUFnZW50cygpOiBhbnlbXSB7XHJcbiAgICBjb25zdCBhZ2VudHM6IGFueVtdID0gW107XHJcblxyXG4gICAgLy8gQWRkIGR5bmFtaWNhbGx5IGRpc2NvdmVyZWQgYWdlbnRzXHJcbiAgICBpZiAodGhpcy5keW5hbWljRGlzY292ZXJ5KSB7XHJcbiAgICAgIGFnZW50cy5wdXNoKC4uLnRoaXMuZHluYW1pY0Rpc2NvdmVyeS5nZXRBbGxBZ2VudHMoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIGVudmlyb25tZW50LW1hbmFnZWQgYWdlbnRzXHJcbiAgICBhZ2VudHMucHVzaCguLi50aGlzLmVudmlyb25tZW50TWFuYWdlci5nZXRBbGxBZ2VudHMoKSk7XHJcblxyXG4gICAgLy8gQWRkIGxlZ2FjeSBhZ2VudHMgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuICAgIGNvbnN0IGxlZ2FjeUFnZW50cyA9IEFycmF5LmZyb20odGhpcy5hZ2VudHMudmFsdWVzKCkpO1xyXG4gICAgYWdlbnRzLnB1c2goLi4ubGVnYWN5QWdlbnRzKTtcclxuXHJcbiAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBiYXNlZCBvbiBVUkxcclxuICAgIGNvbnN0IHVuaXF1ZUFnZW50cyA9IGFnZW50cy5maWx0ZXIoXHJcbiAgICAgIChhZ2VudCwgaW5kZXgsIHNlbGYpID0+XHJcbiAgICAgICAgaW5kZXggPT09IHNlbGYuZmluZEluZGV4KChhKSA9PiBhLnVybCA9PT0gYWdlbnQudXJsKVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdW5pcXVlQWdlbnRzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFnZW50cyBieSBjYXBhYmlsaXR5IHdpdGggbG9hZCBiYWxhbmNpbmdcclxuICAgKi9cclxuICBnZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eTogc3RyaW5nKTogYW55W10ge1xyXG4gICAgY29uc3QgYWdlbnRzOiBhbnlbXSA9IFtdO1xyXG5cclxuICAgIC8vIEdldCBmcm9tIGR5bmFtaWMgZGlzY292ZXJ5XHJcbiAgICBpZiAodGhpcy5keW5hbWljRGlzY292ZXJ5KSB7XHJcbiAgICAgIGFnZW50cy5wdXNoKC4uLnRoaXMuZHluYW1pY0Rpc2NvdmVyeS5nZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCBmcm9tIGVudmlyb25tZW50IG1hbmFnZXJcclxuICAgIGFnZW50cy5wdXNoKC4uLnRoaXMuZW52aXJvbm1lbnRNYW5hZ2VyLmdldEFnZW50c0J5Q2FwYWJpbGl0eShjYXBhYmlsaXR5KSk7XHJcblxyXG4gICAgLy8gR2V0IGZyb20gbGVnYWN5IGFnZW50c1xyXG4gICAgY29uc3QgbGVnYWN5QWdlbnRzID0gQXJyYXkuZnJvbSh0aGlzLmFnZW50cy52YWx1ZXMoKSkuZmlsdGVyKChhZ2VudCkgPT5cclxuICAgICAgYWdlbnQuc2tpbGxzPy5pbmNsdWRlcyhjYXBhYmlsaXR5KVxyXG4gICAgKTtcclxuICAgIGFnZW50cy5wdXNoKC4uLmxlZ2FjeUFnZW50cyk7XHJcblxyXG4gICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgYW5kIHJldHVybiBvbmxpbmUgYWdlbnRzIG9ubHlcclxuICAgIGNvbnN0IHVuaXF1ZUFnZW50cyA9IGFnZW50cy5maWx0ZXIoXHJcbiAgICAgIChhZ2VudCwgaW5kZXgsIHNlbGYpID0+XHJcbiAgICAgICAgaW5kZXggPT09IHNlbGYuZmluZEluZGV4KChhKSA9PiBhLnVybCA9PT0gYWdlbnQudXJsKVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdW5pcXVlQWdlbnRzLmZpbHRlcigoYWdlbnQpID0+IGFnZW50LnN0YXR1cyA9PT0gXCJvbmxpbmVcIik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgbG9hZC1iYWxhbmNlZCBhZ2VudCBVUkwgZm9yIGEgY2FwYWJpbGl0eVxyXG4gICAqL1xyXG4gIGdldExvYWRCYWxhbmNlZEFnZW50VXJsKGNhcGFiaWxpdHk6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgLy8gVHJ5IGVudmlyb25tZW50IG1hbmFnZXIgZmlyc3QgKGhhcyBsb2FkIGJhbGFuY2luZylcclxuICAgIGNvbnN0IGVudkFnZW50ID0gdGhpcy5lbnZpcm9ubWVudE1hbmFnZXIuZ2V0TG9hZEJhbGFuY2VkQWdlbnQoY2FwYWJpbGl0eSk7XHJcbiAgICBpZiAoZW52QWdlbnQpIHJldHVybiBlbnZBZ2VudDtcclxuXHJcbiAgICAvLyBGYWxsIGJhY2sgdG8gZHluYW1pYyBkaXNjb3ZlcnlcclxuICAgIGlmICh0aGlzLmR5bmFtaWNEaXNjb3ZlcnkpIHtcclxuICAgICAgY29uc3QgZHluYW1pY0FnZW50cyA9XHJcbiAgICAgICAgdGhpcy5keW5hbWljRGlzY292ZXJ5LmdldEFnZW50c0J5Q2FwYWJpbGl0eShjYXBhYmlsaXR5KTtcclxuICAgICAgaWYgKGR5bmFtaWNBZ2VudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZHluYW1pY0FnZW50cy5sZW5ndGgpO1xyXG4gICAgICAgIHJldHVybiBkeW5hbWljQWdlbnRzW2luZGV4XS51cmw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBGYWxsIGJhY2sgdG8gbGVnYWN5IGhhcmRjb2RlZCBVUkxzXHJcbiAgICBzd2l0Y2ggKGNhcGFiaWxpdHkpIHtcclxuICAgICAgY2FzZSBcInF1aXotZ2VuZXJhdGlvblwiOlxyXG4gICAgICBjYXNlIFwiY29udGVudC1hbmFseXNpc1wiOlxyXG4gICAgICAgIHJldHVybiBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiO1xyXG4gICAgICBjYXNlIFwidWktb3JjaGVzdHJhdGlvblwiOlxyXG4gICAgICBjYXNlIFwicXVpei1kaXNwbGF5XCI6XHJcbiAgICAgICAgcmV0dXJuIFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCI7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgcHJpbWFyeSBhZ2VudCBVUkwgZm9yIGEgY2FwYWJpbGl0eVxyXG4gICAqL1xyXG4gIGdldFByaW1hcnlBZ2VudFVybChjYXBhYmlsaXR5OiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIC8vIFRyeSBlbnZpcm9ubWVudCBtYW5hZ2VyIGZpcnN0XHJcbiAgICBjb25zdCBlbnZBZ2VudCA9IHRoaXMuZW52aXJvbm1lbnRNYW5hZ2VyLmdldFByaW1hcnlBZ2VudChjYXBhYmlsaXR5KTtcclxuICAgIGlmIChlbnZBZ2VudCkgcmV0dXJuIGVudkFnZW50O1xyXG5cclxuICAgIC8vIEZhbGwgYmFjayB0byBkeW5hbWljIGRpc2NvdmVyeVxyXG4gICAgaWYgKHRoaXMuZHluYW1pY0Rpc2NvdmVyeSkge1xyXG4gICAgICBjb25zdCBkeW5hbWljQWdlbnRzID1cclxuICAgICAgICB0aGlzLmR5bmFtaWNEaXNjb3ZlcnkuZ2V0QWdlbnRzQnlDYXBhYmlsaXR5KGNhcGFiaWxpdHkpO1xyXG4gICAgICBpZiAoZHluYW1pY0FnZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGR5bmFtaWNBZ2VudHNbMF0udXJsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmFsbCBiYWNrIHRvIGxlZ2FjeSBoYXJkY29kZWQgVVJMc1xyXG4gICAgc3dpdGNoIChjYXBhYmlsaXR5KSB7XHJcbiAgICAgIGNhc2UgXCJxdWl6LWdlbmVyYXRpb25cIjpcclxuICAgICAgY2FzZSBcImNvbnRlbnQtYW5hbHlzaXNcIjpcclxuICAgICAgICByZXR1cm4gXCJodHRwOi8vbG9jYWxob3N0OjQwMDFcIjtcclxuICAgICAgY2FzZSBcInVpLW9yY2hlc3RyYXRpb25cIjpcclxuICAgICAgY2FzZSBcInF1aXotZGlzcGxheVwiOlxyXG4gICAgICAgIHJldHVybiBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRW5oYW5jZWQgYWdlbnQgc2VsZWN0aW9uIHVzaW5nIHNvcGhpc3RpY2F0ZWQgc2NvcmluZ1xyXG4gICAqL1xyXG4gIGRldGVybWluZUFnZW50Rm9yUXVlcnkoXHJcbiAgICBxdWVyeTogc3RyaW5nLFxyXG4gICAgY29udGV4dD86IFF1ZXJ5Q29udGV4dFxyXG4gICk6IHtcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUgfCBudWxsO1xyXG4gICAgY29uZmlkZW5jZTogbnVtYmVyO1xyXG4gICAgcmVhc29uaW5nOiBzdHJpbmc7XHJcbiAgfSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci5zZWxlY3RBZ2VudChxdWVyeSwgY29udGV4dCk7XHJcblxyXG4gICAgLy8gQWRkIHRvIGNoYXQgaGlzdG9yeSBmb3IgdHJhbnNwYXJlbmN5XHJcbiAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgdHlwZTogXCJzeXN0ZW1cIixcclxuICAgICAgY29udGVudDogYEFnZW50IHNlbGVjdGlvbjogJHtcclxuICAgICAgICByZXN1bHQuYWdlbnQ/Lm5hbWUgfHwgXCJOb25lXCJcclxuICAgICAgfSAoY29uZmlkZW5jZTogJHtyZXN1bHQuY29uZmlkZW5jZS50b0ZpeGVkKDIpfSwgcmVhc29uaW5nOiAke1xyXG4gICAgICAgIHJlc3VsdC5yZWFzb25pbmdcclxuICAgICAgfSlgLFxyXG4gICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgIGFnZW50SWQ6IHJlc3VsdC5hZ2VudD8uaWQsXHJcbiAgICAgICAgc3RhdHVzOiBcInNlbGVjdGlvbl9jb21wbGV0ZVwiLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExlZ2FjeSBtZXRob2QgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuICAgKi9cclxuICBkZXRlcm1pbmVBZ2VudEZvclF1ZXJ5TGVnYWN5KHF1ZXJ5OiBzdHJpbmcpOiBBZ2VudEluZm8gfCBudWxsIHtcclxuICAgIGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICAgIC8vIFF1aXotcmVsYXRlZCBxdWVyaWVzIGdvIHRvIGJhY2tlbmQgYWdlbnRcclxuICAgIGlmIChcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcInF1aXpcIikgfHxcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcInF1ZXN0aW9uXCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJ0ZXN0XCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJleGFtXCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJhc3Nlc3NtZW50XCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtdWx0aXBsZSBjaG9pY2VcIilcclxuICAgICkge1xyXG4gICAgICByZXR1cm4gdGhpcy5hZ2VudHMuZ2V0KFwiaHR0cDovL2xvY2FsaG9zdDo0MDAxXCIpIHx8IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gV29ya2Zsb3cvb3JjaGVzdHJhdGlvbiBxdWVyaWVzIGdvIHRvIGZyb250ZW5kIGFnZW50XHJcbiAgICBpZiAoXHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJ3b3JrZmxvd1wiKSB8fFxyXG4gICAgICBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwib3JjaGVzdHJhdGVcIikgfHxcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcImNvb3JkaW5hdGVcIikgfHxcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcIm1hbmFnZVwiKVxyXG4gICAgKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmFnZW50cy5nZXQoXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIikgfHwgbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBbGwgb3RoZXIgcXVlcmllcyBnbyB0byBub3JtYWwgTUNQIGFnZW50XHJcbiAgICByZXR1cm4gdGhpcy5hZ2VudHMuZ2V0KFwidmlydHVhbDovL25vcm1hbC1tY3AtYWdlbnRcIikgfHwgbnVsbDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEVuaGFuY2VkIGFnZW50IGV4ZWN1dGlvbiB3aXRoIGNpcmN1aXQgYnJlYWtlciBhbmQgcmV0cnkgbG9naWNcclxuICAgKi9cclxuICBhc3luYyBleGVjdXRlQWdlbnRXaXRoUmVzaWxpZW5jZShcclxuICAgIHF1ZXJ5OiBzdHJpbmcsXHJcbiAgICBjb250ZXh0PzogUXVlcnlDb250ZXh0XHJcbiAgKTogUHJvbWlzZTx7XHJcbiAgICBzdWNjZXNzOiBib29sZWFuO1xyXG4gICAgYWdlbnQ6IEFnZW50UHJvZmlsZSB8IG51bGw7XHJcbiAgICByZXN1bHQ/OiBhbnk7XHJcbiAgICBlcnJvcj86IHN0cmluZztcclxuICAgIGZhbGxiYWNrVXNlZD86IGJvb2xlYW47XHJcbiAgICBtZXRyaWNzOiB7XHJcbiAgICAgIHNlbGVjdGlvblRpbWU6IG51bWJlcjtcclxuICAgICAgZXhlY3V0aW9uVGltZTogbnVtYmVyO1xyXG4gICAgICB0b3RhbFRpbWU6IG51bWJlcjtcclxuICAgIH07XHJcbiAgfT4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIGxldCBzZWxlY3Rpb25UaW1lID0gMDtcclxuICAgIGxldCBleGVjdXRpb25UaW1lID0gMDtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBTdGVwIDE6IFNlbGVjdCBwcmltYXJ5IGFnZW50IHVzaW5nIGVuaGFuY2VkIHNlbGVjdG9yXHJcbiAgICAgIGNvbnN0IHNlbGVjdGlvblN0YXJ0ID0gRGF0ZS5ub3coKTtcclxuICAgICAgY29uc3QgeyBhZ2VudCwgY29uZmlkZW5jZSwgcmVhc29uaW5nIH0gPVxyXG4gICAgICAgIHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnNlbGVjdEFnZW50KHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgc2VsZWN0aW9uVGltZSA9IERhdGUubm93KCkgLSBzZWxlY3Rpb25TdGFydDtcclxuXHJcbiAgICAgIGlmICghYWdlbnQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBhZ2VudDogbnVsbCxcclxuICAgICAgICAgIGVycm9yOiBcIk5vIHN1aXRhYmxlIGFnZW50IGZvdW5kXCIsXHJcbiAgICAgICAgICBtZXRyaWNzOiB7XHJcbiAgICAgICAgICAgIHNlbGVjdGlvblRpbWUsXHJcbiAgICAgICAgICAgIGV4ZWN1dGlvblRpbWU6IDAsXHJcbiAgICAgICAgICAgIHRvdGFsVGltZTogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gU3RlcCAyOiBDaGVjayBjaXJjdWl0IGJyZWFrZXJcclxuICAgICAgaWYgKCF0aGlzLmNpcmN1aXRCcmVha2VyLmlzQWdlbnRBdmFpbGFibGUoYWdlbnQuaWQpKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGBBZ2VudCAke2FnZW50LmlkfSBpcyBjaXJjdWl0LWJyb2tlbiwgdHJ5aW5nIGZhbGxiYWNrYCk7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMudHJ5RmFsbGJhY2tFeGVjdXRpb24oXHJcbiAgICAgICAgICBxdWVyeSxcclxuICAgICAgICAgIGNvbnRleHQsXHJcbiAgICAgICAgICBhZ2VudC5pZCxcclxuICAgICAgICAgIHN0YXJ0VGltZSxcclxuICAgICAgICAgIHNlbGVjdGlvblRpbWVcclxuICAgICAgICApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBTdGVwIDM6IEV4ZWN1dGUgd2l0aCByZXRyeSBsb2dpY1xyXG4gICAgICBjb25zdCBleGVjdXRpb25TdGFydCA9IERhdGUubm93KCk7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhSZXRyeShhZ2VudCwgcXVlcnksIGNvbnRleHQpO1xyXG4gICAgICBleGVjdXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIGV4ZWN1dGlvblN0YXJ0O1xyXG5cclxuICAgICAgLy8gUmVjb3JkIHN1Y2Nlc3NcclxuICAgICAgdGhpcy5jaXJjdWl0QnJlYWtlci5yZWNvcmRTdWNjZXNzKGFnZW50LmlkKTtcclxuICAgICAgdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3IudXBkYXRlQWdlbnRNZXRyaWNzKFxyXG4gICAgICAgIGFnZW50LmlkLFxyXG4gICAgICAgIHRydWUsXHJcbiAgICAgICAgZXhlY3V0aW9uVGltZVxyXG4gICAgICApO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGFnZW50LFxyXG4gICAgICAgIHJlc3VsdCxcclxuICAgICAgICBtZXRyaWNzOiB7XHJcbiAgICAgICAgICBzZWxlY3Rpb25UaW1lLFxyXG4gICAgICAgICAgZXhlY3V0aW9uVGltZSxcclxuICAgICAgICAgIHRvdGFsVGltZTogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgICB9LFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgLy8gUmVjb3JkIGZhaWx1cmUgYW5kIHRyeSBmYWxsYmFja1xyXG4gICAgICBjb25zdCBhZ2VudCA9IHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnNlbGVjdEFnZW50KFxyXG4gICAgICAgIHF1ZXJ5LFxyXG4gICAgICAgIGNvbnRleHRcclxuICAgICAgKS5hZ2VudDtcclxuICAgICAgaWYgKGFnZW50KSB7XHJcbiAgICAgICAgdGhpcy5jaXJjdWl0QnJlYWtlci5yZWNvcmRGYWlsdXJlKGFnZW50LmlkKTtcclxuICAgICAgICB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci51cGRhdGVBZ2VudE1ldHJpY3MoXHJcbiAgICAgICAgICBhZ2VudC5pZCxcclxuICAgICAgICAgIGZhbHNlLFxyXG4gICAgICAgICAgZXhlY3V0aW9uVGltZVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnRyeUZhbGxiYWNrRXhlY3V0aW9uKFxyXG4gICAgICAgIHF1ZXJ5LFxyXG4gICAgICAgIGNvbnRleHQsXHJcbiAgICAgICAgYWdlbnQ/LmlkLFxyXG4gICAgICAgIHN0YXJ0VGltZSxcclxuICAgICAgICBzZWxlY3Rpb25UaW1lXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGVjdXRlIGFnZW50IHdpdGggcmV0cnkgbG9naWNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVXaXRoUmV0cnkoXHJcbiAgICBhZ2VudDogQWdlbnRQcm9maWxlLFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ/OiBRdWVyeUNvbnRleHRcclxuICApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgbGV0IGxhc3RFcnJvcjogRXJyb3IgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICBmb3IgKGxldCBhdHRlbXB0ID0gMTsgYXR0ZW1wdCA8PSB0aGlzLnJldHJ5QXR0ZW1wdHM7IGF0dGVtcHQrKykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGlmIChhZ2VudC51cmwuc3RhcnRzV2l0aChcInZpcnR1YWw6Ly9cIikpIHtcclxuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmV4ZWN1dGVWaXJ0dWFsQWdlbnQoYWdlbnQsIHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZVJlYWxBZ2VudChhZ2VudCwgcXVlcnksIGNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBsYXN0RXJyb3IgPSBlcnJvciBhcyBFcnJvcjtcclxuICAgICAgICBjb25zb2xlLndhcm4oYEF0dGVtcHQgJHthdHRlbXB0fSBmYWlsZWQgZm9yIGFnZW50ICR7YWdlbnQuaWR9OmAsIGVycm9yKTtcclxuXHJcbiAgICAgICAgaWYgKGF0dGVtcHQgPCB0aGlzLnJldHJ5QXR0ZW1wdHMpIHtcclxuICAgICAgICAgIC8vIEV4cG9uZW50aWFsIGJhY2tvZmZcclxuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PlxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KHJlc29sdmUsIE1hdGgucG93KDIsIGF0dGVtcHQpICogMTAwMClcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGhyb3cgbGFzdEVycm9yIHx8IG5ldyBFcnJvcihcIkFsbCByZXRyeSBhdHRlbXB0cyBmYWlsZWRcIik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUcnkgZmFsbGJhY2sgYWdlbnRzIGlmIHByaW1hcnkgZmFpbHNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIHRyeUZhbGxiYWNrRXhlY3V0aW9uKFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ6IFF1ZXJ5Q29udGV4dCB8IHVuZGVmaW5lZCxcclxuICAgIGV4Y2x1ZGVBZ2VudElkOiBzdHJpbmcgfCB1bmRlZmluZWQsXHJcbiAgICBzdGFydFRpbWU6IG51bWJlcixcclxuICAgIHNlbGVjdGlvblRpbWU6IG51bWJlclxyXG4gICk6IFByb21pc2U8e1xyXG4gICAgc3VjY2VzczogYm9vbGVhbjtcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUgfCBudWxsO1xyXG4gICAgcmVzdWx0PzogYW55O1xyXG4gICAgZXJyb3I/OiBzdHJpbmc7XHJcbiAgICBmYWxsYmFja1VzZWQ/OiBib29sZWFuO1xyXG4gICAgbWV0cmljczoge1xyXG4gICAgICBzZWxlY3Rpb25UaW1lOiBudW1iZXI7XHJcbiAgICAgIGV4ZWN1dGlvblRpbWU6IG51bWJlcjtcclxuICAgICAgdG90YWxUaW1lOiBudW1iZXI7XHJcbiAgICB9O1xyXG4gIH0+IHtcclxuICAgIGNvbnN0IGZhbGxiYWNrQWdlbnRzID0gdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3IuZ2V0RmFsbGJhY2tBZ2VudHMoXHJcbiAgICAgIHF1ZXJ5LFxyXG4gICAgICBleGNsdWRlQWdlbnRJZFxyXG4gICAgKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGFnZW50IG9mIGZhbGxiYWNrQWdlbnRzKSB7XHJcbiAgICAgIGlmICghdGhpcy5jaXJjdWl0QnJlYWtlci5pc0FnZW50QXZhaWxhYmxlKGFnZW50LmlkKSkgY29udGludWU7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGV4ZWN1dGlvblN0YXJ0ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVXaXRoUmV0cnkoYWdlbnQsIHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgICBjb25zdCBleGVjdXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIGV4ZWN1dGlvblN0YXJ0O1xyXG5cclxuICAgICAgICB0aGlzLmNpcmN1aXRCcmVha2VyLnJlY29yZFN1Y2Nlc3MoYWdlbnQuaWQpO1xyXG4gICAgICAgIHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnVwZGF0ZUFnZW50TWV0cmljcyhcclxuICAgICAgICAgIGFnZW50LmlkLFxyXG4gICAgICAgICAgdHJ1ZSxcclxuICAgICAgICAgIGV4ZWN1dGlvblRpbWVcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgIGFnZW50LFxyXG4gICAgICAgICAgcmVzdWx0LFxyXG4gICAgICAgICAgZmFsbGJhY2tVc2VkOiB0cnVlLFxyXG4gICAgICAgICAgbWV0cmljczoge1xyXG4gICAgICAgICAgICBzZWxlY3Rpb25UaW1lLFxyXG4gICAgICAgICAgICBleGVjdXRpb25UaW1lLFxyXG4gICAgICAgICAgICB0b3RhbFRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH07XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5jaXJjdWl0QnJlYWtlci5yZWNvcmRGYWlsdXJlKGFnZW50LmlkKTtcclxuICAgICAgICBjb25zb2xlLndhcm4oYEZhbGxiYWNrIGFnZW50ICR7YWdlbnQuaWR9IGFsc28gZmFpbGVkOmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBhZ2VudDogbnVsbCxcclxuICAgICAgZXJyb3I6IFwiQWxsIGFnZW50cyBmYWlsZWQsIGluY2x1ZGluZyBmYWxsYmFja3NcIixcclxuICAgICAgbWV0cmljczoge1xyXG4gICAgICAgIHNlbGVjdGlvblRpbWUsXHJcbiAgICAgICAgZXhlY3V0aW9uVGltZTogMCxcclxuICAgICAgICB0b3RhbFRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXhlY3V0ZSB2aXJ0dWFsIGFnZW50IChsaWtlIE1DUClcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVWaXJ0dWFsQWdlbnQoXHJcbiAgICBhZ2VudDogQWdlbnRQcm9maWxlLFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ/OiBRdWVyeUNvbnRleHRcclxuICApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgLy8gVXNlIGV4aXN0aW5nIGhhbmRsZUdlbmVyYWxNQ1BRdWVyeSBsb2dpY1xyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlR2VuZXJhbE1DUFF1ZXJ5KHsgcXVlcnksIGNvbnRleHQgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGVjdXRlIHJlYWwgYWdlbnQgdmlhIEEyQVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVJlYWxBZ2VudChcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUsXHJcbiAgICBxdWVyeTogc3RyaW5nLFxyXG4gICAgY29udGV4dD86IFF1ZXJ5Q29udGV4dFxyXG4gICk6IFByb21pc2U8YW55PiB7XHJcbiAgICAvLyBVc2UgZXhpc3RpbmcgQTJBIGV4ZWN1dGlvbiBsb2dpYyBmcm9tIGV4ZWN1dGVTdGVwXHJcbiAgICBjb25zdCBzdGVwID0ge1xyXG4gICAgICBpZDogXCJlbmhhbmNlZC1zdGVwXCIsXHJcbiAgICAgIGFnZW50SWQ6IGFnZW50LnVybCxcclxuICAgICAgc2tpbGxJZDogXCJlbmhhbmNlZC1leGVjdXRpb25cIixcclxuICAgICAgaW5wdXQ6IHsgcXVlcnksIGNvbnRleHQgfSxcclxuICAgICAgc3RhdHVzOiBcInJ1bm5pbmdcIiBhcyBjb25zdCxcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZVN0ZXAoc3RlcCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBNb3N0IGltcG9ydGFudCBmdW5jdGlvbiBpbiB0aGUgb3JjaGVzdHJhdG9yIHNlcnZpY2VcclxuICAgKiBDZW50cmFsaXplZCBkZWNpc2lvbiBtYWtlciAtIGRldGVybWluZXMgd2hldGhlciB0byByb3V0ZSB0byBCYWNrZW5kIG9yIERlZXBTZWVrXHJcbiAgICovXHJcbiAgYXN5bmMgaGFuZGxlQ2VudHJhbGl6ZWRSZXF1ZXN0KHJlcXVlc3REYXRhOiBhbnkpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgY29uc3QgeyBxdWVyeSwgY29udGV4dCB9ID0gcmVxdWVzdERhdGE7XHJcblxyXG4gICAgLy8gQWRkIHF1ZXJ5IHRvIGNoYXQgaGlzdG9yeVxyXG4gICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgIHR5cGU6IFwidXNlclwiLFxyXG4gICAgICBjb250ZW50OiBxdWVyeSxcclxuICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcInByb2Nlc3NpbmdcIiB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gVXNlIERlZXBTZWVrIEFJIHRvIGNsYXNzaWZ5IHRoZSByZXF1ZXN0XHJcbiAgICAgIGNvbnN0IHJlcXVlc3RUeXBlID0gYXdhaXQgdGhpcy5jbGFzc2lmeVJlcXVlc3RUeXBlKHF1ZXJ5KTtcclxuXHJcbiAgICAgIGlmIChyZXF1ZXN0VHlwZSA9PT0gXCJxdWl6XCIpIHtcclxuICAgICAgICAvLyBSb3V0ZSB0byBCYWNrZW5kIEFnZW50IGZvciBxdWl6IGdlbmVyYXRpb25cclxuICAgICAgICBjb25zb2xlLmxvZyhcIvCfjq8gT3JjaGVzdHJhdG9yIERlY2lzaW9uOiBRdWl6IFJlcXVlc3Qg4oaSIEJhY2tlbmQgQWdlbnRcIik7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucm91dGVUb0JhY2tlbmRBZ2VudChxdWVyeSwgY29udGV4dCk7XHJcbiAgICAgIH0gZWxzZSBpZiAocmVxdWVzdFR5cGUgPT09IFwibWFudWFsXCIpIHtcclxuICAgICAgICAvLyBSb3V0ZSB0byBNYW51YWwgR2VuZXJhdGlvblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgXCLwn5OWIE9yY2hlc3RyYXRvciBEZWNpc2lvbjogTWFudWFsIFJlcXVlc3Qg4oaSIE1hbnVhbCBHZW5lcmF0b3JcIlxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucm91dGVUb01hbnVhbEdlbmVyYXRvcihxdWVyeSwgY29udGV4dCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gUm91dGUgdG8gRGVlcFNlZWsgQVBJIGZvciBnZW5lcmFsIGNoYXRcclxuICAgICAgICBjb25zb2xlLmxvZyhcIvCfkqwgT3JjaGVzdHJhdG9yIERlY2lzaW9uOiBDaGF0IFJlcXVlc3Qg4oaSIERlZXBTZWVrIEFQSVwiKTtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5yb3V0ZVRvRGVlcFNlZWtBUEkocXVlcnksIGNvbnRleHQpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW4gY2VudHJhbGl6ZWQgcmVxdWVzdCBoYW5kbGluZzpcIiwgZXJyb3IpO1xyXG5cclxuICAgICAgLy8gRmFsbGJhY2sgdG8gc2ltcGxlIHBhdHRlcm4gbWF0Y2hpbmdcclxuICAgICAgY29uc3QgbG93ZXJRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgIGNvbnN0IGlzUXVpekZhbGxiYWNrID1cclxuICAgICAgICAobG93ZXJRdWVyeS5pbmNsdWRlcyhcImNyZWF0ZVwiKSAmJiBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwicXVpelwiKSkgfHxcclxuICAgICAgICAobG93ZXJRdWVyeS5pbmNsdWRlcyhcImdlbmVyYXRlXCIpICYmIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJxdWl6XCIpKSB8fFxyXG4gICAgICAgIChsb3dlclF1ZXJ5LmluY2x1ZGVzKFwibWFrZVwiKSAmJiBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwicXVpelwiKSkgfHxcclxuICAgICAgICBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwicXVpeiBhYm91dFwiKSB8fFxyXG4gICAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJxdWl6IG9uXCIpO1xyXG5cclxuICAgICAgY29uc3QgaXNNYW51YWxGYWxsYmFjayA9XHJcbiAgICAgICAgKGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJjcmVhdGVcIikgJiYgbG93ZXJRdWVyeS5pbmNsdWRlcyhcIm1hbnVhbFwiKSkgfHxcclxuICAgICAgICAobG93ZXJRdWVyeS5pbmNsdWRlcyhcImdlbmVyYXRlXCIpICYmIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtYW51YWxcIikpIHx8XHJcbiAgICAgICAgKGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtYWtlXCIpICYmIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtYW51YWxcIikpIHx8XHJcbiAgICAgICAgKGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJ3cml0ZVwiKSAmJiBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwibWFudWFsXCIpKSB8fFxyXG4gICAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtYW51YWwgYWJvdXRcIikgfHxcclxuICAgICAgICBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwibWFudWFsIG9uXCIpIHx8XHJcbiAgICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcImRvY3VtZW50YXRpb24gYWJvdXRcIikgfHxcclxuICAgICAgICBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwiZ3VpZGUgYWJvdXRcIik7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGlmIChpc1F1aXpGYWxsYmFjaykge1xyXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucm91dGVUb0JhY2tlbmRBZ2VudChxdWVyeSwgY29udGV4dCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChpc01hbnVhbEZhbGxiYWNrKSB7XHJcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5yb3V0ZVRvTWFudWFsR2VuZXJhdG9yKHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucm91dGVUb0RlZXBTZWVrQVBJKHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGZhbGxiYWNrRXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFsbGJhY2sgcm91dGluZyBhbHNvIGZhaWxlZDpcIiwgZmFsbGJhY2tFcnJvcik7XHJcblxyXG4gICAgICAgIC8vIFVsdGltYXRlIGZhbGxiYWNrIC0gcmV0dXJuIGEgc2ltcGxlIHJlc3BvbnNlXHJcbiAgICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgICB0eXBlOiBcImFnZW50XCIsXHJcbiAgICAgICAgICBjb250ZW50OlxyXG4gICAgICAgICAgICBcIkkgYXBvbG9naXplLCBidXQgSSdtIGV4cGVyaWVuY2luZyB0ZWNobmljYWwgZGlmZmljdWx0aWVzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyIG9yIHJlcGhyYXNlIHlvdXIgcmVxdWVzdC5cIixcclxuICAgICAgICAgIG1ldGFkYXRhOiB7IGFnZW50SWQ6IFwiZmFsbGJhY2stYWdlbnRcIiwgc3RhdHVzOiBcImVycm9yXCIgfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcclxuICAgICAgICAgIHJlc3BvbnNlOlxyXG4gICAgICAgICAgICBcIkkgYXBvbG9naXplLCBidXQgSSdtIGV4cGVyaWVuY2luZyB0ZWNobmljYWwgZGlmZmljdWx0aWVzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyIG9yIHJlcGhyYXNlIHlvdXIgcmVxdWVzdC5cIixcclxuICAgICAgICAgIGFnZW50SWQ6IFwiZmFsbGJhY2stYWdlbnRcIixcclxuICAgICAgICAgIGNoYXRIaXN0b3J5OiB0aGlzLmdldENoYXRIaXN0b3J5KCksXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xhc3NpZnkgcmVxdWVzdCB0eXBlIHVzaW5nIERlZXBTZWVrIEFJXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBjbGFzc2lmeVJlcXVlc3RUeXBlKFxyXG4gICAgcXVlcnk6IHN0cmluZ1xyXG4gICk6IFByb21pc2U8XCJxdWl6XCIgfCBcIm1hbnVhbFwiIHwgXCJjaGF0XCI+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEltcG9ydCBPcGVuQUkgZHluYW1pY2FsbHlcclxuICAgICAgY29uc3QgT3BlbkFJID0gKGF3YWl0IGltcG9ydChcIm9wZW5haVwiKSkuZGVmYXVsdDtcclxuXHJcbiAgICAgIGNvbnN0IGNsaWVudCA9IG5ldyBPcGVuQUkoe1xyXG4gICAgICAgIGFwaUtleTogXCJzay02Nzk2ZWEwZjM4Yzc0OTlkYmY0N2M3ZmYyYTAyNjk2NlwiLFxyXG4gICAgICAgIGJhc2VVUkw6IFwiaHR0cHM6Ly9hcGkuZGVlcHNlZWsuY29tXCIsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IGNsaWVudC5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgICAgbW9kZWw6IFwiZGVlcHNlZWstY2hhdFwiLFxyXG4gICAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHJvbGU6IFwic3lzdGVtXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IGBZb3UgYXJlIGEgY2xhc3NpZmllciB0aGF0IGRldGVybWluZXMgdGhlIHR5cGUgb2YgdXNlciByZXF1ZXN0LiBSZXR1cm4gT05MWSBvbmUgb2YgdGhlc2UgdGhyZWUgb3B0aW9uczogXCJxdWl6XCIsIFwibWFudWFsXCIsIG9yIFwiY2hhdFwiLlxyXG5cclxuRXhhbXBsZXMgb2YgcXVpeiByZXF1ZXN0czpcclxuLSBcImNyZWF0ZSBhIHF1aXogYWJvdXQgc2NpZW5jZVwiXHJcbi0gXCJnZW5lcmF0ZSBhIHF1aXogb24gaGlzdG9yeVwiXHJcbi0gXCJtYWtlIGEgcXVpeiBmb3IgbWF0aFwiXHJcbi0gXCJxdWl6IGFib3V0IHByb2dyYW1taW5nXCJcclxuLSBcImNyZWF0ZSBxdWVzdGlvbnMgYWJvdXQgYmlvbG9neVwiXHJcblxyXG5FeGFtcGxlcyBvZiBtYW51YWwgcmVxdWVzdHM6XHJcbi0gXCJjcmVhdGUgYSBtYW51YWwgYWJvdXQgUmVhY3RcIlxyXG4tIFwiZ2VuZXJhdGUgZG9jdW1lbnRhdGlvbiBmb3IgUHl0aG9uXCJcclxuLSBcIndyaXRlIGEgZ3VpZGUgYWJvdXQgY29va2luZ1wiXHJcbi0gXCJtYW51YWwgYWJvdXQgSmF2YVNjcmlwdFwiXHJcbi0gXCJkb2N1bWVudGF0aW9uIGFib3V0IG1hY2hpbmUgbGVhcm5pbmdcIlxyXG5cclxuRXhhbXBsZXMgb2YgY2hhdCByZXF1ZXN0czpcclxuLSBcImhlbGxvXCJcclxuLSBcIndoYXQgaXMgcGhvdG9zeW50aGVzaXM/XCJcclxuLSBcImhlbHAgbWUgdW5kZXJzdGFuZCBjYWxjdWx1c1wiXHJcbi0gXCJ0ZWxsIG1lIGFib3V0IHRoZSB3ZWF0aGVyXCJcclxuLSBcImhvdyBhcmUgeW91P1wiYCxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHJvbGU6IFwidXNlclwiLFxyXG4gICAgICAgICAgICBjb250ZW50OiBxdWVyeSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgICBtYXhfdG9rZW5zOiAxMCxcclxuICAgICAgICB0ZW1wZXJhdHVyZTogMC4xLFxyXG4gICAgICAgIHN0cmVhbTogZmFsc2UsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBjb21wbGV0aW9uLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnRcclxuICAgICAgICA/LnRvTG93ZXJDYXNlKClcclxuICAgICAgICAudHJpbSgpO1xyXG5cclxuICAgICAgaWYgKHJlc3BvbnNlID09PSBcInF1aXpcIikgcmV0dXJuIFwicXVpelwiO1xyXG4gICAgICBpZiAocmVzcG9uc2UgPT09IFwibWFudWFsXCIpIHJldHVybiBcIm1hbnVhbFwiO1xyXG4gICAgICByZXR1cm4gXCJjaGF0XCI7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRGVlcFNlZWsgY2xhc3NpZmljYXRpb24gZXJyb3I6XCIsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbGFzc2lmeSByZXF1ZXN0IHVzaW5nIERlZXBTZWVrIEFJIChsZWdhY3kgbWV0aG9kIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5KVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgY2xhc3NpZnlSZXF1ZXN0KHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEltcG9ydCBPcGVuQUkgZHluYW1pY2FsbHlcclxuICAgICAgY29uc3QgT3BlbkFJID0gKGF3YWl0IGltcG9ydChcIm9wZW5haVwiKSkuZGVmYXVsdDtcclxuXHJcbiAgICAgIGNvbnN0IGNsaWVudCA9IG5ldyBPcGVuQUkoe1xyXG4gICAgICAgIGFwaUtleTogXCJzay02Nzk2ZWEwZjM4Yzc0OTlkYmY0N2M3ZmYyYTAyNjk2NlwiLFxyXG4gICAgICAgIGJhc2VVUkw6IFwiaHR0cHM6Ly9hcGkuZGVlcHNlZWsuY29tXCIsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IGNsaWVudC5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgICAgbW9kZWw6IFwiZGVlcHNlZWstY2hhdFwiLFxyXG4gICAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHJvbGU6IFwic3lzdGVtXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IGBZb3UgYXJlIGEgY2xhc3NpZmllciB0aGF0IGRldGVybWluZXMgaWYgYSB1c2VyIG1lc3NhZ2UgaXMgcmVxdWVzdGluZyBxdWl6IGNyZWF0aW9uLlxyXG5cclxuUmV0dXJuIE9OTFkgXCJ0cnVlXCIgb3IgXCJmYWxzZVwiIGJhc2VkIG9uIHdoZXRoZXIgdGhlIHVzZXIgd2FudHMgdG8gY3JlYXRlIGEgcXVpei5cclxuXHJcbkV4YW1wbGVzIG9mIHF1aXogcmVxdWVzdHM6XHJcbi0gXCJjcmVhdGUgYSBxdWl6IGFib3V0IHNjaWVuY2VcIlxyXG4tIFwiZ2VuZXJhdGUgYSBxdWl6IG9uIGhpc3RvcnlcIlxyXG4tIFwibWFrZSBhIHF1aXogZm9yIG1hdGhcIlxyXG4tIFwicXVpeiBhYm91dCBwcm9ncmFtbWluZ1wiXHJcbi0gXCJjcmVhdGUgcXVlc3Rpb25zIGFib3V0IGJpb2xvZ3lcIlxyXG5cclxuRXhhbXBsZXMgb2YgTk9UIHF1aXogcmVxdWVzdHM6XHJcbi0gXCJoZWxsb1wiXHJcbi0gXCJ3aGF0IGlzIHBob3Rvc3ludGhlc2lzP1wiXHJcbi0gXCJoZWxwIG1lIHVuZGVyc3RhbmQgY2FsY3VsdXNcIlxyXG4tIFwidGVsbCBtZSBhYm91dCB0aGUgd2VhdGhlclwiXHJcbi0gXCJob3cgYXJlIHlvdT9cImAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiBcInVzZXJcIixcclxuICAgICAgICAgICAgY29udGVudDogcXVlcnksXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgbWF4X3Rva2VuczogMTAsXHJcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuMSxcclxuICAgICAgICBzdHJlYW06IGZhbHNlLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gY29tcGxldGlvbi5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50XHJcbiAgICAgICAgPy50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgLnRyaW0oKTtcclxuICAgICAgY29uc29sZS5sb2coXCJEZWVwU2VlayBjbGFzc2lmaWNhdGlvbiByZXNwb25zZTpcIiwgcmVzcG9uc2UpO1xyXG4gICAgICByZXR1cm4gcmVzcG9uc2UgPT09IFwidHJ1ZVwiO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkRlZXBTZWVrIGNsYXNzaWZpY2F0aW9uIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUm91dGUgdG8gQmFja2VuZCBBZ2VudCBmb3IgcXVpeiBnZW5lcmF0aW9uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyByb3V0ZVRvQmFja2VuZEFnZW50KHF1ZXJ5OiBzdHJpbmcsIGNvbnRleHQ6IGFueSk6IFByb21pc2U8YW55PiB7XHJcbiAgICAvLyBUZW1wb3JhcmlseSBza2lwIGJhY2tlbmQgYWdlbnQgZHVlIHRvIGNvbXBsZXhpdHkgaXNzdWVzXHJcbiAgICAvLyBHbyBkaXJlY3RseSB0byBEZWVwU2VlayBBUEkgZm9yIHF1aXogZ2VuZXJhdGlvblxyXG4gICAgY29uc29sZS5sb2coXHJcbiAgICAgIFwi8J+UhCBVc2luZyBEZWVwU2VlayBBUEkgZm9yIHF1aXogZ2VuZXJhdGlvbiAoYmFja2VuZCBhZ2VudCB0ZW1wb3JhcmlseSBkaXNhYmxlZCkuLi5cIlxyXG4gICAgKTtcclxuICAgIHJldHVybiBhd2FpdCB0aGlzLnJvdXRlVG9EZWVwU2Vla0FQSUZvclF1aXoocXVlcnksIGNvbnRleHQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUm91dGUgdG8gTWFudWFsIEdlbmVyYXRvclxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgcm91dGVUb01hbnVhbEdlbmVyYXRvcihcclxuICAgIHF1ZXJ5OiBzdHJpbmcsXHJcbiAgICBjb250ZXh0OiBhbnlcclxuICApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gQWRkIHJvdXRpbmcgbWVzc2FnZSB0byBjaGF0XHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgY29udGVudDogYFJvdXRpbmcgbWFudWFsIHJlcXVlc3QgdG8gTWFudWFsIENyZWF0b3IgQWdlbnQuLi5gLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7IHN0YXR1czogXCJyb3V0aW5nXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBVc2UgRGVlcFNlZWsgQVBJIGRpcmVjdGx5IGZvciBtYW51YWwgZ2VuZXJhdGlvbiAobWFudWFsLWNyZWF0b3ItYWdlbnQgaW50ZWdyYXRpb24gcGVuZGluZylcclxuICAgICAgY29uc29sZS5sb2coXCJVc2luZyBEZWVwU2VlayBBUEkgZm9yIG1hbnVhbCBnZW5lcmF0aW9uLi4uXCIpO1xyXG4gICAgICBjb25zdCBtYW51YWwgPSBhd2FpdCB0aGlzLmdlbmVyYXRlTWFudWFsV2l0aERlZXBTZWVrKHF1ZXJ5LCBcIlwiKTtcclxuXHJcbiAgICAgIC8vIEFkZCBjb21wbGV0aW9uIG1lc3NhZ2VcclxuICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICBjb250ZW50OiBgTWFudWFsIGdlbmVyYXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseSFgLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7IHN0YXR1czogXCJjb21wbGV0ZWRcIiB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgdHlwZTogXCJtYW51YWxcIixcclxuICAgICAgICByZXN1bHQ6IHtcclxuICAgICAgICAgIGRhdGE6IG1hbnVhbCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFnZW50SWQ6IFwibWFudWFsLWdlbmVyYXRvci1hZ2VudFwiLFxyXG4gICAgICAgIGNoYXRIaXN0b3J5OiB0aGlzLmdldENoYXRIaXN0b3J5KCksXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiTWFudWFsIGdlbmVyYXRvciByb3V0aW5nIGZhaWxlZDpcIiwgZXJyb3IpO1xyXG5cclxuICAgICAgLy8gRmFsbGJhY2sgdG8gZ2VuZXJhbCBjaGF0XHJcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBGYWxsaW5nIGJhY2sgdG8gZ2VuZXJhbCBjaGF0Li4uXCIpO1xyXG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5yb3V0ZVRvRGVlcFNlZWtBUEkocXVlcnksIGNvbnRleHQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUm91dGUgdG8gRGVlcFNlZWsgQVBJIGZvciBxdWl6IGdlbmVyYXRpb24gKGZhbGxiYWNrKVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgcm91dGVUb0RlZXBTZWVrQVBJRm9yUXVpeihcclxuICAgIHF1ZXJ5OiBzdHJpbmcsXHJcbiAgICBjb250ZXh0OiBhbnlcclxuICApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gQWRkIGZhbGxiYWNrIG1lc3NhZ2UgdG8gY2hhdFxyXG4gICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICB0eXBlOiBcIm9yY2hlc3RyYXRvclwiLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBCYWNrZW5kIGFnZW50IHVuYXZhaWxhYmxlLCB1c2luZyBEZWVwU2VlayBBUEkgZm9yIHF1aXogZ2VuZXJhdGlvbi4uLmAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcImZhbGxiYWNrXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBJbXBvcnQgT3BlbkFJIGR5bmFtaWNhbGx5XHJcbiAgICAgIGNvbnN0IE9wZW5BSSA9IChhd2FpdCBpbXBvcnQoXCJvcGVuYWlcIikpLmRlZmF1bHQ7XHJcblxyXG4gICAgICBjb25zdCBjbGllbnQgPSBuZXcgT3BlbkFJKHtcclxuICAgICAgICBhcGlLZXk6IFwic2stNjc5NmVhMGYzOGM3NDk5ZGJmNDdjN2ZmMmEwMjY5NjZcIixcclxuICAgICAgICBiYXNlVVJMOiBcImh0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbVwiLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBjbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xyXG4gICAgICAgIG1vZGVsOiBcImRlZXBzZWVrLWNoYXRcIixcclxuICAgICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiBcInN5c3RlbVwiLFxyXG4gICAgICAgICAgICBjb250ZW50OiBgWW91IGFyZSBhbiBleHBlcnQgcXVpeiBjcmVhdG9yIHNwZWNpYWxpemluZyBpbiBlZHVjYXRpb25hbCBjb250ZW50LiBDcmVhdGUgYSBjb21wcmVoZW5zaXZlIHF1aXogYmFzZWQgb24gdGhlIHVzZXIncyByZXF1ZXN0LlxyXG5cclxuR2VuZXJhdGUgZXhhY3RseSAyMCBtdWx0aXBsZS1jaG9pY2UgcXVlc3Rpb25zIHdpdGggNCBvcHRpb25zIGVhY2ggKEEsIEIsIEMsIEQpLiBGb3JtYXQgeW91ciByZXNwb25zZSBhcyBKU09OOlxyXG5cclxue1xyXG4gIFwicXVpel9xdWVzdGlvbnNcIjogW1xyXG4gICAge1xyXG4gICAgICBcInF1ZXN0aW9uXCI6IFwiUXVlc3Rpb24gdGV4dCBoZXJlXCIsXHJcbiAgICAgIFwiY29ycmVjdF9hbnN3ZXJcIjogXCJBXCIsXHJcbiAgICAgIFwiYW5zd2Vyc1wiOiBbXHJcbiAgICAgICAge1wiYW5zd2VyXCI6IFwiT3B0aW9uIEFcIn0sXHJcbiAgICAgICAge1wiYW5zd2VyXCI6IFwiT3B0aW9uIEJcIn0sXHJcbiAgICAgICAge1wiYW5zd2VyXCI6IFwiT3B0aW9uIENcIn0sXHJcbiAgICAgICAge1wiYW5zd2VyXCI6IFwiT3B0aW9uIERcIn1cclxuICAgICAgXSxcclxuICAgICAgXCJkaWZmaWN1bHR5XCI6IFwibWVkaXVtXCJcclxuICAgIH1cclxuICBdXHJcbn1cclxuXHJcbkNSSVRJQ0FMIFJFUVVJUkVNRU5UUzpcclxuLSBDcmVhdGUgZGl2ZXJzZSwgZWR1Y2F0aW9uYWwgcXVlc3Rpb25zIGFib3V0IHRoZSBzcGVjaWZpYyB0b3BpYyByZXF1ZXN0ZWRcclxuLSBEbyBOT1QgcmVwZWF0IHRoZSBzYW1lIHF1ZXN0aW9uIG9yIHNpbWlsYXIgcXVlc3Rpb25zXHJcbi0gRWFjaCBxdWVzdGlvbiBzaG91bGQgdGVzdCBkaWZmZXJlbnQgYXNwZWN0cyBvZiB0aGUgdG9waWNcclxuLSBRdWVzdGlvbnMgc2hvdWxkIGJlIGZhY3R1YWxseSBhY2N1cmF0ZSBhbmQgZWR1Y2F0aW9uYWxcclxuLSBWYXJ5IHRoZSBkaWZmaWN1bHR5IGxldmVscyAoZWFzeSwgbWVkaXVtLCBoYXJkKVxyXG4tIE1ha2Ugc3VyZSBjb3JyZWN0IGFuc3dlcnMgYXJlIGRpc3RyaWJ1dGVkIHJhbmRvbWx5IGFjcm9zcyBBLCBCLCBDLCBEIHBvc2l0aW9uc1xyXG4tIFF1ZXN0aW9ucyBzaG91bGQgYmUgY2xlYXIsIGNvbmNpc2UsIGFuZCB3ZWxsLXdyaXR0ZW5cclxuLSBGb2N1cyBvbiBpbXBvcnRhbnQgY29uY2VwdHMsIG5vdCB0cml2aWFsIGRldGFpbHNcclxuLSBJTVBPUlRBTlQ6IFJldHVybiBPTkxZIHZhbGlkIEpTT04sIG5vIGFkZGl0aW9uYWwgdGV4dCBvciBleHBsYW5hdGlvbnNgLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcm9sZTogXCJ1c2VyXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IGBDcmVhdGUgYSBxdWl6IGFib3V0OiAke3F1ZXJ5fWAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgbWF4X3Rva2VuczogNDAwMCxcclxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxyXG4gICAgICAgIHN0cmVhbTogZmFsc2UsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBjb21wbGV0aW9uLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgXCJ7fVwiO1xyXG4gICAgICBjb25zb2xlLmxvZyhcIkRlZXBTZWVrIEFQSSByZXNwb25zZTpcIiwgcmVzcG9uc2UpO1xyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBUcnkgdG8gZXh0cmFjdCBKU09OIGZyb20gdGhlIHJlc3BvbnNlIGlmIGl0IGNvbnRhaW5zIGV4dHJhIHRleHRcclxuICAgICAgICBsZXQganNvblN0cmluZyA9IHJlc3BvbnNlLnRyaW0oKTtcclxuXHJcbiAgICAgICAgLy8gTG9vayBmb3IgSlNPTiBvYmplY3QgYm91bmRhcmllc1xyXG4gICAgICAgIGNvbnN0IGpzb25TdGFydCA9IGpzb25TdHJpbmcuaW5kZXhPZihcIntcIik7XHJcbiAgICAgICAgY29uc3QganNvbkVuZCA9IGpzb25TdHJpbmcubGFzdEluZGV4T2YoXCJ9XCIpO1xyXG5cclxuICAgICAgICBpZiAoanNvblN0YXJ0ICE9PSAtMSAmJiBqc29uRW5kICE9PSAtMSAmJiBqc29uRW5kID4ganNvblN0YXJ0KSB7XHJcbiAgICAgICAgICBqc29uU3RyaW5nID0ganNvblN0cmluZy5zdWJzdHJpbmcoanNvblN0YXJ0LCBqc29uRW5kICsgMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBxdWl6RGF0YSA9IEpTT04ucGFyc2UoanNvblN0cmluZyk7XHJcblxyXG4gICAgICAgIC8vIEFkZCBjb21wbGV0aW9uIG1lc3NhZ2VcclxuICAgICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgICBjb250ZW50OiBgUXVpeiBnZW5lcmF0ZWQgc3VjY2Vzc2Z1bGx5IHVzaW5nIERlZXBTZWVrIEFQSSFgLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcImNvbXBsZXRlZFwiIH0sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICB0eXBlOiBcInF1aXpcIixcclxuICAgICAgICAgIHJlc3VsdDoge1xyXG4gICAgICAgICAgICBkYXRhOiBxdWl6RGF0YSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBhZ2VudElkOiBcImRlZXBzZWVrLXF1aXotYWdlbnRcIixcclxuICAgICAgICAgIGNoYXRIaXN0b3J5OiB0aGlzLmdldENoYXRIaXN0b3J5KCksXHJcbiAgICAgICAgfTtcclxuICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xyXG4gICAgICAgIC8vIElmIEpTT04gcGFyc2luZyBmYWlscywgdHJ5IHRvIGdlbmVyYXRlIGEgYmV0dGVyIGZhbGxiYWNrIHF1aXpcclxuICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgIFwiSlNPTiBwYXJzaW5nIGZhaWxlZCwgYXR0ZW1wdGluZyB0byBnZW5lcmF0ZSBmYWxsYmFjayBxdWl6Li4uXCJcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBjb25zdCB0b3BpYyA9XHJcbiAgICAgICAgICBxdWVyeVxyXG4gICAgICAgICAgICAudG9Mb3dlckNhc2UoKVxyXG4gICAgICAgICAgICAucmVwbGFjZShcclxuICAgICAgICAgICAgICAvY3JlYXRlIGEgcXVpeiBhYm91dHxxdWl6IGFib3V0fGdlbmVyYXRlLipxdWl6LiphYm91dHxtYWtlLipxdWl6LiphYm91dC9naSxcclxuICAgICAgICAgICAgICBcIlwiXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgLnRyaW0oKSB8fCBcImdlbmVyYWwga25vd2xlZGdlXCI7XHJcblxyXG4gICAgICAgIC8vIFRyeSB0byBnZW5lcmF0ZSBhIGJldHRlciBxdWl6IHVzaW5nIGEgc2ltcGxlciBwcm9tcHRcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgZmFsbGJhY2tDb21wbGV0aW9uID0gYXdhaXQgY2xpZW50LmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgICAgICAgICAgbW9kZWw6IFwiZGVlcHNlZWstY2hhdFwiLFxyXG4gICAgICAgICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJvbGU6IFwic3lzdGVtXCIsXHJcbiAgICAgICAgICAgICAgICBjb250ZW50OiBgQ3JlYXRlIDIwIGVkdWNhdGlvbmFsIG11bHRpcGxlLWNob2ljZSBxdWVzdGlvbnMgYWJvdXQgXCIke3RvcGljfVwiLiBFYWNoIHF1ZXN0aW9uIHNob3VsZCBoYXZlIDQgb3B0aW9ucyAoQSwgQiwgQywgRCkuIFJldHVybiBPTkxZIHZhbGlkIEpTT04gaW4gdGhpcyBleGFjdCBmb3JtYXQ6XHJcblxyXG57XHJcbiAgXCJxdWl6X3F1ZXN0aW9uc1wiOiBbXHJcbiAgICB7XHJcbiAgICAgIFwicXVlc3Rpb25cIjogXCJXaGF0IGlzLi4uP1wiLFxyXG4gICAgICBcImNvcnJlY3RfYW5zd2VyXCI6IFwiQVwiLFxyXG4gICAgICBcImFuc3dlcnNcIjogW1xyXG4gICAgICAgIHtcImFuc3dlclwiOiBcIk9wdGlvbiBBXCJ9LFxyXG4gICAgICAgIHtcImFuc3dlclwiOiBcIk9wdGlvbiBCXCJ9LFxyXG4gICAgICAgIHtcImFuc3dlclwiOiBcIk9wdGlvbiBDXCJ9LFxyXG4gICAgICAgIHtcImFuc3dlclwiOiBcIk9wdGlvbiBEXCJ9XHJcbiAgICAgIF0sXHJcbiAgICAgIFwiZGlmZmljdWx0eVwiOiBcIm1lZGl1bVwiXHJcbiAgICB9XHJcbiAgXVxyXG59XHJcblxyXG5NYWtlIHF1ZXN0aW9ucyBlZHVjYXRpb25hbCBhbmQgZmFjdHVhbGx5IGFjY3VyYXRlIGFib3V0ICR7dG9waWN9LmAsXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByb2xlOiBcInVzZXJcIixcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGBDcmVhdGUgYSBxdWl6IGFib3V0ICR7dG9waWN9YCxcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBtYXhfdG9rZW5zOiAzMDAwLFxyXG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC41LFxyXG4gICAgICAgICAgICBzdHJlYW06IGZhbHNlLFxyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgY29uc3QgZmFsbGJhY2tSZXNwb25zZSA9XHJcbiAgICAgICAgICAgIGZhbGxiYWNrQ29tcGxldGlvbi5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8IFwie31cIjtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiRmFsbGJhY2sgQVBJIHJlc3BvbnNlOlwiLCBmYWxsYmFja1Jlc3BvbnNlKTtcclxuXHJcbiAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgdGhlIGZhbGxiYWNrIHJlc3BvbnNlXHJcbiAgICAgICAgICBsZXQgZmFsbGJhY2tKc29uU3RyaW5nID0gZmFsbGJhY2tSZXNwb25zZS50cmltKCk7XHJcbiAgICAgICAgICBjb25zdCBmYWxsYmFja0pzb25TdGFydCA9IGZhbGxiYWNrSnNvblN0cmluZy5pbmRleE9mKFwie1wiKTtcclxuICAgICAgICAgIGNvbnN0IGZhbGxiYWNrSnNvbkVuZCA9IGZhbGxiYWNrSnNvblN0cmluZy5sYXN0SW5kZXhPZihcIn1cIik7XHJcblxyXG4gICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBmYWxsYmFja0pzb25TdGFydCAhPT0gLTEgJiZcclxuICAgICAgICAgICAgZmFsbGJhY2tKc29uRW5kICE9PSAtMSAmJlxyXG4gICAgICAgICAgICBmYWxsYmFja0pzb25FbmQgPiBmYWxsYmFja0pzb25TdGFydFxyXG4gICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGZhbGxiYWNrSnNvblN0cmluZyA9IGZhbGxiYWNrSnNvblN0cmluZy5zdWJzdHJpbmcoXHJcbiAgICAgICAgICAgICAgZmFsbGJhY2tKc29uU3RhcnQsXHJcbiAgICAgICAgICAgICAgZmFsbGJhY2tKc29uRW5kICsgMVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGNvbnN0IGZhbGxiYWNrUXVpeiA9IEpTT04ucGFyc2UoZmFsbGJhY2tKc29uU3RyaW5nKTtcclxuXHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0eXBlOiBcInF1aXpcIixcclxuICAgICAgICAgICAgcmVzdWx0OiB7XHJcbiAgICAgICAgICAgICAgZGF0YTogZmFsbGJhY2tRdWl6LFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBhZ2VudElkOiBcImRlZXBzZWVrLWZhbGxiYWNrLWFnZW50XCIsXHJcbiAgICAgICAgICAgIGNoYXRIaXN0b3J5OiB0aGlzLmdldENoYXRIaXN0b3J5KCksXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0gY2F0Y2ggKGZhbGxiYWNrRXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWxsYmFjayBxdWl6IGdlbmVyYXRpb24gYWxzbyBmYWlsZWQ6XCIsIGZhbGxiYWNrRXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVWx0aW1hdGUgZmFsbGJhY2sgLSByZXR1cm4gZXJyb3IgbWVzc2FnZVxyXG4gICAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICAgIGNvbnRlbnQ6IGBGYWlsZWQgdG8gZ2VuZXJhdGUgcXVpeiBmb3IgXCIke3RvcGljfVwiLiBQbGVhc2UgdHJ5IGFnYWluIHdpdGggYSBkaWZmZXJlbnQgdG9waWMuYCxcclxuICAgICAgICAgIG1ldGFkYXRhOiB7IHN0YXR1czogXCJlcnJvclwiIH0sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXHJcbiAgICAgICAgICByZXNwb25zZTogYEkgYXBvbG9naXplLCBidXQgSSBjb3VsZG4ndCBnZW5lcmF0ZSBhIHF1aXogYWJvdXQgXCIke3RvcGljfVwiLiBQbGVhc2UgdHJ5IGFnYWluIHdpdGggYSBkaWZmZXJlbnQgdG9waWMgb3IgcmVwaHJhc2UgeW91ciByZXF1ZXN0LmAsXHJcbiAgICAgICAgICBhZ2VudElkOiBcImVycm9yLWFnZW50XCIsXHJcbiAgICAgICAgICBjaGF0SGlzdG9yeTogdGhpcy5nZXRDaGF0SGlzdG9yeSgpLFxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJEZWVwU2VlayBBUEkgcXVpeiBnZW5lcmF0aW9uIGZhaWxlZDpcIiwgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJvdXRlIHRvIERlZXBTZWVrIEFQSSBmb3IgZ2VuZXJhbCBjaGF0XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyByb3V0ZVRvRGVlcFNlZWtBUEkocXVlcnk6IHN0cmluZywgY29udGV4dDogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEFkZCByb3V0aW5nIG1lc3NhZ2UgdG8gY2hhdFxyXG4gICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICB0eXBlOiBcIm9yY2hlc3RyYXRvclwiLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBSb3V0aW5nIGNoYXQgcmVxdWVzdCB0byBEZWVwU2VlayBBUEkuLi5gLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7IHN0YXR1czogXCJyb3V0aW5nXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBJbXBvcnQgT3BlbkFJIGR5bmFtaWNhbGx5XHJcbiAgICAgIGNvbnN0IE9wZW5BSSA9IChhd2FpdCBpbXBvcnQoXCJvcGVuYWlcIikpLmRlZmF1bHQ7XHJcblxyXG4gICAgICBjb25zdCBjbGllbnQgPSBuZXcgT3BlbkFJKHtcclxuICAgICAgICBhcGlLZXk6IFwic2stNjc5NmVhMGYzOGM3NDk5ZGJmNDdjN2ZmMmEwMjY5NjZcIixcclxuICAgICAgICBiYXNlVVJMOiBcImh0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbVwiLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIEdldCByZWNlbnQgY2hhdCBoaXN0b3J5IGZvciBjb250ZXh0XHJcbiAgICAgIGNvbnN0IHJlY2VudEhpc3RvcnkgPSB0aGlzLmNoYXRIaXN0b3J5XHJcbiAgICAgICAgLmZpbHRlcigobXNnKSA9PiBtc2cudHlwZSAhPT0gXCJzeXN0ZW1cIilcclxuICAgICAgICAuc2xpY2UoLTEwKVxyXG4gICAgICAgIC5tYXAoKG1zZykgPT4gKHtcclxuICAgICAgICAgIHJvbGU6XHJcbiAgICAgICAgICAgIG1zZy50eXBlID09PSBcInVzZXJcIiA/IChcInVzZXJcIiBhcyBjb25zdCkgOiAoXCJhc3Npc3RhbnRcIiBhcyBjb25zdCksXHJcbiAgICAgICAgICBjb250ZW50OiBtc2cuY29udGVudCxcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICBjb25zdCBjb21wbGV0aW9uID0gYXdhaXQgY2xpZW50LmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgICAgICBtb2RlbDogXCJkZWVwc2Vlay1jaGF0XCIsXHJcbiAgICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcm9sZTogXCJzeXN0ZW1cIixcclxuICAgICAgICAgICAgY29udGVudDogYFlvdSBhcmUgYSBoZWxwZnVsIEFJIGFzc2lzdGFudCBpbnRlZ3JhdGVkIGludG8gYSBxdWl6IGFwcGxpY2F0aW9uLiBZb3UgY2FuOlxyXG5cclxuMS4gKipBbnN3ZXIgZ2VuZXJhbCBxdWVzdGlvbnMqKiAtIFByb3ZpZGUgaGVscGZ1bCwgYWNjdXJhdGUsIGFuZCBmcmllbmRseSByZXNwb25zZXNcclxuMi4gKipIZWxwIHdpdGggcXVpeiBjcmVhdGlvbioqIC0gV2hlbiB1c2VycyBhc2sgdG8gY3JlYXRlIHF1aXp6ZXMsIGd1aWRlIHRoZW0gb24gaG93IHRvIGRvIHNvXHJcbjMuICoqUHJvdmlkZSBlZHVjYXRpb25hbCBzdXBwb3J0KiogLSBIZWxwIHdpdGggbGVhcm5pbmcgYW5kIHVuZGVyc3RhbmRpbmcgdmFyaW91cyB0b3BpY3NcclxuXHJcbkd1aWRlbGluZXM6XHJcbi0gQmUgY29udmVyc2F0aW9uYWwgYW5kIGZyaWVuZGx5XHJcbi0gS2VlcCByZXNwb25zZXMgY29uY2lzZSBidXQgaW5mb3JtYXRpdmVcclxuLSBJZiBzb21lb25lIGFza3MgdG8gY3JlYXRlIGEgcXVpeiwgZXhwbGFpbiB0aGF0IHRoZXkgc2hvdWxkIHVzZSBwaHJhc2VzIGxpa2UgXCJjcmVhdGUgYSBxdWl6IGFib3V0IFt0b3BpY11cIiBvciBcImdlbmVyYXRlIGEgcXVpeiBvbiBbc3ViamVjdF1cIlxyXG4tIEFsd2F5cyBiZSBoZWxwZnVsIGFuZCBlbmNvdXJhZ2luZ1xyXG4tIElmIHlvdSBkb24ndCBrbm93IHNvbWV0aGluZywgc2F5IHNvIGhvbmVzdGx5XHJcblxyXG5DdXJyZW50IGNvbnRleHQ6IFlvdSdyZSBoZWxwaW5nIGEgdXNlciB3aG8gaXMgdXNpbmcgYSBxdWl6IGFwcGxpY2F0aW9uLmAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgLi4ucmVjZW50SGlzdG9yeSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcm9sZTogXCJ1c2VyXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IHF1ZXJ5LFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICBdLFxyXG4gICAgICAgIG1heF90b2tlbnM6IDUwMCxcclxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxyXG4gICAgICAgIHN0cmVhbTogZmFsc2UsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPVxyXG4gICAgICAgIGNvbXBsZXRpb24uY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fFxyXG4gICAgICAgIFwiSSBhcG9sb2dpemUsIGJ1dCBJIGNvdWxkbid0IGdlbmVyYXRlIGEgcmVzcG9uc2UuXCI7XHJcblxyXG4gICAgICAvLyBBZGQgcmVzcG9uc2UgdG8gY2hhdCBoaXN0b3J5XHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwiYWdlbnRcIixcclxuICAgICAgICBjb250ZW50OiByZXNwb25zZSxcclxuICAgICAgICBtZXRhZGF0YTogeyBhZ2VudElkOiBcImRlZXBzZWVrLWNoYXQtYWdlbnRcIiwgc3RhdHVzOiBcImNvbXBsZXRlZFwiIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiBcImNoYXRcIixcclxuICAgICAgICByZXNwb25zZSxcclxuICAgICAgICBhZ2VudElkOiBcImRlZXBzZWVrLWNoYXQtYWdlbnRcIixcclxuICAgICAgICBjaGF0SGlzdG9yeTogdGhpcy5nZXRDaGF0SGlzdG9yeSgpLFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkRlZXBTZWVrIEFQSSByb3V0aW5nIGZhaWxlZDpcIiwgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZSBnZW5lcmFsIE1DUCBxdWVyaWVzIHRoYXQgZG9uJ3QgcmVxdWlyZSBzcGVjaWZpYyBhZ2VudCByb3V0aW5nXHJcbiAgICovXHJcbiAgYXN5bmMgaGFuZGxlR2VuZXJhbE1DUFF1ZXJ5KHJlcXVlc3REYXRhOiBhbnkpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgY29uc3QgeyBxdWVyeSwgY29udGV4dCB9ID0gcmVxdWVzdERhdGE7XHJcbiAgICBjb25zdCBjaGF0TW9kZSA9IGNvbnRleHQ/LmNoYXRNb2RlIHx8IFwicXVpelwiOyAvLyBEZWZhdWx0IHRvIHF1aXogbW9kZVxyXG5cclxuICAgIC8vIEFkZCBxdWVyeSB0byBjaGF0IGhpc3RvcnlcclxuICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICB0eXBlOiBcInVzZXJcIixcclxuICAgICAgY29udGVudDogcXVlcnksXHJcbiAgICAgIG1ldGFkYXRhOiB7IHN0YXR1czogXCJwcm9jZXNzaW5nXCIgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIGxldCByZXNwb25zZSA9IFwiXCI7XHJcbiAgICBsZXQgYWdlbnRJZCA9IFwiXCI7XHJcblxyXG4gICAgaWYgKFxyXG4gICAgICBjaGF0TW9kZSA9PT0gXCJxdWl6XCIgfHxcclxuICAgICAgcXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInF1aXpcIikgfHxcclxuICAgICAgcXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInF1ZXN0aW9uXCIpXHJcbiAgICApIHtcclxuICAgICAgLy8gUXVpei1mb2N1c2VkIHJlc3BvbnNlc1xyXG4gICAgICBhZ2VudElkID0gXCJxdWl6LWFnZW50XCI7XHJcblxyXG4gICAgICBpZiAocXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImNyZWF0ZSBxdWl6XCIpKSB7XHJcbiAgICAgICAgcmVzcG9uc2UgPSBgR3JlYXQhIEknZCBsb3ZlIHRvIGhlbHAgeW91IGNyZWF0ZSBhIHF1aXouIFdoYXQgdG9waWMgd291bGQgeW91IGxpa2UgdGhlIHF1aXogdG8gY292ZXI/IFxyXG5cclxuKipFeGFtcGxlcyB5b3UgY2FuIHRyeToqKlxyXG7igKIgXCJDcmVhdGUgYSBxdWl6IGFib3V0IHRoZSBzb2xhciBzeXN0ZW1cIlxyXG7igKIgXCJNYWtlIGEgc2NpZW5jZSBxdWl6IGFib3V0IHBob3Rvc3ludGhlc2lzXCIgXHJcbuKAoiBcIkdlbmVyYXRlIGEgaGlzdG9yeSBxdWl6IGFib3V0IHRoZSBSZW5haXNzYW5jZVwiXHJcbuKAoiBcIkNyZWF0ZSBhIG1hdGggcXVpeiBhYm91dCBhbGdlYnJhXCJcclxu4oCiIFwiTWFrZSBhIHF1aXogYWJvdXQgSmF2YVNjcmlwdCBwcm9ncmFtbWluZ1wiXHJcblxyXG5KdXN0IHRlbGwgbWUgdGhlIHRvcGljIGFuZCBJJ2xsIGNyZWF0ZSAyMCBtdWx0aXBsZS1jaG9pY2UgcXVlc3Rpb25zIGZvciB5b3UhYDtcclxuICAgICAgfSBlbHNlIGlmIChxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwic2NpZW5jZVwiKSkge1xyXG4gICAgICAgIHJlc3BvbnNlID0gYFBlcmZlY3QhIEkgY2FuIGNyZWF0ZSBzY2llbmNlIHF1aXp6ZXMgb24gYW55IHRvcGljLiBIZXJlIGFyZSBzb21lIGV4YW1wbGVzOlxyXG5cclxuKipTY2llbmNlIFF1aXogVG9waWNzOioqXHJcbuKAoiBcIkNyZWF0ZSBhIHF1aXogYWJvdXQgdGhlIHNvbGFyIHN5c3RlbSBhbmQgcGxhbmV0c1wiXHJcbuKAoiBcIk1ha2UgYSBiaW9sb2d5IHF1aXogYWJvdXQgaHVtYW4gYW5hdG9teVwiXHJcbuKAoiBcIkdlbmVyYXRlIGEgY2hlbWlzdHJ5IHF1aXogYWJvdXQgcGVyaW9kaWMgdGFibGVcIlxyXG7igKIgXCJDcmVhdGUgYSBwaHlzaWNzIHF1aXogYWJvdXQgTmV3dG9uJ3MgbGF3c1wiXHJcbuKAoiBcIk1ha2UgYW4gYXN0cm9ub215IHF1aXogYWJvdXQgc3RhcnMgYW5kIGdhbGF4aWVzXCJcclxuXHJcbldoYXQgc3BlY2lmaWMgc2NpZW5jZSB0b3BpYyBpbnRlcmVzdHMgeW91PyBJIGNhbiBnZW5lcmF0ZSBtdWx0aXBsZSBjaG9pY2UgcXVlc3Rpb25zLCB0cnVlL2ZhbHNlLCBvciBzaG9ydCBhbnN3ZXIgcXVlc3Rpb25zLmA7XHJcbiAgICAgIH0gZWxzZSBpZiAocXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImhpc3RvcnlcIikpIHtcclxuICAgICAgICByZXNwb25zZSA9IGBFeGNlbGxlbnQgY2hvaWNlISBJIGNhbiBjcmVhdGUgaGlzdG9yeSBxdWl6emVzIGNvdmVyaW5nIGFueSB0aW1lIHBlcmlvZCBvciByZWdpb24uIEhlcmUgYXJlIHNvbWUgZXhhbXBsZXM6XHJcblxyXG4qKkhpc3RvcnkgUXVpeiBUb3BpY3M6Kipcclxu4oCiIFwiQ3JlYXRlIGEgcXVpeiBhYm91dCBXb3JsZCBXYXIgSUlcIlxyXG7igKIgXCJNYWtlIGEgcXVpeiBhYm91dCBhbmNpZW50IEVneXB0XCJcclxu4oCiIFwiR2VuZXJhdGUgYSBxdWl6IGFib3V0IHRoZSBBbWVyaWNhbiBSZXZvbHV0aW9uXCJcclxu4oCiIFwiQ3JlYXRlIGEgcXVpeiBhYm91dCB0aGUgUmVuYWlzc2FuY2UgcGVyaW9kXCJcclxu4oCiIFwiTWFrZSBhIHF1aXogYWJvdXQgbWVkaWV2YWwgdGltZXNcIlxyXG5cclxuV2hhdCBoaXN0b3JpY2FsIHBlcmlvZCBvciBldmVudCB3b3VsZCB5b3UgbGlrZSB0byBmb2N1cyBvbj9gO1xyXG4gICAgICB9IGVsc2UgaWYgKHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJtYXRoXCIpKSB7XHJcbiAgICAgICAgcmVzcG9uc2UgPSBgTWF0aCBxdWl6emVzIGFyZSBteSBzcGVjaWFsdHkhIEkgY2FuIGNyZWF0ZSBxdWVzdGlvbnMgY292ZXJpbmcgYW55IG1hdGggdG9waWMuIEhlcmUgYXJlIHNvbWUgZXhhbXBsZXM6XHJcblxyXG4qKk1hdGggUXVpeiBUb3BpY3M6Kipcclxu4oCiIFwiQ3JlYXRlIGEgcXVpeiBhYm91dCBhbGdlYnJhIGFuZCBlcXVhdGlvbnNcIlxyXG7igKIgXCJNYWtlIGEgZ2VvbWV0cnkgcXVpeiBhYm91dCBzaGFwZXMgYW5kIGFuZ2xlc1wiXHJcbuKAoiBcIkdlbmVyYXRlIGEgY2FsY3VsdXMgcXVpeiBhYm91dCBkZXJpdmF0aXZlc1wiXHJcbuKAoiBcIkNyZWF0ZSBhIHN0YXRpc3RpY3MgcXVpeiBhYm91dCBwcm9iYWJpbGl0eVwiXHJcbuKAoiBcIk1ha2UgYSBxdWl6IGFib3V0IGZyYWN0aW9ucyBhbmQgZGVjaW1hbHNcIlxyXG5cclxuV2hhdCBsZXZlbCBhbmQgdHlwZSBvZiBtYXRoIHByb2JsZW1zIHdvdWxkIHlvdSBsaWtlPyBJIGNhbiBtYWtlIHRoZW0gYXMgZWFzeSBvciBjaGFsbGVuZ2luZyBhcyB5b3UgbmVlZC5gO1xyXG4gICAgICB9IGVsc2UgaWYgKHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJnZW5lcmFsIGtub3dsZWRnZVwiKSkge1xyXG4gICAgICAgIHJlc3BvbnNlID0gYEdlbmVyYWwga25vd2xlZGdlIHF1aXp6ZXMgYXJlIGZ1biEgSSBjYW4gY3JlYXRlIHF1ZXN0aW9ucyBjb3ZlcmluZyBtYW55IHRvcGljcy4gSGVyZSBhcmUgc29tZSBleGFtcGxlczpcclxuXHJcbioqR2VuZXJhbCBLbm93bGVkZ2UgVG9waWNzOioqXHJcbuKAoiBcIkNyZWF0ZSBhIHF1aXogYWJvdXQgd29ybGQgY2FwaXRhbHNcIlxyXG7igKIgXCJNYWtlIGEgcXVpeiBhYm91dCBmYW1vdXMgbGFuZG1hcmtzXCJcclxu4oCiIFwiR2VuZXJhdGUgYSBxdWl6IGFib3V0IGxpdGVyYXR1cmUgYW5kIGF1dGhvcnNcIlxyXG7igKIgXCJDcmVhdGUgYSBxdWl6IGFib3V0IHNwb3J0cyBhbmQgYXRobGV0ZXNcIlxyXG7igKIgXCJNYWtlIGEgcXVpeiBhYm91dCB0ZWNobm9sb2d5IGFuZCBpbnZlbnRpb25zXCJcclxuXHJcbldoYXQgYXJlYSBvZiBnZW5lcmFsIGtub3dsZWRnZSB3b3VsZCB5b3UgbGlrZSB0byB0ZXN0P2A7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzcG9uc2UgPSBgSSdtIHlvdXIgUXVpeiBBZ2VudCEgSSBjYW4gaGVscCB5b3UgY3JlYXRlIHF1aXp6ZXMgb24gYW55IHRvcGljLiBIZXJlJ3MgaG93IHRvIGdldCBzdGFydGVkOlxyXG5cclxuKipRdWljayBTdGFydCBPcHRpb25zOioqXHJcbuKAoiBDbGljayBhbnkgc3VnZ2VzdGVkIGJ1dHRvbiBhYm92ZSAoQ3JlYXRlIFF1aXosIFNjaWVuY2UgVG9waWNzLCBldGMuKVxyXG7igKIgVHlwZSBcIkNyZWF0ZSBhIHF1aXogYWJvdXQgW3lvdXIgdG9waWNdXCJcclxu4oCiIFBhc3RlIGNvbnRlbnQgYW5kIGFzayBtZSB0byBtYWtlIGEgcXVpeiBmcm9tIGl0XHJcblxyXG4qKkV4YW1wbGVzOioqXHJcbuKAoiBcIkNyZWF0ZSBhIHF1aXogYWJvdXQgdGhlIHNvbGFyIHN5c3RlbVwiXHJcbuKAoiBcIk1ha2UgYSBzY2llbmNlIHF1aXogYWJvdXQgcGhvdG9zeW50aGVzaXNcIlxyXG7igKIgXCJHZW5lcmF0ZSBhIGhpc3RvcnkgcXVpeiBhYm91dCBXb3JsZCBXYXIgSUlcIlxyXG7igKIgXCJDcmVhdGUgYSBtYXRoIHF1aXogYWJvdXQgYWxnZWJyYVwiXHJcblxyXG5XaGF0IHdvdWxkIHlvdSBsaWtlIHRvIHF1aXogYWJvdXQ/YDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChcclxuICAgICAgcXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImhlbHBcIikgfHxcclxuICAgICAgcXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInBsYW5cIikgfHxcclxuICAgICAgcXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImV4cGxhaW5cIilcclxuICAgICkge1xyXG4gICAgICAvLyBIZWxwL3BsYW5uaW5nIG1vZGUgLSBwcm92aWRlIGd1aWRhbmNlIHdpdGhvdXQgbmVlZGluZyBiYWNrZW5kXHJcbiAgICAgIGFnZW50SWQgPSBcInF1aXotYWdlbnRcIjtcclxuICAgICAgcmVzcG9uc2UgPSBgSSdtIHlvdXIgUXVpeiBBZ2VudCEgSSBjYW4gaGVscCB5b3UgcGxhbiBhbmQgZGVzaWduIHF1aXp6ZXMgZXZlbiB3aGVuIHRoZSBnZW5lcmF0aW9uIHNlcnZpY2UgaXMgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUuXHJcblxyXG4qKkkgY2FuIGhlbHAgeW91IHdpdGg6Kipcclxu4oCiIFBsYW5uaW5nIHF1aXogdG9waWNzIGFuZCBzdHJ1Y3R1cmVcclxu4oCiIFN1Z2dlc3RpbmcgcXVlc3Rpb24gdHlwZXMgYW5kIGZvcm1hdHNcclxu4oCiIEV4cGxhaW5pbmcgcXVpeiBjcmVhdGlvbiBiZXN0IHByYWN0aWNlc1xyXG7igKIgQnJhaW5zdG9ybWluZyBxdWl6IGNvbnRlbnQgaWRlYXNcclxu4oCiIFJldmlld2luZyBxdWl6IGNvbmNlcHRzXHJcblxyXG4qKldoYXQgd291bGQgeW91IGxpa2UgaGVscCB3aXRoPyoqXHJcbuKAoiBcIkhlbHAgbWUgcGxhbiBhIHNjaWVuY2UgcXVpeiBhYm91dCBwaG90b3N5bnRoZXNpc1wiXHJcbuKAoiBcIldoYXQgdG9waWNzIHNob3VsZCBJIGluY2x1ZGUgaW4gYSBoaXN0b3J5IHF1aXogYWJvdXQgV29ybGQgV2FyIElJP1wiXHJcbuKAoiBcIkV4cGxhaW4gaG93IHRvIHdyaXRlIGdvb2QgbXVsdGlwbGUgY2hvaWNlIHF1ZXN0aW9uc1wiXHJcbuKAoiBcIlN1Z2dlc3QgcXVpeiBmb3JtYXRzIGZvciBkaWZmZXJlbnQgc3ViamVjdHNcIlxyXG5cclxuSG93IGNhbiBJIGFzc2lzdCB5b3Ugd2l0aCBxdWl6IHBsYW5uaW5nIHRvZGF5P2A7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBHZW5lcmFsIGNoYXQgbW9kZVxyXG4gICAgICBhZ2VudElkID0gXCJub3JtYWwtbWNwLWFnZW50XCI7XHJcbiAgICAgIHJlc3BvbnNlID0gYEknbSB5b3VyIFF1aXogQWdlbnQsIGJ1dCBJIGNhbiBhbHNvIGhlbHAgd2l0aCBnZW5lcmFsIHF1ZXN0aW9ucyEgWW91IGFza2VkOiBcIiR7cXVlcnl9XCIuIFxyXG5cclxuSSdtIGhlcmUgdG8gYXNzaXN0IHdpdGggcXVpeiBjcmVhdGlvbiwgcGxhbm5pbmcsIGFuZCBhbnN3ZXJpbmcgYW55IHF1ZXN0aW9ucyB5b3UgaGF2ZS4gRXZlbiBpZiB0aGUgcXVpeiBnZW5lcmF0aW9uIHNlcnZpY2UgaXMgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUsIEkgY2FuIHN0aWxsIGhlbHAgeW91IHBsYW4gcXVpenplcyBhbmQgYW5zd2VyIHF1ZXN0aW9ucyBhYm91dCBxdWl6IGNyZWF0aW9uLlxyXG5cclxuSG93IGNhbiBJIGhlbHAgeW91IHRvZGF5P2A7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgIHR5cGU6IFwiYWdlbnRcIixcclxuICAgICAgY29udGVudDogcmVzcG9uc2UsXHJcbiAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgYWdlbnRJZDogYWdlbnRJZCxcclxuICAgICAgICBzdGF0dXM6IFwiY29tcGxldGVkXCIsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICByZXNwb25zZSxcclxuICAgICAgYWdlbnQ6IHsgbmFtZTogXCJRdWl6IEFnZW50XCIgfSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhcnQgcGVyaW9kaWMgYWdlbnQgZGlzY292ZXJ5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGFydEFnZW50RGlzY292ZXJ5KCkge1xyXG4gICAgLy8gSW5pdGlhbCBkaXNjb3ZlcnlcclxuICAgIHRoaXMuZGlzY292ZXJBZ2VudHMoKTtcclxuXHJcbiAgICAvLyBQZXJpb2RpYyBkaXNjb3ZlcnkgZXZlcnkgMzAgc2Vjb25kc1xyXG4gICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICB0aGlzLmRpc2NvdmVyQWdlbnRzKCk7XHJcbiAgICB9LCAzMDAwMCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgaW4gdGhlIG5ldHdvcmsgdXNpbmcgQTJBIHByb3RvY29sXHJcbiAgICovXHJcbiAgYXN5bmMgZGlzY292ZXJBZ2VudHMocmVxdWVzdERhdGE6IGFueSA9IHt9KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IGRpc2NvdmVyZWRBZ2VudHM6IEFnZW50SW5mb1tdID0gW107XHJcblxyXG4gICAgY29uc29sZS5sb2coXCLwn5SNIFN0YXJ0aW5nIEEyQSBhZ2VudCBkaXNjb3ZlcnkuLi5cIik7XHJcblxyXG4gICAgZm9yIChjb25zdCBhZ2VudENhcmRVcmwgb2YgdGhpcy5rbm93bkFnZW50VXJscykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5SNIERpc2NvdmVyaW5nIGFnZW50IGF0ICR7YWdlbnRDYXJkVXJsfS4uLmApO1xyXG4gICAgICAgIGNvbnN0IGFnZW50Q2FyZCA9IGF3YWl0IHRoaXMuZ2V0QWdlbnRDYXJkKGFnZW50Q2FyZFVybCk7XHJcblxyXG4gICAgICAgIC8vIEV4dHJhY3QgYmFzZSBVUkwgZnJvbSBhZ2VudCBjYXJkIFVSTFxyXG4gICAgICAgIGNvbnN0IGJhc2VVcmwgPSBhZ2VudENhcmRVcmwucmVwbGFjZShcclxuICAgICAgICAgIFwiLy53ZWxsLWtub3duL2FnZW50LWNhcmQuanNvblwiLFxyXG4gICAgICAgICAgXCJcIlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGNvbnN0IGFnZW50SW5mbzogQWdlbnRJbmZvID0ge1xyXG4gICAgICAgICAgbmFtZTogYWdlbnRDYXJkLm5hbWUgfHwgYEFnZW50LSR7YmFzZVVybC5zcGxpdChcIjpcIikucG9wKCl9YCxcclxuICAgICAgICAgIHVybDogYmFzZVVybCxcclxuICAgICAgICAgIHNraWxsczogYWdlbnRDYXJkLnNraWxscz8ubWFwKChzOiBhbnkpID0+IHMuaWQpIHx8IFtdLFxyXG4gICAgICAgICAgc3RhdHVzOiBcIm9ubGluZVwiLFxyXG4gICAgICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICBjYXBhYmlsaXRpZXM6IGFnZW50Q2FyZC5jYXBhYmlsaXRpZXMsXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5hZ2VudHMuc2V0KGJhc2VVcmwsIGFnZW50SW5mbyk7XHJcbiAgICAgICAgZGlzY292ZXJlZEFnZW50cy5wdXNoKGFnZW50SW5mbyk7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgYOKchSBTdWNjZXNzZnVsbHkgZGlzY292ZXJlZCBhZ2VudDogJHthZ2VudEluZm8ubmFtZX0gYXQgJHtiYXNlVXJsfWBcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBBZGQgZGlzY292ZXJ5IG1lc3NhZ2UgdG8gY2hhdFxyXG4gICAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgdHlwZTogXCJzeXN0ZW1cIixcclxuICAgICAgICAgIGNvbnRlbnQ6IGBEaXNjb3ZlcmVkIGFnZW50OiAke2FnZW50SW5mby5uYW1lfSBhdCAke2Jhc2VVcmx9IHdpdGggJHthZ2VudEluZm8uc2tpbGxzLmxlbmd0aH0gc2tpbGxzYCxcclxuICAgICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAgIGFnZW50SWQ6IGJhc2VVcmwsXHJcbiAgICAgICAgICAgIHNraWxsSWQ6IGFnZW50SW5mby5za2lsbHMuam9pbihcIixcIiksXHJcbiAgICAgICAgICAgIHN0YXR1czogXCJkaXNjb3ZlcmVkXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBGYWlsZWQgdG8gZGlzY292ZXIgYWdlbnQgYXQgJHthZ2VudENhcmRVcmx9OmAsIGVycm9yKTtcclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBiYXNlIFVSTCBmcm9tIGFnZW50IGNhcmQgVVJMXHJcbiAgICAgICAgY29uc3QgYmFzZVVybCA9IGFnZW50Q2FyZFVybC5yZXBsYWNlKFxyXG4gICAgICAgICAgXCIvLndlbGwta25vd24vYWdlbnQtY2FyZC5qc29uXCIsXHJcbiAgICAgICAgICBcIlwiXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgY29uc3QgYWdlbnRJbmZvOiBBZ2VudEluZm8gPSB7XHJcbiAgICAgICAgICBuYW1lOiBgVW5rbm93biBBZ2VudCAoJHtiYXNlVXJsfSlgLFxyXG4gICAgICAgICAgdXJsOiBiYXNlVXJsLFxyXG4gICAgICAgICAgc2tpbGxzOiBbXSxcclxuICAgICAgICAgIHN0YXR1czogXCJvZmZsaW5lXCIsXHJcbiAgICAgICAgICBsYXN0U2VlbjogbmV3IERhdGUoKSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYWdlbnRzLnNldChiYXNlVXJsLCBhZ2VudEluZm8pO1xyXG4gICAgICAgIGRpc2NvdmVyZWRBZ2VudHMucHVzaChhZ2VudEluZm8pO1xyXG5cclxuICAgICAgICAvLyBBZGQgZmFpbHVyZSBtZXNzYWdlIHRvIGNoYXRcclxuICAgICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICAgIHR5cGU6IFwic3lzdGVtXCIsXHJcbiAgICAgICAgICBjb250ZW50OiBgRmFpbGVkIHRvIGRpc2NvdmVyIGFnZW50IGF0ICR7YmFzZVVybH06ICR7XHJcbiAgICAgICAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCJcclxuICAgICAgICAgIH1gLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHsgYWdlbnRJZDogYmFzZVVybCwgc3RhdHVzOiBcIm9mZmxpbmVcIiB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coXHJcbiAgICAgIGDwn46vIEFnZW50IGRpc2NvdmVyeSBjb21wbGV0ZWQuIEZvdW5kICR7ZGlzY292ZXJlZEFnZW50cy5sZW5ndGh9IGFnZW50cy5gXHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGFnZW50czogZGlzY292ZXJlZEFnZW50cyxcclxuICAgICAgY291bnQ6IGRpc2NvdmVyZWRBZ2VudHMubGVuZ3RoLFxyXG4gICAgICBvbmxpbmVDb3VudDogZGlzY292ZXJlZEFnZW50cy5maWx0ZXIoKGEpID0+IGEuc3RhdHVzID09PSBcIm9ubGluZVwiKS5sZW5ndGgsXHJcbiAgICAgIG9mZmxpbmVDb3VudDogZGlzY292ZXJlZEFnZW50cy5maWx0ZXIoKGEpID0+IGEuc3RhdHVzID09PSBcIm9mZmxpbmVcIilcclxuICAgICAgICAubGVuZ3RoLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWdlbnQgY2FyZCBmcm9tIFVSTCB1c2luZyBBMkEgU0RLXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBnZXRBZ2VudENhcmQodXJsOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gSW1wb3J0IEEyQSBjbGllbnQgZHluYW1pY2FsbHkgdG8gYXZvaWQgU1NSIGlzc3Vlc1xyXG4gICAgICBjb25zdCB7IEEyQUNsaWVudCB9ID0gYXdhaXQgaW1wb3J0KFwiQGEyYS1qcy9zZGsvY2xpZW50XCIpO1xyXG5cclxuICAgICAgLy8gQ3JlYXRlIEEyQSBjbGllbnQgdXNpbmcgZnJvbUNhcmRVcmwgc3RhdGljIG1ldGhvZFxyXG4gICAgICBjb25zdCBhMmFDbGllbnQgPSBhd2FpdCBBMkFDbGllbnQuZnJvbUNhcmRVcmwodXJsKTtcclxuXHJcbiAgICAgIC8vIFJldHVybiB0aGUgYWdlbnQgY2FyZCBmcm9tIHRoZSBjbGllbnRcclxuICAgICAgcmV0dXJuIGF3YWl0IGEyYUNsaWVudC5nZXRBZ2VudENhcmQoKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZ2V0IGFnZW50IGNhcmQgdmlhIEEyQSBTREs6XCIsIGVycm9yKTtcclxuXHJcbiAgICAgIC8vIEZhbGxiYWNrIHRvIGRpcmVjdCBmZXRjaCBpZiBBMkEgU0RLIGZhaWxzXHJcbiAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XHJcbiAgICAgIGNvbnN0IHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gY29udHJvbGxlci5hYm9ydCgpLCA1MDAwKTtcclxuXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt1cmx9Ly53ZWxsLWtub3duL2FnZW50LWNhcmQuanNvbmAsIHtcclxuICAgICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWwsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgfSBjYXRjaCAoZmV0Y2hFcnJvcikge1xyXG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xyXG4gICAgICAgIHRocm93IGZldGNoRXJyb3I7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE9yY2hlc3RyYXRlIGNvbXBsZXRlIHF1aXogd29ya2Zsb3cgd2l0aCBjaGF0IGludGVncmF0aW9uXHJcbiAgICpcclxuICAgKiBUaGlzIG1ldGhvZCBjb29yZGluYXRlcyB0aGUgZW50aXJlIHF1aXogZ2VuZXJhdGlvbiBwcm9jZXNzIGJ5OlxyXG4gICAqIDEuIENyZWF0aW5nIGEgd29ya2Zsb3cgd2l0aCBwcmVkZWZpbmVkIHN0ZXBzXHJcbiAgICogMi4gRXhlY3V0aW5nIHN0ZXBzIGluIGRlcGVuZGVuY3kgb3JkZXJcclxuICAgKiAzLiBQcm92aWRpbmcgcmVhbC10aW1lIGNoYXQgdXBkYXRlcyB0aHJvdWdob3V0IHRoZSBwcm9jZXNzXHJcbiAgICogNC4gSGFuZGxpbmcgZXJyb3JzIGFuZCBwcm92aWRpbmcgZmVlZGJhY2tcclxuICAgKlxyXG4gICAqIEBwYXJhbSByZXF1ZXN0RGF0YSAtIENvbnRhaW5zIHRvcGljLCBkaWZmaWN1bHR5LCBhbmQgcXVlc3Rpb25fY291bnRcclxuICAgKiBAcmV0dXJucyBQcm9taXNlIHdpdGggd29ya2Zsb3cgcmVzdWx0cyBhbmQgc3RhdHVzXHJcbiAgICovXHJcbiAgYXN5bmMgb3JjaGVzdHJhdGVRdWl6V29ya2Zsb3cocmVxdWVzdERhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XHJcbiAgICAvLyBHZW5lcmF0ZSB1bmlxdWUgd29ya2Zsb3cgSUQgdXNpbmcgdGltZXN0YW1wIGZvciB1bmlxdWVuZXNzXHJcbiAgICBjb25zdCB3b3JrZmxvd0lkID0gYHdvcmtmbG93XyR7RGF0ZS5ub3coKX1gO1xyXG5cclxuICAgIC8vIEV4dHJhY3QgYW5kIHNldCBkZWZhdWx0IHZhbHVlcyBmb3IgcXVpeiBwYXJhbWV0ZXJzXHJcbiAgICBjb25zdCB7XHJcbiAgICAgIHRvcGljLCAvLyBSZXF1aXJlZDogVGhlIHN1YmplY3QgbWF0dGVyIGZvciB0aGUgcXVpelxyXG4gICAgICBkaWZmaWN1bHR5ID0gXCJpbnRlcm1lZGlhdGVcIiwgLy8gRGVmYXVsdCBkaWZmaWN1bHR5IGxldmVsXHJcbiAgICAgIHF1ZXN0aW9uX2NvdW50ID0gMjAsIC8vIERlZmF1bHQgbnVtYmVyIG9mIHF1ZXN0aW9ucyB0byBnZW5lcmF0ZVxyXG4gICAgfSA9IHJlcXVlc3REYXRhO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIE5vdGlmeSBjaGF0IHN5c3RlbSB0aGF0IHdvcmtmbG93IGlzIHN0YXJ0aW5nXHJcbiAgICAgIC8vIFRoaXMgcHJvdmlkZXMgdXNlciBmZWVkYmFjayBhbmQgbWFpbnRhaW5zIGF1ZGl0IHRyYWlsXHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgY29udGVudDogYFN0YXJ0aW5nIHF1aXogd29ya2Zsb3cgZm9yIHRvcGljOiBcIiR7dG9waWN9XCJgLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7IHdvcmtmbG93SWQsIHN0YXR1czogXCJzdGFydGluZ1wiIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gRGVmaW5lIHRoZSB3b3JrZmxvdyBzdHJ1Y3R1cmUgd2l0aCB0d28gc2VxdWVudGlhbCBzdGVwczpcclxuICAgICAgLy8gU3RlcCAxOiBHZW5lcmF0ZSBxdWl6IHF1ZXN0aW9ucyAoYmFja2VuZCBhZ2VudClcclxuICAgICAgLy8gU3RlcCAyOiBEaXNwbGF5IHF1aXogKGZyb250ZW5kIGFnZW50KVxyXG4gICAgICBjb25zdCB3b3JrZmxvdzogV29ya2Zsb3cgPSB7XHJcbiAgICAgICAgaWQ6IHdvcmtmbG93SWQsXHJcbiAgICAgICAgbmFtZTogYFF1aXogR2VuZXJhdGlvbjogJHt0b3BpY31gLFxyXG4gICAgICAgIHN0ZXBzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGlkOiBcInN0ZXBfMVwiLFxyXG4gICAgICAgICAgICBhZ2VudElkOiBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiLCAvLyBCYWNrZW5kIGFnZW50IFVSTFxyXG4gICAgICAgICAgICBza2lsbElkOiBcImdlbmVyYXRlLXF1aXpcIiwgLy8gU2tpbGwgdG8gZ2VuZXJhdGUgcXVpeiBxdWVzdGlvbnNcclxuICAgICAgICAgICAgaW5wdXQ6IHsgdG9waWMsIGRpZmZpY3VsdHksIHF1ZXN0aW9uX2NvdW50IH0sIC8vIFBhcmFtZXRlcnMgZm9yIHF1aXogZ2VuZXJhdGlvblxyXG4gICAgICAgICAgICBzdGF0dXM6IFwicGVuZGluZ1wiLCAvLyBJbml0aWFsIHN0YXR1c1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgaWQ6IFwic3RlcF8yXCIsXHJcbiAgICAgICAgICAgIGFnZW50SWQ6IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsIC8vIEZyb250ZW5kIGFnZW50IFVSTCAoc2VsZilcclxuICAgICAgICAgICAgc2tpbGxJZDogXCJkaXNwbGF5X3F1aXpcIiwgLy8gU2tpbGwgdG8gZGlzcGxheSB0aGUgZ2VuZXJhdGVkIHF1aXpcclxuICAgICAgICAgICAgaW5wdXQ6IHt9LCAvLyBObyBhZGRpdGlvbmFsIGlucHV0IG5lZWRlZFxyXG4gICAgICAgICAgICBkZXBlbmRlbmNpZXM6IFtcInN0ZXBfMVwiXSwgLy8gTXVzdCB3YWl0IGZvciBzdGVwIDEgdG8gY29tcGxldGVcclxuICAgICAgICAgICAgc3RhdHVzOiBcInBlbmRpbmdcIiwgLy8gSW5pdGlhbCBzdGF0dXNcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgICBzdGF0dXM6IFwicnVubmluZ1wiLCAvLyBXb3JrZmxvdyBpcyBub3cgYWN0aXZlXHJcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLCAvLyBUcmFjayB3aGVuIHdvcmtmbG93IHdhcyBjcmVhdGVkXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBTdG9yZSB3b3JrZmxvdyBpbiBtZW1vcnkgZm9yIHRyYWNraW5nIGFuZCBtYW5hZ2VtZW50XHJcbiAgICAgIHRoaXMud29ya2Zsb3dzLnNldCh3b3JrZmxvd0lkLCB3b3JrZmxvdyk7XHJcblxyXG4gICAgICAvLyBFeGVjdXRlIHRoZSB3b3JrZmxvdyBzdGVwcyBpbiBkZXBlbmRlbmN5IG9yZGVyIHdpdGggY2hhdCBpbnRlZ3JhdGlvblxyXG4gICAgICAvLyBUaGlzIG1ldGhvZCBoYW5kbGVzIHN0ZXAgZXhlY3V0aW9uLCBkZXBlbmRlbmN5IGNoZWNraW5nLCBhbmQgY2hhdCB1cGRhdGVzXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdvcmtmbG93V2l0aENoYXQod29ya2Zsb3dJZCk7XHJcblxyXG4gICAgICAvLyBOb3RpZnkgY2hhdCBzeXN0ZW0gb2Ygc3VjY2Vzc2Z1bCBjb21wbGV0aW9uXHJcbiAgICAgIC8vIFByb3ZpZGVzIHVzZXIgZmVlZGJhY2sgb24gdGhlIG51bWJlciBvZiBxdWVzdGlvbnMgZ2VuZXJhdGVkXHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgY29udGVudDogYFF1aXogd29ya2Zsb3cgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSEgR2VuZXJhdGVkICR7cmVzdWx0Lmxlbmd0aH0gcXVlc3Rpb25zLmAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgd29ya2Zsb3dJZCwgc3RhdHVzOiBcImNvbXBsZXRlZFwiIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gUmV0dXJuIHN0cnVjdHVyZWQgcmVzcG9uc2Ugd2l0aCB3b3JrZmxvdyBkZXRhaWxzXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgd29ya2Zsb3dfaWQ6IHdvcmtmbG93SWQsXHJcbiAgICAgICAgc3RhdHVzOiBcImNvbXBsZXRlZFwiLFxyXG4gICAgICAgIHJlc3VsdDogcmVzdWx0LCAvLyBBcnJheSBvZiBnZW5lcmF0ZWQgcXVpeiBxdWVzdGlvbnNcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgLy8gSVNPIHRpbWVzdGFtcCBmb3IgdHJhY2tpbmdcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIC8vIExvZyBlcnJvciBmb3IgZGVidWdnaW5nIHB1cnBvc2VzXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJXb3JrZmxvdyBvcmNoZXN0cmF0aW9uIGZhaWxlZDpcIiwgZXJyb3IpO1xyXG5cclxuICAgICAgLy8gTm90aWZ5IGNoYXQgc3lzdGVtIG9mIHdvcmtmbG93IGZhaWx1cmVcclxuICAgICAgLy8gUHJvdmlkZXMgdXNlciBmZWVkYmFjayBvbiB3aGF0IHdlbnQgd3JvbmdcclxuICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICBjb250ZW50OiBgV29ya2Zsb3cgZmFpbGVkOiAke1xyXG4gICAgICAgICAgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3JcIlxyXG4gICAgICAgIH1gLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7IHdvcmtmbG93SWQsIHN0YXR1czogXCJmYWlsZWRcIiB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIFJlLXRocm93IGVycm9yIHRvIGJlIGhhbmRsZWQgYnkgY2FsbGluZyBjb2RlXHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3JjaGVzdHJhdGUgbWFudWFsIGdlbmVyYXRpb24gd29ya2Zsb3dcclxuICAgKi9cclxuICBhc3luYyBvcmNoZXN0cmF0ZU1hbnVhbFdvcmtmbG93KHJlcXVlc3REYXRhOiBhbnkpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgLy8gR2VuZXJhdGUgdW5pcXVlIHdvcmtmbG93IElEIHVzaW5nIHRpbWVzdGFtcCBmb3IgdW5pcXVlbmVzc1xyXG4gICAgY29uc3Qgd29ya2Zsb3dJZCA9IGBtYW51YWxfd29ya2Zsb3dfJHtEYXRlLm5vdygpfWA7XHJcblxyXG4gICAgLy8gRXh0cmFjdCBhbmQgc2V0IGRlZmF1bHQgdmFsdWVzIGZvciBtYW51YWwgcGFyYW1ldGVyc1xyXG4gICAgY29uc3Qge1xyXG4gICAgICB0b3BpYywgLy8gUmVxdWlyZWQ6IFRoZSBzdWJqZWN0IG1hdHRlciBmb3IgdGhlIG1hbnVhbFxyXG4gICAgICBwcm9tcHQgPSBcIlwiLCAvLyBPcHRpb25hbDogQWRkaXRpb25hbCBwcm9tcHQgb3IgcmVxdWlyZW1lbnRzXHJcbiAgICB9ID0gcmVxdWVzdERhdGE7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gTm90aWZ5IGNoYXQgc3lzdGVtIHRoYXQgd29ya2Zsb3cgaXMgc3RhcnRpbmdcclxuICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICBjb250ZW50OiBgU3RhcnRpbmcgbWFudWFsIHdvcmtmbG93IGZvciB0b3BpYzogXCIke3RvcGljfVwiYCxcclxuICAgICAgICBtZXRhZGF0YTogeyB3b3JrZmxvd0lkLCBzdGF0dXM6IFwic3RhcnRpbmdcIiB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIFVzZSBEZWVwU2VlayBBUEkgZGlyZWN0bHkgZm9yIG1hbnVhbCBnZW5lcmF0aW9uXHJcbiAgICAgIGNvbnN0IG1hbnVhbCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNYW51YWxXaXRoRGVlcFNlZWsodG9waWMsIHByb21wdCk7XHJcblxyXG4gICAgICAvLyBOb3RpZnkgY2hhdCBzeXN0ZW0gb2Ygc3VjY2Vzc2Z1bCBjb21wbGV0aW9uXHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgY29udGVudDogYE1hbnVhbCB3b3JrZmxvdyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5ISBHZW5lcmF0ZWQgY29tcHJlaGVuc2l2ZSBtYW51YWwgZm9yIFwiJHt0b3BpY31cIi5gLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7IHdvcmtmbG93SWQsIHN0YXR1czogXCJjb21wbGV0ZWRcIiB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIFJldHVybiBzdHJ1Y3R1cmVkIHJlc3BvbnNlIHdpdGggd29ya2Zsb3cgZGV0YWlsc1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHdvcmtmbG93X2lkOiB3b3JrZmxvd0lkLFxyXG4gICAgICAgIHN0YXR1czogXCJjb21wbGV0ZWRcIixcclxuICAgICAgICByZXN1bHQ6IHtcclxuICAgICAgICAgIGRhdGE6IG1hbnVhbCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCAvLyBJU08gdGltZXN0YW1wIGZvciB0cmFja2luZ1xyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgLy8gTG9nIGVycm9yIGZvciBkZWJ1Z2dpbmcgcHVycG9zZXNcclxuICAgICAgY29uc29sZS5lcnJvcihcIk1hbnVhbCB3b3JrZmxvdyBvcmNoZXN0cmF0aW9uIGZhaWxlZDpcIiwgZXJyb3IpO1xyXG5cclxuICAgICAgLy8gTm90aWZ5IGNoYXQgc3lzdGVtIG9mIHdvcmtmbG93IGZhaWx1cmVcclxuICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICBjb250ZW50OiBgTWFudWFsIHdvcmtmbG93IGZhaWxlZDogJHtcclxuICAgICAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCJcclxuICAgICAgICB9YCxcclxuICAgICAgICBtZXRhZGF0YTogeyB3b3JrZmxvd0lkLCBzdGF0dXM6IFwiZmFpbGVkXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBSZS10aHJvdyBlcnJvciB0byBiZSBoYW5kbGVkIGJ5IGNhbGxpbmcgY29kZVxyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGwgdGhlIGFjdHVhbCBtYW51YWwtY3JlYXRvci1hZ2VudCB1c2luZyBBMkEgcHJvdG9jb2xcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGNhbGxNYW51YWxDcmVhdG9yQWdlbnQoXHJcbiAgICB0b3BpYzogc3RyaW5nLFxyXG4gICAgcHJvbXB0OiBzdHJpbmdcclxuICApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coYPCfk5ogQ2FsbGluZyBtYW51YWwtY3JlYXRvci1hZ2VudCBmb3IgdG9waWM6ICR7dG9waWN9YCk7XHJcblxyXG4gICAgICAvLyBDYWxsIHRoZSBtYW51YWwtY3JlYXRvci1hZ2VudCBkaXJlY3RseVxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxyXG4gICAgICAgIFwiaHR0cDovL2xvY2FsaG9zdDo0MDAyL2FwaS9hY3Rpb25zL2dlbmVyYXRlLW1hbnVhbFwiLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgdG9waWM6IHRvcGljLFxyXG4gICAgICAgICAgICBwcm9tcHQ6IHByb21wdCxcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuXHJcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgICBgTWFudWFsIGNyZWF0b3IgYWdlbnQgcmVzcG9uZGVkIHdpdGggc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICBjb25zb2xlLmxvZyhcIk1hbnVhbCBjcmVhdG9yIGFnZW50IHJlc3BvbnNlOlwiLCByZXN1bHQpO1xyXG5cclxuICAgICAgLy8gRXh0cmFjdCB0aGUgbWFudWFsIGRhdGEgZnJvbSB0aGUgcmVzcG9uc2VcclxuICAgICAgaWYgKHJlc3VsdC5kYXRhICYmIHJlc3VsdC5kYXRhLmNvbnRlbnQpIHtcclxuICAgICAgICAvLyBUaGUgcmVzcG9uc2UgY29udGFpbnMgbWFya2Rvd24gY29udGVudCwgcGFyc2UgaXRcclxuICAgICAgICBjb25zdCBtYXJrZG93bkNvbnRlbnQgPSByZXN1bHQuZGF0YS5jb250ZW50O1xyXG5cclxuICAgICAgICAvLyBFeHRyYWN0IHRpdGxlIGZyb20gbWFya2Rvd25cclxuICAgICAgICBjb25zdCB0aXRsZU1hdGNoID0gbWFya2Rvd25Db250ZW50Lm1hdGNoKC9eIyAoLispJC9tKTtcclxuICAgICAgICBjb25zdCB0aXRsZSA9IHRpdGxlTWF0Y2ggPyB0aXRsZU1hdGNoWzFdIDogYE1hbnVhbDogJHt0b3BpY31gO1xyXG5cclxuICAgICAgICAvLyBFeHRyYWN0IGludHJvZHVjdGlvblxyXG4gICAgICAgIGNvbnN0IGludHJvTWF0Y2ggPSBtYXJrZG93bkNvbnRlbnQubWF0Y2goXHJcbiAgICAgICAgICAvIyMgSW50cm9kdWN0aW9uXFxuKFtcXHNcXFNdKj8pKD89XFxuIyMgfFxcbiMjIyB8JCkvXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjb25zdCBpbnRyb2R1Y3Rpb24gPSBpbnRyb01hdGNoXHJcbiAgICAgICAgICA/IGludHJvTWF0Y2hbMV0udHJpbSgpXHJcbiAgICAgICAgICA6IGBUaGlzIG1hbnVhbCBwcm92aWRlcyBjb21wcmVoZW5zaXZlIGluZm9ybWF0aW9uIGFib3V0ICR7dG9waWN9YDtcclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBzZWN0aW9uc1xyXG4gICAgICAgIGNvbnN0IHNlY3Rpb25zID0gW107XHJcbiAgICAgICAgY29uc3Qgc2VjdGlvblJlZ2V4ID1cclxuICAgICAgICAgIC8jIyMgU2VjdGlvbiBcXGQrOiAoW15cXG5dKylcXG4oW1xcc1xcU10qPykoPz1cXG4jIyMgU2VjdGlvbiB8XFxuIyMgfCQpL2c7XHJcbiAgICAgICAgbGV0IHNlY3Rpb25NYXRjaDtcclxuXHJcbiAgICAgICAgd2hpbGUgKChzZWN0aW9uTWF0Y2ggPSBzZWN0aW9uUmVnZXguZXhlYyhtYXJrZG93bkNvbnRlbnQpKSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgY29uc3Qgc2VjdGlvblRpdGxlID0gc2VjdGlvbk1hdGNoWzFdLnRyaW0oKTtcclxuICAgICAgICAgIGNvbnN0IHNlY3Rpb25Db250ZW50ID0gc2VjdGlvbk1hdGNoWzJdLnRyaW0oKTtcclxuXHJcbiAgICAgICAgICAvLyBFeHRyYWN0IHN1YnNlY3Rpb25zIGlmIGFueVxyXG4gICAgICAgICAgY29uc3Qgc3Vic2VjdGlvbnMgPSBbXTtcclxuICAgICAgICAgIGNvbnN0IHN1YnNlY3Rpb25SZWdleCA9IC9cXCpcXCooW14qXSspOlxcKlxcKihbXipdKykvZztcclxuICAgICAgICAgIGxldCBzdWJzZWN0aW9uTWF0Y2g7XHJcblxyXG4gICAgICAgICAgd2hpbGUgKFxyXG4gICAgICAgICAgICAoc3Vic2VjdGlvbk1hdGNoID0gc3Vic2VjdGlvblJlZ2V4LmV4ZWMoc2VjdGlvbkNvbnRlbnQpKSAhPT0gbnVsbFxyXG4gICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHN1YnNlY3Rpb25zLnB1c2goe1xyXG4gICAgICAgICAgICAgIHRpdGxlOiBzdWJzZWN0aW9uTWF0Y2hbMV0udHJpbSgpLFxyXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHN1YnNlY3Rpb25NYXRjaFsyXS50cmltKCksXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHNlY3Rpb25zLnB1c2goe1xyXG4gICAgICAgICAgICB0aXRsZTogc2VjdGlvblRpdGxlLFxyXG4gICAgICAgICAgICBjb250ZW50OiBzZWN0aW9uQ29udGVudCxcclxuICAgICAgICAgICAgc3Vic2VjdGlvbnM6IHN1YnNlY3Rpb25zLFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBFeHRyYWN0IGNvbmNsdXNpb25cclxuICAgICAgICBjb25zdCBjb25jbHVzaW9uTWF0Y2ggPSBtYXJrZG93bkNvbnRlbnQubWF0Y2goXHJcbiAgICAgICAgICAvIyMgQ29sbGFib3JhdGl2ZSBSZXZpZXdcXG4oW1xcc1xcU10qPykoPz1cXG4tLS18XFwqfCQpL1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgY29uY2x1c2lvbiA9IGNvbmNsdXNpb25NYXRjaFxyXG4gICAgICAgICAgPyBjb25jbHVzaW9uTWF0Y2hbMV0udHJpbSgpXHJcbiAgICAgICAgICA6IGBUaGlzIG1hbnVhbCBoYXMgcHJvdmlkZWQgY29tcHJlaGVuc2l2ZSBjb3ZlcmFnZSBvZiAke3RvcGljfS5gO1xyXG5cclxuICAgICAgICAvLyBFeHRyYWN0IGdsb3NzYXJ5IGFuZCByZWZlcmVuY2VzXHJcbiAgICAgICAgY29uc3QgZ2xvc3NhcnlNYXRjaCA9IG1hcmtkb3duQ29udGVudC5tYXRjaChcclxuICAgICAgICAgIC9cXCpcXCpHbG9zc2FyeTpcXCpcXCpcXG4oW1xcc1xcU10qPykoPz1cXG5cXCpcXCpSZWZlcmVuY2VzOlxcKlxcKnwkKS9cclxuICAgICAgICApO1xyXG4gICAgICAgIGNvbnN0IHJlZmVyZW5jZXNNYXRjaCA9IG1hcmtkb3duQ29udGVudC5tYXRjaChcclxuICAgICAgICAgIC9cXCpcXCpSZWZlcmVuY2VzOlxcKlxcKlxcbihbXFxzXFxTXSo/KSg/PVxcbi0tLXxcXCp8JCkvXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHRpdGxlOiB0aXRsZSxcclxuICAgICAgICAgIGludHJvZHVjdGlvbjoge1xyXG4gICAgICAgICAgICBwdXJwb3NlOiBpbnRyb2R1Y3Rpb24sXHJcbiAgICAgICAgICAgIGF1ZGllbmNlOiBcIkdlbmVyYWwgdXNlcnNcIixcclxuICAgICAgICAgICAgcHJlcmVxdWlzaXRlczogXCJCYXNpYyB1bmRlcnN0YW5kaW5nIG9mIHRoZSB0b3BpY1wiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNlY3Rpb25zOlxyXG4gICAgICAgICAgICBzZWN0aW9ucy5sZW5ndGggPiAwXHJcbiAgICAgICAgICAgICAgPyBzZWN0aW9uc1xyXG4gICAgICAgICAgICAgIDogW1xyXG4gICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiT3ZlcnZpZXdcIixcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBgVGhpcyBzZWN0aW9uIHByb3ZpZGVzIGFuIG92ZXJ2aWV3IG9mICR7dG9waWN9LmAsXHJcbiAgICAgICAgICAgICAgICAgICAgc3Vic2VjdGlvbnM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiR2V0dGluZyBTdGFydGVkXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogYFRoaXMgc2VjdGlvbiBjb3ZlcnMgdGhlIGJhc2ljcyBvZiAke3RvcGljfS5gLFxyXG4gICAgICAgICAgICAgICAgICAgIHN1YnNlY3Rpb25zOiBbXSxcclxuICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkFkdmFuY2VkIFRvcGljc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGBUaGlzIHNlY3Rpb24gY292ZXJzIGFkdmFuY2VkIGNvbmNlcHRzIHJlbGF0ZWQgdG8gJHt0b3BpY30uYCxcclxuICAgICAgICAgICAgICAgICAgICBzdWJzZWN0aW9uczogW10sXHJcbiAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgY29uY2x1c2lvbjogY29uY2x1c2lvbixcclxuICAgICAgICAgIGFwcGVuZGl4OiB7XHJcbiAgICAgICAgICAgIGdsb3NzYXJ5OiBnbG9zc2FyeU1hdGNoXHJcbiAgICAgICAgICAgICAgPyBnbG9zc2FyeU1hdGNoWzFdLnRyaW0oKVxyXG4gICAgICAgICAgICAgIDogXCJLZXkgdGVybXMgYW5kIGRlZmluaXRpb25zXCIsXHJcbiAgICAgICAgICAgIHJlc291cmNlczogcmVmZXJlbmNlc01hdGNoXHJcbiAgICAgICAgICAgICAgPyByZWZlcmVuY2VzTWF0Y2hbMV0udHJpbSgpXHJcbiAgICAgICAgICAgICAgOiBcIkFkZGl0aW9uYWwgcmVzb3VyY2VzIGFuZCByZWZlcmVuY2VzXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH07XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCByZXNwb25zZSBmb3JtYXQgZnJvbSBtYW51YWwgY3JlYXRvciBhZ2VudFwiKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNhbGxpbmcgbWFudWFsIGNyZWF0b3IgYWdlbnQ6XCIsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBtYW51YWwgdXNpbmcgRGVlcFNlZWsgQVBJXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1hbnVhbFdpdGhEZWVwU2VlayhcclxuICAgIHRvcGljOiBzdHJpbmcsXHJcbiAgICBwcm9tcHQ6IHN0cmluZ1xyXG4gICk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBJbXBvcnQgT3BlbkFJIGR5bmFtaWNhbGx5XHJcbiAgICAgIGNvbnN0IE9wZW5BSSA9IChhd2FpdCBpbXBvcnQoXCJvcGVuYWlcIikpLmRlZmF1bHQ7XHJcblxyXG4gICAgICBjb25zdCBjbGllbnQgPSBuZXcgT3BlbkFJKHtcclxuICAgICAgICBhcGlLZXk6IFwic2stNjc5NmVhMGYzOGM3NDk5ZGJmNDdjN2ZmMmEwMjY5NjZcIixcclxuICAgICAgICBiYXNlVVJMOiBcImh0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbVwiLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBjbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xyXG4gICAgICAgIG1vZGVsOiBcImRlZXBzZWVrLWNoYXRcIixcclxuICAgICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiBcInN5c3RlbVwiLFxyXG4gICAgICAgICAgICBjb250ZW50OiBgWW91IGFyZSBhbiBleHBlcnQgdGVjaG5pY2FsIHdyaXRlciBzcGVjaWFsaXppbmcgaW4gY3JlYXRpbmcgY29tcHJlaGVuc2l2ZSBtYW51YWxzIGFuZCBkb2N1bWVudGF0aW9uLiBDcmVhdGUgYSBkZXRhaWxlZCBtYW51YWwgYmFzZWQgb24gdGhlIHVzZXIncyByZXF1ZXN0LlxyXG5cclxuR2VuZXJhdGUgYSBjb21wcmVoZW5zaXZlIG1hbnVhbCBpbiBKU09OIGZvcm1hdDpcclxuXHJcbntcclxuICBcInRpdGxlXCI6IFwiTWFudWFsIFRpdGxlXCIsXHJcbiAgXCJpbnRyb2R1Y3Rpb25cIjoge1xyXG4gICAgXCJwdXJwb3NlXCI6IFwiUHVycG9zZSBvZiB0aGUgbWFudWFsXCIsXHJcbiAgICBcImF1ZGllbmNlXCI6IFwiVGFyZ2V0IGF1ZGllbmNlXCIsXHJcbiAgICBcInByZXJlcXVpc2l0ZXNcIjogXCJSZXF1aXJlZCBrbm93bGVkZ2Ugb3Igc2tpbGxzXCJcclxuICB9LFxyXG4gIFwic2VjdGlvbnNcIjogW1xyXG4gICAge1xyXG4gICAgICBcInRpdGxlXCI6IFwiU2VjdGlvbiBUaXRsZVwiLFxyXG4gICAgICBcImNvbnRlbnRcIjogXCJEZXRhaWxlZCBjb250ZW50IGZvciB0aGlzIHNlY3Rpb25cIixcclxuICAgICAgXCJzdWJzZWN0aW9uc1wiOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgXCJ0aXRsZVwiOiBcIlN1YnNlY3Rpb24gVGl0bGVcIixcclxuICAgICAgICAgIFwiY29udGVudFwiOiBcIlN1YnNlY3Rpb24gY29udGVudFwiXHJcbiAgICAgICAgfVxyXG4gICAgICBdXHJcbiAgICB9XHJcbiAgXSxcclxuICBcImNvbmNsdXNpb25cIjogXCJTdW1tYXJ5IGFuZCBuZXh0IHN0ZXBzXCIsXHJcbiAgXCJhcHBlbmRpeFwiOiB7XHJcbiAgICBcImdsb3NzYXJ5XCI6IFwiS2V5IHRlcm1zIGFuZCBkZWZpbml0aW9uc1wiLFxyXG4gICAgXCJyZXNvdXJjZXNcIjogXCJBZGRpdGlvbmFsIHJlc291cmNlcyBhbmQgcmVmZXJlbmNlc1wiXHJcbiAgfVxyXG59XHJcblxyXG5SRVFVSVJFTUVOVFM6XHJcbi0gQ3JlYXRlIGEgY29tcHJlaGVuc2l2ZSwgd2VsbC1zdHJ1Y3R1cmVkIG1hbnVhbFxyXG4tIEluY2x1ZGUgcHJhY3RpY2FsIGV4YW1wbGVzIGFuZCBzdGVwLWJ5LXN0ZXAgaW5zdHJ1Y3Rpb25zXHJcbi0gTWFrZSBjb250ZW50IGVkdWNhdGlvbmFsIGFuZCBlYXN5IHRvIGZvbGxvd1xyXG4tIE9yZ2FuaXplIGluZm9ybWF0aW9uIGxvZ2ljYWxseSB3aXRoIGNsZWFyIHNlY3Rpb25zXHJcbi0gSW5jbHVkZSByZWxldmFudCBkZXRhaWxzIGFuZCBjb250ZXh0XHJcbi0gRW5zdXJlIGNvbnRlbnQgaXMgYWNjdXJhdGUgYW5kIHByb2Zlc3Npb25hbGAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiBcInVzZXJcIixcclxuICAgICAgICAgICAgY29udGVudDogYENyZWF0ZSBhIGNvbXByZWhlbnNpdmUgbWFudWFsIGFib3V0OiAke3RvcGljfSR7XHJcbiAgICAgICAgICAgICAgcHJvbXB0ID8gYFxcblxcbkFkZGl0aW9uYWwgcmVxdWlyZW1lbnRzOiAke3Byb21wdH1gIDogXCJcIlxyXG4gICAgICAgICAgICB9YCxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgICBtYXhfdG9rZW5zOiA0MDAwLFxyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXHJcbiAgICAgICAgc3RyZWFtOiBmYWxzZSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGNvbXBsZXRpb24uY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCBcInt9XCI7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIEZpcnN0IHRyeSB0byBwYXJzZSBhcyBKU09OIGRpcmVjdGx5XHJcbiAgICAgICAgY29uc3QgbWFudWFsRGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2UpO1xyXG4gICAgICAgIHJldHVybiBtYW51YWxEYXRhO1xyXG4gICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICBcIkpTT04gcGFyc2luZyBmYWlsZWQsIHRyeWluZyB0byBleHRyYWN0IEpTT04gZnJvbSBtYXJrZG93bjpcIixcclxuICAgICAgICAgIHBhcnNlRXJyb3JcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBUcnkgdG8gZXh0cmFjdCBKU09OIGZyb20gbWFya2Rvd24gY29kZSBibG9ja3NcclxuICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvYGBganNvblxccyooW1xcc1xcU10qPylcXHMqYGBgLyk7XHJcbiAgICAgICAgaWYgKGpzb25NYXRjaCkge1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgZXh0cmFjdGVkSnNvbiA9IGpzb25NYXRjaFsxXS50cmltKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1hbnVhbERhdGEgPSBKU09OLnBhcnNlKGV4dHJhY3RlZEpzb24pO1xyXG4gICAgICAgICAgICByZXR1cm4gbWFudWFsRGF0YTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGV4dHJhY3RFcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBwYXJzZSBleHRyYWN0ZWQgSlNPTjpcIiwgZXh0cmFjdEVycm9yKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRyeSB0byBleHRyYWN0IEpTT04gd2l0aG91dCBjb2RlIGJsb2NrIG1hcmtlcnNcclxuICAgICAgICBjb25zdCBqc29uU3RhcnQgPSByZXNwb25zZS5pbmRleE9mKFwie1wiKTtcclxuICAgICAgICBjb25zdCBqc29uRW5kID0gcmVzcG9uc2UubGFzdEluZGV4T2YoXCJ9XCIpO1xyXG4gICAgICAgIGlmIChqc29uU3RhcnQgIT09IC0xICYmIGpzb25FbmQgIT09IC0xICYmIGpzb25FbmQgPiBqc29uU3RhcnQpIHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGpzb25TdHJpbmcgPSByZXNwb25zZS5zdWJzdHJpbmcoanNvblN0YXJ0LCBqc29uRW5kICsgMSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1hbnVhbERhdGEgPSBKU09OLnBhcnNlKGpzb25TdHJpbmcpO1xyXG4gICAgICAgICAgICByZXR1cm4gbWFudWFsRGF0YTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGV4dHJhY3RFcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBwYXJzZSBleHRyYWN0ZWQgSlNPTiBzdHJpbmc6XCIsIGV4dHJhY3RFcnJvcik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgIFwiQWxsIEpTT04gZXh0cmFjdGlvbiBhdHRlbXB0cyBmYWlsZWQsIHByb2Nlc3NpbmcgYXMgbWFya2Rvd24gY29udGVudFwiXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gSWYgSlNPTiBwYXJzaW5nIGZhaWxzLCBwcm9jZXNzIHRoZSBtYXJrZG93biBjb250ZW50XHJcbiAgICAgICAgY29uc3QgbWFya2Rvd25Db250ZW50ID0gcmVzcG9uc2U7XHJcblxyXG4gICAgICAgIC8vIEV4dHJhY3QgdGl0bGUgZnJvbSBtYXJrZG93blxyXG4gICAgICAgIGNvbnN0IHRpdGxlTWF0Y2ggPSBtYXJrZG93bkNvbnRlbnQubWF0Y2goL14jICguKykkL20pO1xyXG4gICAgICAgIGNvbnN0IHRpdGxlID0gdGl0bGVNYXRjaCA/IHRpdGxlTWF0Y2hbMV0gOiBgTWFudWFsOiAke3RvcGljfWA7XHJcblxyXG4gICAgICAgIC8vIEV4dHJhY3QgaW50cm9kdWN0aW9uXHJcbiAgICAgICAgY29uc3QgaW50cm9NYXRjaCA9IG1hcmtkb3duQ29udGVudC5tYXRjaChcclxuICAgICAgICAgIC8jIyBJbnRyb2R1Y3Rpb25cXG4oW1xcc1xcU10qPykoPz1cXG4jIyB8XFxuIyMjIHwkKS9cclxuICAgICAgICApO1xyXG4gICAgICAgIGNvbnN0IGludHJvZHVjdGlvbiA9IGludHJvTWF0Y2hcclxuICAgICAgICAgID8gaW50cm9NYXRjaFsxXS50cmltKClcclxuICAgICAgICAgIDogYFRoaXMgbWFudWFsIHByb3ZpZGVzIGNvbXByZWhlbnNpdmUgaW5mb3JtYXRpb24gYWJvdXQgJHt0b3BpY31gO1xyXG5cclxuICAgICAgICAvLyBFeHRyYWN0IHNlY3Rpb25zXHJcbiAgICAgICAgY29uc3Qgc2VjdGlvbnMgPSBbXTtcclxuICAgICAgICBjb25zdCBzZWN0aW9uUmVnZXggPVxyXG4gICAgICAgICAgLyMjIyBTZWN0aW9uIFxcZCs6IChbXlxcbl0rKVxcbihbXFxzXFxTXSo/KSg/PVxcbiMjIyBTZWN0aW9uIHxcXG4jIyB8JCkvZztcclxuICAgICAgICBsZXQgc2VjdGlvbk1hdGNoO1xyXG5cclxuICAgICAgICB3aGlsZSAoKHNlY3Rpb25NYXRjaCA9IHNlY3Rpb25SZWdleC5leGVjKG1hcmtkb3duQ29udGVudCkpICE9PSBudWxsKSB7XHJcbiAgICAgICAgICBjb25zdCBzZWN0aW9uVGl0bGUgPSBzZWN0aW9uTWF0Y2hbMV0udHJpbSgpO1xyXG4gICAgICAgICAgY29uc3Qgc2VjdGlvbkNvbnRlbnQgPSBzZWN0aW9uTWF0Y2hbMl0udHJpbSgpO1xyXG5cclxuICAgICAgICAgIC8vIEV4dHJhY3Qgc3Vic2VjdGlvbnMgaWYgYW55XHJcbiAgICAgICAgICBjb25zdCBzdWJzZWN0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgY29uc3Qgc3Vic2VjdGlvblJlZ2V4ID0gL1xcKlxcKihbXipdKyk6XFwqXFwqKFteKl0rKS9nO1xyXG4gICAgICAgICAgbGV0IHN1YnNlY3Rpb25NYXRjaDtcclxuXHJcbiAgICAgICAgICB3aGlsZSAoXHJcbiAgICAgICAgICAgIChzdWJzZWN0aW9uTWF0Y2ggPSBzdWJzZWN0aW9uUmVnZXguZXhlYyhzZWN0aW9uQ29udGVudCkpICE9PSBudWxsXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgc3Vic2VjdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgdGl0bGU6IHN1YnNlY3Rpb25NYXRjaFsxXS50cmltKCksXHJcbiAgICAgICAgICAgICAgY29udGVudDogc3Vic2VjdGlvbk1hdGNoWzJdLnRyaW0oKSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgc2VjdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICAgIHRpdGxlOiBzZWN0aW9uVGl0bGUsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IHNlY3Rpb25Db250ZW50LFxyXG4gICAgICAgICAgICBzdWJzZWN0aW9uczogc3Vic2VjdGlvbnMsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEV4dHJhY3QgY29uY2x1c2lvblxyXG4gICAgICAgIGNvbnN0IGNvbmNsdXNpb25NYXRjaCA9IG1hcmtkb3duQ29udGVudC5tYXRjaChcclxuICAgICAgICAgIC8jIyBDb2xsYWJvcmF0aXZlIFJldmlld1xcbihbXFxzXFxTXSo/KSg/PVxcbi0tLXxcXCp8JCkvXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjb25zdCBjb25jbHVzaW9uID0gY29uY2x1c2lvbk1hdGNoXHJcbiAgICAgICAgICA/IGNvbmNsdXNpb25NYXRjaFsxXS50cmltKClcclxuICAgICAgICAgIDogYFRoaXMgbWFudWFsIGhhcyBwcm92aWRlZCBjb21wcmVoZW5zaXZlIGNvdmVyYWdlIG9mICR7dG9waWN9LmA7XHJcblxyXG4gICAgICAgIC8vIEV4dHJhY3QgZ2xvc3NhcnkgYW5kIHJlZmVyZW5jZXNcclxuICAgICAgICBjb25zdCBnbG9zc2FyeU1hdGNoID0gbWFya2Rvd25Db250ZW50Lm1hdGNoKFxyXG4gICAgICAgICAgL1xcKlxcKkdsb3NzYXJ5OlxcKlxcKlxcbihbXFxzXFxTXSo/KSg/PVxcblxcKlxcKlJlZmVyZW5jZXM6XFwqXFwqfCQpL1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlc01hdGNoID0gbWFya2Rvd25Db250ZW50Lm1hdGNoKFxyXG4gICAgICAgICAgL1xcKlxcKlJlZmVyZW5jZXM6XFwqXFwqXFxuKFtcXHNcXFNdKj8pKD89XFxuLS0tfFxcKnwkKS9cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgdGl0bGU6IHRpdGxlLFxyXG4gICAgICAgICAgaW50cm9kdWN0aW9uOiB7XHJcbiAgICAgICAgICAgIHB1cnBvc2U6IGludHJvZHVjdGlvbixcclxuICAgICAgICAgICAgYXVkaWVuY2U6IFwiR2VuZXJhbCB1c2Vyc1wiLFxyXG4gICAgICAgICAgICBwcmVyZXF1aXNpdGVzOiBcIkJhc2ljIHVuZGVyc3RhbmRpbmcgb2YgdGhlIHRvcGljXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgc2VjdGlvbnM6XHJcbiAgICAgICAgICAgIHNlY3Rpb25zLmxlbmd0aCA+IDBcclxuICAgICAgICAgICAgICA/IHNlY3Rpb25zXHJcbiAgICAgICAgICAgICAgOiBbXHJcbiAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJPdmVydmlld1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGBUaGlzIHNlY3Rpb24gcHJvdmlkZXMgYW4gb3ZlcnZpZXcgb2YgJHt0b3BpY30uYCxcclxuICAgICAgICAgICAgICAgICAgICBzdWJzZWN0aW9uczogW10sXHJcbiAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJHZXR0aW5nIFN0YXJ0ZWRcIixcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBgVGhpcyBzZWN0aW9uIGNvdmVycyB0aGUgYmFzaWNzIG9mICR7dG9waWN9LmAsXHJcbiAgICAgICAgICAgICAgICAgICAgc3Vic2VjdGlvbnM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiQWR2YW5jZWQgVG9waWNzXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogYFRoaXMgc2VjdGlvbiBjb3ZlcnMgYWR2YW5jZWQgY29uY2VwdHMgcmVsYXRlZCB0byAke3RvcGljfS5gLFxyXG4gICAgICAgICAgICAgICAgICAgIHN1YnNlY3Rpb25zOiBbXSxcclxuICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICBjb25jbHVzaW9uOiBjb25jbHVzaW9uLFxyXG4gICAgICAgICAgYXBwZW5kaXg6IHtcclxuICAgICAgICAgICAgZ2xvc3Nhcnk6IGdsb3NzYXJ5TWF0Y2hcclxuICAgICAgICAgICAgICA/IGdsb3NzYXJ5TWF0Y2hbMV0udHJpbSgpXHJcbiAgICAgICAgICAgICAgOiBcIktleSB0ZXJtcyBhbmQgZGVmaW5pdGlvbnNcIixcclxuICAgICAgICAgICAgcmVzb3VyY2VzOiByZWZlcmVuY2VzTWF0Y2hcclxuICAgICAgICAgICAgICA/IHJlZmVyZW5jZXNNYXRjaFsxXS50cmltKClcclxuICAgICAgICAgICAgICA6IFwiQWRkaXRpb25hbCByZXNvdXJjZXMgYW5kIHJlZmVyZW5jZXNcIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkRlZXBTZWVrIG1hbnVhbCBnZW5lcmF0aW9uIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXhlY3V0ZSB3b3JrZmxvdyB3aXRoIGNoYXQgaW50ZWdyYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVXb3JrZmxvd1dpdGhDaGF0KHdvcmtmbG93SWQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCB3b3JrZmxvdyA9IHRoaXMud29ya2Zsb3dzLmdldCh3b3JrZmxvd0lkKTtcclxuICAgIGlmICghd29ya2Zsb3cpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBXb3JrZmxvdyAke3dvcmtmbG93SWR9IG5vdCBmb3VuZGApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3VsdHM6IGFueVtdID0gW107XHJcblxyXG4gICAgZm9yIChjb25zdCBzdGVwIG9mIHdvcmtmbG93LnN0ZXBzKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgLy8gQWRkIHN0ZXAgc3RhcnQgbWVzc2FnZSB0byBjaGF0XHJcbiAgICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgICB0eXBlOiBcIm9yY2hlc3RyYXRvclwiLFxyXG4gICAgICAgICAgY29udGVudDogYEV4ZWN1dGluZyBzdGVwOiAke3N0ZXAuc2tpbGxJZH0gb24gJHtzdGVwLmFnZW50SWR9YCxcclxuICAgICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAgIHdvcmtmbG93SWQsXHJcbiAgICAgICAgICAgIGFnZW50SWQ6IHN0ZXAuYWdlbnRJZCxcclxuICAgICAgICAgICAgc2tpbGxJZDogc3RlcC5za2lsbElkLFxyXG4gICAgICAgICAgICBzdGF0dXM6IFwicnVubmluZ1wiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgZGVwZW5kZW5jaWVzXHJcbiAgICAgICAgaWYgKHN0ZXAuZGVwZW5kZW5jaWVzKSB7XHJcbiAgICAgICAgICBjb25zdCBkZXBlbmRlbmN5UmVzdWx0cyA9IHN0ZXAuZGVwZW5kZW5jaWVzLm1hcCgoZGVwSWQpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGVwU3RlcCA9IHdvcmtmbG93LnN0ZXBzLmZpbmQoKHMpID0+IHMuaWQgPT09IGRlcElkKTtcclxuICAgICAgICAgICAgcmV0dXJuIGRlcFN0ZXA/LnJlc3VsdDtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGlmIChkZXBlbmRlbmN5UmVzdWx0cy5zb21lKChyKSA9PiAhcikpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEZXBlbmRlbmNpZXMgbm90IG1ldCBmb3Igc3RlcCAke3N0ZXAuaWR9YCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBFeGVjdXRlIHN0ZXBcclxuICAgICAgICBzdGVwLnN0YXR1cyA9IFwicnVubmluZ1wiO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVN0ZXAoc3RlcCk7XHJcbiAgICAgICAgc3RlcC5yZXN1bHQgPSByZXN1bHQ7XHJcbiAgICAgICAgc3RlcC5zdGF0dXMgPSBcImNvbXBsZXRlZFwiO1xyXG4gICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQpO1xyXG5cclxuICAgICAgICAvLyBBZGQgc3RlcCBjb21wbGV0aW9uIG1lc3NhZ2UgdG8gY2hhdFxyXG4gICAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgdHlwZTogXCJhZ2VudFwiLFxyXG4gICAgICAgICAgY29udGVudDogYFN0ZXAgY29tcGxldGVkOiAke3N0ZXAuc2tpbGxJZH1gLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgd29ya2Zsb3dJZCxcclxuICAgICAgICAgICAgYWdlbnRJZDogc3RlcC5hZ2VudElkLFxyXG4gICAgICAgICAgICBza2lsbElkOiBzdGVwLnNraWxsSWQsXHJcbiAgICAgICAgICAgIHN0YXR1czogXCJjb21wbGV0ZWRcIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgc3RlcC5zdGF0dXMgPSBcImZhaWxlZFwiO1xyXG4gICAgICAgIHdvcmtmbG93LnN0YXR1cyA9IFwiZmFpbGVkXCI7XHJcblxyXG4gICAgICAgIC8vIEFkZCBzdGVwIGZhaWx1cmUgbWVzc2FnZSB0byBjaGF0XHJcbiAgICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgICB0eXBlOiBcImFnZW50XCIsXHJcbiAgICAgICAgICBjb250ZW50OiBgU3RlcCBmYWlsZWQ6ICR7c3RlcC5za2lsbElkfSAtICR7XHJcbiAgICAgICAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCJcclxuICAgICAgICAgIH1gLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgd29ya2Zsb3dJZCxcclxuICAgICAgICAgICAgYWdlbnRJZDogc3RlcC5hZ2VudElkLFxyXG4gICAgICAgICAgICBza2lsbElkOiBzdGVwLnNraWxsSWQsXHJcbiAgICAgICAgICAgIHN0YXR1czogXCJmYWlsZWRcIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgd29ya2Zsb3cuc3RhdHVzID0gXCJjb21wbGV0ZWRcIjtcclxuICAgIHdvcmtmbG93LmNvbXBsZXRlZEF0ID0gbmV3IERhdGUoKTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0cztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEV4ZWN1dGUgYSBzaW5nbGUgd29ya2Zsb3cgc3RlcCB1c2luZyByZWFsIEEyQSBTREsgd2l0aCBlbmhhbmNlZCBlcnJvciBoYW5kbGluZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVN0ZXAoc3RlcDogV29ya2Zsb3dTdGVwKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IGFnZW50ID0gdGhpcy5hZ2VudHMuZ2V0KHN0ZXAuYWdlbnRJZCk7XHJcbiAgICBpZiAoIWFnZW50KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQWdlbnQgJHtzdGVwLmFnZW50SWR9IG5vdCBmb3VuZGApO1xyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDwn5SEIEV4ZWN1dGluZyBzdGVwICR7c3RlcC5pZH0gb24gYWdlbnQgJHtzdGVwLmFnZW50SWR9YCk7XHJcblxyXG4gICAgICAvLyBVc2UgZGlyZWN0IEhUVFAgY2FsbCBpbnN0ZWFkIG9mIEEyQSBTREsgdG8gYXZvaWQgYWdlbnQgY2FyZCBmZXRjaGluZyBpc3N1ZXNcclxuICAgICAgY29uc3QgbWVzc2FnZSA9IHtcclxuICAgICAgICBtZXNzYWdlSWQ6IHV1aWR2NCgpLFxyXG4gICAgICAgIHBhcnRzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGtpbmQ6IFwidGV4dFwiLFxyXG4gICAgICAgICAgICB0ZXh0OlxyXG4gICAgICAgICAgICAgIHN0ZXAuaW5wdXQudG9waWMgfHxcclxuICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBza2lsbElkOiBzdGVwLnNraWxsSWQsXHJcbiAgICAgICAgICAgICAgICBpbnB1dDogc3RlcC5pbnB1dCxcclxuICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIFNlbmQgZGlyZWN0IEhUVFAgcmVxdWVzdCB0byBiYWNrZW5kIGFnZW50XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7c3RlcC5hZ2VudElkfS9hMmEvdGFza3NgLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXHJcbiAgICAgICAgICBjb25maWd1cmF0aW9uOiB7XHJcbiAgICAgICAgICAgIGJsb2NraW5nOiB0cnVlLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBzdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhgQTJBIHJlc3BvbnNlIGZvciBzdGVwICR7c3RlcC5pZH06YCwgcmVzdWx0KTtcclxuXHJcbiAgICAgIC8vIEhhbmRsZSB0aGUgcmVzcG9uc2UgLSB0aGUgYmFja2VuZCBhZ2VudCByZXR1cm5zIHRoZSBxdWl6IGRhdGEgZGlyZWN0bHlcclxuICAgICAgaWYgKHJlc3VsdCAmJiB0eXBlb2YgcmVzdWx0ID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgLy8gRXh0cmFjdCBxdWl6IGRhdGEgZnJvbSB0aGUgcmVzcG9uc2VcclxuICAgICAgICBsZXQgcXVpekRhdGEgPSBudWxsO1xyXG5cclxuICAgICAgICBpZiAocmVzdWx0LnRhc2sgJiYgcmVzdWx0LnRhc2suYXJ0aWZhY3RzKSB7XHJcbiAgICAgICAgICAvLyBJZiByZXNwb25zZSBoYXMgdGFzayB3aXRoIGFydGlmYWN0cywgZXh0cmFjdCBxdWl6IGZyb20gYXJ0aWZhY3RzXHJcbiAgICAgICAgICBjb25zdCBxdWl6QXJ0aWZhY3QgPSByZXN1bHQudGFzay5hcnRpZmFjdHMuZmluZChcclxuICAgICAgICAgICAgKGFydGlmYWN0OiBhbnkpID0+XHJcbiAgICAgICAgICAgICAgYXJ0aWZhY3QubmFtZSA9PT0gXCJxdWl6Lmpzb25cIiB8fCBhcnRpZmFjdC5uYW1lID09PSBcInF1aXpcIlxyXG4gICAgICAgICAgKTtcclxuICAgICAgICAgIGlmIChxdWl6QXJ0aWZhY3QgJiYgcXVpekFydGlmYWN0LnBhcnRzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHF1aXpUZXh0ID0gcXVpekFydGlmYWN0LnBhcnRzLmZpbmQoXHJcbiAgICAgICAgICAgICAgKHBhcnQ6IGFueSkgPT4gcGFydC5raW5kID09PSBcInRleHRcIlxyXG4gICAgICAgICAgICApPy50ZXh0O1xyXG4gICAgICAgICAgICBpZiAocXVpelRleHQpIHtcclxuICAgICAgICAgICAgICBxdWl6RGF0YSA9IEpTT04ucGFyc2UocXVpelRleHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuZGF0YSkge1xyXG4gICAgICAgICAgLy8gSWYgcmVzcG9uc2UgaGFzIGRhdGEgZGlyZWN0bHlcclxuICAgICAgICAgIHF1aXpEYXRhID0gcmVzdWx0LmRhdGE7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQucXVpel9xdWVzdGlvbnMpIHtcclxuICAgICAgICAgIC8vIElmIHJlc3BvbnNlIGhhcyBxdWl6X3F1ZXN0aW9ucyBkaXJlY3RseVxyXG4gICAgICAgICAgcXVpekRhdGEgPSByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAocXVpekRhdGEgJiYgcXVpekRhdGEucXVpel9xdWVzdGlvbnMpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgICBg4pyFIFN0ZXAgJHtzdGVwLmlkfSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IHdpdGggJHtxdWl6RGF0YS5xdWl6X3F1ZXN0aW9ucy5sZW5ndGh9IHF1ZXN0aW9uc2BcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICByZXR1cm4gcXVpekRhdGEucXVpel9xdWVzdGlvbnM7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgICBg4pqg77iPIFN0ZXAgJHtzdGVwLmlkfSBjb21wbGV0ZWQgYnV0IG5vIHF1aXogZGF0YSBmb3VuZCBpbiByZXNwb25zZWBcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgYOKaoO+4jyBTdGVwICR7c3RlcC5pZH0gY29tcGxldGVkIHdpdGggdW5leHBlY3RlZCByZXNwb25zZSBmb3JtYXRgXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEEyQSB0YXNrIGV4ZWN1dGlvbiBmYWlsZWQgZm9yIHN0ZXAgJHtzdGVwLmlkfTpgLCBlcnJvcik7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICBgQTJBIGFnZW50IGNhbGwgZmFpbGVkIGZvciBzdGVwICR7c3RlcC5pZH06ICR7XHJcbiAgICAgICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBlcnJvclwiXHJcbiAgICAgICAgfWBcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEVuaGFuY2VkIHN5c3RlbSBoZWFsdGggbW9uaXRvcmluZyB3aXRoIGNpcmN1aXQgYnJlYWtlciBzdGF0dXNcclxuICAgKi9cclxuICBhc3luYyBtb25pdG9yU3lzdGVtSGVhbHRoKHJlcXVlc3REYXRhOiBhbnkpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgY29uc3QgaGVhbHRoQ2hlY2tzID0gW107XHJcbiAgICBjb25zdCBlbmhhbmNlZEFnZW50cyA9IHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLmdldEFsbEFnZW50cygpO1xyXG5cclxuICAgIC8vIENoZWNrIGVuaGFuY2VkIGFnZW50c1xyXG4gICAgZm9yIChjb25zdCBhZ2VudCBvZiBlbmhhbmNlZEFnZW50cykge1xyXG4gICAgICBjb25zdCBicmVha2VyU3RhdHVzID0gdGhpcy5jaXJjdWl0QnJlYWtlci5nZXRTdGF0dXMoYWdlbnQuaWQpO1xyXG5cclxuICAgICAgaGVhbHRoQ2hlY2tzLnB1c2goe1xyXG4gICAgICAgIGFnZW50OiBhZ2VudC5uYW1lLFxyXG4gICAgICAgIHVybDogYWdlbnQudXJsLFxyXG4gICAgICAgIHN0YXR1czogYWdlbnQuc3RhdHVzLFxyXG4gICAgICAgIGxvYWQ6IGFnZW50LmxvYWQsXHJcbiAgICAgICAgcmVsaWFiaWxpdHk6IGFnZW50LnJlbGlhYmlsaXR5LFxyXG4gICAgICAgIHJlc3BvbnNlVGltZTogYWdlbnQucmVzcG9uc2VUaW1lLFxyXG4gICAgICAgIGNpcmN1aXRCcmVha2VyOiBicmVha2VyU3RhdHVzLFxyXG4gICAgICAgIGxhc3RTZWVuOiBhZ2VudC5sYXN0U2VlbixcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgbGVnYWN5IGFnZW50c1xyXG4gICAgY29uc3QgYWdlbnRFbnRyaWVzID0gQXJyYXkuZnJvbSh0aGlzLmFnZW50cy5lbnRyaWVzKCkpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhZ2VudEVudHJpZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgW3VybCwgYWdlbnRdID0gYWdlbnRFbnRyaWVzW2ldO1xyXG5cclxuICAgICAgLy8gU2tpcCBpZiBhbHJlYWR5IGNoZWNrZWQgaW4gZW5oYW5jZWQgYWdlbnRzXHJcbiAgICAgIGlmIChlbmhhbmNlZEFnZW50cy5zb21lKChlYSkgPT4gZWEudXJsID09PSB1cmwpKSBjb250aW51ZTtcclxuXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcclxuICAgICAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgMzAwMCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dXJsfS9oZWFsdGhgLCB7XHJcbiAgICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xyXG5cclxuICAgICAgICBoZWFsdGhDaGVja3MucHVzaCh7XHJcbiAgICAgICAgICBhZ2VudDogYWdlbnQubmFtZSxcclxuICAgICAgICAgIHVybDogdXJsLFxyXG4gICAgICAgICAgc3RhdHVzOiBcImhlYWx0aHlcIixcclxuICAgICAgICAgIHJlc3BvbnNlX3RpbWU6IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KFwieC1yZXNwb25zZS10aW1lXCIpIHx8IFwidW5rbm93blwiLFxyXG4gICAgICAgICAgY2lyY3VpdEJyZWFrZXI6IG51bGwsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgaGVhbHRoQ2hlY2tzLnB1c2goe1xyXG4gICAgICAgICAgYWdlbnQ6IGFnZW50Lm5hbWUsXHJcbiAgICAgICAgICB1cmw6IHVybCxcclxuICAgICAgICAgIHN0YXR1czogXCJ1bmhlYWx0aHlcIixcclxuICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBlcnJvclwiLFxyXG4gICAgICAgICAgY2lyY3VpdEJyZWFrZXI6IG51bGwsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBvdmVyYWxsSGVhbHRoID0gaGVhbHRoQ2hlY2tzLmV2ZXJ5KChoKSA9PiBoLnN0YXR1cyA9PT0gXCJoZWFsdGh5XCIpXHJcbiAgICAgID8gXCJoZWFsdGh5XCJcclxuICAgICAgOiBcImRlZ3JhZGVkXCI7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgb3ZlcmFsbF9oZWFsdGg6IG92ZXJhbGxIZWFsdGgsXHJcbiAgICAgIGFnZW50czogaGVhbHRoQ2hlY2tzLFxyXG4gICAgICBjaXJjdWl0QnJlYWtlcnM6IHRoaXMuY2lyY3VpdEJyZWFrZXIuZ2V0QWxsU3RhdGVzKCksXHJcbiAgICAgIGVuaGFuY2VkX21ldHJpY3M6IHtcclxuICAgICAgICB0b3RhbEFnZW50czogZW5oYW5jZWRBZ2VudHMubGVuZ3RoLFxyXG4gICAgICAgIG9ubGluZUFnZW50czogZW5oYW5jZWRBZ2VudHMuZmlsdGVyKChhKSA9PiBhLnN0YXR1cyA9PT0gXCJvbmxpbmVcIilcclxuICAgICAgICAgIC5sZW5ndGgsXHJcbiAgICAgICAgYXZlcmFnZVJlbGlhYmlsaXR5OlxyXG4gICAgICAgICAgZW5oYW5jZWRBZ2VudHMucmVkdWNlKChzdW0sIGEpID0+IHN1bSArIGEucmVsaWFiaWxpdHksIDApIC9cclxuICAgICAgICAgIGVuaGFuY2VkQWdlbnRzLmxlbmd0aCxcclxuICAgICAgICBhdmVyYWdlUmVzcG9uc2VUaW1lOlxyXG4gICAgICAgICAgZW5oYW5jZWRBZ2VudHMucmVkdWNlKChzdW0sIGEpID0+IHN1bSArIGEucmVzcG9uc2VUaW1lLCAwKSAvXHJcbiAgICAgICAgICBlbmhhbmNlZEFnZW50cy5sZW5ndGgsXHJcbiAgICAgIH0sXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZCBtZXNzYWdlIHRvIGNoYXQgaGlzdG9yeVxyXG4gICAqL1xyXG4gIGFkZENoYXRNZXNzYWdlKG1lc3NhZ2U6IE9taXQ8Q2hhdE1lc3NhZ2UsIFwiaWRcIiB8IFwidGltZXN0YW1wXCI+KSB7XHJcbiAgICBjb25zdCBjaGF0TWVzc2FnZTogQ2hhdE1lc3NhZ2UgPSB7XHJcbiAgICAgIGlkOiB1dWlkdjQoKSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAuLi5tZXNzYWdlLFxyXG4gICAgfTtcclxuICAgIHRoaXMuY2hhdEhpc3RvcnkucHVzaChjaGF0TWVzc2FnZSk7XHJcbiAgICByZXR1cm4gY2hhdE1lc3NhZ2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgY2hhdCBoaXN0b3J5XHJcbiAgICovXHJcbiAgZ2V0Q2hhdEhpc3RvcnkoKTogQ2hhdE1lc3NhZ2VbXSB7XHJcbiAgICByZXR1cm4gdGhpcy5jaGF0SGlzdG9yeTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBjaGF0IGhpc3RvcnkgZm9yIGEgc3BlY2lmaWMgd29ya2Zsb3dcclxuICAgKi9cclxuICBnZXRXb3JrZmxvd0NoYXRIaXN0b3J5KHdvcmtmbG93SWQ6IHN0cmluZyk6IENoYXRNZXNzYWdlW10ge1xyXG4gICAgcmV0dXJuIHRoaXMuY2hhdEhpc3RvcnkuZmlsdGVyKFxyXG4gICAgICAobXNnKSA9PiBtc2cubWV0YWRhdGE/LndvcmtmbG93SWQgPT09IHdvcmtmbG93SWRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbGVhciBjaGF0IGhpc3RvcnlcclxuICAgKi9cclxuICBjbGVhckNoYXRIaXN0b3J5KCkge1xyXG4gICAgdGhpcy5jaGF0SGlzdG9yeSA9IFtdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFsbCB3b3JrZmxvd3NcclxuICAgKi9cclxuICBnZXRBbGxXb3JrZmxvd3MoKTogV29ya2Zsb3dbXSB7XHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLndvcmtmbG93cy52YWx1ZXMoKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgd29ya2Zsb3cgYnkgSURcclxuICAgKi9cclxuICBnZXRXb3JrZmxvdyh3b3JrZmxvd0lkOiBzdHJpbmcpOiBXb3JrZmxvdyB8IHVuZGVmaW5lZCB7XHJcbiAgICByZXR1cm4gdGhpcy53b3JrZmxvd3MuZ2V0KHdvcmtmbG93SWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFsbCBhZ2VudHNcclxuICAgKi9cclxuICBnZXRBbGxBZ2VudHMoKTogQWdlbnRJbmZvW10ge1xyXG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5hZ2VudHMudmFsdWVzKCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFnZW50IGJ5IFVSTFxyXG4gICAqL1xyXG4gIGdldEFnZW50KHVybDogc3RyaW5nKTogQWdlbnRJbmZvIHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiB0aGlzLmFnZW50cy5nZXQodXJsKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbInY0IiwidXVpZHY0IiwiRW5oYW5jZWRBZ2VudFNlbGVjdG9yIiwiQWdlbnRDaXJjdWl0QnJlYWtlciIsIkR5bmFtaWNBZ2VudERpc2NvdmVyeSIsIkVudmlyb25tZW50QWdlbnRNYW5hZ2VyIiwiTmV4dEpTT3JjaGVzdHJhdG9yU2VydmljZSIsImNvbnN0cnVjdG9yIiwiYWdlbnRzIiwiTWFwIiwid29ya2Zsb3dzIiwiY2hhdEhpc3RvcnkiLCJrbm93bkFnZW50VXJscyIsInJldHJ5QXR0ZW1wdHMiLCJ0aW1lb3V0TXMiLCJkeW5hbWljRGlzY292ZXJ5IiwiZW5oYW5jZWRBZ2VudFNlbGVjdG9yIiwiY2lyY3VpdEJyZWFrZXIiLCJlbnZpcm9ubWVudCIsInByb2Nlc3MiLCJlbnZpcm9ubWVudE1hbmFnZXIiLCJzdGFydEFnZW50RGlzY292ZXJ5IiwiaW5pdGlhbGl6ZVZpcnR1YWxBZ2VudHMiLCJpbml0aWFsaXplRW5oYW5jZWRBZ2VudHMiLCJpbml0aWFsaXplRHluYW1pY0Rpc2NvdmVyeSIsImJhY2tlbmRBZ2VudCIsImlkIiwibmFtZSIsInVybCIsImNhcGFiaWxpdGllcyIsImRlc2NyaXB0aW9uIiwia2V5d29yZHMiLCJjb25maWRlbmNlIiwicmVxdWlyZW1lbnRzIiwic3RhdHVzIiwibG9hZCIsInJlc3BvbnNlVGltZSIsInJlbGlhYmlsaXR5IiwibGFzdFNlZW4iLCJEYXRlIiwiZnJvbnRlbmRBZ2VudCIsIm1jcEFnZW50IiwicmVnaXN0ZXJBZ2VudCIsImRpc2NvdmVyeU1ldGhvZCIsImVudiIsIkFHRU5UX0RJU0NPVkVSWV9NRVRIT0QiLCJkaXNjb3ZlcnlDb25maWciLCJwcmVmaXgiLCJBR0VOVF9QUkVGSVgiLCJwb3J0cyIsInBhcnNlUG9ydHMiLCJBR0VOVF9QT1JUUyIsImhvc3RzIiwicGFyc2VIb3N0cyIsIkFHRU5UX0hPU1RTIiwibWFudWFsIiwiZ2V0QWxsQWdlbnRzIiwibWFwIiwiYWdlbnQiLCJtZXRhZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIndhcm4iLCJwb3J0c1N0cmluZyIsInNwbGl0IiwicG9ydCIsInBhcnNlSW50IiwidHJpbSIsImZpbHRlciIsImlzTmFOIiwiaG9zdHNTdHJpbmciLCJob3N0IiwibGVuZ3RoIiwibm9ybWFsTUNQQWdlbnQiLCJza2lsbHMiLCJ0eXBlIiwic2V0IiwiZ2V0QWxsQXZhaWxhYmxlQWdlbnRzIiwicHVzaCIsImxlZ2FjeUFnZW50cyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsInVuaXF1ZUFnZW50cyIsImluZGV4Iiwic2VsZiIsImZpbmRJbmRleCIsImEiLCJnZXRBZ2VudHNCeUNhcGFiaWxpdHkiLCJjYXBhYmlsaXR5IiwiaW5jbHVkZXMiLCJnZXRMb2FkQmFsYW5jZWRBZ2VudFVybCIsImVudkFnZW50IiwiZ2V0TG9hZEJhbGFuY2VkQWdlbnQiLCJkeW5hbWljQWdlbnRzIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiZ2V0UHJpbWFyeUFnZW50VXJsIiwiZ2V0UHJpbWFyeUFnZW50IiwiZGV0ZXJtaW5lQWdlbnRGb3JRdWVyeSIsInF1ZXJ5IiwiY29udGV4dCIsInJlc3VsdCIsInNlbGVjdEFnZW50IiwiYWRkQ2hhdE1lc3NhZ2UiLCJjb250ZW50IiwidG9GaXhlZCIsInJlYXNvbmluZyIsImFnZW50SWQiLCJkZXRlcm1pbmVBZ2VudEZvclF1ZXJ5TGVnYWN5IiwibG93ZXJRdWVyeSIsInRvTG93ZXJDYXNlIiwiZ2V0IiwiZXhlY3V0ZUFnZW50V2l0aFJlc2lsaWVuY2UiLCJzdGFydFRpbWUiLCJub3ciLCJzZWxlY3Rpb25UaW1lIiwiZXhlY3V0aW9uVGltZSIsInNlbGVjdGlvblN0YXJ0Iiwic3VjY2VzcyIsIm1ldHJpY3MiLCJ0b3RhbFRpbWUiLCJpc0FnZW50QXZhaWxhYmxlIiwidHJ5RmFsbGJhY2tFeGVjdXRpb24iLCJleGVjdXRpb25TdGFydCIsImV4ZWN1dGVXaXRoUmV0cnkiLCJyZWNvcmRTdWNjZXNzIiwidXBkYXRlQWdlbnRNZXRyaWNzIiwicmVjb3JkRmFpbHVyZSIsImxhc3RFcnJvciIsImF0dGVtcHQiLCJzdGFydHNXaXRoIiwiZXhlY3V0ZVZpcnR1YWxBZ2VudCIsImV4ZWN1dGVSZWFsQWdlbnQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJwb3ciLCJFcnJvciIsImV4Y2x1ZGVBZ2VudElkIiwiZmFsbGJhY2tBZ2VudHMiLCJnZXRGYWxsYmFja0FnZW50cyIsImZhbGxiYWNrVXNlZCIsImhhbmRsZUdlbmVyYWxNQ1BRdWVyeSIsInN0ZXAiLCJza2lsbElkIiwiaW5wdXQiLCJleGVjdXRlU3RlcCIsImhhbmRsZUNlbnRyYWxpemVkUmVxdWVzdCIsInJlcXVlc3REYXRhIiwicmVxdWVzdFR5cGUiLCJjbGFzc2lmeVJlcXVlc3RUeXBlIiwicm91dGVUb0JhY2tlbmRBZ2VudCIsInJvdXRlVG9NYW51YWxHZW5lcmF0b3IiLCJyb3V0ZVRvRGVlcFNlZWtBUEkiLCJpc1F1aXpGYWxsYmFjayIsImlzTWFudWFsRmFsbGJhY2siLCJmYWxsYmFja0Vycm9yIiwicmVzcG9uc2UiLCJnZXRDaGF0SGlzdG9yeSIsIk9wZW5BSSIsImRlZmF1bHQiLCJjbGllbnQiLCJhcGlLZXkiLCJiYXNlVVJMIiwiY29tcGxldGlvbiIsImNoYXQiLCJjb21wbGV0aW9ucyIsImNyZWF0ZSIsIm1vZGVsIiwibWVzc2FnZXMiLCJyb2xlIiwibWF4X3Rva2VucyIsInRlbXBlcmF0dXJlIiwic3RyZWFtIiwiY2hvaWNlcyIsIm1lc3NhZ2UiLCJjbGFzc2lmeVJlcXVlc3QiLCJyb3V0ZVRvRGVlcFNlZWtBUElGb3JRdWl6IiwiZ2VuZXJhdGVNYW51YWxXaXRoRGVlcFNlZWsiLCJkYXRhIiwianNvblN0cmluZyIsImpzb25TdGFydCIsImluZGV4T2YiLCJqc29uRW5kIiwibGFzdEluZGV4T2YiLCJzdWJzdHJpbmciLCJxdWl6RGF0YSIsIkpTT04iLCJwYXJzZSIsInBhcnNlRXJyb3IiLCJ0b3BpYyIsInJlcGxhY2UiLCJmYWxsYmFja0NvbXBsZXRpb24iLCJmYWxsYmFja1Jlc3BvbnNlIiwiZmFsbGJhY2tKc29uU3RyaW5nIiwiZmFsbGJhY2tKc29uU3RhcnQiLCJmYWxsYmFja0pzb25FbmQiLCJmYWxsYmFja1F1aXoiLCJyZWNlbnRIaXN0b3J5IiwibXNnIiwic2xpY2UiLCJjaGF0TW9kZSIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwiZGlzY292ZXJBZ2VudHMiLCJzZXRJbnRlcnZhbCIsImRpc2NvdmVyZWRBZ2VudHMiLCJhZ2VudENhcmRVcmwiLCJhZ2VudENhcmQiLCJnZXRBZ2VudENhcmQiLCJiYXNlVXJsIiwiYWdlbnRJbmZvIiwicG9wIiwicyIsImpvaW4iLCJjb3VudCIsIm9ubGluZUNvdW50Iiwib2ZmbGluZUNvdW50IiwiQTJBQ2xpZW50IiwiYTJhQ2xpZW50IiwiZnJvbUNhcmRVcmwiLCJjb250cm9sbGVyIiwiQWJvcnRDb250cm9sbGVyIiwidGltZW91dElkIiwiYWJvcnQiLCJmZXRjaCIsInNpZ25hbCIsImNsZWFyVGltZW91dCIsImpzb24iLCJmZXRjaEVycm9yIiwib3JjaGVzdHJhdGVRdWl6V29ya2Zsb3ciLCJ3b3JrZmxvd0lkIiwiZGlmZmljdWx0eSIsInF1ZXN0aW9uX2NvdW50Iiwid29ya2Zsb3ciLCJzdGVwcyIsImRlcGVuZGVuY2llcyIsImNyZWF0ZWRBdCIsImV4ZWN1dGVXb3JrZmxvd1dpdGhDaGF0Iiwid29ya2Zsb3dfaWQiLCJvcmNoZXN0cmF0ZU1hbnVhbFdvcmtmbG93IiwicHJvbXB0IiwiY2FsbE1hbnVhbENyZWF0b3JBZ2VudCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5Iiwic3RyaW5naWZ5Iiwib2siLCJtYXJrZG93bkNvbnRlbnQiLCJ0aXRsZU1hdGNoIiwibWF0Y2giLCJ0aXRsZSIsImludHJvTWF0Y2giLCJpbnRyb2R1Y3Rpb24iLCJzZWN0aW9ucyIsInNlY3Rpb25SZWdleCIsInNlY3Rpb25NYXRjaCIsImV4ZWMiLCJzZWN0aW9uVGl0bGUiLCJzZWN0aW9uQ29udGVudCIsInN1YnNlY3Rpb25zIiwic3Vic2VjdGlvblJlZ2V4Iiwic3Vic2VjdGlvbk1hdGNoIiwiY29uY2x1c2lvbk1hdGNoIiwiY29uY2x1c2lvbiIsImdsb3NzYXJ5TWF0Y2giLCJyZWZlcmVuY2VzTWF0Y2giLCJwdXJwb3NlIiwiYXVkaWVuY2UiLCJwcmVyZXF1aXNpdGVzIiwiYXBwZW5kaXgiLCJnbG9zc2FyeSIsInJlc291cmNlcyIsIm1hbnVhbERhdGEiLCJqc29uTWF0Y2giLCJleHRyYWN0ZWRKc29uIiwiZXh0cmFjdEVycm9yIiwicmVzdWx0cyIsImRlcGVuZGVuY3lSZXN1bHRzIiwiZGVwSWQiLCJkZXBTdGVwIiwiZmluZCIsInNvbWUiLCJyIiwiY29tcGxldGVkQXQiLCJtZXNzYWdlSWQiLCJwYXJ0cyIsImtpbmQiLCJ0ZXh0IiwiY29uZmlndXJhdGlvbiIsImJsb2NraW5nIiwidGFzayIsImFydGlmYWN0cyIsInF1aXpBcnRpZmFjdCIsImFydGlmYWN0IiwicXVpelRleHQiLCJwYXJ0IiwicXVpel9xdWVzdGlvbnMiLCJtb25pdG9yU3lzdGVtSGVhbHRoIiwiaGVhbHRoQ2hlY2tzIiwiZW5oYW5jZWRBZ2VudHMiLCJicmVha2VyU3RhdHVzIiwiZ2V0U3RhdHVzIiwiYWdlbnRFbnRyaWVzIiwiZW50cmllcyIsImkiLCJlYSIsInJlc3BvbnNlX3RpbWUiLCJvdmVyYWxsSGVhbHRoIiwiZXZlcnkiLCJoIiwib3ZlcmFsbF9oZWFsdGgiLCJjaXJjdWl0QnJlYWtlcnMiLCJnZXRBbGxTdGF0ZXMiLCJlbmhhbmNlZF9tZXRyaWNzIiwidG90YWxBZ2VudHMiLCJvbmxpbmVBZ2VudHMiLCJhdmVyYWdlUmVsaWFiaWxpdHkiLCJyZWR1Y2UiLCJzdW0iLCJhdmVyYWdlUmVzcG9uc2VUaW1lIiwiY2hhdE1lc3NhZ2UiLCJnZXRXb3JrZmxvd0NoYXRIaXN0b3J5IiwiY2xlYXJDaGF0SGlzdG9yeSIsImdldEFsbFdvcmtmbG93cyIsImdldFdvcmtmbG93IiwiZ2V0QWdlbnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/orchestratorService.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();