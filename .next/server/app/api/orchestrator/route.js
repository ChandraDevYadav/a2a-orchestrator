"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/orchestrator/route";
exports.ids = ["app/api/orchestrator/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_Chan_Dra_Dev_AtoA_Protocol_A2_Quiz_quiz_frontend_src_app_api_orchestrator_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/orchestrator/route.ts */ \"(rsc)/./src/app/api/orchestrator/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/orchestrator/route\",\n        pathname: \"/api/orchestrator\",\n        filename: \"route\",\n        bundlePath: \"app/api/orchestrator/route\"\n    },\n    resolvedPagePath: \"D:\\\\Chan Dra Dev\\\\AtoA_Protocol\\\\A2\\\\Quiz\\\\quiz-frontend\\\\src\\\\app\\\\api\\\\orchestrator\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Chan_Dra_Dev_AtoA_Protocol_A2_Quiz_quiz_frontend_src_app_api_orchestrator_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/orchestrator/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZvcmNoZXN0cmF0b3IlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm9yY2hlc3RyYXRvciUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRm9yY2hlc3RyYXRvciUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDQ2hhbiUyMERyYSUyMERldiU1Q0F0b0FfUHJvdG9jb2wlNUNBMiU1Q1F1aXolNUNxdWl6LWZyb250ZW5kJTVDc3JjJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1EJTNBJTVDQ2hhbiUyMERyYSUyMERldiU1Q0F0b0FfUHJvdG9jb2wlNUNBMiU1Q1F1aXolNUNxdWl6LWZyb250ZW5kJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUMrQztBQUM1SDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3F1aXotZnJvbnRlbmQvP2FhZjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcQ2hhbiBEcmEgRGV2XFxcXEF0b0FfUHJvdG9jb2xcXFxcQTJcXFxcUXVpelxcXFxxdWl6LWZyb250ZW5kXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXG9yY2hlc3RyYXRvclxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvb3JjaGVzdHJhdG9yL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvb3JjaGVzdHJhdG9yXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9vcmNoZXN0cmF0b3Ivcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxDaGFuIERyYSBEZXZcXFxcQXRvQV9Qcm90b2NvbFxcXFxBMlxcXFxRdWl6XFxcXHF1aXotZnJvbnRlbmRcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcb3JjaGVzdHJhdG9yXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9vcmNoZXN0cmF0b3Ivcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/orchestrator/route.ts":
/*!*******************************************!*\
  !*** ./src/app/api/orchestrator/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_orchestratorService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/orchestratorService */ \"(rsc)/./src/lib/orchestratorService.ts\");\n\n\n// Global orchestrator service instance\nlet orchestratorService;\n// Initialize orchestrator service\nfunction getOrchestratorService() {\n    if (!orchestratorService) {\n        orchestratorService = new _lib_orchestratorService__WEBPACK_IMPORTED_MODULE_1__.NextJSOrchestratorService();\n    }\n    return orchestratorService;\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { action, ...data } = body;\n        let result;\n        switch(action){\n            case \"discover_agents\":\n                result = await getOrchestratorService().discoverAgents(data);\n                break;\n            case \"orchestrate_quiz_workflow\":\n                result = await getOrchestratorService().orchestrateQuizWorkflow(data);\n                break;\n            case \"orchestrate-manual-workflow\":\n                result = await getOrchestratorService().orchestrateManualWorkflow(data);\n                break;\n            case \"monitor_system_health\":\n                result = await getOrchestratorService().monitorSystemHealth(data);\n                break;\n            case \"get_chat_history\":\n                result = getOrchestratorService().getChatHistory();\n                break;\n            case \"get_workflow_chat_history\":\n                result = getOrchestratorService().getWorkflowChatHistory(data.workflowId);\n                break;\n            case \"clear_chat_history\":\n                getOrchestratorService().clearChatHistory();\n                result = {\n                    success: true\n                };\n                break;\n            case \"get_workflows\":\n                result = getOrchestratorService().getAllWorkflows();\n                break;\n            case \"get_workflow\":\n                result = getOrchestratorService().getWorkflow(data.workflowId);\n                break;\n            case \"get_agents\":\n                result = getOrchestratorService().getAllAgents();\n                break;\n            case \"get_agent\":\n                result = getOrchestratorService().getAgent(data.url);\n                break;\n            case \"determine_agent_for_query\":\n                result = getOrchestratorService().determineAgentForQuery(data.query, data.context);\n                break;\n            case \"execute_agent_with_resilience\":\n                result = await getOrchestratorService().executeAgentWithResilience(data.query, data.context);\n                break;\n            case \"handle_general_mcp_query\":\n                result = await getOrchestratorService().handleGeneralMCPQuery(data);\n                break;\n            case \"handle_centralized_request\":\n                result = await getOrchestratorService().handleCentralizedRequest(data);\n                break;\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: `Unknown action: ${action}`\n                }, {\n                    status: 400\n                });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error(\"Orchestrator API error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const action = searchParams.get(\"action\");\n        let result;\n        switch(action){\n            case \"health\":\n                result = {\n                    status: \"ok\",\n                    service: \"nextjs-orchestrator\"\n                };\n                break;\n            case \"status\":\n                result = {\n                    orchestrator: {\n                        status: \"running\",\n                        uptime: process.uptime(),\n                        memory: process.memoryUsage(),\n                        version: \"1.0.0\"\n                    },\n                    agents: {\n                        discovered: getOrchestratorService().getAllAgents().length,\n                        active: getOrchestratorService().getAllAgents().filter((a)=>a.status === \"online\").length,\n                        last_discovery: new Date().toISOString()\n                    }\n                };\n                break;\n            case \"chat_history\":\n                result = getOrchestratorService().getChatHistory();\n                break;\n            case \"workflows\":\n                result = getOrchestratorService().getAllWorkflows();\n                break;\n            case \"agents\":\n                result = getOrchestratorService().getAllAgents();\n                break;\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: `Unknown action: ${action}`\n                }, {\n                    status: 400\n                });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error(\"Orchestrator GET API error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9vcmNoZXN0cmF0b3Ivcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUF3RDtBQUNjO0FBRXRFLHVDQUF1QztBQUN2QyxJQUFJRTtBQUVKLGtDQUFrQztBQUNsQyxTQUFTQztJQUNQLElBQUksQ0FBQ0QscUJBQXFCO1FBQ3hCQSxzQkFBc0IsSUFBSUQsK0VBQXlCQTtJQUNyRDtJQUNBLE9BQU9DO0FBQ1Q7QUFFTyxlQUFlRSxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNRCxRQUFRRSxJQUFJO1FBQy9CLE1BQU0sRUFBRUMsTUFBTSxFQUFFLEdBQUdDLE1BQU0sR0FBR0g7UUFFNUIsSUFBSUk7UUFFSixPQUFRRjtZQUNOLEtBQUs7Z0JBQ0hFLFNBQVMsTUFBTVAseUJBQXlCUSxjQUFjLENBQUNGO2dCQUN2RDtZQUVGLEtBQUs7Z0JBQ0hDLFNBQVMsTUFBTVAseUJBQXlCUyx1QkFBdUIsQ0FBQ0g7Z0JBQ2hFO1lBRUYsS0FBSztnQkFDSEMsU0FBUyxNQUFNUCx5QkFBeUJVLHlCQUF5QixDQUFDSjtnQkFDbEU7WUFFRixLQUFLO2dCQUNIQyxTQUFTLE1BQU1QLHlCQUF5QlcsbUJBQW1CLENBQUNMO2dCQUM1RDtZQUVGLEtBQUs7Z0JBQ0hDLFNBQVNQLHlCQUF5QlksY0FBYztnQkFDaEQ7WUFFRixLQUFLO2dCQUNITCxTQUFTUCx5QkFBeUJhLHNCQUFzQixDQUN0RFAsS0FBS1EsVUFBVTtnQkFFakI7WUFFRixLQUFLO2dCQUNIZCx5QkFBeUJlLGdCQUFnQjtnQkFDekNSLFNBQVM7b0JBQUVTLFNBQVM7Z0JBQUs7Z0JBQ3pCO1lBRUYsS0FBSztnQkFDSFQsU0FBU1AseUJBQXlCaUIsZUFBZTtnQkFDakQ7WUFFRixLQUFLO2dCQUNIVixTQUFTUCx5QkFBeUJrQixXQUFXLENBQUNaLEtBQUtRLFVBQVU7Z0JBQzdEO1lBRUYsS0FBSztnQkFDSFAsU0FBU1AseUJBQXlCbUIsWUFBWTtnQkFDOUM7WUFFRixLQUFLO2dCQUNIWixTQUFTUCx5QkFBeUJvQixRQUFRLENBQUNkLEtBQUtlLEdBQUc7Z0JBQ25EO1lBRUYsS0FBSztnQkFDSGQsU0FBU1AseUJBQXlCc0Isc0JBQXNCLENBQ3REaEIsS0FBS2lCLEtBQUssRUFDVmpCLEtBQUtrQixPQUFPO2dCQUVkO1lBRUYsS0FBSztnQkFDSGpCLFNBQVMsTUFBTVAseUJBQXlCeUIsMEJBQTBCLENBQ2hFbkIsS0FBS2lCLEtBQUssRUFDVmpCLEtBQUtrQixPQUFPO2dCQUVkO1lBRUYsS0FBSztnQkFDSGpCLFNBQVMsTUFBTVAseUJBQXlCMEIscUJBQXFCLENBQUNwQjtnQkFDOUQ7WUFFRixLQUFLO2dCQUNIQyxTQUFTLE1BQU1QLHlCQUF5QjJCLHdCQUF3QixDQUFDckI7Z0JBQ2pFO1lBRUY7Z0JBQ0UsT0FBT1QscURBQVlBLENBQUNPLElBQUksQ0FDdEI7b0JBQUV3QixPQUFPLENBQUMsZ0JBQWdCLEVBQUV2QixPQUFPLENBQUM7Z0JBQUMsR0FDckM7b0JBQUV3QixRQUFRO2dCQUFJO1FBRXBCO1FBRUEsT0FBT2hDLHFEQUFZQSxDQUFDTyxJQUFJLENBQUNHO0lBQzNCLEVBQUUsT0FBT3FCLE9BQU87UUFDZEUsUUFBUUYsS0FBSyxDQUFDLDJCQUEyQkE7UUFDekMsT0FBTy9CLHFEQUFZQSxDQUFDTyxJQUFJLENBQ3RCO1lBQ0V3QixPQUFPQSxpQkFBaUJHLFFBQVFILE1BQU1JLE9BQU8sR0FBRztRQUNsRCxHQUNBO1lBQUVILFFBQVE7UUFBSTtJQUVsQjtBQUNGO0FBRU8sZUFBZUksSUFBSS9CLE9BQW9CO0lBQzVDLElBQUk7UUFDRixNQUFNLEVBQUVnQyxZQUFZLEVBQUUsR0FBRyxJQUFJQyxJQUFJakMsUUFBUW1CLEdBQUc7UUFDNUMsTUFBTWhCLFNBQVM2QixhQUFhRSxHQUFHLENBQUM7UUFFaEMsSUFBSTdCO1FBRUosT0FBUUY7WUFDTixLQUFLO2dCQUNIRSxTQUFTO29CQUFFc0IsUUFBUTtvQkFBTVEsU0FBUztnQkFBc0I7Z0JBQ3hEO1lBRUYsS0FBSztnQkFDSDlCLFNBQVM7b0JBQ1ArQixjQUFjO3dCQUNaVCxRQUFRO3dCQUNSVSxRQUFRQyxRQUFRRCxNQUFNO3dCQUN0QkUsUUFBUUQsUUFBUUUsV0FBVzt3QkFDM0JDLFNBQVM7b0JBQ1g7b0JBQ0FDLFFBQVE7d0JBQ05DLFlBQVk3Qyx5QkFBeUJtQixZQUFZLEdBQUcyQixNQUFNO3dCQUMxREMsUUFBUS9DLHlCQUNMbUIsWUFBWSxHQUNaNkIsTUFBTSxDQUFDLENBQUNDLElBQU1BLEVBQUVwQixNQUFNLEtBQUssVUFBVWlCLE1BQU07d0JBQzlDSSxnQkFBZ0IsSUFBSUMsT0FBT0MsV0FBVztvQkFDeEM7Z0JBQ0Y7Z0JBQ0E7WUFFRixLQUFLO2dCQUNIN0MsU0FBU1AseUJBQXlCWSxjQUFjO2dCQUNoRDtZQUVGLEtBQUs7Z0JBQ0hMLFNBQVNQLHlCQUF5QmlCLGVBQWU7Z0JBQ2pEO1lBRUYsS0FBSztnQkFDSFYsU0FBU1AseUJBQXlCbUIsWUFBWTtnQkFDOUM7WUFFRjtnQkFDRSxPQUFPdEIscURBQVlBLENBQUNPLElBQUksQ0FDdEI7b0JBQUV3QixPQUFPLENBQUMsZ0JBQWdCLEVBQUV2QixPQUFPLENBQUM7Z0JBQUMsR0FDckM7b0JBQUV3QixRQUFRO2dCQUFJO1FBRXBCO1FBRUEsT0FBT2hDLHFEQUFZQSxDQUFDTyxJQUFJLENBQUNHO0lBQzNCLEVBQUUsT0FBT3FCLE9BQU87UUFDZEUsUUFBUUYsS0FBSyxDQUFDLCtCQUErQkE7UUFDN0MsT0FBTy9CLHFEQUFZQSxDQUFDTyxJQUFJLENBQ3RCO1lBQ0V3QixPQUFPQSxpQkFBaUJHLFFBQVFILE1BQU1JLE9BQU8sR0FBRztRQUNsRCxHQUNBO1lBQUVILFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcXVpei1mcm9udGVuZC8uL3NyYy9hcHAvYXBpL29yY2hlc3RyYXRvci9yb3V0ZS50cz9iODQwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgTmV4dEpTT3JjaGVzdHJhdG9yU2VydmljZSB9IGZyb20gXCJAL2xpYi9vcmNoZXN0cmF0b3JTZXJ2aWNlXCI7XHJcblxyXG4vLyBHbG9iYWwgb3JjaGVzdHJhdG9yIHNlcnZpY2UgaW5zdGFuY2VcclxubGV0IG9yY2hlc3RyYXRvclNlcnZpY2U6IE5leHRKU09yY2hlc3RyYXRvclNlcnZpY2UgfCB1bmRlZmluZWQ7XHJcblxyXG4vLyBJbml0aWFsaXplIG9yY2hlc3RyYXRvciBzZXJ2aWNlXHJcbmZ1bmN0aW9uIGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKTogTmV4dEpTT3JjaGVzdHJhdG9yU2VydmljZSB7XHJcbiAgaWYgKCFvcmNoZXN0cmF0b3JTZXJ2aWNlKSB7XHJcbiAgICBvcmNoZXN0cmF0b3JTZXJ2aWNlID0gbmV3IE5leHRKU09yY2hlc3RyYXRvclNlcnZpY2UoKTtcclxuICB9XHJcbiAgcmV0dXJuIG9yY2hlc3RyYXRvclNlcnZpY2U7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcclxuICAgIGNvbnN0IHsgYWN0aW9uLCAuLi5kYXRhIH0gPSBib2R5O1xyXG5cclxuICAgIGxldCByZXN1bHQ7XHJcblxyXG4gICAgc3dpdGNoIChhY3Rpb24pIHtcclxuICAgICAgY2FzZSBcImRpc2NvdmVyX2FnZW50c1wiOlxyXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5kaXNjb3ZlckFnZW50cyhkYXRhKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJvcmNoZXN0cmF0ZV9xdWl6X3dvcmtmbG93XCI6XHJcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLm9yY2hlc3RyYXRlUXVpeldvcmtmbG93KGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcIm9yY2hlc3RyYXRlLW1hbnVhbC13b3JrZmxvd1wiOlxyXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5vcmNoZXN0cmF0ZU1hbnVhbFdvcmtmbG93KGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcIm1vbml0b3Jfc3lzdGVtX2hlYWx0aFwiOlxyXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5tb25pdG9yU3lzdGVtSGVhbHRoKGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImdldF9jaGF0X2hpc3RvcnlcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0Q2hhdEhpc3RvcnkoKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJnZXRfd29ya2Zsb3dfY2hhdF9oaXN0b3J5XCI6XHJcbiAgICAgICAgcmVzdWx0ID0gZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmdldFdvcmtmbG93Q2hhdEhpc3RvcnkoXHJcbiAgICAgICAgICBkYXRhLndvcmtmbG93SWRcclxuICAgICAgICApO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImNsZWFyX2NoYXRfaGlzdG9yeVwiOlxyXG4gICAgICAgIGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5jbGVhckNoYXRIaXN0b3J5KCk7XHJcbiAgICAgICAgcmVzdWx0ID0geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiZ2V0X3dvcmtmbG93c1wiOlxyXG4gICAgICAgIHJlc3VsdCA9IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5nZXRBbGxXb3JrZmxvd3MoKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJnZXRfd29ya2Zsb3dcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0V29ya2Zsb3coZGF0YS53b3JrZmxvd0lkKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJnZXRfYWdlbnRzXCI6XHJcbiAgICAgICAgcmVzdWx0ID0gZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmdldEFsbEFnZW50cygpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImdldF9hZ2VudFwiOlxyXG4gICAgICAgIHJlc3VsdCA9IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5nZXRBZ2VudChkYXRhLnVybCk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiZGV0ZXJtaW5lX2FnZW50X2Zvcl9xdWVyeVwiOlxyXG4gICAgICAgIHJlc3VsdCA9IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5kZXRlcm1pbmVBZ2VudEZvclF1ZXJ5KFxyXG4gICAgICAgICAgZGF0YS5xdWVyeSxcclxuICAgICAgICAgIGRhdGEuY29udGV4dFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiZXhlY3V0ZV9hZ2VudF93aXRoX3Jlc2lsaWVuY2VcIjpcclxuICAgICAgICByZXN1bHQgPSBhd2FpdCBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZXhlY3V0ZUFnZW50V2l0aFJlc2lsaWVuY2UoXHJcbiAgICAgICAgICBkYXRhLnF1ZXJ5LFxyXG4gICAgICAgICAgZGF0YS5jb250ZXh0XHJcbiAgICAgICAgKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJoYW5kbGVfZ2VuZXJhbF9tY3BfcXVlcnlcIjpcclxuICAgICAgICByZXN1bHQgPSBhd2FpdCBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuaGFuZGxlR2VuZXJhbE1DUFF1ZXJ5KGRhdGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcImhhbmRsZV9jZW50cmFsaXplZF9yZXF1ZXN0XCI6XHJcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmhhbmRsZUNlbnRyYWxpemVkUmVxdWVzdChkYXRhKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgeyBlcnJvcjogYFVua25vd24gYWN0aW9uOiAke2FjdGlvbn1gIH0sXHJcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXN1bHQpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiT3JjaGVzdHJhdG9yIEFQSSBlcnJvcjpcIiwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7XHJcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xyXG4gICAgY29uc3QgYWN0aW9uID0gc2VhcmNoUGFyYW1zLmdldChcImFjdGlvblwiKTtcclxuXHJcbiAgICBsZXQgcmVzdWx0O1xyXG5cclxuICAgIHN3aXRjaCAoYWN0aW9uKSB7XHJcbiAgICAgIGNhc2UgXCJoZWFsdGhcIjpcclxuICAgICAgICByZXN1bHQgPSB7IHN0YXR1czogXCJva1wiLCBzZXJ2aWNlOiBcIm5leHRqcy1vcmNoZXN0cmF0b3JcIiB9O1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSBcInN0YXR1c1wiOlxyXG4gICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgIG9yY2hlc3RyYXRvcjoge1xyXG4gICAgICAgICAgICBzdGF0dXM6IFwicnVubmluZ1wiLFxyXG4gICAgICAgICAgICB1cHRpbWU6IHByb2Nlc3MudXB0aW1lKCksXHJcbiAgICAgICAgICAgIG1lbW9yeTogcHJvY2Vzcy5tZW1vcnlVc2FnZSgpLFxyXG4gICAgICAgICAgICB2ZXJzaW9uOiBcIjEuMC4wXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYWdlbnRzOiB7XHJcbiAgICAgICAgICAgIGRpc2NvdmVyZWQ6IGdldE9yY2hlc3RyYXRvclNlcnZpY2UoKS5nZXRBbGxBZ2VudHMoKS5sZW5ndGgsXHJcbiAgICAgICAgICAgIGFjdGl2ZTogZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpXHJcbiAgICAgICAgICAgICAgLmdldEFsbEFnZW50cygpXHJcbiAgICAgICAgICAgICAgLmZpbHRlcigoYSkgPT4gYS5zdGF0dXMgPT09IFwib25saW5lXCIpLmxlbmd0aCxcclxuICAgICAgICAgICAgbGFzdF9kaXNjb3Zlcnk6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJjaGF0X2hpc3RvcnlcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0Q2hhdEhpc3RvcnkoKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgXCJ3b3JrZmxvd3NcIjpcclxuICAgICAgICByZXN1bHQgPSBnZXRPcmNoZXN0cmF0b3JTZXJ2aWNlKCkuZ2V0QWxsV29ya2Zsb3dzKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIFwiYWdlbnRzXCI6XHJcbiAgICAgICAgcmVzdWx0ID0gZ2V0T3JjaGVzdHJhdG9yU2VydmljZSgpLmdldEFsbEFnZW50cygpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgICB7IGVycm9yOiBgVW5rbm93biBhY3Rpb246ICR7YWN0aW9ufWAgfSxcclxuICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3VsdCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJPcmNoZXN0cmF0b3IgR0VUIEFQSSBlcnJvcjpcIiwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7XHJcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIk5leHRKU09yY2hlc3RyYXRvclNlcnZpY2UiLCJvcmNoZXN0cmF0b3JTZXJ2aWNlIiwiZ2V0T3JjaGVzdHJhdG9yU2VydmljZSIsIlBPU1QiLCJyZXF1ZXN0IiwiYm9keSIsImpzb24iLCJhY3Rpb24iLCJkYXRhIiwicmVzdWx0IiwiZGlzY292ZXJBZ2VudHMiLCJvcmNoZXN0cmF0ZVF1aXpXb3JrZmxvdyIsIm9yY2hlc3RyYXRlTWFudWFsV29ya2Zsb3ciLCJtb25pdG9yU3lzdGVtSGVhbHRoIiwiZ2V0Q2hhdEhpc3RvcnkiLCJnZXRXb3JrZmxvd0NoYXRIaXN0b3J5Iiwid29ya2Zsb3dJZCIsImNsZWFyQ2hhdEhpc3RvcnkiLCJzdWNjZXNzIiwiZ2V0QWxsV29ya2Zsb3dzIiwiZ2V0V29ya2Zsb3ciLCJnZXRBbGxBZ2VudHMiLCJnZXRBZ2VudCIsInVybCIsImRldGVybWluZUFnZW50Rm9yUXVlcnkiLCJxdWVyeSIsImNvbnRleHQiLCJleGVjdXRlQWdlbnRXaXRoUmVzaWxpZW5jZSIsImhhbmRsZUdlbmVyYWxNQ1BRdWVyeSIsImhhbmRsZUNlbnRyYWxpemVkUmVxdWVzdCIsImVycm9yIiwic3RhdHVzIiwiY29uc29sZSIsIkVycm9yIiwibWVzc2FnZSIsIkdFVCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsImdldCIsInNlcnZpY2UiLCJvcmNoZXN0cmF0b3IiLCJ1cHRpbWUiLCJwcm9jZXNzIiwibWVtb3J5IiwibWVtb3J5VXNhZ2UiLCJ2ZXJzaW9uIiwiYWdlbnRzIiwiZGlzY292ZXJlZCIsImxlbmd0aCIsImFjdGl2ZSIsImZpbHRlciIsImEiLCJsYXN0X2Rpc2NvdmVyeSIsIkRhdGUiLCJ0b0lTT1N0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/orchestrator/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/circuit-breaker.ts":
/*!************************************!*\
  !*** ./src/lib/circuit-breaker.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AgentCircuitBreaker: () => (/* binding */ AgentCircuitBreaker)\n/* harmony export */ });\n/**\r\n * Circuit Breaker Pattern for Agent Resilience\r\n * Prevents cascading failures and provides graceful degradation\r\n */ class AgentCircuitBreaker {\n    constructor(failureThreshold = 5, timeoutMs = 60000, successThreshold = 3){\n        this.breakers = new Map();\n        this.failureThreshold = failureThreshold;\n        this.timeoutMs = timeoutMs;\n        this.successThreshold = successThreshold;\n    }\n    /**\r\n   * Check if agent is available (circuit breaker allows)\r\n   */ isAgentAvailable(agentId) {\n        const breaker = this.breakers.get(agentId);\n        if (!breaker) return true; // No breaker = available\n        switch(breaker.state){\n            case \"closed\":\n                return true;\n            case \"open\":\n                // Check if timeout has passed\n                if (breaker.lastFailureTime && Date.now() - breaker.lastFailureTime.getTime() > this.timeoutMs) {\n                    breaker.state = \"half-open\";\n                    breaker.successCount = 0;\n                    return true;\n                }\n                return false;\n            case \"half-open\":\n                return true;\n            default:\n                return true;\n        }\n    }\n    /**\r\n   * Record a successful operation\r\n   */ recordSuccess(agentId) {\n        const breaker = this.breakers.get(agentId) || this.createBreaker(agentId);\n        breaker.successCount++;\n        breaker.failureCount = 0;\n        if (breaker.state === \"half-open\" && breaker.successCount >= this.successThreshold) {\n            breaker.state = \"closed\";\n        }\n    }\n    /**\r\n   * Record a failed operation\r\n   */ recordFailure(agentId) {\n        const breaker = this.breakers.get(agentId) || this.createBreaker(agentId);\n        breaker.failureCount++;\n        breaker.lastFailureTime = new Date();\n        if (breaker.failureCount >= this.failureThreshold) {\n            breaker.state = \"open\";\n        }\n    }\n    createBreaker(agentId) {\n        const breaker = {\n            state: \"closed\",\n            failureCount: 0,\n            successCount: 0\n        };\n        this.breakers.set(agentId, breaker);\n        return breaker;\n    }\n    /**\r\n   * Get circuit breaker status for monitoring\r\n   */ getStatus(agentId) {\n        return this.breakers.get(agentId) || null;\n    }\n    /**\r\n   * Reset circuit breaker (for manual intervention)\r\n   */ reset(agentId) {\n        this.breakers.delete(agentId);\n    }\n    /**\r\n   * Get all circuit breaker states\r\n   */ getAllStates() {\n        return new Map(this.breakers);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NpcmN1aXQtYnJlYWtlci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7OztDQUdDLEdBU00sTUFBTUE7SUFNWEMsWUFDRUMsbUJBQTJCLENBQUMsRUFDNUJDLFlBQW9CLEtBQUssRUFDekJDLG1CQUEyQixDQUFDLENBQzVCO2FBVE1DLFdBQTZDLElBQUlDO1FBVXZELElBQUksQ0FBQ0osZ0JBQWdCLEdBQUdBO1FBQ3hCLElBQUksQ0FBQ0MsU0FBUyxHQUFHQTtRQUNqQixJQUFJLENBQUNDLGdCQUFnQixHQUFHQTtJQUMxQjtJQUVBOztHQUVDLEdBQ0RHLGlCQUFpQkMsT0FBZSxFQUFXO1FBQ3pDLE1BQU1DLFVBQVUsSUFBSSxDQUFDSixRQUFRLENBQUNLLEdBQUcsQ0FBQ0Y7UUFDbEMsSUFBSSxDQUFDQyxTQUFTLE9BQU8sTUFBTSx5QkFBeUI7UUFFcEQsT0FBUUEsUUFBUUUsS0FBSztZQUNuQixLQUFLO2dCQUNILE9BQU87WUFDVCxLQUFLO2dCQUNILDhCQUE4QjtnQkFDOUIsSUFDRUYsUUFBUUcsZUFBZSxJQUN2QkMsS0FBS0MsR0FBRyxLQUFLTCxRQUFRRyxlQUFlLENBQUNHLE9BQU8sS0FBSyxJQUFJLENBQUNaLFNBQVMsRUFDL0Q7b0JBQ0FNLFFBQVFFLEtBQUssR0FBRztvQkFDaEJGLFFBQVFPLFlBQVksR0FBRztvQkFDdkIsT0FBTztnQkFDVDtnQkFDQSxPQUFPO1lBQ1QsS0FBSztnQkFDSCxPQUFPO1lBQ1Q7Z0JBQ0UsT0FBTztRQUNYO0lBQ0Y7SUFFQTs7R0FFQyxHQUNEQyxjQUFjVCxPQUFlLEVBQVE7UUFDbkMsTUFBTUMsVUFBVSxJQUFJLENBQUNKLFFBQVEsQ0FBQ0ssR0FBRyxDQUFDRixZQUFZLElBQUksQ0FBQ1UsYUFBYSxDQUFDVjtRQUVqRUMsUUFBUU8sWUFBWTtRQUNwQlAsUUFBUVUsWUFBWSxHQUFHO1FBRXZCLElBQ0VWLFFBQVFFLEtBQUssS0FBSyxlQUNsQkYsUUFBUU8sWUFBWSxJQUFJLElBQUksQ0FBQ1osZ0JBQWdCLEVBQzdDO1lBQ0FLLFFBQVFFLEtBQUssR0FBRztRQUNsQjtJQUNGO0lBRUE7O0dBRUMsR0FDRFMsY0FBY1osT0FBZSxFQUFRO1FBQ25DLE1BQU1DLFVBQVUsSUFBSSxDQUFDSixRQUFRLENBQUNLLEdBQUcsQ0FBQ0YsWUFBWSxJQUFJLENBQUNVLGFBQWEsQ0FBQ1Y7UUFFakVDLFFBQVFVLFlBQVk7UUFDcEJWLFFBQVFHLGVBQWUsR0FBRyxJQUFJQztRQUU5QixJQUFJSixRQUFRVSxZQUFZLElBQUksSUFBSSxDQUFDakIsZ0JBQWdCLEVBQUU7WUFDakRPLFFBQVFFLEtBQUssR0FBRztRQUNsQjtJQUNGO0lBRVFPLGNBQWNWLE9BQWUsRUFBdUI7UUFDMUQsTUFBTUMsVUFBK0I7WUFDbkNFLE9BQU87WUFDUFEsY0FBYztZQUNkSCxjQUFjO1FBQ2hCO1FBQ0EsSUFBSSxDQUFDWCxRQUFRLENBQUNnQixHQUFHLENBQUNiLFNBQVNDO1FBQzNCLE9BQU9BO0lBQ1Q7SUFFQTs7R0FFQyxHQUNEYSxVQUFVZCxPQUFlLEVBQThCO1FBQ3JELE9BQU8sSUFBSSxDQUFDSCxRQUFRLENBQUNLLEdBQUcsQ0FBQ0YsWUFBWTtJQUN2QztJQUVBOztHQUVDLEdBQ0RlLE1BQU1mLE9BQWUsRUFBUTtRQUMzQixJQUFJLENBQUNILFFBQVEsQ0FBQ21CLE1BQU0sQ0FBQ2hCO0lBQ3ZCO0lBRUE7O0dBRUMsR0FDRGlCLGVBQWlEO1FBQy9DLE9BQU8sSUFBSW5CLElBQUksSUFBSSxDQUFDRCxRQUFRO0lBQzlCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6LWZyb250ZW5kLy4vc3JjL2xpYi9jaXJjdWl0LWJyZWFrZXIudHM/MTJkNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ2lyY3VpdCBCcmVha2VyIFBhdHRlcm4gZm9yIEFnZW50IFJlc2lsaWVuY2VcclxuICogUHJldmVudHMgY2FzY2FkaW5nIGZhaWx1cmVzIGFuZCBwcm92aWRlcyBncmFjZWZ1bCBkZWdyYWRhdGlvblxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ2lyY3VpdEJyZWFrZXJTdGF0ZSB7XHJcbiAgc3RhdGU6IFwiY2xvc2VkXCIgfCBcIm9wZW5cIiB8IFwiaGFsZi1vcGVuXCI7XHJcbiAgZmFpbHVyZUNvdW50OiBudW1iZXI7XHJcbiAgbGFzdEZhaWx1cmVUaW1lPzogRGF0ZTtcclxuICBzdWNjZXNzQ291bnQ6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFnZW50Q2lyY3VpdEJyZWFrZXIge1xyXG4gIHByaXZhdGUgYnJlYWtlcnM6IE1hcDxzdHJpbmcsIENpcmN1aXRCcmVha2VyU3RhdGU+ID0gbmV3IE1hcCgpO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgZmFpbHVyZVRocmVzaG9sZDogbnVtYmVyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgdGltZW91dE1zOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBzdWNjZXNzVGhyZXNob2xkOiBudW1iZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZmFpbHVyZVRocmVzaG9sZDogbnVtYmVyID0gNSxcclxuICAgIHRpbWVvdXRNczogbnVtYmVyID0gNjAwMDAsIC8vIDEgbWludXRlXHJcbiAgICBzdWNjZXNzVGhyZXNob2xkOiBudW1iZXIgPSAzXHJcbiAgKSB7XHJcbiAgICB0aGlzLmZhaWx1cmVUaHJlc2hvbGQgPSBmYWlsdXJlVGhyZXNob2xkO1xyXG4gICAgdGhpcy50aW1lb3V0TXMgPSB0aW1lb3V0TXM7XHJcbiAgICB0aGlzLnN1Y2Nlc3NUaHJlc2hvbGQgPSBzdWNjZXNzVGhyZXNob2xkO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgYWdlbnQgaXMgYXZhaWxhYmxlIChjaXJjdWl0IGJyZWFrZXIgYWxsb3dzKVxyXG4gICAqL1xyXG4gIGlzQWdlbnRBdmFpbGFibGUoYWdlbnRJZDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBicmVha2VyID0gdGhpcy5icmVha2Vycy5nZXQoYWdlbnRJZCk7XHJcbiAgICBpZiAoIWJyZWFrZXIpIHJldHVybiB0cnVlOyAvLyBObyBicmVha2VyID0gYXZhaWxhYmxlXHJcblxyXG4gICAgc3dpdGNoIChicmVha2VyLnN0YXRlKSB7XHJcbiAgICAgIGNhc2UgXCJjbG9zZWRcIjpcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgY2FzZSBcIm9wZW5cIjpcclxuICAgICAgICAvLyBDaGVjayBpZiB0aW1lb3V0IGhhcyBwYXNzZWRcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICBicmVha2VyLmxhc3RGYWlsdXJlVGltZSAmJlxyXG4gICAgICAgICAgRGF0ZS5ub3coKSAtIGJyZWFrZXIubGFzdEZhaWx1cmVUaW1lLmdldFRpbWUoKSA+IHRoaXMudGltZW91dE1zXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICBicmVha2VyLnN0YXRlID0gXCJoYWxmLW9wZW5cIjtcclxuICAgICAgICAgIGJyZWFrZXIuc3VjY2Vzc0NvdW50ID0gMDtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGNhc2UgXCJoYWxmLW9wZW5cIjpcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlY29yZCBhIHN1Y2Nlc3NmdWwgb3BlcmF0aW9uXHJcbiAgICovXHJcbiAgcmVjb3JkU3VjY2VzcyhhZ2VudElkOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGNvbnN0IGJyZWFrZXIgPSB0aGlzLmJyZWFrZXJzLmdldChhZ2VudElkKSB8fCB0aGlzLmNyZWF0ZUJyZWFrZXIoYWdlbnRJZCk7XHJcblxyXG4gICAgYnJlYWtlci5zdWNjZXNzQ291bnQrKztcclxuICAgIGJyZWFrZXIuZmFpbHVyZUNvdW50ID0gMDtcclxuXHJcbiAgICBpZiAoXHJcbiAgICAgIGJyZWFrZXIuc3RhdGUgPT09IFwiaGFsZi1vcGVuXCIgJiZcclxuICAgICAgYnJlYWtlci5zdWNjZXNzQ291bnQgPj0gdGhpcy5zdWNjZXNzVGhyZXNob2xkXHJcbiAgICApIHtcclxuICAgICAgYnJlYWtlci5zdGF0ZSA9IFwiY2xvc2VkXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWNvcmQgYSBmYWlsZWQgb3BlcmF0aW9uXHJcbiAgICovXHJcbiAgcmVjb3JkRmFpbHVyZShhZ2VudElkOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGNvbnN0IGJyZWFrZXIgPSB0aGlzLmJyZWFrZXJzLmdldChhZ2VudElkKSB8fCB0aGlzLmNyZWF0ZUJyZWFrZXIoYWdlbnRJZCk7XHJcblxyXG4gICAgYnJlYWtlci5mYWlsdXJlQ291bnQrKztcclxuICAgIGJyZWFrZXIubGFzdEZhaWx1cmVUaW1lID0gbmV3IERhdGUoKTtcclxuXHJcbiAgICBpZiAoYnJlYWtlci5mYWlsdXJlQ291bnQgPj0gdGhpcy5mYWlsdXJlVGhyZXNob2xkKSB7XHJcbiAgICAgIGJyZWFrZXIuc3RhdGUgPSBcIm9wZW5cIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlQnJlYWtlcihhZ2VudElkOiBzdHJpbmcpOiBDaXJjdWl0QnJlYWtlclN0YXRlIHtcclxuICAgIGNvbnN0IGJyZWFrZXI6IENpcmN1aXRCcmVha2VyU3RhdGUgPSB7XHJcbiAgICAgIHN0YXRlOiBcImNsb3NlZFwiLFxyXG4gICAgICBmYWlsdXJlQ291bnQ6IDAsXHJcbiAgICAgIHN1Y2Nlc3NDb3VudDogMCxcclxuICAgIH07XHJcbiAgICB0aGlzLmJyZWFrZXJzLnNldChhZ2VudElkLCBicmVha2VyKTtcclxuICAgIHJldHVybiBicmVha2VyO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGNpcmN1aXQgYnJlYWtlciBzdGF0dXMgZm9yIG1vbml0b3JpbmdcclxuICAgKi9cclxuICBnZXRTdGF0dXMoYWdlbnRJZDogc3RyaW5nKTogQ2lyY3VpdEJyZWFrZXJTdGF0ZSB8IG51bGwge1xyXG4gICAgcmV0dXJuIHRoaXMuYnJlYWtlcnMuZ2V0KGFnZW50SWQpIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXNldCBjaXJjdWl0IGJyZWFrZXIgKGZvciBtYW51YWwgaW50ZXJ2ZW50aW9uKVxyXG4gICAqL1xyXG4gIHJlc2V0KGFnZW50SWQ6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgdGhpcy5icmVha2Vycy5kZWxldGUoYWdlbnRJZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIGNpcmN1aXQgYnJlYWtlciBzdGF0ZXNcclxuICAgKi9cclxuICBnZXRBbGxTdGF0ZXMoKTogTWFwPHN0cmluZywgQ2lyY3VpdEJyZWFrZXJTdGF0ZT4ge1xyXG4gICAgcmV0dXJuIG5ldyBNYXAodGhpcy5icmVha2Vycyk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJBZ2VudENpcmN1aXRCcmVha2VyIiwiY29uc3RydWN0b3IiLCJmYWlsdXJlVGhyZXNob2xkIiwidGltZW91dE1zIiwic3VjY2Vzc1RocmVzaG9sZCIsImJyZWFrZXJzIiwiTWFwIiwiaXNBZ2VudEF2YWlsYWJsZSIsImFnZW50SWQiLCJicmVha2VyIiwiZ2V0Iiwic3RhdGUiLCJsYXN0RmFpbHVyZVRpbWUiLCJEYXRlIiwibm93IiwiZ2V0VGltZSIsInN1Y2Nlc3NDb3VudCIsInJlY29yZFN1Y2Nlc3MiLCJjcmVhdGVCcmVha2VyIiwiZmFpbHVyZUNvdW50IiwicmVjb3JkRmFpbHVyZSIsInNldCIsImdldFN0YXR1cyIsInJlc2V0IiwiZGVsZXRlIiwiZ2V0QWxsU3RhdGVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/circuit-breaker.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/dynamic-agent-discovery.ts":
/*!********************************************!*\
  !*** ./src/lib/dynamic-agent-discovery.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DynamicAgentDiscovery: () => (/* binding */ DynamicAgentDiscovery)\n/* harmony export */ });\n/**\r\n * Dynamic Agent Discovery and Service Registry\r\n * Handles multiple agents dynamically without hardcoded URLs\r\n */ class DynamicAgentDiscovery {\n    constructor(config){\n        this.discoveredAgents = new Map();\n        this.discoveryInterval = null;\n        this.config = config;\n        this.startDiscovery();\n    }\n    /**\r\n   * Start agent discovery based on configuration\r\n   */ startDiscovery() {\n        // Initial discovery\n        this.performDiscovery();\n        // Periodic discovery every 30 seconds\n        this.discoveryInterval = setInterval(()=>{\n            this.performDiscovery();\n        }, 30000);\n    }\n    /**\r\n   * Perform discovery based on configured method\r\n   */ async performDiscovery() {\n        try {\n            switch(this.config.discoveryMethod){\n                case \"environment\":\n                    await this.discoverFromEnvironment();\n                    break;\n                case \"consul\":\n                    await this.discoverFromConsul();\n                    break;\n                case \"kubernetes\":\n                    await this.discoverFromKubernetes();\n                    break;\n                case \"multicast\":\n                    await this.discoverFromMulticast();\n                    break;\n                case \"manual\":\n                    await this.discoverFromManual();\n                    break;\n                default:\n                    console.warn(`Unknown discovery method: ${this.config.discoveryMethod}`);\n            }\n        } catch (error) {\n            console.error(\"Agent discovery failed:\", error);\n        }\n    }\n    /**\r\n   * Discover agents from environment variables\r\n   */ async discoverFromEnvironment() {\n        if (!this.config.environment) return;\n        const { prefix, ports = [\n            3000,\n            4001\n        ], hosts = [\n            \"localhost\"\n        ] } = this.config.environment;\n        for (const host of hosts){\n            for (const port of ports){\n                const url = `http://${host}:${port}`;\n                const agentId = `${host}:${port}`;\n                try {\n                    // Check if agent exists and get its capabilities\n                    const agentInfo = await this.probeAgent(url);\n                    if (agentInfo) {\n                        this.discoveredAgents.set(agentId, {\n                            id: agentId,\n                            name: agentInfo.name || `Agent-${agentId}`,\n                            url,\n                            capabilities: agentInfo.capabilities || [],\n                            status: \"online\",\n                            lastSeen: new Date(),\n                            metadata: {\n                                version: agentInfo.version,\n                                instance: agentId,\n                                tags: [\n                                    `env:${prefix}`\n                                ]\n                            }\n                        });\n                    }\n                } catch (error) {\n                    // Mark as offline if probe fails\n                    const existing = this.discoveredAgents.get(agentId);\n                    if (existing) {\n                        existing.status = \"offline\";\n                        existing.lastSeen = new Date();\n                    }\n                }\n            }\n        }\n    }\n    /**\r\n   * Discover agents from Consul service registry\r\n   */ async discoverFromConsul() {\n        if (!this.config.consul) return;\n        const { host, port, serviceName } = this.config.consul;\n        const consulUrl = `http://${host}:${port}`;\n        try {\n            const response = await fetch(`${consulUrl}/v1/health/service/${serviceName}`);\n            const services = await response.json();\n            for (const service of services){\n                const agent = service.Service;\n                const agentId = agent.ID;\n                this.discoveredAgents.set(agentId, {\n                    id: agentId,\n                    name: agent.Service,\n                    url: `http://${agent.Address}:${agent.Port}`,\n                    capabilities: agent.Tags || [],\n                    status: \"online\",\n                    lastSeen: new Date(),\n                    metadata: {\n                        version: agent.Meta?.version,\n                        region: service.Node?.Datacenter,\n                        instance: agentId,\n                        tags: agent.Tags\n                    }\n                });\n            }\n        } catch (error) {\n            console.error(\"Consul discovery failed:\", error);\n        }\n    }\n    /**\r\n   * Discover agents from Kubernetes\r\n   */ async discoverFromKubernetes() {\n        if (!this.config.kubernetes) return;\n        const { namespace, labelSelector } = this.config.kubernetes;\n        try {\n            // This would use Kubernetes API to discover services\n            // Implementation depends on your K8s setup\n            const response = await fetch(`/api/v1/namespaces/${namespace}/services?labelSelector=${labelSelector}`);\n            const services = await response.json();\n            for (const service of services.items){\n                const agentId = service.metadata.name;\n                const url = `http://${service.spec.clusterIP}:${service.spec.ports[0].port}`;\n                this.discoveredAgents.set(agentId, {\n                    id: agentId,\n                    name: service.metadata.name,\n                    url,\n                    capabilities: service.metadata.labels?.capabilities?.split(\",\") || [],\n                    status: \"online\",\n                    lastSeen: new Date(),\n                    metadata: {\n                        version: service.metadata.labels?.version,\n                        namespace: service.metadata.namespace,\n                        instance: agentId,\n                        tags: Object.keys(service.metadata.labels || {})\n                    }\n                });\n            }\n        } catch (error) {\n            console.error(\"Kubernetes discovery failed:\", error);\n        }\n    }\n    /**\r\n   * Discover agents using multicast\r\n   */ async discoverFromMulticast() {\n        if (!this.config.multicast) return;\n        // Implementation would use UDP multicast to discover agents\n        // This is a simplified version\n        console.log(\"Multicast discovery not implemented yet\");\n    }\n    /**\r\n   * Use manually configured agents\r\n   */ async discoverFromManual() {\n        if (!this.config.manual) return;\n        for (const agentConfig of this.config.manual.agents){\n            try {\n                const agentInfo = await this.probeAgent(agentConfig.url);\n                if (agentInfo) {\n                    this.discoveredAgents.set(agentConfig.id, {\n                        id: agentConfig.id,\n                        name: agentInfo.name || agentConfig.id,\n                        url: agentConfig.url,\n                        capabilities: agentConfig.capabilities,\n                        status: \"online\",\n                        lastSeen: new Date(),\n                        metadata: agentConfig.metadata\n                    });\n                }\n            } catch (error) {\n                console.warn(`Failed to probe manual agent ${agentConfig.id}:`, error);\n            }\n        }\n    }\n    /**\r\n   * Probe an agent to get its information\r\n   */ async probeAgent(url) {\n        const controller = new AbortController();\n        const timeoutId = setTimeout(()=>controller.abort(), 5000);\n        try {\n            const response = await fetch(`${url}/.well-known/agent-card.json`, {\n                signal: controller.signal\n            });\n            clearTimeout(timeoutId);\n            if (response.ok) {\n                return await response.json();\n            }\n        } catch (error) {\n            clearTimeout(timeoutId);\n            throw error;\n        }\n        return null;\n    }\n    /**\r\n   * Get all discovered agents\r\n   */ getAllAgents() {\n        return Array.from(this.discoveredAgents.values());\n    }\n    /**\r\n   * Get agents by capability\r\n   */ getAgentsByCapability(capability) {\n        return this.getAllAgents().filter((agent)=>agent.capabilities.includes(capability));\n    }\n    /**\r\n   * Get online agents only\r\n   */ getOnlineAgents() {\n        return this.getAllAgents().filter((agent)=>agent.status === \"online\");\n    }\n    /**\r\n   * Get agent by ID\r\n   */ getAgent(agentId) {\n        return this.discoveredAgents.get(agentId);\n    }\n    /**\r\n   * Stop discovery\r\n   */ stop() {\n        if (this.discoveryInterval) {\n            clearInterval(this.discoveryInterval);\n            this.discoveryInterval = null;\n        }\n    }\n    /**\r\n   * Update agent status\r\n   */ updateAgentStatus(agentId, status) {\n        const agent = this.discoveredAgents.get(agentId);\n        if (agent) {\n            agent.status = status;\n            agent.lastSeen = new Date();\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2R5bmFtaWMtYWdlbnQtZGlzY292ZXJ5LnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0NBR0MsR0F1RE0sTUFBTUE7SUFLWEMsWUFBWUMsTUFBNEIsQ0FBRTthQUpsQ0MsbUJBQWlELElBQUlDO2FBQ3JEQyxvQkFBMkM7UUFJakQsSUFBSSxDQUFDSCxNQUFNLEdBQUdBO1FBQ2QsSUFBSSxDQUFDSSxjQUFjO0lBQ3JCO0lBRUE7O0dBRUMsR0FDRCxpQkFBK0I7UUFDN0Isb0JBQW9CO1FBQ3BCLElBQUksQ0FBQ0MsZ0JBQWdCO1FBRXJCLHNDQUFzQztRQUN0QyxJQUFJLENBQUNGLGlCQUFpQixHQUFHRyxZQUFZO1lBQ25DLElBQUksQ0FBQ0QsZ0JBQWdCO1FBQ3ZCLEdBQUc7SUFDTDtJQUVBOztHQUVDLEdBQ0QsTUFBY0EsbUJBQWtDO1FBQzlDLElBQUk7WUFDRixPQUFRLElBQUksQ0FBQ0wsTUFBTSxDQUFDTyxlQUFlO2dCQUNqQyxLQUFLO29CQUNILE1BQU0sSUFBSSxDQUFDQyx1QkFBdUI7b0JBQ2xDO2dCQUNGLEtBQUs7b0JBQ0gsTUFBTSxJQUFJLENBQUNDLGtCQUFrQjtvQkFDN0I7Z0JBQ0YsS0FBSztvQkFDSCxNQUFNLElBQUksQ0FBQ0Msc0JBQXNCO29CQUNqQztnQkFDRixLQUFLO29CQUNILE1BQU0sSUFBSSxDQUFDQyxxQkFBcUI7b0JBQ2hDO2dCQUNGLEtBQUs7b0JBQ0gsTUFBTSxJQUFJLENBQUNDLGtCQUFrQjtvQkFDN0I7Z0JBQ0Y7b0JBQ0VDLFFBQVFDLElBQUksQ0FDVixDQUFDLDBCQUEwQixFQUFFLElBQUksQ0FBQ2QsTUFBTSxDQUFDTyxlQUFlLENBQUMsQ0FBQztZQUVoRTtRQUNGLEVBQUUsT0FBT1EsT0FBTztZQUNkRixRQUFRRSxLQUFLLENBQUMsMkJBQTJCQTtRQUMzQztJQUNGO0lBRUE7O0dBRUMsR0FDRCxNQUFjUCwwQkFBeUM7UUFDckQsSUFBSSxDQUFDLElBQUksQ0FBQ1IsTUFBTSxDQUFDZ0IsV0FB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RyxJQUFJQztRQUN2QjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6LWZyb250ZW5kLy4vc3JjL2xpYi9keW5hbWljLWFnZW50LWRpc2NvdmVyeS50cz8xZWE5Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBEeW5hbWljIEFnZW50IERpc2NvdmVyeSBhbmQgU2VydmljZSBSZWdpc3RyeVxyXG4gKiBIYW5kbGVzIG11bHRpcGxlIGFnZW50cyBkeW5hbWljYWxseSB3aXRob3V0IGhhcmRjb2RlZCBVUkxzXHJcbiAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBZ2VudERpc2NvdmVyeUNvbmZpZyB7XHJcbiAgZGlzY292ZXJ5TWV0aG9kOlxyXG4gICAgfCBcImVudmlyb25tZW50XCJcclxuICAgIHwgXCJjb25zdWxcIlxyXG4gICAgfCBcImV0Y2RcIlxyXG4gICAgfCBcImt1YmVybmV0ZXNcIlxyXG4gICAgfCBcIm11bHRpY2FzdFwiXHJcbiAgICB8IFwibWFudWFsXCI7XHJcbiAgZW52aXJvbm1lbnQ/OiB7XHJcbiAgICBwcmVmaXg6IHN0cmluZzsgLy8gZS5nLiwgXCJRVUlaX0FHRU5UXCJcclxuICAgIHBvcnRzPzogbnVtYmVyW107IC8vIGUuZy4sIFszMDAwLCA0MDAxLCA0MDAyXVxyXG4gICAgaG9zdHM/OiBzdHJpbmdbXTsgLy8gZS5nLiwgW1wibG9jYWxob3N0XCIsIFwiYWdlbnQxLmV4YW1wbGUuY29tXCJdXHJcbiAgfTtcclxuICBjb25zdWw/OiB7XHJcbiAgICBob3N0OiBzdHJpbmc7XHJcbiAgICBwb3J0OiBudW1iZXI7XHJcbiAgICBzZXJ2aWNlTmFtZTogc3RyaW5nO1xyXG4gIH07XHJcbiAga3ViZXJuZXRlcz86IHtcclxuICAgIG5hbWVzcGFjZTogc3RyaW5nO1xyXG4gICAgbGFiZWxTZWxlY3Rvcjogc3RyaW5nO1xyXG4gIH07XHJcbiAgbXVsdGljYXN0Pzoge1xyXG4gICAgcG9ydDogbnVtYmVyO1xyXG4gICAgZ3JvdXA6IHN0cmluZztcclxuICB9O1xyXG4gIG1hbnVhbD86IHtcclxuICAgIGFnZW50czogQXJyYXk8e1xyXG4gICAgICBpZDogc3RyaW5nO1xyXG4gICAgICB1cmw6IHN0cmluZztcclxuICAgICAgY2FwYWJpbGl0aWVzOiBzdHJpbmdbXTtcclxuICAgICAgbWV0YWRhdGE/OiBhbnk7XHJcbiAgICB9PjtcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERpc2NvdmVyZWRBZ2VudCB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgY2FwYWJpbGl0aWVzOiBzdHJpbmdbXTtcclxuICBzdGF0dXM6IFwib25saW5lXCIgfCBcIm9mZmxpbmVcIiB8IFwidW5rbm93blwiO1xyXG4gIGxhc3RTZWVuOiBEYXRlO1xyXG4gIG1ldGFkYXRhPzoge1xyXG4gICAgdmVyc2lvbj86IHN0cmluZztcclxuICAgIHJlZ2lvbj86IHN0cmluZztcclxuICAgIGluc3RhbmNlPzogc3RyaW5nO1xyXG4gICAgbG9hZD86IG51bWJlcjtcclxuICAgIHRhZ3M/OiBzdHJpbmdbXTtcclxuICAgIG5hbWVzcGFjZT86IHN0cmluZztcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRHluYW1pY0FnZW50RGlzY292ZXJ5IHtcclxuICBwcml2YXRlIGRpc2NvdmVyZWRBZ2VudHM6IE1hcDxzdHJpbmcsIERpc2NvdmVyZWRBZ2VudD4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSBkaXNjb3ZlcnlJbnRlcnZhbDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcclxuICBwcml2YXRlIGNvbmZpZzogQWdlbnREaXNjb3ZlcnlDb25maWc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogQWdlbnREaXNjb3ZlcnlDb25maWcpIHtcclxuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG4gICAgdGhpcy5zdGFydERpc2NvdmVyeSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhcnQgYWdlbnQgZGlzY292ZXJ5IGJhc2VkIG9uIGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIHN0YXJ0RGlzY292ZXJ5KCk6IHZvaWQge1xyXG4gICAgLy8gSW5pdGlhbCBkaXNjb3ZlcnlcclxuICAgIHRoaXMucGVyZm9ybURpc2NvdmVyeSgpO1xyXG5cclxuICAgIC8vIFBlcmlvZGljIGRpc2NvdmVyeSBldmVyeSAzMCBzZWNvbmRzXHJcbiAgICB0aGlzLmRpc2NvdmVyeUludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICB0aGlzLnBlcmZvcm1EaXNjb3ZlcnkoKTtcclxuICAgIH0sIDMwMDAwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBlcmZvcm0gZGlzY292ZXJ5IGJhc2VkIG9uIGNvbmZpZ3VyZWQgbWV0aG9kXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBwZXJmb3JtRGlzY292ZXJ5KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgc3dpdGNoICh0aGlzLmNvbmZpZy5kaXNjb3ZlcnlNZXRob2QpIHtcclxuICAgICAgICBjYXNlIFwiZW52aXJvbm1lbnRcIjpcclxuICAgICAgICAgIGF3YWl0IHRoaXMuZGlzY292ZXJGcm9tRW52aXJvbm1lbnQoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJjb25zdWxcIjpcclxuICAgICAgICAgIGF3YWl0IHRoaXMuZGlzY292ZXJGcm9tQ29uc3VsKCk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwia3ViZXJuZXRlc1wiOlxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5kaXNjb3ZlckZyb21LdWJlcm5ldGVzKCk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwibXVsdGljYXN0XCI6XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLmRpc2NvdmVyRnJvbU11bHRpY2FzdCgpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIm1hbnVhbFwiOlxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5kaXNjb3ZlckZyb21NYW51YWwoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oXHJcbiAgICAgICAgICAgIGBVbmtub3duIGRpc2NvdmVyeSBtZXRob2Q6ICR7dGhpcy5jb25maWcuZGlzY292ZXJ5TWV0aG9kfWBcclxuICAgICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJBZ2VudCBkaXNjb3ZlcnkgZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgZnJvbSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGRpc2NvdmVyRnJvbUVudmlyb25tZW50KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5lbnZpcm9ubWVudCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IHtcclxuICAgICAgcHJlZml4LFxyXG4gICAgICBwb3J0cyA9IFszMDAwLCA0MDAxXSxcclxuICAgICAgaG9zdHMgPSBbXCJsb2NhbGhvc3RcIl0sXHJcbiAgICB9ID0gdGhpcy5jb25maWcuZW52aXJvbm1lbnQ7XHJcblxyXG4gICAgZm9yIChjb25zdCBob3N0IG9mIGhvc3RzKSB7XHJcbiAgICAgIGZvciAoY29uc3QgcG9ydCBvZiBwb3J0cykge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwOi8vJHtob3N0fToke3BvcnR9YDtcclxuICAgICAgICBjb25zdCBhZ2VudElkID0gYCR7aG9zdH06JHtwb3J0fWA7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBDaGVjayBpZiBhZ2VudCBleGlzdHMgYW5kIGdldCBpdHMgY2FwYWJpbGl0aWVzXHJcbiAgICAgICAgICBjb25zdCBhZ2VudEluZm8gPSBhd2FpdCB0aGlzLnByb2JlQWdlbnQodXJsKTtcclxuICAgICAgICAgIGlmIChhZ2VudEluZm8pIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudElkLCB7XHJcbiAgICAgICAgICAgICAgaWQ6IGFnZW50SWQsXHJcbiAgICAgICAgICAgICAgbmFtZTogYWdlbnRJbmZvLm5hbWUgfHwgYEFnZW50LSR7YWdlbnRJZH1gLFxyXG4gICAgICAgICAgICAgIHVybCxcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IGFnZW50SW5mby5jYXBhYmlsaXRpZXMgfHwgW10sXHJcbiAgICAgICAgICAgICAgc3RhdHVzOiBcIm9ubGluZVwiLFxyXG4gICAgICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBhZ2VudEluZm8udmVyc2lvbixcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlOiBhZ2VudElkLFxyXG4gICAgICAgICAgICAgICAgdGFnczogW2BlbnY6JHtwcmVmaXh9YF0sXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIC8vIE1hcmsgYXMgb2ZmbGluZSBpZiBwcm9iZSBmYWlsc1xyXG4gICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLmRpc2NvdmVyZWRBZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAgICAgICAgIGV4aXN0aW5nLnN0YXR1cyA9IFwib2ZmbGluZVwiO1xyXG4gICAgICAgICAgICBleGlzdGluZy5sYXN0U2VlbiA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgZnJvbSBDb25zdWwgc2VydmljZSByZWdpc3RyeVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZGlzY292ZXJGcm9tQ29uc3VsKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5jb25zdWwpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCB7IGhvc3QsIHBvcnQsIHNlcnZpY2VOYW1lIH0gPSB0aGlzLmNvbmZpZy5jb25zdWw7XHJcbiAgICBjb25zdCBjb25zdWxVcmwgPSBgaHR0cDovLyR7aG9zdH06JHtwb3J0fWA7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcclxuICAgICAgICBgJHtjb25zdWxVcmx9L3YxL2hlYWx0aC9zZXJ2aWNlLyR7c2VydmljZU5hbWV9YFxyXG4gICAgICApO1xyXG4gICAgICBjb25zdCBzZXJ2aWNlcyA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuXHJcbiAgICAgIGZvciAoY29uc3Qgc2VydmljZSBvZiBzZXJ2aWNlcykge1xyXG4gICAgICAgIGNvbnN0IGFnZW50ID0gc2VydmljZS5TZXJ2aWNlO1xyXG4gICAgICAgIGNvbnN0IGFnZW50SWQgPSBhZ2VudC5JRDtcclxuXHJcbiAgICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudElkLCB7XHJcbiAgICAgICAgICBpZDogYWdlbnRJZCxcclxuICAgICAgICAgIG5hbWU6IGFnZW50LlNlcnZpY2UsXHJcbiAgICAgICAgICB1cmw6IGBodHRwOi8vJHthZ2VudC5BZGRyZXNzfToke2FnZW50LlBvcnR9YCxcclxuICAgICAgICAgIGNhcGFiaWxpdGllczogYWdlbnQuVGFncyB8fCBbXSxcclxuICAgICAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogYWdlbnQuTWV0YT8udmVyc2lvbixcclxuICAgICAgICAgICAgcmVnaW9uOiBzZXJ2aWNlLk5vZGU/LkRhdGFjZW50ZXIsXHJcbiAgICAgICAgICAgIGluc3RhbmNlOiBhZ2VudElkLFxyXG4gICAgICAgICAgICB0YWdzOiBhZ2VudC5UYWdzLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkNvbnN1bCBkaXNjb3ZlcnkgZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgZnJvbSBLdWJlcm5ldGVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBkaXNjb3ZlckZyb21LdWJlcm5ldGVzKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5rdWJlcm5ldGVzKSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgeyBuYW1lc3BhY2UsIGxhYmVsU2VsZWN0b3IgfSA9IHRoaXMuY29uZmlnLmt1YmVybmV0ZXM7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gVGhpcyB3b3VsZCB1c2UgS3ViZXJuZXRlcyBBUEkgdG8gZGlzY292ZXIgc2VydmljZXNcclxuICAgICAgLy8gSW1wbGVtZW50YXRpb24gZGVwZW5kcyBvbiB5b3VyIEs4cyBzZXR1cFxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxyXG4gICAgICAgIGAvYXBpL3YxL25hbWVzcGFjZXMvJHtuYW1lc3BhY2V9L3NlcnZpY2VzP2xhYmVsU2VsZWN0b3I9JHtsYWJlbFNlbGVjdG9yfWBcclxuICAgICAgKTtcclxuICAgICAgY29uc3Qgc2VydmljZXMgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IHNlcnZpY2Ugb2Ygc2VydmljZXMuaXRlbXMpIHtcclxuICAgICAgICBjb25zdCBhZ2VudElkID0gc2VydmljZS5tZXRhZGF0YS5uYW1lO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwOi8vJHtzZXJ2aWNlLnNwZWMuY2x1c3RlcklQfToke3NlcnZpY2Uuc3BlYy5wb3J0c1swXS5wb3J0fWA7XHJcblxyXG4gICAgICAgIHRoaXMuZGlzY292ZXJlZEFnZW50cy5zZXQoYWdlbnRJZCwge1xyXG4gICAgICAgICAgaWQ6IGFnZW50SWQsXHJcbiAgICAgICAgICBuYW1lOiBzZXJ2aWNlLm1ldGFkYXRhLm5hbWUsXHJcbiAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICBjYXBhYmlsaXRpZXM6IHNlcnZpY2UubWV0YWRhdGEubGFiZWxzPy5jYXBhYmlsaXRpZXM/LnNwbGl0KFwiLFwiKSB8fCBbXSxcclxuICAgICAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogc2VydmljZS5tZXRhZGF0YS5sYWJlbHM/LnZlcnNpb24sXHJcbiAgICAgICAgICAgIG5hbWVzcGFjZTogc2VydmljZS5tZXRhZGF0YS5uYW1lc3BhY2UsXHJcbiAgICAgICAgICAgIGluc3RhbmNlOiBhZ2VudElkLFxyXG4gICAgICAgICAgICB0YWdzOiBPYmplY3Qua2V5cyhzZXJ2aWNlLm1ldGFkYXRhLmxhYmVscyB8fCB7fSksXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiS3ViZXJuZXRlcyBkaXNjb3ZlcnkgZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNjb3ZlciBhZ2VudHMgdXNpbmcgbXVsdGljYXN0XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBkaXNjb3ZlckZyb21NdWx0aWNhc3QoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBpZiAoIXRoaXMuY29uZmlnLm11bHRpY2FzdCkgcmV0dXJuO1xyXG5cclxuICAgIC8vIEltcGxlbWVudGF0aW9uIHdvdWxkIHVzZSBVRFAgbXVsdGljYXN0IHRvIGRpc2NvdmVyIGFnZW50c1xyXG4gICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvblxyXG4gICAgY29uc29sZS5sb2coXCJNdWx0aWNhc3QgZGlzY292ZXJ5IG5vdCBpbXBsZW1lbnRlZCB5ZXRcIik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVc2UgbWFudWFsbHkgY29uZmlndXJlZCBhZ2VudHNcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGRpc2NvdmVyRnJvbU1hbnVhbCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGlmICghdGhpcy5jb25maWcubWFudWFsKSByZXR1cm47XHJcblxyXG4gICAgZm9yIChjb25zdCBhZ2VudENvbmZpZyBvZiB0aGlzLmNvbmZpZy5tYW51YWwuYWdlbnRzKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWdlbnRJbmZvID0gYXdhaXQgdGhpcy5wcm9iZUFnZW50KGFnZW50Q29uZmlnLnVybCk7XHJcbiAgICAgICAgaWYgKGFnZW50SW5mbykge1xyXG4gICAgICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudENvbmZpZy5pZCwge1xyXG4gICAgICAgICAgICBpZDogYWdlbnRDb25maWcuaWQsXHJcbiAgICAgICAgICAgIG5hbWU6IGFnZW50SW5mby5uYW1lIHx8IGFnZW50Q29uZmlnLmlkLFxyXG4gICAgICAgICAgICB1cmw6IGFnZW50Q29uZmlnLnVybCxcclxuICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBhZ2VudENvbmZpZy5jYXBhYmlsaXRpZXMsXHJcbiAgICAgICAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgIG1ldGFkYXRhOiBhZ2VudENvbmZpZy5tZXRhZGF0YSxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oYEZhaWxlZCB0byBwcm9iZSBtYW51YWwgYWdlbnQgJHthZ2VudENvbmZpZy5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQcm9iZSBhbiBhZ2VudCB0byBnZXQgaXRzIGluZm9ybWF0aW9uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBwcm9iZUFnZW50KHVybDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XHJcbiAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgNTAwMCk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt1cmx9Ly53ZWxsLWtub3duL2FnZW50LWNhcmQuanNvbmAsIHtcclxuICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxyXG4gICAgICB9KTtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcblxyXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIGRpc2NvdmVyZWQgYWdlbnRzXHJcbiAgICovXHJcbiAgZ2V0QWxsQWdlbnRzKCk6IERpc2NvdmVyZWRBZ2VudFtdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZGlzY292ZXJlZEFnZW50cy52YWx1ZXMoKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWdlbnRzIGJ5IGNhcGFiaWxpdHlcclxuICAgKi9cclxuICBnZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eTogc3RyaW5nKTogRGlzY292ZXJlZEFnZW50W10ge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0QWxsQWdlbnRzKCkuZmlsdGVyKChhZ2VudCkgPT5cclxuICAgICAgYWdlbnQuY2FwYWJpbGl0aWVzLmluY2x1ZGVzKGNhcGFiaWxpdHkpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IG9ubGluZSBhZ2VudHMgb25seVxyXG4gICAqL1xyXG4gIGdldE9ubGluZUFnZW50cygpOiBEaXNjb3ZlcmVkQWdlbnRbXSB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRBbGxBZ2VudHMoKS5maWx0ZXIoKGFnZW50KSA9PiBhZ2VudC5zdGF0dXMgPT09IFwib25saW5lXCIpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFnZW50IGJ5IElEXHJcbiAgICovXHJcbiAgZ2V0QWdlbnQoYWdlbnRJZDogc3RyaW5nKTogRGlzY292ZXJlZEFnZW50IHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiB0aGlzLmRpc2NvdmVyZWRBZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RvcCBkaXNjb3ZlcnlcclxuICAgKi9cclxuICBzdG9wKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuZGlzY292ZXJ5SW50ZXJ2YWwpIHtcclxuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmRpc2NvdmVyeUludGVydmFsKTtcclxuICAgICAgdGhpcy5kaXNjb3ZlcnlJbnRlcnZhbCA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgYWdlbnQgc3RhdHVzXHJcbiAgICovXHJcbiAgdXBkYXRlQWdlbnRTdGF0dXMoYWdlbnRJZDogc3RyaW5nLCBzdGF0dXM6IFwib25saW5lXCIgfCBcIm9mZmxpbmVcIik6IHZvaWQge1xyXG4gICAgY29uc3QgYWdlbnQgPSB0aGlzLmRpc2NvdmVyZWRBZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gICAgaWYgKGFnZW50KSB7XHJcbiAgICAgIGFnZW50LnN0YXR1cyA9IHN0YXR1cztcclxuICAgICAgYWdlbnQubGFzdFNlZW4gPSBuZXcgRGF0ZSgpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRHluYW1pY0FnZW50RGlzY292ZXJ5IiwiY29uc3RydWN0b3IiLCJjb25maWciLCJkaXNjb3ZlcmVkQWdlbnRzIiwiTWFwIiwiZGlzY292ZXJ5SW50ZXJ2YWwiLCJzdGFydERpc2NvdmVyeSIsInBlcmZvcm1EaXNjb3ZlcnkiLCJzZXRJbnRlcnZhbCIsImRpc2NvdmVyeU1ldGhvZCIsImRpc2NvdmVyRnJvbUVudmlyb25tZW50IiwiZGlzY292ZXJGcm9tQ29uc3VsIiwiZGlzY292ZXJGcm9tS3ViZXJuZXRlcyIsImRpc2NvdmVyRnJvbU11bHRpY2FzdCIsImRpc2NvdmVyRnJvbU1hbnVhbCIsImNvbnNvbGUiLCJ3YXJuIiwiZXJyb3IiLCJlbnZpcm9ubWVudCIsInByZWZpeCIsInBvcnRzIiwiaG9zdHMiLCJob3N0IiwicG9ydCIsInVybCIsImFnZW50SWQiLCJhZ2VudEluZm8iLCJwcm9iZUFnZW50Iiwic2V0IiwiaWQiLCJuYW1lIiwiY2FwYWJpbGl0aWVzIiwic3RhdHVzIiwibGFzdFNlZW4iLCJEYXRlIiwibWV0YWRhdGEiLCJ2ZXJzaW9uIiwiaW5zdGFuY2UiLCJ0YWdzIiwiZXhpc3RpbmciLCJnZXQiLCJjb25zdWwiLCJzZXJ2aWNlTmFtZSIsImNvbnN1bFVybCIsInJlc3BvbnNlIiwiZmV0Y2giLCJzZXJ2aWNlcyIsImpzb24iLCJzZXJ2aWNlIiwiYWdlbnQiLCJTZXJ2aWNlIiwiSUQiLCJBZGRyZXNzIiwiUG9ydCIsIlRhZ3MiLCJNZXRhIiwicmVnaW9uIiwiTm9kZSIsIkRhdGFjZW50ZXIiLCJrdWJlcm5ldGVzIiwibmFtZXNwYWNlIiwibGFiZWxTZWxlY3RvciIsIml0ZW1zIiwic3BlYyIsImNsdXN0ZXJJUCIsImxhYmVscyIsInNwbGl0IiwiT2JqZWN0Iiwia2V5cyIsIm11bHRpY2FzdCIsImxvZyIsIm1hbnVhbCIsImFnZW50Q29uZmlnIiwiYWdlbnRzIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInNpZ25hbCIsImNsZWFyVGltZW91dCIsIm9rIiwiZ2V0QWxsQWdlbnRzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwiZ2V0QWdlbnRzQnlDYXBhYmlsaXR5IiwiY2FwYWJpbGl0eSIsImZpbHRlciIsImluY2x1ZGVzIiwiZ2V0T25saW5lQWdlbnRzIiwiZ2V0QWdlbnQiLCJzdG9wIiwiY2xlYXJJbnRlcnZhbCIsInVwZGF0ZUFnZW50U3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/dynamic-agent-discovery.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/enhanced-agent-selector.ts":
/*!********************************************!*\
  !*** ./src/lib/enhanced-agent-selector.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EnhancedAgentSelector: () => (/* binding */ EnhancedAgentSelector)\n/* harmony export */ });\n/**\r\n * Enhanced Agent Selection System\r\n * Provides sophisticated agent routing based on multiple criteria\r\n */ class EnhancedAgentSelector {\n    /**\r\n   * Register an agent with its capabilities\r\n   */ registerAgent(agent) {\n        this.agents.set(agent.id, agent);\n        // Build capability index for faster lookups\n        agent.capabilities.forEach((capability)=>{\n            if (!this.capabilityIndex.has(capability.id)) {\n                this.capabilityIndex.set(capability.id, []);\n            }\n            this.capabilityIndex.get(capability.id).push(agent);\n        });\n    }\n    /**\r\n   * Select the best agent for a given query using multiple criteria\r\n   */ selectAgent(query, context) {\n        const queryLower = query.toLowerCase();\n        const candidates = [];\n        // Score each agent based on multiple criteria\n        for (const agent of Array.from(this.agents.values())){\n            if (agent.status !== \"online\") continue;\n            const { score, reasoning } = this.scoreAgent(agent, queryLower, context);\n            if (score > 0) {\n                candidates.push({\n                    agent,\n                    score,\n                    reasoning\n                });\n            }\n        }\n        // Sort by score (highest first)\n        candidates.sort((a, b)=>b.score - a.score);\n        if (candidates.length === 0) {\n            return {\n                agent: null,\n                confidence: 0,\n                reasoning: \"No suitable agents found\"\n            };\n        }\n        const best = candidates[0];\n        return {\n            agent: best.agent,\n            confidence: best.score,\n            reasoning: best.reasoning\n        };\n    }\n    /**\r\n   * Score an agent based on multiple criteria\r\n   */ scoreAgent(agent, queryLower, context) {\n        let totalScore = 0;\n        const reasons = [];\n        // 1. Capability matching (40% weight)\n        const capabilityScore = this.calculateCapabilityScore(agent, queryLower);\n        totalScore += capabilityScore * 0.4;\n        if (capabilityScore > 0) {\n            reasons.push(`Capability match: ${capabilityScore.toFixed(2)}`);\n        }\n        // 2. Agent availability (20% weight)\n        const availabilityScore = this.calculateAvailabilityScore(agent);\n        totalScore += availabilityScore * 0.2;\n        reasons.push(`Availability: ${availabilityScore.toFixed(2)}`);\n        // 3. Performance metrics (20% weight)\n        const performanceScore = this.calculatePerformanceScore(agent);\n        totalScore += performanceScore * 0.2;\n        reasons.push(`Performance: ${performanceScore.toFixed(2)}`);\n        // 4. Context awareness (20% weight)\n        const contextScore = this.calculateContextScore(agent, context);\n        totalScore += contextScore * 0.2;\n        if (contextScore > 0) {\n            reasons.push(`Context match: ${contextScore.toFixed(2)}`);\n        }\n        return {\n            score: Math.min(totalScore, 1),\n            reasoning: reasons.join(\", \")\n        };\n    }\n    calculateCapabilityScore(agent, queryLower) {\n        let bestMatch = 0;\n        for (const capability of agent.capabilities){\n            let capabilityScore = 0;\n            // Check keyword matches\n            const keywordMatches = capability.keywords.filter((keyword)=>queryLower.includes(keyword.toLowerCase())).length;\n            if (keywordMatches > 0) {\n                capabilityScore = keywordMatches / capability.keywords.length * capability.confidence;\n                bestMatch = Math.max(bestMatch, capabilityScore);\n            }\n        }\n        return bestMatch;\n    }\n    calculateAvailabilityScore(agent) {\n        // Factor in status, load, and recent activity\n        let score = 1.0;\n        if (agent.status === \"busy\") score *= 0.7;\n        if (agent.status === \"maintenance\") score *= 0.1;\n        if (agent.load > 0.8) score *= 0.5;\n        // Check if agent was recently active\n        const timeSinceLastSeen = Date.now() - agent.lastSeen.getTime();\n        if (timeSinceLastSeen > 300000) {\n            // 5 minutes\n            score *= 0.8;\n        }\n        return score;\n    }\n    calculatePerformanceScore(agent) {\n        // Combine response time and reliability\n        const responseScore = Math.max(0, 1 - agent.responseTime / 5000); // 5s max\n        const reliabilityScore = agent.reliability;\n        return (responseScore + reliabilityScore) / 2;\n    }\n    calculateContextScore(agent, context) {\n        if (!context) return 0.5; // Neutral score if no context\n        let score = 0.5; // Base score\n        // Adjust based on urgency\n        if (context.urgency === \"high\" && agent.responseTime < 1000) {\n            score += 0.3;\n        }\n        // Adjust based on complexity\n        if (context.complexity === \"complex\" && agent.capabilities.length > 3) {\n            score += 0.2;\n        }\n        return Math.min(score, 1.0);\n    }\n    /**\r\n   * Get fallback agents if primary selection fails\r\n   */ getFallbackAgents(query, excludeAgentId) {\n        const candidates = Array.from(this.agents.values()).filter((agent)=>agent.status === \"online\" && agent.id !== excludeAgentId).sort((a, b)=>b.reliability - a.reliability);\n        return candidates.slice(0, 3); // Return top 3 fallbacks\n    }\n    /**\r\n   * Update agent metrics after task completion\r\n   */ updateAgentMetrics(agentId, success, responseTime) {\n        const agent = this.agents.get(agentId);\n        if (!agent) return;\n        // Update reliability (exponential moving average)\n        agent.reliability = agent.reliability * 0.9 + (success ? 1 : 0) * 0.1;\n        // Update response time (exponential moving average)\n        agent.responseTime = agent.responseTime * 0.8 + responseTime * 0.2;\n        // Update last seen\n        agent.lastSeen = new Date();\n    }\n    /**\r\n   * Get all registered agents\r\n   */ getAllAgents() {\n        return Array.from(this.agents.values());\n    }\n    /**\r\n   * Get agent by ID\r\n   */ getAgent(agentId) {\n        return this.agents.get(agentId);\n    }\n    constructor(){\n        this.agents = new Map();\n        this.capabilityIndex = new Map();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2VuaGFuY2VkLWFnZW50LXNlbGVjdG9yLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0NBR0MsR0FnQ00sTUFBTUE7SUFJWDs7R0FFQyxHQUNEQyxjQUFjQyxLQUFtQixFQUFRO1FBQ3ZDLElBQUksQ0FBQ0MsTUFBTSxDQUFDQyxHQUFHLENBQUNGLE1BQU1HLEVBQUUsRUFBRUg7UUFFMUIsNENBQTRDO1FBQzVDQSxNQUFNSSxZQUFZLENBQUNDLE9BQU8sQ0FBQyxDQUFDQztZQUMxQixJQUFJLENBQUMsSUFBSSxDQUFDQyxlQUFlLENBQUNDLEdBQUcsQ0FBQ0YsV0FBV0gsRUFBRSxHQUFHO2dCQUM1QyxJQUFJLENBQUNJLGVBQWUsQ0FBQ0wsR0FBRyxDQUFDSSxXQUFXSCxFQUFFLEVBQUUsRUFBRTtZQUM1QztZQUNBLElBQUksQ0FBQ0ksZUFBZSxDQUFDRSxHQUFHLENBQUNILFdBQVdILEVBQUUsRUFBR08sSUFBSSxDQUFDVjtRQUNoRDtJQUNGO0lBRUE7O0dBRUMsR0FDRFcsWUFDRUMsS0FBYSxFQUNiQyxPQUFzQixFQUt0QjtRQUNBLE1BQU1DLGFBQWFGLE1BQU1HLFdBQVc7UUFDcEMsTUFBTUMsYUFJRCxFQUFFO1FBRVAsOENBQThDO1FBQzlDLEtBQUssTUFBTWhCLFNBQVNpQixNQUFNQyxJQUFJLENBQUMsSUFBSSxDQUFDakIsTUFBTSxDQUFDa0IsTUFBTSxJQUFLO1lBQ3BELElBQUluQixNQUFNb0IsTUFBTSxLQUFLLFVBQVU7WUFFL0IsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLFNBQVMsRUFBRSxHQUFHLElBQUksQ0FBQ0MsVUFBVSxDQUFDdkIsT0FBT2MsWUFBWUQ7WUFDaEUsSUFBSVEsUUFBUSxHQUFHO2dCQUNiTCxXQUFXTixJQUFJLENBQUM7b0JBQUVWO29CQUFPcUI7b0JBQU9DO2dCQUFVO1lBQzVDO1FBQ0Y7UUFFQSxnQ0FBZ0M7UUFDaENOLFdBQVdRLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNQSxFQUFFTCxLQUFL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QUFJLENBQUNDLE1BQU0sQ0FBQ1EsR0FBRyxDQUFDMEQ7UUFDOUIsSUFBSSxDQUFDbkUsT0FBTztRQUVaLGtEQUFrRDtRQUNsREEsTUFBTTRELFdBQVcsR0FBRzVELE1BQU00RCxXQUFXLEdBQUcsTUFBTSxDQUFDUSxVQUFVLElBQUksS0FBSztRQUVsRSxvREFBb0Q7UUFDcERwRSxNQUFNMEQsWUFBWSxHQUFHMUQsTUFBTTBELFlBQVksR0FBRyxNQUFNQSxlQUFlO1FBRS9ELG1CQUFtQjtRQUNuQjFELE1BQU11RCxRQUFRLEdBQUcsSUFBSUY7SUFDdkI7SUFFQTs7R0FFQyxHQUNEZ0IsZUFBK0I7UUFDN0IsT0FBT3BELE1BQU1DLElBQUksQ0FBQyxJQUFJLENBQUNqQixNQUFNLENBQUNrQixNQUFNO0lBQ3RDO0lBRUE7O0dBRUMsR0FDRG1ELFNBQVNILE9BQWUsRUFBNEI7UUFDbEQsT0FBTyxJQUFJLENBQUNsRSxNQUFNLENBQUNRLEdBQUcsQ0FBQzBEO0lBQ3pCOzthQS9OUWxFLFNBQW9DLElBQUlzRTthQUN4Q2hFLGtCQUErQyxJQUFJZ0U7O0FBK043RCIsInNvdXJjZXMiOlsid2VicGFjazovL3F1aXotZnJvbnRlbmQvLi9zcmMvbGliL2VuaGFuY2VkLWFnZW50LXNlbGVjdG9yLnRzP2JmOTIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEVuaGFuY2VkIEFnZW50IFNlbGVjdGlvbiBTeXN0ZW1cclxuICogUHJvdmlkZXMgc29waGlzdGljYXRlZCBhZ2VudCByb3V0aW5nIGJhc2VkIG9uIG11bHRpcGxlIGNyaXRlcmlhXHJcbiAqL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBZ2VudENhcGFiaWxpdHkge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAga2V5d29yZHM6IHN0cmluZ1tdO1xyXG4gIGNvbmZpZGVuY2U6IG51bWJlcjsgLy8gMC0xIHNjb3JlIGZvciBob3cgd2VsbCB0aGlzIGFnZW50IGhhbmRsZXMgdGhpcyBjYXBhYmlsaXR5XHJcbiAgcmVxdWlyZW1lbnRzPzogc3RyaW5nW107IC8vIEFkZGl0aW9uYWwgcmVxdWlyZW1lbnRzIChlLmcuLCBcIm5lZWRzLWF1dGhcIiwgXCJoaWdoLW1lbW9yeVwiKVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFnZW50UHJvZmlsZSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgY2FwYWJpbGl0aWVzOiBBZ2VudENhcGFiaWxpdHlbXTtcclxuICBzdGF0dXM6IFwib25saW5lXCIgfCBcIm9mZmxpbmVcIiB8IFwiYnVzeVwiIHwgXCJtYWludGVuYW5jZVwiO1xyXG4gIGxvYWQ6IG51bWJlcjsgLy8gQ3VycmVudCBsb2FkICgwLTEpXHJcbiAgcmVzcG9uc2VUaW1lOiBudW1iZXI7IC8vIEF2ZXJhZ2UgcmVzcG9uc2UgdGltZSBpbiBtc1xyXG4gIHJlbGlhYmlsaXR5OiBudW1iZXI7IC8vIFN1Y2Nlc3MgcmF0ZSAoMC0xKVxyXG4gIGxhc3RTZWVuOiBEYXRlO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJ5Q29udGV4dCB7XHJcbiAgcXVlcnk6IHN0cmluZztcclxuICB1c2VySW50ZW50Pzogc3RyaW5nO1xyXG4gIHByZXZpb3VzQ29udGV4dD86IGFueTtcclxuICB1c2VyUHJlZmVyZW5jZXM/OiBhbnk7XHJcbiAgdXJnZW5jeT86IFwibG93XCIgfCBcIm1lZGl1bVwiIHwgXCJoaWdoXCI7XHJcbiAgY29tcGxleGl0eT86IFwic2ltcGxlXCIgfCBcIm1vZGVyYXRlXCIgfCBcImNvbXBsZXhcIjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEVuaGFuY2VkQWdlbnRTZWxlY3RvciB7XHJcbiAgcHJpdmF0ZSBhZ2VudHM6IE1hcDxzdHJpbmcsIEFnZW50UHJvZmlsZT4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSBjYXBhYmlsaXR5SW5kZXg6IE1hcDxzdHJpbmcsIEFnZW50UHJvZmlsZVtdPiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXIgYW4gYWdlbnQgd2l0aCBpdHMgY2FwYWJpbGl0aWVzXHJcbiAgICovXHJcbiAgcmVnaXN0ZXJBZ2VudChhZ2VudDogQWdlbnRQcm9maWxlKTogdm9pZCB7XHJcbiAgICB0aGlzLmFnZW50cy5zZXQoYWdlbnQuaWQsIGFnZW50KTtcclxuXHJcbiAgICAvLyBCdWlsZCBjYXBhYmlsaXR5IGluZGV4IGZvciBmYXN0ZXIgbG9va3Vwc1xyXG4gICAgYWdlbnQuY2FwYWJpbGl0aWVzLmZvckVhY2goKGNhcGFiaWxpdHkpID0+IHtcclxuICAgICAgaWYgKCF0aGlzLmNhcGFiaWxpdHlJbmRleC5oYXMoY2FwYWJpbGl0eS5pZCkpIHtcclxuICAgICAgICB0aGlzLmNhcGFiaWxpdHlJbmRleC5zZXQoY2FwYWJpbGl0eS5pZCwgW10pO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuY2FwYWJpbGl0eUluZGV4LmdldChjYXBhYmlsaXR5LmlkKSEucHVzaChhZ2VudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNlbGVjdCB0aGUgYmVzdCBhZ2VudCBmb3IgYSBnaXZlbiBxdWVyeSB1c2luZyBtdWx0aXBsZSBjcml0ZXJpYVxyXG4gICAqL1xyXG4gIHNlbGVjdEFnZW50KFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ/OiBRdWVyeUNvbnRleHRcclxuICApOiB7XHJcbiAgICBhZ2VudDogQWdlbnRQcm9maWxlIHwgbnVsbDtcclxuICAgIGNvbmZpZGVuY2U6IG51bWJlcjtcclxuICAgIHJlYXNvbmluZzogc3RyaW5nO1xyXG4gIH0ge1xyXG4gICAgY29uc3QgcXVlcnlMb3dlciA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBjYW5kaWRhdGVzOiBBcnJheTx7XHJcbiAgICAgIGFnZW50OiBBZ2VudFByb2ZpbGU7XHJcbiAgICAgIHNjb3JlOiBudW1iZXI7XHJcbiAgICAgIHJlYXNvbmluZzogc3RyaW5nO1xyXG4gICAgfT4gPSBbXTtcclxuXHJcbiAgICAvLyBTY29yZSBlYWNoIGFnZW50IGJhc2VkIG9uIG11bHRpcGxlIGNyaXRlcmlhXHJcbiAgICBmb3IgKGNvbnN0IGFnZW50IG9mIEFycmF5LmZyb20odGhpcy5hZ2VudHMudmFsdWVzKCkpKSB7XHJcbiAgICAgIGlmIChhZ2VudC5zdGF0dXMgIT09IFwib25saW5lXCIpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgY29uc3QgeyBzY29yZSwgcmVhc29uaW5nIH0gPSB0aGlzLnNjb3JlQWdlbnQoYWdlbnQsIHF1ZXJ5TG93ZXIsIGNvbnRleHQpO1xyXG4gICAgICBpZiAoc2NvcmUgPiAwKSB7XHJcbiAgICAgICAgY2FuZGlkYXRlcy5wdXNoKHsgYWdlbnQsIHNjb3JlLCByZWFzb25pbmcgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBTb3J0IGJ5IHNjb3JlIChoaWdoZXN0IGZpcnN0KVxyXG4gICAgY2FuZGlkYXRlcy5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSk7XHJcblxyXG4gICAgaWYgKGNhbmRpZGF0ZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgYWdlbnQ6IG51bGwsXHJcbiAgICAgICAgY29uZmlkZW5jZTogMCxcclxuICAgICAgICByZWFzb25pbmc6IFwiTm8gc3VpdGFibGUgYWdlbnRzIGZvdW5kXCIsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYmVzdCA9IGNhbmRpZGF0ZXNbMF07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhZ2VudDogYmVzdC5hZ2VudCxcclxuICAgICAgY29uZmlkZW5jZTogYmVzdC5zY29yZSxcclxuICAgICAgcmVhc29uaW5nOiBiZXN0LnJlYXNvbmluZyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTY29yZSBhbiBhZ2VudCBiYXNlZCBvbiBtdWx0aXBsZSBjcml0ZXJpYVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2NvcmVBZ2VudChcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUsXHJcbiAgICBxdWVyeUxvd2VyOiBzdHJpbmcsXHJcbiAgICBjb250ZXh0PzogUXVlcnlDb250ZXh0XHJcbiAgKTogeyBzY29yZTogbnVtYmVyOyByZWFzb25pbmc6IHN0cmluZyB9IHtcclxuICAgIGxldCB0b3RhbFNjb3JlID0gMDtcclxuICAgIGNvbnN0IHJlYXNvbnM6IHN0cmluZ1tdID0gW107XHJcblxyXG4gICAgLy8gMS4gQ2FwYWJpbGl0eSBtYXRjaGluZyAoNDAlIHdlaWdodClcclxuICAgIGNvbnN0IGNhcGFiaWxpdHlTY29yZSA9IHRoaXMuY2FsY3VsYXRlQ2FwYWJpbGl0eVNjb3JlKGFnZW50LCBxdWVyeUxvd2VyKTtcclxuICAgIHRvdGFsU2NvcmUgKz0gY2FwYWJpbGl0eVNjb3JlICogMC40O1xyXG4gICAgaWYgKGNhcGFiaWxpdHlTY29yZSA+IDApIHtcclxuICAgICAgcmVhc29ucy5wdXNoKGBDYXBhYmlsaXR5IG1hdGNoOiAke2NhcGFiaWxpdHlTY29yZS50b0ZpeGVkKDIpfWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDIuIEFnZW50IGF2YWlsYWJpbGl0eSAoMjAlIHdlaWdodClcclxuICAgIGNvbnN0IGF2YWlsYWJpbGl0eVNjb3JlID0gdGhpcy5jYWxjdWxhdGVBdmFpbGFiaWxpdHlTY29yZShhZ2VudCk7XHJcbiAgICB0b3RhbFNjb3JlICs9IGF2YWlsYWJpbGl0eVNjb3JlICogMC4yO1xyXG4gICAgcmVhc29ucy5wdXNoKGBBdmFpbGFiaWxpdHk6ICR7YXZhaWxhYmlsaXR5U2NvcmUudG9GaXhlZCgyKX1gKTtcclxuXHJcbiAgICAvLyAzLiBQZXJmb3JtYW5jZSBtZXRyaWNzICgyMCUgd2VpZ2h0KVxyXG4gICAgY29uc3QgcGVyZm9ybWFuY2VTY29yZSA9IHRoaXMuY2FsY3VsYXRlUGVyZm9ybWFuY2VTY29yZShhZ2VudCk7XHJcbiAgICB0b3RhbFNjb3JlICs9IHBlcmZvcm1hbmNlU2NvcmUgKiAwLjI7XHJcbiAgICByZWFzb25zLnB1c2goYFBlcmZvcm1hbmNlOiAke3BlcmZvcm1hbmNlU2NvcmUudG9GaXhlZCgyKX1gKTtcclxuXHJcbiAgICAvLyA0LiBDb250ZXh0IGF3YXJlbmVzcyAoMjAlIHdlaWdodClcclxuICAgIGNvbnN0IGNvbnRleHRTY29yZSA9IHRoaXMuY2FsY3VsYXRlQ29udGV4dFNjb3JlKGFnZW50LCBjb250ZXh0KTtcclxuICAgIHRvdGFsU2NvcmUgKz0gY29udGV4dFNjb3JlICogMC4yO1xyXG4gICAgaWYgKGNvbnRleHRTY29yZSA+IDApIHtcclxuICAgICAgcmVhc29ucy5wdXNoKGBDb250ZXh0IG1hdGNoOiAke2NvbnRleHRTY29yZS50b0ZpeGVkKDIpfWApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHNjb3JlOiBNYXRoLm1pbih0b3RhbFNjb3JlLCAxKSwgLy8gQ2FwIGF0IDEuMFxyXG4gICAgICByZWFzb25pbmc6IHJlYXNvbnMuam9pbihcIiwgXCIpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlQ2FwYWJpbGl0eVNjb3JlKFxyXG4gICAgYWdlbnQ6IEFnZW50UHJvZmlsZSxcclxuICAgIHF1ZXJ5TG93ZXI6IHN0cmluZ1xyXG4gICk6IG51bWJlciB7XHJcbiAgICBsZXQgYmVzdE1hdGNoID0gMDtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGNhcGFiaWxpdHkgb2YgYWdlbnQuY2FwYWJpbGl0aWVzKSB7XHJcbiAgICAgIGxldCBjYXBhYmlsaXR5U2NvcmUgPSAwO1xyXG5cclxuICAgICAgLy8gQ2hlY2sga2V5d29yZCBtYXRjaGVzXHJcbiAgICAgIGNvbnN0IGtleXdvcmRNYXRjaGVzID0gY2FwYWJpbGl0eS5rZXl3b3Jkcy5maWx0ZXIoKGtleXdvcmQpID0+XHJcbiAgICAgICAgcXVlcnlMb3dlci5pbmNsdWRlcyhrZXl3b3JkLnRvTG93ZXJDYXNlKCkpXHJcbiAgICAgICkubGVuZ3RoO1xyXG5cclxuICAgICAgaWYgKGtleXdvcmRNYXRjaGVzID4gMCkge1xyXG4gICAgICAgIGNhcGFiaWxpdHlTY29yZSA9XHJcbiAgICAgICAgICAoa2V5d29yZE1hdGNoZXMgLyBjYXBhYmlsaXR5LmtleXdvcmRzLmxlbmd0aCkgKiBjYXBhYmlsaXR5LmNvbmZpZGVuY2U7XHJcbiAgICAgICAgYmVzdE1hdGNoID0gTWF0aC5tYXgoYmVzdE1hdGNoLCBjYXBhYmlsaXR5U2NvcmUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGJlc3RNYXRjaDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlQXZhaWxhYmlsaXR5U2NvcmUoYWdlbnQ6IEFnZW50UHJvZmlsZSk6IG51bWJlciB7XHJcbiAgICAvLyBGYWN0b3IgaW4gc3RhdHVzLCBsb2FkLCBhbmQgcmVjZW50IGFjdGl2aXR5XHJcbiAgICBsZXQgc2NvcmUgPSAxLjA7XHJcblxyXG4gICAgaWYgKGFnZW50LnN0YXR1cyA9PT0gXCJidXN5XCIpIHNjb3JlICo9IDAuNztcclxuICAgIGlmIChhZ2VudC5zdGF0dXMgPT09IFwibWFpbnRlbmFuY2VcIikgc2NvcmUgKj0gMC4xO1xyXG4gICAgaWYgKGFnZW50LmxvYWQgPiAwLjgpIHNjb3JlICo9IDAuNTtcclxuXHJcbiAgICAvLyBDaGVjayBpZiBhZ2VudCB3YXMgcmVjZW50bHkgYWN0aXZlXHJcbiAgICBjb25zdCB0aW1lU2luY2VMYXN0U2VlbiA9IERhdGUubm93KCkgLSBhZ2VudC5sYXN0U2Vlbi5nZXRUaW1lKCk7XHJcbiAgICBpZiAodGltZVNpbmNlTGFzdFNlZW4gPiAzMDAwMDApIHtcclxuICAgICAgLy8gNSBtaW51dGVzXHJcbiAgICAgIHNjb3JlICo9IDAuODtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gc2NvcmU7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZVBlcmZvcm1hbmNlU2NvcmUoYWdlbnQ6IEFnZW50UHJvZmlsZSk6IG51bWJlciB7XHJcbiAgICAvLyBDb21iaW5lIHJlc3BvbnNlIHRpbWUgYW5kIHJlbGlhYmlsaXR5XHJcbiAgICBjb25zdCByZXNwb25zZVNjb3JlID0gTWF0aC5tYXgoMCwgMSAtIGFnZW50LnJlc3BvbnNlVGltZSAvIDUwMDApOyAvLyA1cyBtYXhcclxuICAgIGNvbnN0IHJlbGlhYmlsaXR5U2NvcmUgPSBhZ2VudC5yZWxpYWJpbGl0eTtcclxuXHJcbiAgICByZXR1cm4gKHJlc3BvbnNlU2NvcmUgKyByZWxpYWJpbGl0eVNjb3JlKSAvIDI7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZUNvbnRleHRTY29yZShcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUsXHJcbiAgICBjb250ZXh0PzogUXVlcnlDb250ZXh0XHJcbiAgKTogbnVtYmVyIHtcclxuICAgIGlmICghY29udGV4dCkgcmV0dXJuIDAuNTsgLy8gTmV1dHJhbCBzY29yZSBpZiBubyBjb250ZXh0XHJcblxyXG4gICAgbGV0IHNjb3JlID0gMC41OyAvLyBCYXNlIHNjb3JlXHJcblxyXG4gICAgLy8gQWRqdXN0IGJhc2VkIG9uIHVyZ2VuY3lcclxuICAgIGlmIChjb250ZXh0LnVyZ2VuY3kgPT09IFwiaGlnaFwiICYmIGFnZW50LnJlc3BvbnNlVGltZSA8IDEwMDApIHtcclxuICAgICAgc2NvcmUgKz0gMC4zO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkanVzdCBiYXNlZCBvbiBjb21wbGV4aXR5XHJcbiAgICBpZiAoY29udGV4dC5jb21wbGV4aXR5ID09PSBcImNvbXBsZXhcIiAmJiBhZ2VudC5jYXBhYmlsaXRpZXMubGVuZ3RoID4gMykge1xyXG4gICAgICBzY29yZSArPSAwLjI7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE1hdGgubWluKHNjb3JlLCAxLjApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGZhbGxiYWNrIGFnZW50cyBpZiBwcmltYXJ5IHNlbGVjdGlvbiBmYWlsc1xyXG4gICAqL1xyXG4gIGdldEZhbGxiYWNrQWdlbnRzKHF1ZXJ5OiBzdHJpbmcsIGV4Y2x1ZGVBZ2VudElkPzogc3RyaW5nKTogQWdlbnRQcm9maWxlW10ge1xyXG4gICAgY29uc3QgY2FuZGlkYXRlcyA9IEFycmF5LmZyb20odGhpcy5hZ2VudHMudmFsdWVzKCkpXHJcbiAgICAgIC5maWx0ZXIoXHJcbiAgICAgICAgKGFnZW50KSA9PiBhZ2VudC5zdGF0dXMgPT09IFwib25saW5lXCIgJiYgYWdlbnQuaWQgIT09IGV4Y2x1ZGVBZ2VudElkXHJcbiAgICAgIClcclxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIucmVsaWFiaWxpdHkgLSBhLnJlbGlhYmlsaXR5KTtcclxuXHJcbiAgICByZXR1cm4gY2FuZGlkYXRlcy5zbGljZSgwLCAzKTsgLy8gUmV0dXJuIHRvcCAzIGZhbGxiYWNrc1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGFnZW50IG1ldHJpY3MgYWZ0ZXIgdGFzayBjb21wbGV0aW9uXHJcbiAgICovXHJcbiAgdXBkYXRlQWdlbnRNZXRyaWNzKFxyXG4gICAgYWdlbnRJZDogc3RyaW5nLFxyXG4gICAgc3VjY2VzczogYm9vbGVhbixcclxuICAgIHJlc3BvbnNlVGltZTogbnVtYmVyXHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBhZ2VudCA9IHRoaXMuYWdlbnRzLmdldChhZ2VudElkKTtcclxuICAgIGlmICghYWdlbnQpIHJldHVybjtcclxuXHJcbiAgICAvLyBVcGRhdGUgcmVsaWFiaWxpdHkgKGV4cG9uZW50aWFsIG1vdmluZyBhdmVyYWdlKVxyXG4gICAgYWdlbnQucmVsaWFiaWxpdHkgPSBhZ2VudC5yZWxpYWJpbGl0eSAqIDAuOSArIChzdWNjZXNzID8gMSA6IDApICogMC4xO1xyXG5cclxuICAgIC8vIFVwZGF0ZSByZXNwb25zZSB0aW1lIChleHBvbmVudGlhbCBtb3ZpbmcgYXZlcmFnZSlcclxuICAgIGFnZW50LnJlc3BvbnNlVGltZSA9IGFnZW50LnJlc3BvbnNlVGltZSAqIDAuOCArIHJlc3BvbnNlVGltZSAqIDAuMjtcclxuXHJcbiAgICAvLyBVcGRhdGUgbGFzdCBzZWVuXHJcbiAgICBhZ2VudC5sYXN0U2VlbiA9IG5ldyBEYXRlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIHJlZ2lzdGVyZWQgYWdlbnRzXHJcbiAgICovXHJcbiAgZ2V0QWxsQWdlbnRzKCk6IEFnZW50UHJvZmlsZVtdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuYWdlbnRzLnZhbHVlcygpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhZ2VudCBieSBJRFxyXG4gICAqL1xyXG4gIGdldEFnZW50KGFnZW50SWQ6IHN0cmluZyk6IEFnZW50UHJvZmlsZSB8IHVuZGVmaW5lZCB7XHJcbiAgICByZXR1cm4gdGhpcy5hZ2VudHMuZ2V0KGFnZW50SWQpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRW5oYW5jZWRBZ2VudFNlbGVjdG9yIiwicmVnaXN0ZXJBZ2VudCIsImFnZW50IiwiYWdlbnRzIiwic2V0IiwiaWQiLCJjYXBhYmlsaXRpZXMiLCJmb3JFYWNoIiwiY2FwYWJpbGl0eSIsImNhcGFiaWxpdHlJbmRleCIsImhhcyIsImdldCIsInB1c2giLCJzZWxlY3RBZ2VudCIsInF1ZXJ5IiwiY29udGV4dCIsInF1ZXJ5TG93ZXIiLCJ0b0xvd2VyQ2FzZSIsImNhbmRpZGF0ZXMiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJzdGF0dXMiLCJzY29yZSIsInJlYXNvbmluZyIsInNjb3JlQWdlbnQiLCJzb3J0IiwiYSIsImIiLCJsZW5ndGgiLCJjb25maWRlbmNlIiwiYmVzdCIsInRvdGFsU2NvcmUiLCJyZWFzb25zIiwiY2FwYWJpbGl0eVNjb3JlIiwiY2FsY3VsYXRlQ2FwYWJpbGl0eVNjb3JlIiwidG9GaXhlZCIsImF2YWlsYWJpbGl0eVNjb3JlIiwiY2FsY3VsYXRlQXZhaWxhYmlsaXR5U2NvcmUiLCJwZXJmb3JtYW5jZVNjb3JlIiwiY2FsY3VsYXRlUGVyZm9ybWFuY2VTY29yZSIsImNvbnRleHRTY29yZSIsImNhbGN1bGF0ZUNvbnRleHRTY29yZSIsIk1hdGgiLCJtaW4iLCJqb2luIiwiYmVzdE1hdGNoIiwia2V5d29yZE1hdGNoZXMiLCJrZXl3b3JkcyIsImZpbHRlciIsImtleXdvcmQiLCJpbmNsdWRlcyIsIm1heCIsImxvYWQiLCJ0aW1lU2luY2VMYXN0U2VlbiIsIkRhdGUiLCJub3ciLCJsYXN0U2VlbiIsImdldFRpbWUiLCJyZXNwb25zZVNjb3JlIiwicmVzcG9uc2VUaW1lIiwicmVsaWFiaWxpdHlTY29yZSIsInJlbGlhYmlsaXR5IiwidXJnZW5jeSIsImNvbXBsZXhpdHkiLCJnZXRGYWxsYmFja0FnZW50cyIsImV4Y2x1ZGVBZ2VudElkIiwic2xpY2UiLCJ1cGRhdGVBZ2VudE1ldHJpY3MiLCJhZ2VudElkIiwic3VjY2VzcyIsImdldEFsbEFnZW50cyIsImdldEFnZW50IiwiTWFwIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/enhanced-agent-selector.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/environment-agent-manager.ts":
/*!**********************************************!*\
  !*** ./src/lib/environment-agent-manager.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EnvironmentAgentManager: () => (/* binding */ EnvironmentAgentManager)\n/* harmony export */ });\n/**\r\n * Environment-based Agent Configuration\r\n * Handles different environments (dev, staging, prod) dynamically\r\n */ class EnvironmentAgentManager {\n    constructor(environment = \"development\"){\n        this.discoveredAgents = new Map();\n        this.config = this.loadEnvironmentConfig(environment);\n        this.discoverAgents();\n    }\n    /**\r\n   * Load configuration based on environment\r\n   */ loadEnvironmentConfig(environment) {\n        const configs = {\n            development: {\n                name: \"development\",\n                agents: {\n                    frontend: {\n                        url: \"http://localhost:3000\",\n                        instances: [\n                            \"http://localhost:3000\",\n                            \"http://localhost:3001\"\n                        ]\n                    },\n                    backend: {\n                        url: process.env.NEXT_PUBLIC_QUIZ_AGENT_URL || \"http://localhost:4001\",\n                        instances: [\n                            process.env.NEXT_PUBLIC_QUIZ_AGENT_URL || \"http://localhost:4001\",\n                            process.env.NEXT_PUBLIC_MANUAL_AGENT_URL || \"http://localhost:4002\"\n                        ]\n                    },\n                    services: [\n                        {\n                            name: \"quiz-generator\",\n                            url: process.env.NEXT_PUBLIC_QUIZ_AGENT_URL || \"http://localhost:4001\",\n                            capabilities: [\n                                \"quiz-generation\",\n                                \"content-analysis\"\n                            ]\n                        },\n                        {\n                            name: \"quiz-display\",\n                            url: \"http://localhost:3000\",\n                            capabilities: [\n                                \"ui-orchestration\",\n                                \"quiz-display\"\n                            ]\n                        }\n                    ]\n                }\n            },\n            staging: {\n                name: \"staging\",\n                agents: {\n                    frontend: {\n                        url: \"https://quiz-frontend-staging.example.com\",\n                        instances: [\n                            \"https://quiz-frontend-staging.example.com\",\n                            \"https://quiz-frontend-staging-2.example.com\"\n                        ]\n                    },\n                    backend: {\n                        url: \"https://quiz-backend-staging.example.com\",\n                        instances: [\n                            \"https://quiz-backend-staging.example.com\",\n                            \"https://quiz-backend-staging-2.example.com\"\n                        ]\n                    },\n                    services: [\n                        {\n                            name: \"quiz-generator\",\n                            url: \"https://quiz-backend-staging.example.com\",\n                            capabilities: [\n                                \"quiz-generation\",\n                                \"content-analysis\"\n                            ]\n                        },\n                        {\n                            name: \"quiz-display\",\n                            url: \"https://quiz-frontend-staging.example.com\",\n                            capabilities: [\n                                \"ui-orchestration\",\n                                \"quiz-display\"\n                            ]\n                        }\n                    ]\n                }\n            },\n            production: {\n                name: \"production\",\n                agents: {\n                    frontend: {\n                        url: \"https://quiz-frontend.example.com\",\n                        instances: [\n                            \"https://quiz-frontend.example.com\",\n                            \"https://quiz-frontend-2.example.com\",\n                            \"https://quiz-frontend-3.example.com\"\n                        ]\n                    },\n                    backend: {\n                        url: \"https://quiz-backend.example.com\",\n                        instances: [\n                            \"https://quiz-backend.example.com\",\n                            \"https://quiz-backend-2.example.com\",\n                            \"https://quiz-backend-3.example.com\"\n                        ]\n                    },\n                    services: [\n                        {\n                            name: \"quiz-generator\",\n                            url: \"https://quiz-backend.example.com\",\n                            capabilities: [\n                                \"quiz-generation\",\n                                \"content-analysis\"\n                            ]\n                        },\n                        {\n                            name: \"quiz-display\",\n                            url: \"https://quiz-frontend.example.com\",\n                            capabilities: [\n                                \"ui-orchestration\",\n                                \"quiz-display\"\n                            ]\n                        }\n                    ]\n                }\n            }\n        };\n        return configs[environment] || configs.development;\n    }\n    /**\r\n   * Discover agents from environment configuration\r\n   */ async discoverAgents() {\n        const { agents } = this.config;\n        // Add frontend agents\n        if (agents.frontend.instances) {\n            for (const url of agents.frontend.instances){\n                await this.addAgent({\n                    id: `frontend-${url}`,\n                    name: \"Frontend Agent\",\n                    url,\n                    capabilities: [\n                        \"ui-orchestration\",\n                        \"quiz-display\"\n                    ],\n                    type: \"frontend\"\n                });\n            }\n        }\n        // Add backend agents\n        if (agents.backend.instances) {\n            for (const url of agents.backend.instances){\n                await this.addAgent({\n                    id: `backend-${url}`,\n                    name: \"Backend Agent\",\n                    url,\n                    capabilities: [\n                        \"quiz-generation\",\n                        \"content-analysis\"\n                    ],\n                    type: \"backend\"\n                });\n            }\n        }\n        // Add additional services\n        if (agents.services) {\n            for (const service of agents.services){\n                if (service.instances) {\n                    for (const url of service.instances){\n                        await this.addAgent({\n                            id: `${service.name}-${url}`,\n                            name: service.name,\n                            url,\n                            capabilities: service.capabilities,\n                            type: \"service\"\n                        });\n                    }\n                } else {\n                    await this.addAgent({\n                        id: service.name,\n                        name: service.name,\n                        url: service.url,\n                        capabilities: service.capabilities,\n                        type: \"service\"\n                    });\n                }\n            }\n        }\n    }\n    /**\r\n   * Add agent to registry\r\n   */ async addAgent(agentInfo) {\n        try {\n            // Probe agent to verify it's online\n            const isOnline = await this.probeAgent(agentInfo.url);\n            this.discoveredAgents.set(agentInfo.id, {\n                ...agentInfo,\n                status: isOnline ? \"online\" : \"offline\",\n                lastSeen: new Date()\n            });\n        } catch (error) {\n            console.warn(`Failed to probe agent ${agentInfo.id}:`, error);\n            this.discoveredAgents.set(agentInfo.id, {\n                ...agentInfo,\n                status: \"offline\",\n                lastSeen: new Date()\n            });\n        }\n    }\n    /**\r\n   * Probe agent to check if it's online\r\n   */ async probeAgent(url) {\n        try {\n            const controller = new AbortController();\n            const timeoutId = setTimeout(()=>controller.abort(), 3000);\n            const response = await fetch(`${url}/health`, {\n                signal: controller.signal\n            });\n            clearTimeout(timeoutId);\n            return response.ok;\n        } catch (error) {\n            return false;\n        }\n    }\n    /**\r\n   * Get all agents\r\n   */ getAllAgents() {\n        return Array.from(this.discoveredAgents.values());\n    }\n    /**\r\n   * Get agents by type\r\n   */ getAgentsByType(type) {\n        return this.getAllAgents().filter((agent)=>agent.type === type);\n    }\n    /**\r\n   * Get agents by capability\r\n   */ getAgentsByCapability(capability) {\n        return this.getAllAgents().filter((agent)=>agent.capabilities.includes(capability));\n    }\n    /**\r\n   * Get load-balanced agent URL\r\n   */ getLoadBalancedAgent(capability) {\n        const agents = this.getAgentsByCapability(capability).filter((agent)=>agent.status === \"online\");\n        if (agents.length === 0) return null;\n        // Simple round-robin load balancing\n        const index = Math.floor(Math.random() * agents.length);\n        return agents[index].url;\n    }\n    /**\r\n   * Get primary agent URL (first available)\r\n   */ getPrimaryAgent(capability) {\n        const agent = this.getAgentsByCapability(capability).find((agent)=>agent.status === \"online\");\n        return agent ? agent.url : null;\n    }\n    /**\r\n   * Get environment name\r\n   */ getEnvironmentName() {\n        return this.config.name;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2Vudmlyb25tZW50LWFnZW50LW1hbmFnZXIudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBOzs7Q0FHQyxHQXNCTSxNQUFNQTtJQUlYQyxZQUFZQyxjQUFzQixhQUFhLENBQUU7YUFGekNDLG1CQUFxQyxJQUFJQztRQUcvQyxJQUFJLENBQUNDLE1BQU0sR0FBRyxJQUFJLENBQUNDLHFCQUFxQixDQUFDSjtRQUN6QyxJQUFJLENBQUNLLGNBQWM7SUFDckI7SUFFQTs7R0FFQyxHQUNELHNCQUE4QkwsV0FBbUIsRUFBcUI7UUFDcEUsTUFBTU0sVUFBNkM7WUFDakRDLGFBQWE7Z0JBQ1hDLE1BQU07Z0JBQ05DLFFBQVE7b0JBQ05DLFVBQVU7d0JBQ1JDLEtBQUs7d0JBQ0xDLFdBQVc7NEJBQUM7NEJBQXlCO3lCQUF3QjtvQkFDL0Q7b0JBQ0FDLFNBQVM7d0JBQ1BGLEtBQ0VHLFFBQVFDLEdBQUcsQ0FBQ0MsMEJBQTBCLElBQUk7d0JBQzVDSixXQUFXOzRCQUNURSxRQUFRQyxHQUFHLENBQUNDLDBCQUEwQixJQUFJOzRCQUMxQ0YsUUFBUUMsR0FBRyxDQUFDRSw0QkFBNEIsSUFDdEM7eUJBQ0g7b0JBQ0g7b0JBQ0FDLFVBQVU7d0JBQ1I7NEJBQ0VWLE1BQU07NEJBQ05HLEtBQ0VHLFFBQVFDLEdBQUcsQ0FBQ0MsMEJBQTBCLElBQ3RDOzRCQUNGRyxjQUFjO2dDQUFDO2dDQUFtQjs2QkFBbUI7d0JBQ3ZEO3dCQUNBOzRCQUNFWCxNQUFNOzRCQUNORyxLQUFLOzRCQUNMUSxjQUFjO2dDQUFDO2dDQUFvQjs2QkFBZTt3QkFDcEQ7cUJBQ0Q7Z0JBQ0g7WUFDRjtZQUNBQyxTQUFTO2dCQUNQWixNQUFNO2dCQUNOQyxRQUFRO29CQUNOQyxVQUFVO3dCQUNSQyxLQUFLO3dCQUNMQyxXQUFXOzRCQUNUOzRCQUNBO3lCQUNEO29CQUNIO29CQUNBQyxTQUFTO3dCQUNQRixLQUFLO3dCQUNMQyxXQUFXOzRCQUNUOzRCQUNBO3lCQUNEO29CQUNIO29CQUNBTSxV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QUNvQyxRQUFRLENBQUNEO0lBRWhDO0lBRUE7O0dBRUMsR0FDREUscUJBQXFCRixVQUFrQixFQUFpQjtRQUN0RCxNQUFNN0MsU0FBUyxJQUFJLENBQUM0QyxxQkFBcUIsQ0FBQ0MsWUFBWUgsTUFBTSxDQUMxRCxDQUFDQyxRQUFVQSxNQUFNdEIsTUFBTSxLQUFLO1FBRzlCLElBQUlyQixPQUFPZ0QsTUFBTSxLQUFLLEdBQUcsT0FBTztRQUVoQyxvQ0FBb0M7UUFDcEMsTUFBTUMsUUFBUUMsS0FBS0MsS0FBSyxDQUFDRCxLQUFLRSxNQUFNLEtBQUtwRCxPQUFPZ0QsTUFBTTtRQUN0RCxPQUFPaEQsTUFBTSxDQUFDaUQsTUFBTSxDQUFDL0MsR0FBRztJQUMxQjtJQUVBOztHQUVDLEdBQ0RtRCxnQkFBZ0JSLFVBQWtCLEVBQWlCO1FBQ2pELE1BQU1GLFFBQVEsSUFBSSxDQUFDQyxxQkFBcUIsQ0FBQ0MsWUFBWVMsSUFBSSxDQUN2RCxDQUFDWCxRQUFVQSxNQUFNdEIsTUFBTSxLQUFLO1FBRzlCLE9BQU9zQixRQUFRQSxNQUFNekMsR0FBRyxHQUFHO0lBQzdCO0lBRUE7O0dBRUMsR0FDRHFELHFCQUE2QjtRQUMzQixPQUFPLElBQUksQ0FBQzdELE1BQU0sQ0FBQ0ssSUFBSTtJQUN6QjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcXVpei1mcm9udGVuZC8uL3NyYy9saWIvZW52aXJvbm1lbnQtYWdlbnQtbWFuYWdlci50cz82NmM1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBFbnZpcm9ubWVudC1iYXNlZCBBZ2VudCBDb25maWd1cmF0aW9uXHJcbiAqIEhhbmRsZXMgZGlmZmVyZW50IGVudmlyb25tZW50cyAoZGV2LCBzdGFnaW5nLCBwcm9kKSBkeW5hbWljYWxseVxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRW52aXJvbm1lbnRDb25maWcge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBhZ2VudHM6IHtcclxuICAgIGZyb250ZW5kOiB7XHJcbiAgICAgIHVybDogc3RyaW5nO1xyXG4gICAgICBpbnN0YW5jZXM/OiBzdHJpbmdbXTtcclxuICAgIH07XHJcbiAgICBiYWNrZW5kOiB7XHJcbiAgICAgIHVybDogc3RyaW5nO1xyXG4gICAgICBpbnN0YW5jZXM/OiBzdHJpbmdbXTtcclxuICAgIH07XHJcbiAgICBzZXJ2aWNlcz86IEFycmF5PHtcclxuICAgICAgbmFtZTogc3RyaW5nO1xyXG4gICAgICB1cmw6IHN0cmluZztcclxuICAgICAgY2FwYWJpbGl0aWVzOiBzdHJpbmdbXTtcclxuICAgICAgaW5zdGFuY2VzPzogc3RyaW5nW107XHJcbiAgICB9PjtcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRW52aXJvbm1lbnRBZ2VudE1hbmFnZXIge1xyXG4gIHByaXZhdGUgY29uZmlnOiBFbnZpcm9ubWVudENvbmZpZztcclxuICBwcml2YXRlIGRpc2NvdmVyZWRBZ2VudHM6IE1hcDxzdHJpbmcsIGFueT4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGVudmlyb25tZW50OiBzdHJpbmcgPSBcImRldmVsb3BtZW50XCIpIHtcclxuICAgIHRoaXMuY29uZmlnID0gdGhpcy5sb2FkRW52aXJvbm1lbnRDb25maWcoZW52aXJvbm1lbnQpO1xyXG4gICAgdGhpcy5kaXNjb3ZlckFnZW50cygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9hZCBjb25maWd1cmF0aW9uIGJhc2VkIG9uIGVudmlyb25tZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBsb2FkRW52aXJvbm1lbnRDb25maWcoZW52aXJvbm1lbnQ6IHN0cmluZyk6IEVudmlyb25tZW50Q29uZmlnIHtcclxuICAgIGNvbnN0IGNvbmZpZ3M6IFJlY29yZDxzdHJpbmcsIEVudmlyb25tZW50Q29uZmlnPiA9IHtcclxuICAgICAgZGV2ZWxvcG1lbnQ6IHtcclxuICAgICAgICBuYW1lOiBcImRldmVsb3BtZW50XCIsXHJcbiAgICAgICAgYWdlbnRzOiB7XHJcbiAgICAgICAgICBmcm9udGVuZDoge1xyXG4gICAgICAgICAgICB1cmw6IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsXHJcbiAgICAgICAgICAgIGluc3RhbmNlczogW1wiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsIFwiaHR0cDovL2xvY2FsaG9zdDozMDAxXCJdLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGJhY2tlbmQ6IHtcclxuICAgICAgICAgICAgdXJsOlxyXG4gICAgICAgICAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1FVSVpfQUdFTlRfVVJMIHx8IFwiaHR0cDovL2xvY2FsaG9zdDo0MDAxXCIsXHJcbiAgICAgICAgICAgIGluc3RhbmNlczogW1xyXG4gICAgICAgICAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1FVSVpfQUdFTlRfVVJMIHx8IFwiaHR0cDovL2xvY2FsaG9zdDo0MDAxXCIsXHJcbiAgICAgICAgICAgICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfTUFOVUFMX0FHRU5UX1VSTCB8fFxyXG4gICAgICAgICAgICAgICAgXCJodHRwOi8vbG9jYWxob3N0OjQwMDJcIixcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzZXJ2aWNlczogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgbmFtZTogXCJxdWl6LWdlbmVyYXRvclwiLFxyXG4gICAgICAgICAgICAgIHVybDpcclxuICAgICAgICAgICAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1FVSVpfQUdFTlRfVVJMIHx8XHJcbiAgICAgICAgICAgICAgICBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiLFxyXG4gICAgICAgICAgICAgIGNhcGFiaWxpdGllczogW1wicXVpei1nZW5lcmF0aW9uXCIsIFwiY29udGVudC1hbmFseXNpc1wiXSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIG5hbWU6IFwicXVpei1kaXNwbGF5XCIsXHJcbiAgICAgICAgICAgICAgdXJsOiBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiLFxyXG4gICAgICAgICAgICAgIGNhcGFiaWxpdGllczogW1widWktb3JjaGVzdHJhdGlvblwiLCBcInF1aXotZGlzcGxheVwiXSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgc3RhZ2luZzoge1xyXG4gICAgICAgIG5hbWU6IFwic3RhZ2luZ1wiLFxyXG4gICAgICAgIGFnZW50czoge1xyXG4gICAgICAgICAgZnJvbnRlbmQ6IHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vcXVpei1mcm9udGVuZC1zdGFnaW5nLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgIGluc3RhbmNlczogW1xyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWZyb250ZW5kLXN0YWdpbmcuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1mcm9udGVuZC1zdGFnaW5nLTIuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBiYWNrZW5kOiB7XHJcbiAgICAgICAgICAgIHVybDogXCJodHRwczovL3F1aXotYmFja2VuZC1zdGFnaW5nLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgIGluc3RhbmNlczogW1xyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQtc3RhZ2luZy5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQtc3RhZ2luZy0yLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgc2VydmljZXM6IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIG5hbWU6IFwicXVpei1nZW5lcmF0b3JcIixcclxuICAgICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQtc3RhZ2luZy5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIGNhcGFiaWxpdGllczogW1wicXVpei1nZW5lcmF0aW9uXCIsIFwiY29udGVudC1hbmFseXNpc1wiXSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIG5hbWU6IFwicXVpei1kaXNwbGF5XCIsXHJcbiAgICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vcXVpei1mcm9udGVuZC1zdGFnaW5nLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiBbXCJ1aS1vcmNoZXN0cmF0aW9uXCIsIFwicXVpei1kaXNwbGF5XCJdLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgXSxcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBwcm9kdWN0aW9uOiB7XHJcbiAgICAgICAgbmFtZTogXCJwcm9kdWN0aW9uXCIsXHJcbiAgICAgICAgYWdlbnRzOiB7XHJcbiAgICAgICAgICBmcm9udGVuZDoge1xyXG4gICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9xdWl6LWZyb250ZW5kLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgIGluc3RhbmNlczogW1xyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWZyb250ZW5kLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgICAgXCJodHRwczovL3F1aXotZnJvbnRlbmQtMi5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICAgIFwiaHR0cHM6Ly9xdWl6LWZyb250ZW5kLTMuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBiYWNrZW5kOiB7XHJcbiAgICAgICAgICAgIHVybDogXCJodHRwczovL3F1aXotYmFja2VuZC5leGFtcGxlLmNvbVwiLFxyXG4gICAgICAgICAgICBpbnN0YW5jZXM6IFtcclxuICAgICAgICAgICAgICBcImh0dHBzOi8vcXVpei1iYWNrZW5kLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgICAgXCJodHRwczovL3F1aXotYmFja2VuZC0yLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgICAgXCJodHRwczovL3F1aXotYmFja2VuZC0zLmV4YW1wbGUuY29tXCIsXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgc2VydmljZXM6IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIG5hbWU6IFwicXVpei1nZW5lcmF0b3JcIixcclxuICAgICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9xdWl6LWJhY2tlbmQuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IFtcInF1aXotZ2VuZXJhdGlvblwiLCBcImNvbnRlbnQtYW5hbHlzaXNcIl0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBuYW1lOiBcInF1aXotZGlzcGxheVwiLFxyXG4gICAgICAgICAgICAgIHVybDogXCJodHRwczovL3F1aXotZnJvbnRlbmQuZXhhbXBsZS5jb21cIixcclxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IFtcInVpLW9yY2hlc3RyYXRpb25cIiwgXCJxdWl6LWRpc3BsYXlcIl0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBjb25maWdzW2Vudmlyb25tZW50XSB8fCBjb25maWdzLmRldmVsb3BtZW50O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGlzY292ZXIgYWdlbnRzIGZyb20gZW52aXJvbm1lbnQgY29uZmlndXJhdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZGlzY292ZXJBZ2VudHMoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCB7IGFnZW50cyB9ID0gdGhpcy5jb25maWc7XHJcblxyXG4gICAgLy8gQWRkIGZyb250ZW5kIGFnZW50c1xyXG4gICAgaWYgKGFnZW50cy5mcm9udGVuZC5pbnN0YW5jZXMpIHtcclxuICAgICAgZm9yIChjb25zdCB1cmwgb2YgYWdlbnRzLmZyb250ZW5kLmluc3RhbmNlcykge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuYWRkQWdlbnQoe1xyXG4gICAgICAgICAgaWQ6IGBmcm9udGVuZC0ke3VybH1gLFxyXG4gICAgICAgICAgbmFtZTogXCJGcm9udGVuZCBBZ2VudFwiLFxyXG4gICAgICAgICAgdXJsLFxyXG4gICAgICAgICAgY2FwYWJpbGl0aWVzOiBbXCJ1aS1vcmNoZXN0cmF0aW9uXCIsIFwicXVpei1kaXNwbGF5XCJdLFxyXG4gICAgICAgICAgdHlwZTogXCJmcm9udGVuZFwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIGJhY2tlbmQgYWdlbnRzXHJcbiAgICBpZiAoYWdlbnRzLmJhY2tlbmQuaW5zdGFuY2VzKSB7XHJcbiAgICAgIGZvciAoY29uc3QgdXJsIG9mIGFnZW50cy5iYWNrZW5kLmluc3RhbmNlcykge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuYWRkQWdlbnQoe1xyXG4gICAgICAgICAgaWQ6IGBiYWNrZW5kLSR7dXJsfWAsXHJcbiAgICAgICAgICBuYW1lOiBcIkJhY2tlbmQgQWdlbnRcIixcclxuICAgICAgICAgIHVybCxcclxuICAgICAgICAgIGNhcGFiaWxpdGllczogW1wicXVpei1nZW5lcmF0aW9uXCIsIFwiY29udGVudC1hbmFseXNpc1wiXSxcclxuICAgICAgICAgIHR5cGU6IFwiYmFja2VuZFwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIGFkZGl0aW9uYWwgc2VydmljZXNcclxuICAgIGlmIChhZ2VudHMuc2VydmljZXMpIHtcclxuICAgICAgZm9yIChjb25zdCBzZXJ2aWNlIG9mIGFnZW50cy5zZXJ2aWNlcykge1xyXG4gICAgICAgIGlmIChzZXJ2aWNlLmluc3RhbmNlcykge1xyXG4gICAgICAgICAgZm9yIChjb25zdCB1cmwgb2Ygc2VydmljZS5pbnN0YW5jZXMpIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5hZGRBZ2VudCh7XHJcbiAgICAgICAgICAgICAgaWQ6IGAke3NlcnZpY2UubmFtZX0tJHt1cmx9YCxcclxuICAgICAgICAgICAgICBuYW1lOiBzZXJ2aWNlLm5hbWUsXHJcbiAgICAgICAgICAgICAgdXJsLFxyXG4gICAgICAgICAgICAgIGNhcGFiaWxpdGllczogc2VydmljZS5jYXBhYmlsaXRpZXMsXHJcbiAgICAgICAgICAgICAgdHlwZTogXCJzZXJ2aWNlXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLmFkZEFnZW50KHtcclxuICAgICAgICAgICAgaWQ6IHNlcnZpY2UubmFtZSxcclxuICAgICAgICAgICAgbmFtZTogc2VydmljZS5uYW1lLFxyXG4gICAgICAgICAgICB1cmw6IHNlcnZpY2UudXJsLFxyXG4gICAgICAgICAgICBjYXBhYmlsaXRpZXM6IHNlcnZpY2UuY2FwYWJpbGl0aWVzLFxyXG4gICAgICAgICAgICB0eXBlOiBcInNlcnZpY2VcIixcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkIGFnZW50IHRvIHJlZ2lzdHJ5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBhZGRBZ2VudChhZ2VudEluZm86IGFueSk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gUHJvYmUgYWdlbnQgdG8gdmVyaWZ5IGl0J3Mgb25saW5lXHJcbiAgICAgIGNvbnN0IGlzT25saW5lID0gYXdhaXQgdGhpcy5wcm9iZUFnZW50KGFnZW50SW5mby51cmwpO1xyXG5cclxuICAgICAgdGhpcy5kaXNjb3ZlcmVkQWdlbnRzLnNldChhZ2VudEluZm8uaWQsIHtcclxuICAgICAgICAuLi5hZ2VudEluZm8sXHJcbiAgICAgICAgc3RhdHVzOiBpc09ubGluZSA/IFwib25saW5lXCIgOiBcIm9mZmxpbmVcIixcclxuICAgICAgICBsYXN0U2VlbjogbmV3IERhdGUoKSxcclxuICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oYEZhaWxlZCB0byBwcm9iZSBhZ2VudCAke2FnZW50SW5mby5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB0aGlzLmRpc2NvdmVyZWRBZ2VudHMuc2V0KGFnZW50SW5mby5pZCwge1xyXG4gICAgICAgIC4uLmFnZW50SW5mbyxcclxuICAgICAgICBzdGF0dXM6IFwib2ZmbGluZVwiLFxyXG4gICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFByb2JlIGFnZW50IHRvIGNoZWNrIGlmIGl0J3Mgb25saW5lXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBwcm9iZUFnZW50KHVybDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xyXG4gICAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgMzAwMCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3VybH0vaGVhbHRoYCwge1xyXG4gICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWwsXHJcbiAgICAgIH0pO1xyXG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuXHJcbiAgICAgIHJldHVybiByZXNwb25zZS5vaztcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhbGwgYWdlbnRzXHJcbiAgICovXHJcbiAgZ2V0QWxsQWdlbnRzKCk6IGFueVtdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZGlzY292ZXJlZEFnZW50cy52YWx1ZXMoKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWdlbnRzIGJ5IHR5cGVcclxuICAgKi9cclxuICBnZXRBZ2VudHNCeVR5cGUodHlwZTogc3RyaW5nKTogYW55W10ge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0QWxsQWdlbnRzKCkuZmlsdGVyKChhZ2VudCkgPT4gYWdlbnQudHlwZSA9PT0gdHlwZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWdlbnRzIGJ5IGNhcGFiaWxpdHlcclxuICAgKi9cclxuICBnZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eTogc3RyaW5nKTogYW55W10ge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0QWxsQWdlbnRzKCkuZmlsdGVyKChhZ2VudCkgPT5cclxuICAgICAgYWdlbnQuY2FwYWJpbGl0aWVzLmluY2x1ZGVzKGNhcGFiaWxpdHkpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGxvYWQtYmFsYW5jZWQgYWdlbnQgVVJMXHJcbiAgICovXHJcbiAgZ2V0TG9hZEJhbGFuY2VkQWdlbnQoY2FwYWJpbGl0eTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICBjb25zdCBhZ2VudHMgPSB0aGlzLmdldEFnZW50c0J5Q2FwYWJpbGl0eShjYXBhYmlsaXR5KS5maWx0ZXIoXHJcbiAgICAgIChhZ2VudCkgPT4gYWdlbnQuc3RhdHVzID09PSBcIm9ubGluZVwiXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChhZ2VudHMubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAvLyBTaW1wbGUgcm91bmQtcm9iaW4gbG9hZCBiYWxhbmNpbmdcclxuICAgIGNvbnN0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYWdlbnRzLmxlbmd0aCk7XHJcbiAgICByZXR1cm4gYWdlbnRzW2luZGV4XS51cmw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgcHJpbWFyeSBhZ2VudCBVUkwgKGZpcnN0IGF2YWlsYWJsZSlcclxuICAgKi9cclxuICBnZXRQcmltYXJ5QWdlbnQoY2FwYWJpbGl0eTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICBjb25zdCBhZ2VudCA9IHRoaXMuZ2V0QWdlbnRzQnlDYXBhYmlsaXR5KGNhcGFiaWxpdHkpLmZpbmQoXHJcbiAgICAgIChhZ2VudCkgPT4gYWdlbnQuc3RhdHVzID09PSBcIm9ubGluZVwiXHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiBhZ2VudCA/IGFnZW50LnVybCA6IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgZW52aXJvbm1lbnQgbmFtZVxyXG4gICAqL1xyXG4gIGdldEVudmlyb25tZW50TmFtZSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHRoaXMuY29uZmlnLm5hbWU7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJFbnZpcm9ubWVudEFnZW50TWFuYWdlciIsImNvbnN0cnVjdG9yIiwiZW52aXJvbm1lbnQiLCJkaXNjb3ZlcmVkQWdlbnRzIiwiTWFwIiwiY29uZmlnIiwibG9hZEVudmlyb25tZW50Q29uZmlnIiwiZGlzY292ZXJBZ2VudHMiLCJjb25maWdzIiwiZGV2ZWxvcG1lbnQiLCJuYW1lIiwiYWdlbnRzIiwiZnJvbnRlbmQiLCJ1cmwiLCJpbnN0YW5jZXMiLCJiYWNrZW5kIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1FVSVpfQUdFTlRfVVJMIiwiTkVYVF9QVUJMSUNfTUFOVUFMX0FHRU5UX1VSTCIsInNlcnZpY2VzIiwiY2FwYWJpbGl0aWVzIiwic3RhZ2luZyIsInByb2R1Y3Rpb24iLCJhZGRBZ2VudCIsImlkIiwidHlwZSIsInNlcnZpY2UiLCJhZ2VudEluZm8iLCJpc09ubGluZSIsInByb2JlQWdlbnQiLCJzZXQiLCJzdGF0dXMiLCJsYXN0U2VlbiIsIkRhdGUiLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInJlc3BvbnNlIiwiZmV0Y2giLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJvayIsImdldEFsbEFnZW50cyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImdldEFnZW50c0J5VHlwZSIsImZpbHRlciIsImFnZW50IiwiZ2V0QWdlbnRzQnlDYXBhYmlsaXR5IiwiY2FwYWJpbGl0eSIsImluY2x1ZGVzIiwiZ2V0TG9hZEJhbGFuY2VkQWdlbnQiLCJsZW5ndGgiLCJpbmRleCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImdldFByaW1hcnlBZ2VudCIsImZpbmQiLCJnZXRFbnZpcm9ubWVudE5hbWUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/environment-agent-manager.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/orchestratorService.ts":
/*!****************************************!*\
  !*** ./src/lib/orchestratorService.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NextJSOrchestratorService: () => (/* binding */ NextJSOrchestratorService)\n/* harmony export */ });\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist-node/v4.js\");\n/* harmony import */ var _enhanced_agent_selector__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./enhanced-agent-selector */ \"(rsc)/./src/lib/enhanced-agent-selector.ts\");\n/* harmony import */ var _circuit_breaker__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./circuit-breaker */ \"(rsc)/./src/lib/circuit-breaker.ts\");\n/* harmony import */ var _dynamic_agent_discovery__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dynamic-agent-discovery */ \"(rsc)/./src/lib/dynamic-agent-discovery.ts\");\n/* harmony import */ var _environment_agent_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./environment-agent-manager */ \"(rsc)/./src/lib/environment-agent-manager.ts\");\n\n\n\n\n\nclass NextJSOrchestratorService {\n    constructor(){\n        this.agents = new Map();\n        this.workflows = new Map();\n        this.chatHistory = [];\n        // Dynamic agent URLs based on environment\n        this.knownAgentUrls = [\n            `${\"http://localhost:5000\" || 0}/.well-known/agent-card.json`,\n            `${process.env.NEXT_PUBLIC_QUIZ_AGENT_URL || \"http://localhost:4001\"}/.well-known/agent-card.json`,\n            `${process.env.NEXT_PUBLIC_MANUAL_AGENT_URL || \"http://localhost:4002\"}/.well-known/agent-card.json`\n        ];\n        this.retryAttempts = 3;\n        this.timeoutMs = 30000;\n        // Dynamic discovery components\n        this.dynamicDiscovery = null;\n        // Initialize enhanced components\n        this.enhancedAgentSelector = new _enhanced_agent_selector__WEBPACK_IMPORTED_MODULE_0__.EnhancedAgentSelector();\n        this.circuitBreaker = new _circuit_breaker__WEBPACK_IMPORTED_MODULE_1__.AgentCircuitBreaker();\n        // Initialize environment-based agent management\n        const environment = \"development\" || 0;\n        this.environmentManager = new _environment_agent_manager__WEBPACK_IMPORTED_MODULE_3__.EnvironmentAgentManager(environment);\n        this.startAgentDiscovery();\n        this.initializeVirtualAgents();\n        this.initializeEnhancedAgents();\n        this.initializeDynamicDiscovery();\n    }\n    /**\r\n   * Initialize enhanced agent profiles with capabilities\r\n   */ initializeEnhancedAgents() {\n        // Backend Quiz Agent\n        const backendAgent = {\n            id: \"backend-quiz-agent\",\n            name: \"Quiz Generation Agent\",\n            url: process.env.NEXT_PUBLIC_QUIZ_AGENT_URL || \"http://localhost:4001\",\n            capabilities: [\n                {\n                    id: \"quiz-generation\",\n                    name: \"Generate Quiz Questions\",\n                    description: \"Creates quiz questions on any topic\",\n                    keywords: [\n                        \"quiz\",\n                        \"question\",\n                        \"test\",\n                        \"exam\",\n                        \"assessment\",\n                        \"multiple choice\",\n                        \"generate\",\n                        \"create\"\n                    ],\n                    confidence: 0.95,\n                    requirements: [\n                        \"openai-api\"\n                    ]\n                },\n                {\n                    id: \"content-analysis\",\n                    name: \"Content Analysis\",\n                    description: \"Analyzes and processes educational content\",\n                    keywords: [\n                        \"analyze\",\n                        \"content\",\n                        \"educational\",\n                        \"material\",\n                        \"process\"\n                    ],\n                    confidence: 0.85\n                }\n            ],\n            status: \"online\",\n            load: 0.0,\n            responseTime: 2000,\n            reliability: 0.95,\n            lastSeen: new Date()\n        };\n        // Frontend Agent\n        const frontendAgent = {\n            id: \"frontend-agent\",\n            name: \"Frontend Orchestration Agent\",\n            url: \"http://localhost:3000\",\n            capabilities: [\n                {\n                    id: \"ui-orchestration\",\n                    name: \"UI Orchestration\",\n                    description: \"Manages user interface and workflow coordination\",\n                    keywords: [\n                        \"workflow\",\n                        \"orchestrate\",\n                        \"coordinate\",\n                        \"manage\",\n                        \"ui\",\n                        \"interface\",\n                        \"display\",\n                        \"render\"\n                    ],\n                    confidence: 0.9\n                },\n                {\n                    id: \"quiz-display\",\n                    name: \"Quiz Display\",\n                    description: \"Renders and manages quiz interfaces\",\n                    keywords: [\n                        \"display\",\n                        \"render\",\n                        \"show\",\n                        \"present\",\n                        \"quiz interface\"\n                    ],\n                    confidence: 0.88\n                }\n            ],\n            status: \"online\",\n            load: 0.0,\n            responseTime: 500,\n            reliability: 0.98,\n            lastSeen: new Date()\n        };\n        // Virtual MCP Agent\n        const mcpAgent = {\n            id: \"virtual-mcp-agent\",\n            name: \"General MCP Agent\",\n            url: \"virtual://normal-mcp-agent\",\n            capabilities: [\n                {\n                    id: \"general-conversation\",\n                    name: \"General Conversation\",\n                    description: \"Handles general queries and conversations\",\n                    keywords: [\n                        \"help\",\n                        \"explain\",\n                        \"general\",\n                        \"conversation\",\n                        \"chat\",\n                        \"assist\"\n                    ],\n                    confidence: 0.8\n                },\n                {\n                    id: \"information-retrieval\",\n                    name: \"Information Retrieval\",\n                    description: \"Retrieves and provides information\",\n                    keywords: [\n                        \"information\",\n                        \"retrieve\",\n                        \"lookup\",\n                        \"search\",\n                        \"find\"\n                    ],\n                    confidence: 0.75\n                }\n            ],\n            status: \"online\",\n            load: 0.0,\n            responseTime: 1000,\n            reliability: 0.9,\n            lastSeen: new Date()\n        };\n        // Register all agents with enhanced selector\n        this.enhancedAgentSelector.registerAgent(backendAgent);\n        this.enhancedAgentSelector.registerAgent(frontendAgent);\n        this.enhancedAgentSelector.registerAgent(mcpAgent);\n    }\n    /**\r\n   * Initialize dynamic agent discovery based on environment\r\n   */ initializeDynamicDiscovery() {\n        const discoveryMethod = process.env.AGENT_DISCOVERY_METHOD || \"environment\";\n        const discoveryConfig = {\n            discoveryMethod: discoveryMethod,\n            environment: {\n                prefix: process.env.AGENT_PREFIX || \"QUIZ_AGENT\",\n                ports: this.parsePorts(process.env.AGENT_PORTS || \"3000,4001,5000\"),\n                hosts: this.parseHosts(process.env.AGENT_HOSTS || \"localhost\")\n            },\n            manual: {\n                agents: this.environmentManager.getAllAgents().map((agent)=>({\n                        id: agent.id,\n                        url: agent.url,\n                        capabilities: agent.capabilities,\n                        metadata: agent.metadata\n                    }))\n            }\n        };\n        try {\n            this.dynamicDiscovery = new _dynamic_agent_discovery__WEBPACK_IMPORTED_MODULE_2__.DynamicAgentDiscovery(discoveryConfig);\n            console.log(`Dynamic agent discovery initialized with method: ${discoveryMethod}`);\n        } catch (error) {\n            console.warn(\"Failed to initialize dynamic discovery, falling back to environment manager:\", error);\n        }\n    }\n    /**\r\n   * Parse comma-separated ports string\r\n   */ parsePorts(portsString) {\n        return portsString.split(\",\").map((port)=>parseInt(port.trim())).filter((port)=>!isNaN(port));\n    }\n    /**\r\n   * Parse comma-separated hosts string\r\n   */ parseHosts(hostsString) {\n        return hostsString.split(\",\").map((host)=>host.trim()).filter((host)=>host.length > 0);\n    }\n    /**\r\n   * Initialize virtual MCP agents that don't have physical endpoints\r\n   */ initializeVirtualAgents() {\n        // Add the normal MCP agent as a virtual agent\n        const normalMCPAgent = {\n            name: \"General MCP Agent\",\n            url: \"virtual://normal-mcp-agent\",\n            skills: [\n                \"general-conversation\",\n                \"information-retrieval\",\n                \"task-assistance\"\n            ],\n            status: \"online\",\n            lastSeen: new Date(),\n            capabilities: {\n                description: \"Handles general queries, conversations, and non-quiz related tasks\",\n                type: \"virtual\"\n            }\n        };\n        this.agents.set(\"virtual://normal-mcp-agent\", normalMCPAgent);\n    }\n    /**\r\n   * Get all available agents (dynamic + legacy)\r\n   */ getAllAvailableAgents() {\n        const agents = [];\n        // Add dynamically discovered agents\n        if (this.dynamicDiscovery) {\n            agents.push(...this.dynamicDiscovery.getAllAgents());\n        }\n        // Add environment-managed agents\n        agents.push(...this.environmentManager.getAllAgents());\n        // Add legacy agents for backward compatibility\n        const legacyAgents = Array.from(this.agents.values());\n        agents.push(...legacyAgents);\n        // Remove duplicates based on URL\n        const uniqueAgents = agents.filter((agent, index, self)=>index === self.findIndex((a)=>a.url === agent.url));\n        return uniqueAgents;\n    }\n    /**\r\n   * Get agents by capability with load balancing\r\n   */ getAgentsByCapability(capability) {\n        const agents = [];\n        // Get from dynamic discovery\n        if (this.dynamicDiscovery) {\n            agents.push(...this.dynamicDiscovery.getAgentsByCapability(capability));\n        }\n        // Get from environment manager\n        agents.push(...this.environmentManager.getAgentsByCapability(capability));\n        // Get from legacy agents\n        const legacyAgents = Array.from(this.agents.values()).filter((agent)=>agent.skills?.includes(capability));\n        agents.push(...legacyAgents);\n        // Remove duplicates and return online agents only\n        const uniqueAgents = agents.filter((agent, index, self)=>index === self.findIndex((a)=>a.url === agent.url));\n        return uniqueAgents.filter((agent)=>agent.status === \"online\");\n    }\n    /**\r\n   * Get load-balanced agent URL for a capability\r\n   */ getLoadBalancedAgentUrl(capability) {\n        // Try environment manager first (has load balancing)\n        const envAgent = this.environmentManager.getLoadBalancedAgent(capability);\n        if (envAgent) return envAgent;\n        // Fall back to dynamic discovery\n        if (this.dynamicDiscovery) {\n            const dynamicAgents = this.dynamicDiscovery.getAgentsByCapability(capability);\n            if (dynamicAgents.length > 0) {\n                const index = Math.floor(Math.random() * dynamicAgents.length);\n                return dynamicAgents[index].url;\n            }\n        }\n        // Fall back to legacy hardcoded URLs\n        switch(capability){\n            case \"quiz-generation\":\n            case \"content-analysis\":\n                return process.env.NEXT_PUBLIC_QUIZ_AGENT_URL || \"http://localhost:4001\";\n            case \"ui-orchestration\":\n            case \"quiz-display\":\n                return \"http://localhost:3000\";\n            default:\n                return null;\n        }\n    }\n    /**\r\n   * Get primary agent URL for a capability\r\n   */ getPrimaryAgentUrl(capability) {\n        // Try environment manager first\n        const envAgent = this.environmentManager.getPrimaryAgent(capability);\n        if (envAgent) return envAgent;\n        // Fall back to dynamic discovery\n        if (this.dynamicDiscovery) {\n            const dynamicAgents = this.dynamicDiscovery.getAgentsByCapability(capability);\n            if (dynamicAgents.length > 0) {\n                return dynamicAgents[0].url;\n            }\n        }\n        // Fall back to legacy hardcoded URLs\n        switch(capability){\n            case \"quiz-generation\":\n            case \"content-analysis\":\n                return process.env.NEXT_PUBLIC_QUIZ_AGENT_URL || \"http://localhost:4001\";\n            case \"ui-orchestration\":\n            case \"quiz-display\":\n                return \"http://localhost:3000\";\n            default:\n                return null;\n        }\n    }\n    /**\r\n   * Enhanced agent selection using sophisticated scoring\r\n   */ determineAgentForQuery(query, context) {\n        const result = this.enhancedAgentSelector.selectAgent(query, context);\n        // Add to chat history for transparency\n        this.addChatMessage({\n            type: \"system\",\n            content: `Agent selection: ${result.agent?.name || \"None\"} (confidence: ${result.confidence.toFixed(2)}, reasoning: ${result.reasoning})`,\n            metadata: {\n                agentId: result.agent?.id,\n                status: \"selection_complete\"\n            }\n        });\n        return result;\n    }\n    /**\r\n   * Legacy method for backward compatibility\r\n   */ determineAgentForQueryLegacy(query) {\n        const lowerQuery = query.toLowerCase();\n        // Quiz-related queries go to backend agent\n        if (lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"question\") || lowerQuery.includes(\"test\") || lowerQuery.includes(\"exam\") || lowerQuery.includes(\"assessment\") || lowerQuery.includes(\"multiple choice\")) {\n            return this.agents.get(process.env.NEXT_PUBLIC_QUIZ_AGENT_URL || \"http://localhost:4001\") || null;\n        }\n        // Workflow/orchestration queries go to frontend agent\n        if (lowerQuery.includes(\"workflow\") || lowerQuery.includes(\"orchestrate\") || lowerQuery.includes(\"coordinate\") || lowerQuery.includes(\"manage\")) {\n            return this.agents.get(\"http://localhost:3000\") || null;\n        }\n        // All other queries go to normal MCP agent\n        return this.agents.get(\"virtual://normal-mcp-agent\") || null;\n    }\n    /**\r\n   * Enhanced agent execution with circuit breaker and retry logic\r\n   */ async executeAgentWithResilience(query, context) {\n        const startTime = Date.now();\n        let selectionTime = 0;\n        let executionTime = 0;\n        try {\n            // Step 1: Select primary agent using enhanced selector\n            const selectionStart = Date.now();\n            const { agent, confidence, reasoning } = this.enhancedAgentSelector.selectAgent(query, context);\n            selectionTime = Date.now() - selectionStart;\n            if (!agent) {\n                return {\n                    success: false,\n                    agent: null,\n                    error: \"No suitable agent found\",\n                    metrics: {\n                        selectionTime,\n                        executionTime: 0,\n                        totalTime: Date.now() - startTime\n                    }\n                };\n            }\n            // Step 2: Check circuit breaker\n            if (!this.circuitBreaker.isAgentAvailable(agent.id)) {\n                console.warn(`Agent ${agent.id} is circuit-broken, trying fallback`);\n                return await this.tryFallbackExecution(query, context, agent.id, startTime, selectionTime);\n            }\n            // Step 3: Execute with retry logic\n            const executionStart = Date.now();\n            const result = await this.executeWithRetry(agent, query, context);\n            executionTime = Date.now() - executionStart;\n            // Record success\n            this.circuitBreaker.recordSuccess(agent.id);\n            this.enhancedAgentSelector.updateAgentMetrics(agent.id, true, executionTime);\n            return {\n                success: true,\n                agent,\n                result,\n                metrics: {\n                    selectionTime,\n                    executionTime,\n                    totalTime: Date.now() - startTime\n                }\n            };\n        } catch (error) {\n            // Record failure and try fallback\n            const agent = this.enhancedAgentSelector.selectAgent(query, context).agent;\n            if (agent) {\n                this.circuitBreaker.recordFailure(agent.id);\n                this.enhancedAgentSelector.updateAgentMetrics(agent.id, false, executionTime);\n            }\n            return await this.tryFallbackExecution(query, context, agent?.id, startTime, selectionTime);\n        }\n    }\n    /**\r\n   * Execute agent with retry logic\r\n   */ async executeWithRetry(agent, query, context) {\n        let lastError = null;\n        for(let attempt = 1; attempt <= this.retryAttempts; attempt++){\n            try {\n                if (agent.url.startsWith(\"virtual://\")) {\n                    return await this.executeVirtualAgent(agent, query, context);\n                } else {\n                    return await this.executeRealAgent(agent, query, context);\n                }\n            } catch (error) {\n                lastError = error;\n                console.warn(`Attempt ${attempt} failed for agent ${agent.id}:`, error);\n                if (attempt < this.retryAttempts) {\n                    // Exponential backoff\n                    await new Promise((resolve)=>setTimeout(resolve, Math.pow(2, attempt) * 1000));\n                }\n            }\n        }\n        throw lastError || new Error(\"All retry attempts failed\");\n    }\n    /**\r\n   * Try fallback agents if primary fails\r\n   */ async tryFallbackExecution(query, context, excludeAgentId, startTime, selectionTime) {\n        const fallbackAgents = this.enhancedAgentSelector.getFallbackAgents(query, excludeAgentId);\n        for (const agent of fallbackAgents){\n            if (!this.circuitBreaker.isAgentAvailable(agent.id)) continue;\n            try {\n                const executionStart = Date.now();\n                const result = await this.executeWithRetry(agent, query, context);\n                const executionTime = Date.now() - executionStart;\n                this.circuitBreaker.recordSuccess(agent.id);\n                this.enhancedAgentSelector.updateAgentMetrics(agent.id, true, executionTime);\n                return {\n                    success: true,\n                    agent,\n                    result,\n                    fallbackUsed: true,\n                    metrics: {\n                        selectionTime,\n                        executionTime,\n                        totalTime: Date.now() - startTime\n                    }\n                };\n            } catch (error) {\n                this.circuitBreaker.recordFailure(agent.id);\n                console.warn(`Fallback agent ${agent.id} also failed:`, error);\n            }\n        }\n        return {\n            success: false,\n            agent: null,\n            error: \"All agents failed, including fallbacks\",\n            metrics: {\n                selectionTime,\n                executionTime: 0,\n                totalTime: Date.now() - startTime\n            }\n        };\n    }\n    /**\r\n   * Execute virtual agent (like MCP)\r\n   */ async executeVirtualAgent(agent, query, context) {\n        // Use existing handleGeneralMCPQuery logic\n        return await this.handleGeneralMCPQuery({\n            query,\n            context\n        });\n    }\n    /**\r\n   * Execute real agent via A2A\r\n   */ async executeRealAgent(agent, query, context) {\n        // Use existing A2A execution logic from executeStep\n        const step = {\n            id: \"enhanced-step\",\n            agentId: agent.url,\n            skillId: \"enhanced-execution\",\n            input: {\n                query,\n                context\n            },\n            status: \"running\"\n        };\n        return await this.executeStep(step);\n    }\n    /**\r\n   * Most important function in the orchestrator service\r\n   * Centralized decision maker - determines whether to route to Backend or DeepSeek\r\n   */ async handleCentralizedRequest(requestData) {\n        const { query, context } = requestData;\n        // Add query to chat history\n        this.addChatMessage({\n            type: \"user\",\n            content: query,\n            metadata: {\n                status: \"processing\"\n            }\n        });\n        try {\n            // Use DeepSeek AI to classify the request\n            const requestType = await this.classifyRequestType(query);\n            if (requestType === \"quiz\") {\n                // Route to Backend Agent for quiz generation\n                console.log(\"\\uD83C\\uDFAF Orchestrator Decision: Quiz Request → Backend Agent\");\n                return await this.routeToBackendAgent(query, context);\n            } else if (requestType === \"manual\") {\n                // Route to Manual Generation\n                console.log(\"\\uD83D\\uDCD6 Orchestrator Decision: Manual Request → Manual Generator\");\n                return await this.routeToManualGenerator(query, context);\n            } else {\n                // Route to DeepSeek API for general chat\n                console.log(\"\\uD83D\\uDCAC Orchestrator Decision: Chat Request → DeepSeek API\");\n                return await this.routeToDeepSeekAPI(query, context);\n            }\n        } catch (error) {\n            console.error(\"Error in centralized request handling:\", error);\n            // Fallback to simple pattern matching\n            const lowerQuery = query.toLowerCase();\n            const isQuizFallback = lowerQuery.includes(\"create\") && lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"generate\") && lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"make\") && lowerQuery.includes(\"quiz\") || lowerQuery.includes(\"quiz about\") || lowerQuery.includes(\"quiz on\");\n            const isManualFallback = lowerQuery.includes(\"create\") && lowerQuery.includes(\"manual\") || lowerQuery.includes(\"generate\") && lowerQuery.includes(\"manual\") || lowerQuery.includes(\"make\") && lowerQuery.includes(\"manual\") || lowerQuery.includes(\"write\") && lowerQuery.includes(\"manual\") || lowerQuery.includes(\"manual about\") || lowerQuery.includes(\"manual on\") || lowerQuery.includes(\"documentation about\") || lowerQuery.includes(\"guide about\");\n            try {\n                if (isQuizFallback) {\n                    return await this.routeToBackendAgent(query, context);\n                } else if (isManualFallback) {\n                    return await this.routeToManualGenerator(query, context);\n                } else {\n                    return await this.routeToDeepSeekAPI(query, context);\n                }\n            } catch (fallbackError) {\n                console.error(\"Fallback routing also failed:\", fallbackError);\n                // Ultimate fallback - return a simple response\n                this.addChatMessage({\n                    type: \"agent\",\n                    content: \"I apologize, but I'm experiencing technical difficulties. Please try again later or rephrase your request.\",\n                    metadata: {\n                        agentId: \"fallback-agent\",\n                        status: \"error\"\n                    }\n                });\n                return {\n                    type: \"error\",\n                    response: \"I apologize, but I'm experiencing technical difficulties. Please try again later or rephrase your request.\",\n                    agentId: \"fallback-agent\",\n                    chatHistory: this.getChatHistory()\n                };\n            }\n        }\n    }\n    /**\r\n   * Classify request type using DeepSeek AI\r\n   */ async classifyRequestType(query) {\n        try {\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are a classifier that determines the type of user request. Return ONLY one of these three options: \"quiz\", \"manual\", or \"chat\".\r\n\r\nExamples of quiz requests:\r\n- \"create a quiz about science\"\r\n- \"generate a quiz on history\"\r\n- \"make a quiz for math\"\r\n- \"quiz about programming\"\r\n- \"create questions about biology\"\r\n\r\nExamples of manual requests:\r\n- \"create a manual about React\"\r\n- \"generate documentation for Python\"\r\n- \"write a guide about cooking\"\r\n- \"manual about JavaScript\"\r\n- \"documentation about machine learning\"\r\n\r\nExamples of chat requests:\r\n- \"hello\"\r\n- \"what is photosynthesis?\"\r\n- \"help me understand calculus\"\r\n- \"tell me about the weather\"\r\n- \"how are you?\"`\n                    },\n                    {\n                        role: \"user\",\n                        content: query\n                    }\n                ],\n                max_tokens: 10,\n                temperature: 0.1,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content?.toLowerCase().trim();\n            if (response === \"quiz\") return \"quiz\";\n            if (response === \"manual\") return \"manual\";\n            return \"chat\";\n        } catch (error) {\n            console.error(\"DeepSeek classification error:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Classify request using DeepSeek AI (legacy method for backward compatibility)\r\n   */ async classifyRequest(query) {\n        try {\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are a classifier that determines if a user message is requesting quiz creation.\r\n\r\nReturn ONLY \"true\" or \"false\" based on whether the user wants to create a quiz.\r\n\r\nExamples of quiz requests:\r\n- \"create a quiz about science\"\r\n- \"generate a quiz on history\"\r\n- \"make a quiz for math\"\r\n- \"quiz about programming\"\r\n- \"create questions about biology\"\r\n\r\nExamples of NOT quiz requests:\r\n- \"hello\"\r\n- \"what is photosynthesis?\"\r\n- \"help me understand calculus\"\r\n- \"tell me about the weather\"\r\n- \"how are you?\"`\n                    },\n                    {\n                        role: \"user\",\n                        content: query\n                    }\n                ],\n                max_tokens: 10,\n                temperature: 0.1,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content?.toLowerCase().trim();\n            console.log(\"DeepSeek classification response:\", response);\n            return response === \"true\";\n        } catch (error) {\n            console.error(\"DeepSeek classification error:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Route to Backend Agent for quiz generation\r\n   */ async routeToBackendAgent(query, context) {\n        // Temporarily skip backend agent due to complexity issues\n        // Go directly to DeepSeek API for quiz generation\n        console.log(\"\\uD83D\\uDD04 Using DeepSeek API for quiz generation (backend agent temporarily disabled)...\");\n        return await this.routeToDeepSeekAPIForQuiz(query, context);\n    }\n    /**\r\n   * Route to Manual Generator\r\n   */ async routeToManualGenerator(query, context) {\n        try {\n            // Add routing message to chat\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Routing manual request to Manual Creator Agent...`,\n                metadata: {\n                    status: \"routing\"\n                }\n            });\n            // Use DeepSeek API directly for manual generation (manual-creator-agent integration pending)\n            console.log(\"Using DeepSeek API for manual generation...\");\n            const manual = await this.generateManualWithDeepSeek(query, \"\");\n            // Add completion message\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Manual generation completed successfully!`,\n                metadata: {\n                    status: \"completed\"\n                }\n            });\n            return {\n                type: \"manual\",\n                result: {\n                    data: manual\n                },\n                agentId: \"manual-generator-agent\",\n                chatHistory: this.getChatHistory()\n            };\n        } catch (error) {\n            console.error(\"Manual generator routing failed:\", error);\n            // Fallback to general chat\n            console.log(\"\\uD83D\\uDD04 Falling back to general chat...\");\n            return await this.routeToDeepSeekAPI(query, context);\n        }\n    }\n    /**\r\n   * Route to DeepSeek API for quiz generation (fallback)\r\n   */ async routeToDeepSeekAPIForQuiz(query, context) {\n        try {\n            // Add fallback message to chat\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Backend agent unavailable, using DeepSeek API for quiz generation...`,\n                metadata: {\n                    status: \"fallback\"\n                }\n            });\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are an expert quiz creator specializing in educational content. Create a comprehensive quiz based on the user's request.\r\n\r\nGenerate exactly 20 multiple-choice questions with 4 options each (A, B, C, D). Format your response as JSON:\r\n\r\n{\r\n  \"quiz_questions\": [\r\n    {\r\n      \"question\": \"Question text here\",\r\n      \"correct_answer\": \"A\",\r\n      \"answers\": [\r\n        {\"answer\": \"Option A\"},\r\n        {\"answer\": \"Option B\"},\r\n        {\"answer\": \"Option C\"},\r\n        {\"answer\": \"Option D\"}\r\n      ],\r\n      \"difficulty\": \"medium\"\r\n    }\r\n  ]\r\n}\r\n\r\nCRITICAL REQUIREMENTS:\r\n- Create diverse, educational questions about the specific topic requested\r\n- Do NOT repeat the same question or similar questions\r\n- Each question should test different aspects of the topic\r\n- Questions should be factually accurate and educational\r\n- Vary the difficulty levels (easy, medium, hard)\r\n- Make sure correct answers are distributed randomly across A, B, C, D positions\r\n- Questions should be clear, concise, and well-written\r\n- Focus on important concepts, not trivial details\r\n- IMPORTANT: Return ONLY valid JSON, no additional text or explanations`\n                    },\n                    {\n                        role: \"user\",\n                        content: `Create a quiz about: ${query}`\n                    }\n                ],\n                max_tokens: 4000,\n                temperature: 0.7,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content || \"{}\";\n            console.log(\"DeepSeek API response:\", response);\n            try {\n                // Try to extract JSON from the response if it contains extra text\n                let jsonString = response.trim();\n                // Look for JSON object boundaries\n                const jsonStart = jsonString.indexOf(\"{\");\n                const jsonEnd = jsonString.lastIndexOf(\"}\");\n                if (jsonStart !== -1 && jsonEnd !== -1 && jsonEnd > jsonStart) {\n                    jsonString = jsonString.substring(jsonStart, jsonEnd + 1);\n                }\n                const quizData = JSON.parse(jsonString);\n                // Add completion message\n                this.addChatMessage({\n                    type: \"orchestrator\",\n                    content: `Quiz generated successfully using DeepSeek API!`,\n                    metadata: {\n                        status: \"completed\"\n                    }\n                });\n                return {\n                    type: \"quiz\",\n                    result: {\n                        data: quizData\n                    },\n                    agentId: \"deepseek-quiz-agent\",\n                    chatHistory: this.getChatHistory()\n                };\n            } catch (parseError) {\n                // If JSON parsing fails, try to generate a better fallback quiz\n                console.log(\"JSON parsing failed, attempting to generate fallback quiz...\");\n                const topic = query.toLowerCase().replace(/create a quiz about|quiz about|generate.*quiz.*about|make.*quiz.*about/gi, \"\").trim() || \"general knowledge\";\n                // Try to generate a better quiz using a simpler prompt\n                try {\n                    const fallbackCompletion = await client.chat.completions.create({\n                        model: \"deepseek-chat\",\n                        messages: [\n                            {\n                                role: \"system\",\n                                content: `Create 20 educational multiple-choice questions about \"${topic}\". Each question should have 4 options (A, B, C, D). Return ONLY valid JSON in this exact format:\r\n\r\n{\r\n  \"quiz_questions\": [\r\n    {\r\n      \"question\": \"What is...?\",\r\n      \"correct_answer\": \"A\",\r\n      \"answers\": [\r\n        {\"answer\": \"Option A\"},\r\n        {\"answer\": \"Option B\"},\r\n        {\"answer\": \"Option C\"},\r\n        {\"answer\": \"Option D\"}\r\n      ],\r\n      \"difficulty\": \"medium\"\r\n    }\r\n  ]\r\n}\r\n\r\nMake questions educational and factually accurate about ${topic}.`\n                            },\n                            {\n                                role: \"user\",\n                                content: `Create a quiz about ${topic}`\n                            }\n                        ],\n                        max_tokens: 3000,\n                        temperature: 0.5,\n                        stream: false\n                    });\n                    const fallbackResponse = fallbackCompletion.choices[0]?.message?.content || \"{}\";\n                    console.log(\"Fallback API response:\", fallbackResponse);\n                    // Try to parse the fallback response\n                    let fallbackJsonString = fallbackResponse.trim();\n                    const fallbackJsonStart = fallbackJsonString.indexOf(\"{\");\n                    const fallbackJsonEnd = fallbackJsonString.lastIndexOf(\"}\");\n                    if (fallbackJsonStart !== -1 && fallbackJsonEnd !== -1 && fallbackJsonEnd > fallbackJsonStart) {\n                        fallbackJsonString = fallbackJsonString.substring(fallbackJsonStart, fallbackJsonEnd + 1);\n                    }\n                    const fallbackQuiz = JSON.parse(fallbackJsonString);\n                    return {\n                        type: \"quiz\",\n                        result: {\n                            data: fallbackQuiz\n                        },\n                        agentId: \"deepseek-fallback-agent\",\n                        chatHistory: this.getChatHistory()\n                    };\n                } catch (fallbackError) {\n                    console.error(\"Fallback quiz generation also failed:\", fallbackError);\n                }\n                // Ultimate fallback - return error message\n                this.addChatMessage({\n                    type: \"orchestrator\",\n                    content: `Failed to generate quiz for \"${topic}\". Please try again with a different topic.`,\n                    metadata: {\n                        status: \"error\"\n                    }\n                });\n                return {\n                    type: \"error\",\n                    response: `I apologize, but I couldn't generate a quiz about \"${topic}\". Please try again with a different topic or rephrase your request.`,\n                    agentId: \"error-agent\",\n                    chatHistory: this.getChatHistory()\n                };\n            }\n        } catch (error) {\n            console.error(\"DeepSeek API quiz generation failed:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Route to DeepSeek API for general chat\r\n   */ async routeToDeepSeekAPI(query, context) {\n        try {\n            // Add routing message to chat\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Routing chat request to DeepSeek API...`,\n                metadata: {\n                    status: \"routing\"\n                }\n            });\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            // Get recent chat history for context\n            const recentHistory = this.chatHistory.filter((msg)=>msg.type !== \"system\").slice(-10).map((msg)=>({\n                    role: msg.type === \"user\" ? \"user\" : \"assistant\",\n                    content: msg.content\n                }));\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are a helpful AI assistant integrated into a quiz application. You can:\r\n\r\n1. **Answer general questions** - Provide helpful, accurate, and friendly responses\r\n2. **Help with quiz creation** - When users ask to create quizzes, guide them on how to do so\r\n3. **Provide educational support** - Help with learning and understanding various topics\r\n\r\nGuidelines:\r\n- Be conversational and friendly\r\n- Keep responses concise but informative\r\n- If someone asks to create a quiz, explain that they should use phrases like \"create a quiz about [topic]\" or \"generate a quiz on [subject]\"\r\n- Always be helpful and encouraging\r\n- If you don't know something, say so honestly\r\n\r\nCurrent context: You're helping a user who is using a quiz application.`\n                    },\n                    ...recentHistory,\n                    {\n                        role: \"user\",\n                        content: query\n                    }\n                ],\n                max_tokens: 500,\n                temperature: 0.7,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content || \"I apologize, but I couldn't generate a response.\";\n            // Add response to chat history\n            this.addChatMessage({\n                type: \"agent\",\n                content: response,\n                metadata: {\n                    agentId: \"deepseek-chat-agent\",\n                    status: \"completed\"\n                }\n            });\n            return {\n                type: \"chat\",\n                response,\n                agentId: \"deepseek-chat-agent\",\n                chatHistory: this.getChatHistory()\n            };\n        } catch (error) {\n            console.error(\"DeepSeek API routing failed:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Handle general MCP queries that don't require specific agent routing\r\n   */ async handleGeneralMCPQuery(requestData) {\n        const { query, context } = requestData;\n        const chatMode = context?.chatMode || \"quiz\"; // Default to quiz mode\n        // Add query to chat history\n        this.addChatMessage({\n            type: \"user\",\n            content: query,\n            metadata: {\n                status: \"processing\"\n            }\n        });\n        let response = \"\";\n        let agentId = \"\";\n        if (chatMode === \"quiz\" || query.toLowerCase().includes(\"quiz\") || query.toLowerCase().includes(\"question\")) {\n            // Quiz-focused responses\n            agentId = \"quiz-agent\";\n            if (query.toLowerCase().includes(\"create quiz\")) {\n                response = `Great! I'd love to help you create a quiz. What topic would you like the quiz to cover? \r\n\r\n**Examples you can try:**\r\n• \"Create a quiz about the solar system\"\r\n• \"Make a science quiz about photosynthesis\" \r\n• \"Generate a history quiz about the Renaissance\"\r\n• \"Create a math quiz about algebra\"\r\n• \"Make a quiz about JavaScript programming\"\r\n\r\nJust tell me the topic and I'll create 20 multiple-choice questions for you!`;\n            } else if (query.toLowerCase().includes(\"science\")) {\n                response = `Perfect! I can create science quizzes on any topic. Here are some examples:\r\n\r\n**Science Quiz Topics:**\r\n• \"Create a quiz about the solar system and planets\"\r\n• \"Make a biology quiz about human anatomy\"\r\n• \"Generate a chemistry quiz about periodic table\"\r\n• \"Create a physics quiz about Newton's laws\"\r\n• \"Make an astronomy quiz about stars and galaxies\"\r\n\r\nWhat specific science topic interests you? I can generate multiple choice questions, true/false, or short answer questions.`;\n            } else if (query.toLowerCase().includes(\"history\")) {\n                response = `Excellent choice! I can create history quizzes covering any time period or region. Here are some examples:\r\n\r\n**History Quiz Topics:**\r\n• \"Create a quiz about World War II\"\r\n• \"Make a quiz about ancient Egypt\"\r\n• \"Generate a quiz about the American Revolution\"\r\n• \"Create a quiz about the Renaissance period\"\r\n• \"Make a quiz about medieval times\"\r\n\r\nWhat historical period or event would you like to focus on?`;\n            } else if (query.toLowerCase().includes(\"math\")) {\n                response = `Math quizzes are my specialty! I can create questions covering any math topic. Here are some examples:\r\n\r\n**Math Quiz Topics:**\r\n• \"Create a quiz about algebra and equations\"\r\n• \"Make a geometry quiz about shapes and angles\"\r\n• \"Generate a calculus quiz about derivatives\"\r\n• \"Create a statistics quiz about probability\"\r\n• \"Make a quiz about fractions and decimals\"\r\n\r\nWhat level and type of math problems would you like? I can make them as easy or challenging as you need.`;\n            } else if (query.toLowerCase().includes(\"general knowledge\")) {\n                response = `General knowledge quizzes are fun! I can create questions covering many topics. Here are some examples:\r\n\r\n**General Knowledge Topics:**\r\n• \"Create a quiz about world capitals\"\r\n• \"Make a quiz about famous landmarks\"\r\n• \"Generate a quiz about literature and authors\"\r\n• \"Create a quiz about sports and athletes\"\r\n• \"Make a quiz about technology and inventions\"\r\n\r\nWhat area of general knowledge would you like to test?`;\n            } else {\n                response = `I'm your Quiz Agent! I can help you create quizzes on any topic. Here's how to get started:\r\n\r\n**Quick Start Options:**\r\n• Click any suggested button above (Create Quiz, Science Topics, etc.)\r\n• Type \"Create a quiz about [your topic]\"\r\n• Paste content and ask me to make a quiz from it\r\n\r\n**Examples:**\r\n• \"Create a quiz about the solar system\"\r\n• \"Make a science quiz about photosynthesis\"\r\n• \"Generate a history quiz about World War II\"\r\n• \"Create a math quiz about algebra\"\r\n\r\nWhat would you like to quiz about?`;\n            }\n        } else if (query.toLowerCase().includes(\"help\") || query.toLowerCase().includes(\"plan\") || query.toLowerCase().includes(\"explain\")) {\n            // Help/planning mode - provide guidance without needing backend\n            agentId = \"quiz-agent\";\n            response = `I'm your Quiz Agent! I can help you plan and design quizzes even when the generation service is temporarily unavailable.\r\n\r\n**I can help you with:**\r\n• Planning quiz topics and structure\r\n• Suggesting question types and formats\r\n• Explaining quiz creation best practices\r\n• Brainstorming quiz content ideas\r\n• Reviewing quiz concepts\r\n\r\n**What would you like help with?**\r\n• \"Help me plan a science quiz about photosynthesis\"\r\n• \"What topics should I include in a history quiz about World War II?\"\r\n• \"Explain how to write good multiple choice questions\"\r\n• \"Suggest quiz formats for different subjects\"\r\n\r\nHow can I assist you with quiz planning today?`;\n        } else {\n            // General chat mode\n            agentId = \"normal-mcp-agent\";\n            response = `I'm your Quiz Agent, but I can also help with general questions! You asked: \"${query}\". \r\n\r\nI'm here to assist with quiz creation, planning, and answering any questions you have. Even if the quiz generation service is temporarily unavailable, I can still help you plan quizzes and answer questions about quiz creation.\r\n\r\nHow can I help you today?`;\n        }\n        this.addChatMessage({\n            type: \"agent\",\n            content: response,\n            metadata: {\n                agentId: agentId,\n                status: \"completed\"\n            }\n        });\n        return {\n            success: true,\n            response,\n            agent: {\n                name: \"Quiz Agent\"\n            },\n            timestamp: new Date().toISOString()\n        };\n    }\n    /**\r\n   * Start periodic agent discovery\r\n   */ startAgentDiscovery() {\n        // Initial discovery\n        this.discoverAgents();\n        // Periodic discovery every 30 seconds\n        setInterval(()=>{\n            this.discoverAgents();\n        }, 30000);\n    }\n    /**\r\n   * Discover agents in the network using A2A protocol\r\n   */ async discoverAgents(requestData = {}) {\n        const discoveredAgents = [];\n        console.log(\"\\uD83D\\uDD0D Starting A2A agent discovery...\");\n        for (const agentCardUrl of this.knownAgentUrls){\n            try {\n                console.log(`🔍 Discovering agent at ${agentCardUrl}...`);\n                const agentCard = await this.getAgentCard(agentCardUrl);\n                // Extract base URL from agent card URL\n                const baseUrl = agentCardUrl.replace(\"/.well-known/agent-card.json\", \"\");\n                const agentInfo = {\n                    name: agentCard.name || `Agent-${baseUrl.split(\":\").pop()}`,\n                    url: baseUrl,\n                    skills: agentCard.skills?.map((s)=>s.id) || [],\n                    status: \"online\",\n                    lastSeen: new Date(),\n                    capabilities: agentCard.capabilities\n                };\n                this.agents.set(baseUrl, agentInfo);\n                discoveredAgents.push(agentInfo);\n                console.log(`✅ Successfully discovered agent: ${agentInfo.name} at ${baseUrl}`);\n                // Add discovery message to chat\n                this.addChatMessage({\n                    type: \"system\",\n                    content: `Discovered agent: ${agentInfo.name} at ${baseUrl} with ${agentInfo.skills.length} skills`,\n                    metadata: {\n                        agentId: baseUrl,\n                        skillId: agentInfo.skills.join(\",\"),\n                        status: \"discovered\"\n                    }\n                });\n            } catch (error) {\n                console.error(`❌ Failed to discover agent at ${agentCardUrl}:`, error);\n                // Extract base URL from agent card URL\n                const baseUrl = agentCardUrl.replace(\"/.well-known/agent-card.json\", \"\");\n                const agentInfo = {\n                    name: `Unknown Agent (${baseUrl})`,\n                    url: baseUrl,\n                    skills: [],\n                    status: \"offline\",\n                    lastSeen: new Date()\n                };\n                this.agents.set(baseUrl, agentInfo);\n                discoveredAgents.push(agentInfo);\n                // Add failure message to chat\n                this.addChatMessage({\n                    type: \"system\",\n                    content: `Failed to discover agent at ${baseUrl}: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                    metadata: {\n                        agentId: baseUrl,\n                        status: \"offline\"\n                    }\n                });\n            }\n        }\n        console.log(`🎯 Agent discovery completed. Found ${discoveredAgents.length} agents.`);\n        return {\n            agents: discoveredAgents,\n            count: discoveredAgents.length,\n            onlineCount: discoveredAgents.filter((a)=>a.status === \"online\").length,\n            offlineCount: discoveredAgents.filter((a)=>a.status === \"offline\").length,\n            timestamp: new Date().toISOString()\n        };\n    }\n    /**\r\n   * Get agent card from URL using A2A SDK\r\n   */ async getAgentCard(url) {\n        try {\n            // Import A2A client dynamically to avoid SSR issues\n            const { A2AClient } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/@a2a-js\").then(__webpack_require__.bind(__webpack_require__, /*! @a2a-js/sdk/client */ \"(rsc)/./node_modules/@a2a-js/sdk/dist/client/index.js\"));\n            // Create A2A client using fromCardUrl static method\n            const a2aClient = await A2AClient.fromCardUrl(url);\n            // Return the agent card from the client\n            return await a2aClient.getAgentCard();\n        } catch (error) {\n            console.error(\"Failed to get agent card via A2A SDK:\", error);\n            // Fallback to direct fetch if A2A SDK fails\n            const controller = new AbortController();\n            const timeoutId = setTimeout(()=>controller.abort(), 5000);\n            try {\n                const response = await fetch(`${url}/.well-known/agent-card.json`, {\n                    signal: controller.signal\n                });\n                clearTimeout(timeoutId);\n                return response.json();\n            } catch (fetchError) {\n                clearTimeout(timeoutId);\n                throw fetchError;\n            }\n        }\n    }\n    /**\r\n   * Orchestrate complete quiz workflow with chat integration\r\n   *\r\n   * This method coordinates the entire quiz generation process by:\r\n   * 1. Creating a workflow with predefined steps\r\n   * 2. Executing steps in dependency order\r\n   * 3. Providing real-time chat updates throughout the process\r\n   * 4. Handling errors and providing feedback\r\n   *\r\n   * @param requestData - Contains topic, difficulty, and question_count\r\n   * @returns Promise with workflow results and status\r\n   */ async orchestrateQuizWorkflow(requestData) {\n        // Generate unique workflow ID using timestamp for uniqueness\n        const workflowId = `workflow_${Date.now()}`;\n        // Extract and set default values for quiz parameters\n        const { topic, difficulty = \"intermediate\", question_count = 20 } = requestData;\n        try {\n            // Notify chat system that workflow is starting\n            // This provides user feedback and maintains audit trail\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Starting quiz workflow for topic: \"${topic}\"`,\n                metadata: {\n                    workflowId,\n                    status: \"starting\"\n                }\n            });\n            // Define the workflow structure with two sequential steps:\n            // Step 1: Generate quiz questions (backend agent)\n            // Step 2: Display quiz (frontend agent)\n            const workflow = {\n                id: workflowId,\n                name: `Quiz Generation: ${topic}`,\n                steps: [\n                    {\n                        id: \"step_1\",\n                        agentId: process.env.NEXT_PUBLIC_QUIZ_AGENT_URL || \"http://localhost:4001\",\n                        skillId: \"generate-quiz\",\n                        input: {\n                            topic,\n                            difficulty,\n                            question_count\n                        },\n                        status: \"pending\"\n                    },\n                    {\n                        id: \"step_2\",\n                        agentId: \"http://localhost:3000\",\n                        skillId: \"display_quiz\",\n                        input: {},\n                        dependencies: [\n                            \"step_1\"\n                        ],\n                        status: \"pending\"\n                    }\n                ],\n                status: \"running\",\n                createdAt: new Date()\n            };\n            // Store workflow in memory for tracking and management\n            this.workflows.set(workflowId, workflow);\n            // Execute the workflow steps in dependency order with chat integration\n            // This method handles step execution, dependency checking, and chat updates\n            const result = await this.executeWorkflowWithChat(workflowId);\n            // Notify chat system of successful completion\n            // Provides user feedback on the number of questions generated\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Quiz workflow completed successfully! Generated ${result.length} questions.`,\n                metadata: {\n                    workflowId,\n                    status: \"completed\"\n                }\n            });\n            // Return structured response with workflow details\n            return {\n                workflow_id: workflowId,\n                status: \"completed\",\n                result: result,\n                timestamp: new Date().toISOString()\n            };\n        } catch (error) {\n            // Log error for debugging purposes\n            console.error(\"Workflow orchestration failed:\", error);\n            // Notify chat system of workflow failure\n            // Provides user feedback on what went wrong\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Workflow failed: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                metadata: {\n                    workflowId,\n                    status: \"failed\"\n                }\n            });\n            // Re-throw error to be handled by calling code\n            throw error;\n        }\n    }\n    /**\r\n   * Orchestrate manual generation workflow\r\n   */ async orchestrateManualWorkflow(requestData) {\n        // Generate unique workflow ID using timestamp for uniqueness\n        const workflowId = `manual_workflow_${Date.now()}`;\n        // Extract and set default values for manual parameters\n        const { topic, prompt = \"\" } = requestData;\n        try {\n            // Notify chat system that workflow is starting\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Starting manual workflow for topic: \"${topic}\"`,\n                metadata: {\n                    workflowId,\n                    status: \"starting\"\n                }\n            });\n            // Use DeepSeek API directly for manual generation\n            const manual = await this.generateManualWithDeepSeek(topic, prompt);\n            // Notify chat system of successful completion\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Manual workflow completed successfully! Generated comprehensive manual for \"${topic}\".`,\n                metadata: {\n                    workflowId,\n                    status: \"completed\"\n                }\n            });\n            // Return structured response with workflow details\n            return {\n                workflow_id: workflowId,\n                status: \"completed\",\n                result: {\n                    data: manual\n                },\n                timestamp: new Date().toISOString()\n            };\n        } catch (error) {\n            // Log error for debugging purposes\n            console.error(\"Manual workflow orchestration failed:\", error);\n            // Notify chat system of workflow failure\n            this.addChatMessage({\n                type: \"orchestrator\",\n                content: `Manual workflow failed: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                metadata: {\n                    workflowId,\n                    status: \"failed\"\n                }\n            });\n            // Re-throw error to be handled by calling code\n            throw error;\n        }\n    }\n    /**\r\n   * Call the actual manual-creator-agent using A2A protocol\r\n   */ async callManualCreatorAgent(topic, prompt) {\n        try {\n            console.log(`📚 Calling manual-creator-agent for topic: ${topic}`);\n            // Call the manual-creator-agent directly\n            const response = await fetch(`${process.env.NEXT_PUBLIC_MANUAL_AGENT_URL || \"http://localhost:4002\"}/api/actions/generate-manual`, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    topic: topic,\n                    prompt: prompt\n                })\n            });\n            if (!response.ok) {\n                throw new Error(`Manual creator agent responded with status: ${response.status}`);\n            }\n            const result = await response.json();\n            console.log(\"Manual creator agent response:\", result);\n            // Extract the manual data from the response\n            if (result.data && result.data.content) {\n                // The response contains markdown content, parse it\n                const markdownContent = result.data.content;\n                // Extract title from markdown\n                const titleMatch = markdownContent.match(/^# (.+)$/m);\n                const title = titleMatch ? titleMatch[1] : `Manual: ${topic}`;\n                // Extract introduction\n                const introMatch = markdownContent.match(/## Introduction\\n([\\s\\S]*?)(?=\\n## |\\n### |$)/);\n                const introduction = introMatch ? introMatch[1].trim() : `This manual provides comprehensive information about ${topic}`;\n                // Extract sections\n                const sections = [];\n                const sectionRegex = /### Section \\d+: ([^\\n]+)\\n([\\s\\S]*?)(?=\\n### Section |\\n## |$)/g;\n                let sectionMatch;\n                while((sectionMatch = sectionRegex.exec(markdownContent)) !== null){\n                    const sectionTitle = sectionMatch[1].trim();\n                    const sectionContent = sectionMatch[2].trim();\n                    // Extract subsections if any\n                    const subsections = [];\n                    const subsectionRegex = /\\*\\*([^*]+):\\*\\*([^*]+)/g;\n                    let subsectionMatch;\n                    while((subsectionMatch = subsectionRegex.exec(sectionContent)) !== null){\n                        subsections.push({\n                            title: subsectionMatch[1].trim(),\n                            content: subsectionMatch[2].trim()\n                        });\n                    }\n                    sections.push({\n                        title: sectionTitle,\n                        content: sectionContent,\n                        subsections: subsections\n                    });\n                }\n                // Extract conclusion\n                const conclusionMatch = markdownContent.match(/## Collaborative Review\\n([\\s\\S]*?)(?=\\n---|\\*|$)/);\n                const conclusion = conclusionMatch ? conclusionMatch[1].trim() : `This manual has provided comprehensive coverage of ${topic}.`;\n                // Extract glossary and references\n                const glossaryMatch = markdownContent.match(/\\*\\*Glossary:\\*\\*\\n([\\s\\S]*?)(?=\\n\\*\\*References:\\*\\*|$)/);\n                const referencesMatch = markdownContent.match(/\\*\\*References:\\*\\*\\n([\\s\\S]*?)(?=\\n---|\\*|$)/);\n                return {\n                    title: title,\n                    introduction: {\n                        purpose: introduction,\n                        audience: \"General users\",\n                        prerequisites: \"Basic understanding of the topic\"\n                    },\n                    sections: sections.length > 0 ? sections : [\n                        {\n                            title: \"Overview\",\n                            content: `This section provides an overview of ${topic}.`,\n                            subsections: []\n                        },\n                        {\n                            title: \"Getting Started\",\n                            content: `This section covers the basics of ${topic}.`,\n                            subsections: []\n                        },\n                        {\n                            title: \"Advanced Topics\",\n                            content: `This section covers advanced concepts related to ${topic}.`,\n                            subsections: []\n                        }\n                    ],\n                    conclusion: conclusion,\n                    appendix: {\n                        glossary: glossaryMatch ? glossaryMatch[1].trim() : \"Key terms and definitions\",\n                        resources: referencesMatch ? referencesMatch[1].trim() : \"Additional resources and references\"\n                    }\n                };\n            } else {\n                throw new Error(\"Invalid response format from manual creator agent\");\n            }\n        } catch (error) {\n            console.error(\"Error calling manual creator agent:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Generate manual using DeepSeek API\r\n   */ async generateManualWithDeepSeek(topic, prompt) {\n        try {\n            // Import OpenAI dynamically\n            const OpenAI = (await __webpack_require__.e(/*! import() */ \"vendor-chunks/openai\").then(__webpack_require__.bind(__webpack_require__, /*! openai */ \"(rsc)/./node_modules/openai/index.mjs\"))).default;\n            const client = new OpenAI({\n                apiKey: \"sk-6796ea0f38c7499dbf47c7ff2a026966\",\n                baseURL: \"https://api.deepseek.com\"\n            });\n            const completion = await client.chat.completions.create({\n                model: \"deepseek-chat\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `You are an expert technical writer specializing in creating comprehensive manuals and documentation. Create a detailed manual based on the user's request.\r\n\r\nGenerate a comprehensive manual in JSON format:\r\n\r\n{\r\n  \"title\": \"Manual Title\",\r\n  \"introduction\": {\r\n    \"purpose\": \"Purpose of the manual\",\r\n    \"audience\": \"Target audience\",\r\n    \"prerequisites\": \"Required knowledge or skills\"\r\n  },\r\n  \"sections\": [\r\n    {\r\n      \"title\": \"Section Title\",\r\n      \"content\": \"Detailed content for this section\",\r\n      \"subsections\": [\r\n        {\r\n          \"title\": \"Subsection Title\",\r\n          \"content\": \"Subsection content\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"conclusion\": \"Summary and next steps\",\r\n  \"appendix\": {\r\n    \"glossary\": \"Key terms and definitions\",\r\n    \"resources\": \"Additional resources and references\"\r\n  }\r\n}\r\n\r\nREQUIREMENTS:\r\n- Create a comprehensive, well-structured manual\r\n- Include practical examples and step-by-step instructions\r\n- Make content educational and easy to follow\r\n- Organize information logically with clear sections\r\n- Include relevant details and context\r\n- Ensure content is accurate and professional`\n                    },\n                    {\n                        role: \"user\",\n                        content: `Create a comprehensive manual about: ${topic}${prompt ? `\\n\\nAdditional requirements: ${prompt}` : \"\"}`\n                    }\n                ],\n                max_tokens: 4000,\n                temperature: 0.7,\n                stream: false\n            });\n            const response = completion.choices[0]?.message?.content || \"{}\";\n            try {\n                // First try to parse as JSON directly\n                const manualData = JSON.parse(response);\n                return manualData;\n            } catch (parseError) {\n                console.log(\"JSON parsing failed, trying to extract JSON from markdown:\", parseError);\n                // Try to extract JSON from markdown code blocks\n                const jsonMatch = response.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n                if (jsonMatch) {\n                    try {\n                        const extractedJson = jsonMatch[1].trim();\n                        const manualData = JSON.parse(extractedJson);\n                        return manualData;\n                    } catch (extractError) {\n                        console.log(\"Failed to parse extracted JSON:\", extractError);\n                    }\n                }\n                // Try to extract JSON without code block markers\n                const jsonStart = response.indexOf(\"{\");\n                const jsonEnd = response.lastIndexOf(\"}\");\n                if (jsonStart !== -1 && jsonEnd !== -1 && jsonEnd > jsonStart) {\n                    try {\n                        const jsonString = response.substring(jsonStart, jsonEnd + 1);\n                        const manualData = JSON.parse(jsonString);\n                        return manualData;\n                    } catch (extractError) {\n                        console.log(\"Failed to parse extracted JSON string:\", extractError);\n                    }\n                }\n                console.log(\"All JSON extraction attempts failed, processing as markdown content\");\n                // If JSON parsing fails, process the markdown content\n                const markdownContent = response;\n                // Extract title from markdown\n                const titleMatch = markdownContent.match(/^# (.+)$/m);\n                const title = titleMatch ? titleMatch[1] : `Manual: ${topic}`;\n                // Extract introduction\n                const introMatch = markdownContent.match(/## Introduction\\n([\\s\\S]*?)(?=\\n## |\\n### |$)/);\n                const introduction = introMatch ? introMatch[1].trim() : `This manual provides comprehensive information about ${topic}`;\n                // Extract sections\n                const sections = [];\n                const sectionRegex = /### Section \\d+: ([^\\n]+)\\n([\\s\\S]*?)(?=\\n### Section |\\n## |$)/g;\n                let sectionMatch;\n                while((sectionMatch = sectionRegex.exec(markdownContent)) !== null){\n                    const sectionTitle = sectionMatch[1].trim();\n                    const sectionContent = sectionMatch[2].trim();\n                    // Extract subsections if any\n                    const subsections = [];\n                    const subsectionRegex = /\\*\\*([^*]+):\\*\\*([^*]+)/g;\n                    let subsectionMatch;\n                    while((subsectionMatch = subsectionRegex.exec(sectionContent)) !== null){\n                        subsections.push({\n                            title: subsectionMatch[1].trim(),\n                            content: subsectionMatch[2].trim()\n                        });\n                    }\n                    sections.push({\n                        title: sectionTitle,\n                        content: sectionContent,\n                        subsections: subsections\n                    });\n                }\n                // Extract conclusion\n                const conclusionMatch = markdownContent.match(/## Collaborative Review\\n([\\s\\S]*?)(?=\\n---|\\*|$)/);\n                const conclusion = conclusionMatch ? conclusionMatch[1].trim() : `This manual has provided comprehensive coverage of ${topic}.`;\n                // Extract glossary and references\n                const glossaryMatch = markdownContent.match(/\\*\\*Glossary:\\*\\*\\n([\\s\\S]*?)(?=\\n\\*\\*References:\\*\\*|$)/);\n                const referencesMatch = markdownContent.match(/\\*\\*References:\\*\\*\\n([\\s\\S]*?)(?=\\n---|\\*|$)/);\n                return {\n                    title: title,\n                    introduction: {\n                        purpose: introduction,\n                        audience: \"General users\",\n                        prerequisites: \"Basic understanding of the topic\"\n                    },\n                    sections: sections.length > 0 ? sections : [\n                        {\n                            title: \"Overview\",\n                            content: `This section provides an overview of ${topic}.`,\n                            subsections: []\n                        },\n                        {\n                            title: \"Getting Started\",\n                            content: `This section covers the basics of ${topic}.`,\n                            subsections: []\n                        },\n                        {\n                            title: \"Advanced Topics\",\n                            content: `This section covers advanced concepts related to ${topic}.`,\n                            subsections: []\n                        }\n                    ],\n                    conclusion: conclusion,\n                    appendix: {\n                        glossary: glossaryMatch ? glossaryMatch[1].trim() : \"Key terms and definitions\",\n                        resources: referencesMatch ? referencesMatch[1].trim() : \"Additional resources and references\"\n                    }\n                };\n            }\n        } catch (error) {\n            console.error(\"DeepSeek manual generation error:\", error);\n            throw error;\n        }\n    }\n    /**\r\n   * Execute workflow with chat integration\r\n   */ async executeWorkflowWithChat(workflowId) {\n        const workflow = this.workflows.get(workflowId);\n        if (!workflow) {\n            throw new Error(`Workflow ${workflowId} not found`);\n        }\n        const results = [];\n        for (const step of workflow.steps){\n            try {\n                // Add step start message to chat\n                this.addChatMessage({\n                    type: \"orchestrator\",\n                    content: `Executing step: ${step.skillId} on ${step.agentId}`,\n                    metadata: {\n                        workflowId,\n                        agentId: step.agentId,\n                        skillId: step.skillId,\n                        status: \"running\"\n                    }\n                });\n                // Check dependencies\n                if (step.dependencies) {\n                    const dependencyResults = step.dependencies.map((depId)=>{\n                        const depStep = workflow.steps.find((s)=>s.id === depId);\n                        return depStep?.result;\n                    });\n                    if (dependencyResults.some((r)=>!r)) {\n                        throw new Error(`Dependencies not met for step ${step.id}`);\n                    }\n                }\n                // Execute step\n                step.status = \"running\";\n                const result = await this.executeStep(step);\n                step.result = result;\n                step.status = \"completed\";\n                results.push(result);\n                // Add step completion message to chat\n                this.addChatMessage({\n                    type: \"agent\",\n                    content: `Step completed: ${step.skillId}`,\n                    metadata: {\n                        workflowId,\n                        agentId: step.agentId,\n                        skillId: step.skillId,\n                        status: \"completed\"\n                    }\n                });\n            } catch (error) {\n                step.status = \"failed\";\n                workflow.status = \"failed\";\n                // Add step failure message to chat\n                this.addChatMessage({\n                    type: \"agent\",\n                    content: `Step failed: ${step.skillId} - ${error instanceof Error ? error.message : \"Unknown error\"}`,\n                    metadata: {\n                        workflowId,\n                        agentId: step.agentId,\n                        skillId: step.skillId,\n                        status: \"failed\"\n                    }\n                });\n                throw error;\n            }\n        }\n        workflow.status = \"completed\";\n        workflow.completedAt = new Date();\n        return results;\n    }\n    /**\r\n   * Execute a single workflow step using real A2A SDK with enhanced error handling\r\n   */ async executeStep(step) {\n        const agent = this.agents.get(step.agentId);\n        if (!agent) {\n            throw new Error(`Agent ${step.agentId} not found`);\n        }\n        try {\n            console.log(`🔄 Executing step ${step.id} on agent ${step.agentId}`);\n            // Use direct HTTP call instead of A2A SDK to avoid agent card fetching issues\n            const message = {\n                messageId: (0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(),\n                parts: [\n                    {\n                        kind: \"text\",\n                        text: step.input.topic || JSON.stringify({\n                            skillId: step.skillId,\n                            input: step.input\n                        })\n                    }\n                ]\n            };\n            // Send direct HTTP request to backend agent\n            const response = await fetch(`${step.agentId}/a2a/tasks`, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    message: message,\n                    configuration: {\n                        blocking: true\n                    }\n                })\n            });\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status}`);\n            }\n            const result = await response.json();\n            console.log(`A2A response for step ${step.id}:`, result);\n            // Handle the response - the backend agent returns the quiz data directly\n            if (result && typeof result === \"object\") {\n                // Extract quiz data from the response\n                let quizData = null;\n                if (result.task && result.task.artifacts) {\n                    // If response has task with artifacts, extract quiz from artifacts\n                    const quizArtifact = result.task.artifacts.find((artifact)=>artifact.name === \"quiz.json\" || artifact.name === \"quiz\");\n                    if (quizArtifact && quizArtifact.parts) {\n                        const quizText = quizArtifact.parts.find((part)=>part.kind === \"text\")?.text;\n                        if (quizText) {\n                            quizData = JSON.parse(quizText);\n                        }\n                    }\n                } else if (result.data) {\n                    // If response has data directly\n                    quizData = result.data;\n                } else if (result.quiz_questions) {\n                    // If response has quiz_questions directly\n                    quizData = result;\n                }\n                if (quizData && quizData.quiz_questions) {\n                    console.log(`✅ Step ${step.id} completed successfully with ${quizData.quiz_questions.length} questions`);\n                    return quizData.quiz_questions;\n                } else {\n                    console.log(`⚠️ Step ${step.id} completed but no quiz data found in response`);\n                    return [];\n                }\n            } else {\n                console.log(`⚠️ Step ${step.id} completed with unexpected response format`);\n                return [];\n            }\n        } catch (error) {\n            console.error(`A2A task execution failed for step ${step.id}:`, error);\n            throw new Error(`A2A agent call failed for step ${step.id}: ${error instanceof Error ? error.message : \"Unknown error\"}`);\n        }\n    }\n    /**\r\n   * Enhanced system health monitoring with circuit breaker status\r\n   */ async monitorSystemHealth(requestData) {\n        const healthChecks = [];\n        const enhancedAgents = this.enhancedAgentSelector.getAllAgents();\n        // Check enhanced agents\n        for (const agent of enhancedAgents){\n            const breakerStatus = this.circuitBreaker.getStatus(agent.id);\n            healthChecks.push({\n                agent: agent.name,\n                url: agent.url,\n                status: agent.status,\n                load: agent.load,\n                reliability: agent.reliability,\n                responseTime: agent.responseTime,\n                circuitBreaker: breakerStatus,\n                lastSeen: agent.lastSeen\n            });\n        }\n        // Check legacy agents\n        const agentEntries = Array.from(this.agents.entries());\n        for(let i = 0; i < agentEntries.length; i++){\n            const [url, agent] = agentEntries[i];\n            // Skip if already checked in enhanced agents\n            if (enhancedAgents.some((ea)=>ea.url === url)) continue;\n            try {\n                const controller = new AbortController();\n                const timeoutId = setTimeout(()=>controller.abort(), 3000);\n                const response = await fetch(`${url}/health`, {\n                    signal: controller.signal\n                });\n                clearTimeout(timeoutId);\n                healthChecks.push({\n                    agent: agent.name,\n                    url: url,\n                    status: \"healthy\",\n                    response_time: response.headers.get(\"x-response-time\") || \"unknown\",\n                    circuitBreaker: null\n                });\n            } catch (error) {\n                healthChecks.push({\n                    agent: agent.name,\n                    url: url,\n                    status: \"unhealthy\",\n                    error: error instanceof Error ? error.message : \"Unknown error\",\n                    circuitBreaker: null\n                });\n            }\n        }\n        const overallHealth = healthChecks.every((h)=>h.status === \"healthy\") ? \"healthy\" : \"degraded\";\n        return {\n            overall_health: overallHealth,\n            agents: healthChecks,\n            circuitBreakers: this.circuitBreaker.getAllStates(),\n            enhanced_metrics: {\n                totalAgents: enhancedAgents.length,\n                onlineAgents: enhancedAgents.filter((a)=>a.status === \"online\").length,\n                averageReliability: enhancedAgents.reduce((sum, a)=>sum + a.reliability, 0) / enhancedAgents.length,\n                averageResponseTime: enhancedAgents.reduce((sum, a)=>sum + a.responseTime, 0) / enhancedAgents.length\n            },\n            timestamp: new Date().toISOString()\n        };\n    }\n    /**\r\n   * Add message to chat history\r\n   */ addChatMessage(message) {\n        const chatMessage = {\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(),\n            timestamp: new Date(),\n            ...message\n        };\n        this.chatHistory.push(chatMessage);\n        return chatMessage;\n    }\n    /**\r\n   * Get chat history\r\n   */ getChatHistory() {\n        return this.chatHistory;\n    }\n    /**\r\n   * Get chat history for a specific workflow\r\n   */ getWorkflowChatHistory(workflowId) {\n        return this.chatHistory.filter((msg)=>msg.metadata?.workflowId === workflowId);\n    }\n    /**\r\n   * Clear chat history\r\n   */ clearChatHistory() {\n        this.chatHistory = [];\n    }\n    /**\r\n   * Get all workflows\r\n   */ getAllWorkflows() {\n        return Array.from(this.workflows.values());\n    }\n    /**\r\n   * Get workflow by ID\r\n   */ getWorkflow(workflowId) {\n        return this.workflows.get(workflowId);\n    }\n    /**\r\n   * Get all agents\r\n   */ getAllAgents() {\n        return Array.from(this.agents.values());\n    }\n    /**\r\n   * Get agent by URL\r\n   */ getAgent(url) {\n        return this.agents.get(url);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cVAsWUFBWTlGLFVBQWtCLEVBQXdCO1FBQ3BELE9BQU8sSUFBSSxDQUFDbk8sU0FBUyxDQUFDMkcsR0FBRyxDQUFDd0g7SUFDNUI7SUFFQTs7R0FFQyxHQUNEbEwsZUFBNEI7UUFDMUIsT0FBT3lCLE1BQU1DLElBQUksQ0FBQyxJQUFJLENBQUM3RSxNQUFNLENBQUM4RSxNQUFNO0lBQ3RDO0lBRUE7O0dBRUMsR0FDRHNQLFNBQVM1UyxHQUFXLEVBQXlCO1FBQzNDLE9BQU8sSUFBSSxDQUFDeEIsTUFBTSxDQUFDNkcsR0FBRyxDQUFDckY7SUFDekI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3F1aXotZnJvbnRlbmQvLi9zcmMvbGliL29yY2hlc3RyYXRvclNlcnZpY2UudHM/YzJiOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tIFwidXVpZFwiO1xyXG5pbXBvcnQge1xyXG4gIEVuaGFuY2VkQWdlbnRTZWxlY3RvcixcclxuICBBZ2VudFByb2ZpbGUsXHJcbiAgUXVlcnlDb250ZXh0LFxyXG59IGZyb20gXCIuL2VuaGFuY2VkLWFnZW50LXNlbGVjdG9yXCI7XHJcbmltcG9ydCB7IEFnZW50Q2lyY3VpdEJyZWFrZXIgfSBmcm9tIFwiLi9jaXJjdWl0LWJyZWFrZXJcIjtcclxuaW1wb3J0IHtcclxuICBEeW5hbWljQWdlbnREaXNjb3ZlcnksXHJcbiAgQWdlbnREaXNjb3ZlcnlDb25maWcsXHJcbn0gZnJvbSBcIi4vZHluYW1pYy1hZ2VudC1kaXNjb3ZlcnlcIjtcclxuaW1wb3J0IHsgRW52aXJvbm1lbnRBZ2VudE1hbmFnZXIgfSBmcm9tIFwiLi9lbnZpcm9ubWVudC1hZ2VudC1tYW5hZ2VyXCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFnZW50SW5mbyB7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIHVybDogc3RyaW5nO1xyXG4gIHNraWxsczogc3RyaW5nW107XHJcbiAgc3RhdHVzOiBcIm9ubGluZVwiIHwgXCJvZmZsaW5lXCIgfCBcInVua25vd25cIjtcclxuICBsYXN0U2VlbjogRGF0ZTtcclxuICBjYXBhYmlsaXRpZXM/OiBhbnk7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV29ya2Zsb3dTdGVwIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIGFnZW50SWQ6IHN0cmluZztcclxuICBza2lsbElkOiBzdHJpbmc7XHJcbiAgaW5wdXQ6IGFueTtcclxuICBkZXBlbmRlbmNpZXM/OiBzdHJpbmdbXTtcclxuICBzdGF0dXM6IFwicGVuZGluZ1wiIHwgXCJydW5uaW5nXCIgfCBcImNvbXBsZXRlZFwiIHwgXCJmYWlsZWRcIjtcclxuICByZXN1bHQ/OiBhbnk7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV29ya2Zsb3cge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIHN0ZXBzOiBXb3JrZmxvd1N0ZXBbXTtcclxuICBzdGF0dXM6IFwicGVuZGluZ1wiIHwgXCJydW5uaW5nXCIgfCBcImNvbXBsZXRlZFwiIHwgXCJmYWlsZWRcIjtcclxuICBjcmVhdGVkQXQ6IERhdGU7XHJcbiAgY29tcGxldGVkQXQ/OiBEYXRlO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENoYXRNZXNzYWdlIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHR5cGU6IFwidXNlclwiIHwgXCJvcmNoZXN0cmF0b3JcIiB8IFwiYWdlbnRcIiB8IFwic3lzdGVtXCI7XHJcbiAgY29udGVudDogc3RyaW5nO1xyXG4gIHRpbWVzdGFtcDogRGF0ZTtcclxuICBtZXRhZGF0YT86IHtcclxuICAgIHdvcmtmbG93SWQ/OiBzdHJpbmc7XHJcbiAgICBhZ2VudElkPzogc3RyaW5nO1xyXG4gICAgc2tpbGxJZD86IHN0cmluZztcclxuICAgIHN0YXR1cz86IHN0cmluZztcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgTmV4dEpTT3JjaGVzdHJhdG9yU2VydmljZSB7XHJcbiAgcHJpdmF0ZSBhZ2VudHM6IE1hcDxzdHJpbmcsIEFnZW50SW5mbz4gPSBuZXcgTWFwKCk7XHJcbiAgcHJpdmF0ZSB3b3JrZmxvd3M6IE1hcDxzdHJpbmcsIFdvcmtmbG93PiA9IG5ldyBNYXAoKTtcclxuICBwcml2YXRlIGNoYXRIaXN0b3J5OiBDaGF0TWVzc2FnZVtdID0gW107XHJcblxyXG4gIC8vIER5bmFtaWMgYWdlbnQgVVJMcyBiYXNlZCBvbiBlbnZpcm9ubWVudFxyXG4gIHByaXZhdGUga25vd25BZ2VudFVybHM6IHN0cmluZ1tdID0gW1xyXG4gICAgYCR7XHJcbiAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX09SQ0hFU1RSQVRPUl9VUkwgfHwgXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIlxyXG4gICAgfS8ud2VsbC1rbm93bi9hZ2VudC1jYXJkLmpzb25gLCAvLyBGcm9udGVuZCBhZ2VudCAoc2VsZilcclxuICAgIGAke1xyXG4gICAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19RVUlaX0FHRU5UX1VSTCB8fCBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiXHJcbiAgICB9Ly53ZWxsLWtub3duL2FnZW50LWNhcmQuanNvbmAsIC8vIEJhY2tlbmQgYWdlbnRcclxuICAgIGAke1xyXG4gICAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19NQU5VQUxfQUdFTlRfVVJMIHx8IFwiaHR0cDovL2xvY2FsaG9zdDo0MDAyXCJcclxuICAgIH0vLndlbGwta25vd24vYWdlbnQtY2FyZC5qc29uYCwgLy8gTWFudWFsLWNyZWF0b3IgYWdlbnRcclxuICBdO1xyXG5cclxuICAvLyBFbmhhbmNlZCBjb21wb25lbnRzXHJcbiAgcHJpdmF0ZSBlbmhhbmNlZEFnZW50U2VsZWN0b3I6IEVuaGFuY2VkQWdlbnRTZWxlY3RvcjtcclxuICBwcml2YXRlIGNpcmN1aXRCcmVha2VyOiBBZ2VudENpcmN1aXRCcmVha2VyO1xyXG4gIHByaXZhdGUgcmV0cnlBdHRlbXB0czogbnVtYmVyID0gMztcclxuICBwcml2YXRlIHRpbWVvdXRNczogbnVtYmVyID0gMzAwMDA7XHJcblxyXG4gIC8vIER5bmFtaWMgZGlzY292ZXJ5IGNvbXBvbmVudHNcclxuICBwcml2YXRlIGR5bmFtaWNEaXNjb3Zlcnk6IER5bmFtaWNBZ2VudERpc2NvdmVyeSB8IG51bGwgPSBudWxsO1xyXG4gIHByaXZhdGUgZW52aXJvbm1lbnRNYW5hZ2VyOiBFbnZpcm9ubWVudEFnZW50TWFuYWdlcjtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAvLyBJbml0aWFsaXplIGVuaGFuY2VkIGNvbXBvbmVudHNcclxuICAgIHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yID0gbmV3IEVuaGFuY2VkQWdlbnRTZWxlY3RvcigpO1xyXG4gICAgdGhpcy5jaXJjdWl0QnJlYWtlciA9IG5ldyBBZ2VudENpcmN1aXRCcmVha2VyKCk7XHJcblxyXG4gICAgLy8gSW5pdGlhbGl6ZSBlbnZpcm9ubWVudC1iYXNlZCBhZ2VudCBtYW5hZ2VtZW50XHJcbiAgICBjb25zdCBlbnZpcm9ubWVudCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WIHx8IFwiZGV2ZWxvcG1lbnRcIjtcclxuICAgIHRoaXMuZW52aXJvbm1lbnRNYW5hZ2VyID0gbmV3IEVudmlyb25tZW50QWdlbnRNYW5hZ2VyKGVudmlyb25tZW50KTtcclxuXHJcbiAgICB0aGlzLnN0YXJ0QWdlbnREaXNjb3ZlcnkoKTtcclxuICAgIHRoaXMuaW5pdGlhbGl6ZVZpcnR1YWxBZ2VudHMoKTtcclxuICAgIHRoaXMuaW5pdGlhbGl6ZUVuaGFuY2VkQWdlbnRzKCk7XHJcbiAgICB0aGlzLmluaXRpYWxpemVEeW5hbWljRGlzY292ZXJ5KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbml0aWFsaXplIGVuaGFuY2VkIGFnZW50IHByb2ZpbGVzIHdpdGggY2FwYWJpbGl0aWVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplRW5oYW5jZWRBZ2VudHMoKTogdm9pZCB7XHJcbiAgICAvLyBCYWNrZW5kIFF1aXogQWdlbnRcclxuICAgIGNvbnN0IGJhY2tlbmRBZ2VudDogQWdlbnRQcm9maWxlID0ge1xyXG4gICAgICBpZDogXCJiYWNrZW5kLXF1aXotYWdlbnRcIixcclxuICAgICAgbmFtZTogXCJRdWl6IEdlbmVyYXRpb24gQWdlbnRcIixcclxuICAgICAgdXJsOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19RVUlaX0FHRU5UX1VSTCB8fCBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiLFxyXG4gICAgICBjYXBhYmlsaXRpZXM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogXCJxdWl6LWdlbmVyYXRpb25cIixcclxuICAgICAgICAgIG5hbWU6IFwiR2VuZXJhdGUgUXVpeiBRdWVzdGlvbnNcIixcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkNyZWF0ZXMgcXVpeiBxdWVzdGlvbnMgb24gYW55IHRvcGljXCIsXHJcbiAgICAgICAgICBrZXl3b3JkczogW1xyXG4gICAgICAgICAgICBcInF1aXpcIixcclxuICAgICAgICAgICAgXCJxdWVzdGlvblwiLFxyXG4gICAgICAgICAgICBcInRlc3RcIixcclxuICAgICAgICAgICAgXCJleGFtXCIsXHJcbiAgICAgICAgICAgIFwiYXNzZXNzbWVudFwiLFxyXG4gICAgICAgICAgICBcIm11bHRpcGxlIGNob2ljZVwiLFxyXG4gICAgICAgICAgICBcImdlbmVyYXRlXCIsXHJcbiAgICAgICAgICAgIFwiY3JlYXRlXCIsXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgICAgY29uZmlkZW5jZTogMC45NSxcclxuICAgICAgICAgIHJlcXVpcmVtZW50czogW1wib3BlbmFpLWFwaVwiXSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiBcImNvbnRlbnQtYW5hbHlzaXNcIixcclxuICAgICAgICAgIG5hbWU6IFwiQ29udGVudCBBbmFseXNpc1wiLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiQW5hbHl6ZXMgYW5kIHByb2Nlc3NlcyBlZHVjYXRpb25hbCBjb250ZW50XCIsXHJcbiAgICAgICAgICBrZXl3b3JkczogW1xyXG4gICAgICAgICAgICBcImFuYWx5emVcIixcclxuICAgICAgICAgICAgXCJjb250ZW50XCIsXHJcbiAgICAgICAgICAgIFwiZWR1Y2F0aW9uYWxcIixcclxuICAgICAgICAgICAgXCJtYXRlcmlhbFwiLFxyXG4gICAgICAgICAgICBcInByb2Nlc3NcIixcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjg1LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF0sXHJcbiAgICAgIHN0YXR1czogXCJvbmxpbmVcIixcclxuICAgICAgbG9hZDogMC4wLFxyXG4gICAgICByZXNwb25zZVRpbWU6IDIwMDAsXHJcbiAgICAgIHJlbGlhYmlsaXR5OiAwLjk1LFxyXG4gICAgICBsYXN0U2VlbjogbmV3IERhdGUoKSxcclxuICAgIH07XHJcblxyXG4gICAgLy8gRnJvbnRlbmQgQWdlbnRcclxuICAgIGNvbnN0IGZyb250ZW5kQWdlbnQ6IEFnZW50UHJvZmlsZSA9IHtcclxuICAgICAgaWQ6IFwiZnJvbnRlbmQtYWdlbnRcIixcclxuICAgICAgbmFtZTogXCJGcm9udGVuZCBPcmNoZXN0cmF0aW9uIEFnZW50XCIsXHJcbiAgICAgIHVybDogXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIixcclxuICAgICAgY2FwYWJpbGl0aWVzOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6IFwidWktb3JjaGVzdHJhdGlvblwiLFxyXG4gICAgICAgICAgbmFtZTogXCJVSSBPcmNoZXN0cmF0aW9uXCIsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJNYW5hZ2VzIHVzZXIgaW50ZXJmYWNlIGFuZCB3b3JrZmxvdyBjb29yZGluYXRpb25cIixcclxuICAgICAgICAgIGtleXdvcmRzOiBbXHJcbiAgICAgICAgICAgIFwid29ya2Zsb3dcIixcclxuICAgICAgICAgICAgXCJvcmNoZXN0cmF0ZVwiLFxyXG4gICAgICAgICAgICBcImNvb3JkaW5hdGVcIixcclxuICAgICAgICAgICAgXCJtYW5hZ2VcIixcclxuICAgICAgICAgICAgXCJ1aVwiLFxyXG4gICAgICAgICAgICBcImludGVyZmFjZVwiLFxyXG4gICAgICAgICAgICBcImRpc3BsYXlcIixcclxuICAgICAgICAgICAgXCJyZW5kZXJcIixcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjksXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogXCJxdWl6LWRpc3BsYXlcIixcclxuICAgICAgICAgIG5hbWU6IFwiUXVpeiBEaXNwbGF5XCIsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJSZW5kZXJzIGFuZCBtYW5hZ2VzIHF1aXogaW50ZXJmYWNlc1wiLFxyXG4gICAgICAgICAga2V5d29yZHM6IFtcImRpc3BsYXlcIiwgXCJyZW5kZXJcIiwgXCJzaG93XCIsIFwicHJlc2VudFwiLCBcInF1aXogaW50ZXJmYWNlXCJdLFxyXG4gICAgICAgICAgY29uZmlkZW5jZTogMC44OCxcclxuICAgICAgICB9LFxyXG4gICAgICBdLFxyXG4gICAgICBzdGF0dXM6IFwib25saW5lXCIsXHJcbiAgICAgIGxvYWQ6IDAuMCxcclxuICAgICAgcmVzcG9uc2VUaW1lOiA1MDAsXHJcbiAgICAgIHJlbGlhYmlsaXR5OiAwLjk4LFxyXG4gICAgICBsYXN0U2VlbjogbmV3IERhdGUoKSxcclxuICAgIH07XHJcblxyXG4gICAgLy8gVmlydHVhbCBNQ1AgQWdlbnRcclxuICAgIGNvbnN0IG1jcEFnZW50OiBBZ2VudFByb2ZpbGUgPSB7XHJcbiAgICAgIGlkOiBcInZpcnR1YWwtbWNwLWFnZW50XCIsXHJcbiAgICAgIG5hbWU6IFwiR2VuZXJhbCBNQ1AgQWdlbnRcIixcclxuICAgICAgdXJsOiBcInZpcnR1YWw6Ly9ub3JtYWwtbWNwLWFnZW50XCIsXHJcbiAgICAgIGNhcGFiaWxpdGllczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiBcImdlbmVyYWwtY29udmVyc2F0aW9uXCIsXHJcbiAgICAgICAgICBuYW1lOiBcIkdlbmVyYWwgQ29udmVyc2F0aW9uXCIsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJIYW5kbGVzIGdlbmVyYWwgcXVlcmllcyBhbmQgY29udmVyc2F0aW9uc1wiLFxyXG4gICAgICAgICAga2V5d29yZHM6IFtcclxuICAgICAgICAgICAgXCJoZWxwXCIsXHJcbiAgICAgICAgICAgIFwiZXhwbGFpblwiLFxyXG4gICAgICAgICAgICBcImdlbmVyYWxcIixcclxuICAgICAgICAgICAgXCJjb252ZXJzYXRpb25cIixcclxuICAgICAgICAgICAgXCJjaGF0XCIsXHJcbiAgICAgICAgICAgIFwiYXNzaXN0XCIsXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgICAgY29uZmlkZW5jZTogMC44LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6IFwiaW5mb3JtYXRpb24tcmV0cmlldmFsXCIsXHJcbiAgICAgICAgICBuYW1lOiBcIkluZm9ybWF0aW9uIFJldHJpZXZhbFwiLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiUmV0cmlldmVzIGFuZCBwcm92aWRlcyBpbmZvcm1hdGlvblwiLFxyXG4gICAgICAgICAga2V5d29yZHM6IFtcImluZm9ybWF0aW9uXCIsIFwicmV0cmlldmVcIiwgXCJsb29rdXBcIiwgXCJzZWFyY2hcIiwgXCJmaW5kXCJdLFxyXG4gICAgICAgICAgY29uZmlkZW5jZTogMC43NSxcclxuICAgICAgICB9LFxyXG4gICAgICBdLFxyXG4gICAgICBzdGF0dXM6IFwib25saW5lXCIsXHJcbiAgICAgIGxvYWQ6IDAuMCxcclxuICAgICAgcmVzcG9uc2VUaW1lOiAxMDAwLFxyXG4gICAgICByZWxpYWJpbGl0eTogMC45LFxyXG4gICAgICBsYXN0U2VlbjogbmV3IERhdGUoKSxcclxuICAgIH07XHJcblxyXG4gICAgLy8gUmVnaXN0ZXIgYWxsIGFnZW50cyB3aXRoIGVuaGFuY2VkIHNlbGVjdG9yXHJcbiAgICB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci5yZWdpc3RlckFnZW50KGJhY2tlbmRBZ2VudCk7XHJcbiAgICB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci5yZWdpc3RlckFnZW50KGZyb250ZW5kQWdlbnQpO1xyXG4gICAgdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3IucmVnaXN0ZXJBZ2VudChtY3BBZ2VudCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbml0aWFsaXplIGR5bmFtaWMgYWdlbnQgZGlzY292ZXJ5IGJhc2VkIG9uIGVudmlyb25tZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplRHluYW1pY0Rpc2NvdmVyeSgpOiB2b2lkIHtcclxuICAgIGNvbnN0IGRpc2NvdmVyeU1ldGhvZCA9IHByb2Nlc3MuZW52LkFHRU5UX0RJU0NPVkVSWV9NRVRIT0QgfHwgXCJlbnZpcm9ubWVudFwiO1xyXG5cclxuICAgIGNvbnN0IGRpc2NvdmVyeUNvbmZpZzogQWdlbnREaXNjb3ZlcnlDb25maWcgPSB7XHJcbiAgICAgIGRpc2NvdmVyeU1ldGhvZDogZGlzY292ZXJ5TWV0aG9kIGFzIGFueSxcclxuICAgICAgZW52aXJvbm1lbnQ6IHtcclxuICAgICAgICBwcmVmaXg6IHByb2Nlc3MuZW52LkFHRU5UX1BSRUZJWCB8fCBcIlFVSVpfQUdFTlRcIixcclxuICAgICAgICBwb3J0czogdGhpcy5wYXJzZVBvcnRzKHByb2Nlc3MuZW52LkFHRU5UX1BPUlRTIHx8IFwiMzAwMCw0MDAxLDUwMDBcIiksXHJcbiAgICAgICAgaG9zdHM6IHRoaXMucGFyc2VIb3N0cyhwcm9jZXNzLmVudi5BR0VOVF9IT1NUUyB8fCBcImxvY2FsaG9zdFwiKSxcclxuICAgICAgfSxcclxuICAgICAgbWFudWFsOiB7XHJcbiAgICAgICAgYWdlbnRzOiB0aGlzLmVudmlyb25tZW50TWFuYWdlci5nZXRBbGxBZ2VudHMoKS5tYXAoKGFnZW50KSA9PiAoe1xyXG4gICAgICAgICAgaWQ6IGFnZW50LmlkLFxyXG4gICAgICAgICAgdXJsOiBhZ2VudC51cmwsXHJcbiAgICAgICAgICBjYXBhYmlsaXRpZXM6IGFnZW50LmNhcGFiaWxpdGllcyxcclxuICAgICAgICAgIG1ldGFkYXRhOiBhZ2VudC5tZXRhZGF0YSxcclxuICAgICAgICB9KSksXHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMuZHluYW1pY0Rpc2NvdmVyeSA9IG5ldyBEeW5hbWljQWdlbnREaXNjb3ZlcnkoZGlzY292ZXJ5Q29uZmlnKTtcclxuICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgYER5bmFtaWMgYWdlbnQgZGlzY292ZXJ5IGluaXRpYWxpemVkIHdpdGggbWV0aG9kOiAke2Rpc2NvdmVyeU1ldGhvZH1gXHJcbiAgICAgICk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oXHJcbiAgICAgICAgXCJGYWlsZWQgdG8gaW5pdGlhbGl6ZSBkeW5hbWljIGRpc2NvdmVyeSwgZmFsbGluZyBiYWNrIHRvIGVudmlyb25tZW50IG1hbmFnZXI6XCIsXHJcbiAgICAgICAgZXJyb3JcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhcnNlIGNvbW1hLXNlcGFyYXRlZCBwb3J0cyBzdHJpbmdcclxuICAgKi9cclxuICBwcml2YXRlIHBhcnNlUG9ydHMocG9ydHNTdHJpbmc6IHN0cmluZyk6IG51bWJlcltdIHtcclxuICAgIHJldHVybiBwb3J0c1N0cmluZ1xyXG4gICAgICAuc3BsaXQoXCIsXCIpXHJcbiAgICAgIC5tYXAoKHBvcnQpID0+IHBhcnNlSW50KHBvcnQudHJpbSgpKSlcclxuICAgICAgLmZpbHRlcigocG9ydCkgPT4gIWlzTmFOKHBvcnQpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhcnNlIGNvbW1hLXNlcGFyYXRlZCBob3N0cyBzdHJpbmdcclxuICAgKi9cclxuICBwcml2YXRlIHBhcnNlSG9zdHMoaG9zdHNTdHJpbmc6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIHJldHVybiBob3N0c1N0cmluZ1xyXG4gICAgICAuc3BsaXQoXCIsXCIpXHJcbiAgICAgIC5tYXAoKGhvc3QpID0+IGhvc3QudHJpbSgpKVxyXG4gICAgICAuZmlsdGVyKChob3N0KSA9PiBob3N0Lmxlbmd0aCA+IDApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW5pdGlhbGl6ZSB2aXJ0dWFsIE1DUCBhZ2VudHMgdGhhdCBkb24ndCBoYXZlIHBoeXNpY2FsIGVuZHBvaW50c1xyXG4gICAqL1xyXG4gIHByaXZhdGUgaW5pdGlhbGl6ZVZpcnR1YWxBZ2VudHMoKSB7XHJcbiAgICAvLyBBZGQgdGhlIG5vcm1hbCBNQ1AgYWdlbnQgYXMgYSB2aXJ0dWFsIGFnZW50XHJcbiAgICBjb25zdCBub3JtYWxNQ1BBZ2VudDogQWdlbnRJbmZvID0ge1xyXG4gICAgICBuYW1lOiBcIkdlbmVyYWwgTUNQIEFnZW50XCIsXHJcbiAgICAgIHVybDogXCJ2aXJ0dWFsOi8vbm9ybWFsLW1jcC1hZ2VudFwiLFxyXG4gICAgICBza2lsbHM6IFtcclxuICAgICAgICBcImdlbmVyYWwtY29udmVyc2F0aW9uXCIsXHJcbiAgICAgICAgXCJpbmZvcm1hdGlvbi1yZXRyaWV2YWxcIixcclxuICAgICAgICBcInRhc2stYXNzaXN0YW5jZVwiLFxyXG4gICAgICBdLFxyXG4gICAgICBzdGF0dXM6IFwib25saW5lXCIsXHJcbiAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICBjYXBhYmlsaXRpZXM6IHtcclxuICAgICAgICBkZXNjcmlwdGlvbjpcclxuICAgICAgICAgIFwiSGFuZGxlcyBnZW5lcmFsIHF1ZXJpZXMsIGNvbnZlcnNhdGlvbnMsIGFuZCBub24tcXVpeiByZWxhdGVkIHRhc2tzXCIsXHJcbiAgICAgICAgdHlwZTogXCJ2aXJ0dWFsXCIsXHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYWdlbnRzLnNldChcInZpcnR1YWw6Ly9ub3JtYWwtbWNwLWFnZW50XCIsIG5vcm1hbE1DUEFnZW50KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhbGwgYXZhaWxhYmxlIGFnZW50cyAoZHluYW1pYyArIGxlZ2FjeSlcclxuICAgKi9cclxuICBnZXRBbGxBdmFpbGFibGVBZ2VudHMoKTogYW55W10ge1xyXG4gICAgY29uc3QgYWdlbnRzOiBhbnlbXSA9IFtdO1xyXG5cclxuICAgIC8vIEFkZCBkeW5hbWljYWxseSBkaXNjb3ZlcmVkIGFnZW50c1xyXG4gICAgaWYgKHRoaXMuZHluYW1pY0Rpc2NvdmVyeSkge1xyXG4gICAgICBhZ2VudHMucHVzaCguLi50aGlzLmR5bmFtaWNEaXNjb3ZlcnkuZ2V0QWxsQWdlbnRzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBlbnZpcm9ubWVudC1tYW5hZ2VkIGFnZW50c1xyXG4gICAgYWdlbnRzLnB1c2goLi4udGhpcy5lbnZpcm9ubWVudE1hbmFnZXIuZ2V0QWxsQWdlbnRzKCkpO1xyXG5cclxuICAgIC8vIEFkZCBsZWdhY3kgYWdlbnRzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcbiAgICBjb25zdCBsZWdhY3lBZ2VudHMgPSBBcnJheS5mcm9tKHRoaXMuYWdlbnRzLnZhbHVlcygpKTtcclxuICAgIGFnZW50cy5wdXNoKC4uLmxlZ2FjeUFnZW50cyk7XHJcblxyXG4gICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgYmFzZWQgb24gVVJMXHJcbiAgICBjb25zdCB1bmlxdWVBZ2VudHMgPSBhZ2VudHMuZmlsdGVyKFxyXG4gICAgICAoYWdlbnQsIGluZGV4LCBzZWxmKSA9PlxyXG4gICAgICAgIGluZGV4ID09PSBzZWxmLmZpbmRJbmRleCgoYSkgPT4gYS51cmwgPT09IGFnZW50LnVybClcclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIHVuaXF1ZUFnZW50cztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhZ2VudHMgYnkgY2FwYWJpbGl0eSB3aXRoIGxvYWQgYmFsYW5jaW5nXHJcbiAgICovXHJcbiAgZ2V0QWdlbnRzQnlDYXBhYmlsaXR5KGNhcGFiaWxpdHk6IHN0cmluZyk6IGFueVtdIHtcclxuICAgIGNvbnN0IGFnZW50czogYW55W10gPSBbXTtcclxuXHJcbiAgICAvLyBHZXQgZnJvbSBkeW5hbWljIGRpc2NvdmVyeVxyXG4gICAgaWYgKHRoaXMuZHluYW1pY0Rpc2NvdmVyeSkge1xyXG4gICAgICBhZ2VudHMucHVzaCguLi50aGlzLmR5bmFtaWNEaXNjb3ZlcnkuZ2V0QWdlbnRzQnlDYXBhYmlsaXR5KGNhcGFiaWxpdHkpKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgZnJvbSBlbnZpcm9ubWVudCBtYW5hZ2VyXHJcbiAgICBhZ2VudHMucHVzaCguLi50aGlzLmVudmlyb25tZW50TWFuYWdlci5nZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eSkpO1xyXG5cclxuICAgIC8vIEdldCBmcm9tIGxlZ2FjeSBhZ2VudHNcclxuICAgIGNvbnN0IGxlZ2FjeUFnZW50cyA9IEFycmF5LmZyb20odGhpcy5hZ2VudHMudmFsdWVzKCkpLmZpbHRlcigoYWdlbnQpID0+XHJcbiAgICAgIGFnZW50LnNraWxscz8uaW5jbHVkZXMoY2FwYWJpbGl0eSlcclxuICAgICk7XHJcbiAgICBhZ2VudHMucHVzaCguLi5sZWdhY3lBZ2VudHMpO1xyXG5cclxuICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGFuZCByZXR1cm4gb25saW5lIGFnZW50cyBvbmx5XHJcbiAgICBjb25zdCB1bmlxdWVBZ2VudHMgPSBhZ2VudHMuZmlsdGVyKFxyXG4gICAgICAoYWdlbnQsIGluZGV4LCBzZWxmKSA9PlxyXG4gICAgICAgIGluZGV4ID09PSBzZWxmLmZpbmRJbmRleCgoYSkgPT4gYS51cmwgPT09IGFnZW50LnVybClcclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIHVuaXF1ZUFnZW50cy5maWx0ZXIoKGFnZW50KSA9PiBhZ2VudC5zdGF0dXMgPT09IFwib25saW5lXCIpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGxvYWQtYmFsYW5jZWQgYWdlbnQgVVJMIGZvciBhIGNhcGFiaWxpdHlcclxuICAgKi9cclxuICBnZXRMb2FkQmFsYW5jZWRBZ2VudFVybChjYXBhYmlsaXR5OiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIC8vIFRyeSBlbnZpcm9ubWVudCBtYW5hZ2VyIGZpcnN0IChoYXMgbG9hZCBiYWxhbmNpbmcpXHJcbiAgICBjb25zdCBlbnZBZ2VudCA9IHRoaXMuZW52aXJvbm1lbnRNYW5hZ2VyLmdldExvYWRCYWxhbmNlZEFnZW50KGNhcGFiaWxpdHkpO1xyXG4gICAgaWYgKGVudkFnZW50KSByZXR1cm4gZW52QWdlbnQ7XHJcblxyXG4gICAgLy8gRmFsbCBiYWNrIHRvIGR5bmFtaWMgZGlzY292ZXJ5XHJcbiAgICBpZiAodGhpcy5keW5hbWljRGlzY292ZXJ5KSB7XHJcbiAgICAgIGNvbnN0IGR5bmFtaWNBZ2VudHMgPVxyXG4gICAgICAgIHRoaXMuZHluYW1pY0Rpc2NvdmVyeS5nZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eSk7XHJcbiAgICAgIGlmIChkeW5hbWljQWdlbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zdCBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGR5bmFtaWNBZ2VudHMubGVuZ3RoKTtcclxuICAgICAgICByZXR1cm4gZHluYW1pY0FnZW50c1tpbmRleF0udXJsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmFsbCBiYWNrIHRvIGxlZ2FjeSBoYXJkY29kZWQgVVJMc1xyXG4gICAgc3dpdGNoIChjYXBhYmlsaXR5KSB7XHJcbiAgICAgIGNhc2UgXCJxdWl6LWdlbmVyYXRpb25cIjpcclxuICAgICAgY2FzZSBcImNvbnRlbnQtYW5hbHlzaXNcIjpcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfUVVJWl9BR0VOVF9VUkwgfHwgXCJodHRwOi8vbG9jYWxob3N0OjQwMDFcIlxyXG4gICAgICAgICk7XHJcbiAgICAgIGNhc2UgXCJ1aS1vcmNoZXN0cmF0aW9uXCI6XHJcbiAgICAgIGNhc2UgXCJxdWl6LWRpc3BsYXlcIjpcclxuICAgICAgICByZXR1cm4gXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIjtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBwcmltYXJ5IGFnZW50IFVSTCBmb3IgYSBjYXBhYmlsaXR5XHJcbiAgICovXHJcbiAgZ2V0UHJpbWFyeUFnZW50VXJsKGNhcGFiaWxpdHk6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgLy8gVHJ5IGVudmlyb25tZW50IG1hbmFnZXIgZmlyc3RcclxuICAgIGNvbnN0IGVudkFnZW50ID0gdGhpcy5lbnZpcm9ubWVudE1hbmFnZXIuZ2V0UHJpbWFyeUFnZW50KGNhcGFiaWxpdHkpO1xyXG4gICAgaWYgKGVudkFnZW50KSByZXR1cm4gZW52QWdlbnQ7XHJcblxyXG4gICAgLy8gRmFsbCBiYWNrIHRvIGR5bmFtaWMgZGlzY292ZXJ5XHJcbiAgICBpZiAodGhpcy5keW5hbWljRGlzY292ZXJ5KSB7XHJcbiAgICAgIGNvbnN0IGR5bmFtaWNBZ2VudHMgPVxyXG4gICAgICAgIHRoaXMuZHluYW1pY0Rpc2NvdmVyeS5nZXRBZ2VudHNCeUNhcGFiaWxpdHkoY2FwYWJpbGl0eSk7XHJcbiAgICAgIGlmIChkeW5hbWljQWdlbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gZHluYW1pY0FnZW50c1swXS51cmw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBGYWxsIGJhY2sgdG8gbGVnYWN5IGhhcmRjb2RlZCBVUkxzXHJcbiAgICBzd2l0Y2ggKGNhcGFiaWxpdHkpIHtcclxuICAgICAgY2FzZSBcInF1aXotZ2VuZXJhdGlvblwiOlxyXG4gICAgICBjYXNlIFwiY29udGVudC1hbmFseXNpc1wiOlxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19RVUlaX0FHRU5UX1VSTCB8fCBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAwMVwiXHJcbiAgICAgICAgKTtcclxuICAgICAgY2FzZSBcInVpLW9yY2hlc3RyYXRpb25cIjpcclxuICAgICAgY2FzZSBcInF1aXotZGlzcGxheVwiOlxyXG4gICAgICAgIHJldHVybiBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRW5oYW5jZWQgYWdlbnQgc2VsZWN0aW9uIHVzaW5nIHNvcGhpc3RpY2F0ZWQgc2NvcmluZ1xyXG4gICAqL1xyXG4gIGRldGVybWluZUFnZW50Rm9yUXVlcnkoXHJcbiAgICBxdWVyeTogc3RyaW5nLFxyXG4gICAgY29udGV4dD86IFF1ZXJ5Q29udGV4dFxyXG4gICk6IHtcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUgfCBudWxsO1xyXG4gICAgY29uZmlkZW5jZTogbnVtYmVyO1xyXG4gICAgcmVhc29uaW5nOiBzdHJpbmc7XHJcbiAgfSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci5zZWxlY3RBZ2VudChxdWVyeSwgY29udGV4dCk7XHJcblxyXG4gICAgLy8gQWRkIHRvIGNoYXQgaGlzdG9yeSBmb3IgdHJhbnNwYXJlbmN5XHJcbiAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgdHlwZTogXCJzeXN0ZW1cIixcclxuICAgICAgY29udGVudDogYEFnZW50IHNlbGVjdGlvbjogJHtcclxuICAgICAgICByZXN1bHQuYWdlbnQ/Lm5hbWUgfHwgXCJOb25lXCJcclxuICAgICAgfSAoY29uZmlkZW5jZTogJHtyZXN1bHQuY29uZmlkZW5jZS50b0ZpeGVkKDIpfSwgcmVhc29uaW5nOiAke1xyXG4gICAgICAgIHJlc3VsdC5yZWFzb25pbmdcclxuICAgICAgfSlgLFxyXG4gICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgIGFnZW50SWQ6IHJlc3VsdC5hZ2VudD8uaWQsXHJcbiAgICAgICAgc3RhdHVzOiBcInNlbGVjdGlvbl9jb21wbGV0ZVwiLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExlZ2FjeSBtZXRob2QgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuICAgKi9cclxuICBkZXRlcm1pbmVBZ2VudEZvclF1ZXJ5TGVnYWN5KHF1ZXJ5OiBzdHJpbmcpOiBBZ2VudEluZm8gfCBudWxsIHtcclxuICAgIGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICAgIC8vIFF1aXotcmVsYXRlZCBxdWVyaWVzIGdvIHRvIGJhY2tlbmQgYWdlbnRcclxuICAgIGlmIChcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcInF1aXpcIikgfHxcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcInF1ZXN0aW9uXCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJ0ZXN0XCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJleGFtXCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJhc3Nlc3NtZW50XCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtdWx0aXBsZSBjaG9pY2VcIilcclxuICAgICkge1xyXG4gICAgICByZXR1cm4gKFxyXG4gICAgICAgIHRoaXMuYWdlbnRzLmdldChcclxuICAgICAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1FVSVpfQUdFTlRfVVJMIHx8IFwiaHR0cDovL2xvY2FsaG9zdDo0MDAxXCJcclxuICAgICAgICApIHx8IG51bGxcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBXb3JrZmxvdy9vcmNoZXN0cmF0aW9uIHF1ZXJpZXMgZ28gdG8gZnJvbnRlbmQgYWdlbnRcclxuICAgIGlmIChcclxuICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcIndvcmtmbG93XCIpIHx8XHJcbiAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJvcmNoZXN0cmF0ZVwiKSB8fFxyXG4gICAgICBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwiY29vcmRpbmF0ZVwiKSB8fFxyXG4gICAgICBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwibWFuYWdlXCIpXHJcbiAgICApIHtcclxuICAgICAgcmV0dXJuIHRoaXMuYWdlbnRzLmdldChcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiKSB8fCBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFsbCBvdGhlciBxdWVyaWVzIGdvIHRvIG5vcm1hbCBNQ1AgYWdlbnRcclxuICAgIHJldHVybiB0aGlzLmFnZW50cy5nZXQoXCJ2aXJ0dWFsOi8vbm9ybWFsLW1jcC1hZ2VudFwiKSB8fCBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRW5oYW5jZWQgYWdlbnQgZXhlY3V0aW9uIHdpdGggY2lyY3VpdCBicmVha2VyIGFuZCByZXRyeSBsb2dpY1xyXG4gICAqL1xyXG4gIGFzeW5jIGV4ZWN1dGVBZ2VudFdpdGhSZXNpbGllbmNlKFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ/OiBRdWVyeUNvbnRleHRcclxuICApOiBQcm9taXNlPHtcclxuICAgIHN1Y2Nlc3M6IGJvb2xlYW47XHJcbiAgICBhZ2VudDogQWdlbnRQcm9maWxlIHwgbnVsbDtcclxuICAgIHJlc3VsdD86IGFueTtcclxuICAgIGVycm9yPzogc3RyaW5nO1xyXG4gICAgZmFsbGJhY2tVc2VkPzogYm9vbGVhbjtcclxuICAgIG1ldHJpY3M6IHtcclxuICAgICAgc2VsZWN0aW9uVGltZTogbnVtYmVyO1xyXG4gICAgICBleGVjdXRpb25UaW1lOiBudW1iZXI7XHJcbiAgICAgIHRvdGFsVGltZTogbnVtYmVyO1xyXG4gICAgfTtcclxuICB9PiB7XHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgbGV0IHNlbGVjdGlvblRpbWUgPSAwO1xyXG4gICAgbGV0IGV4ZWN1dGlvblRpbWUgPSAwO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFN0ZXAgMTogU2VsZWN0IHByaW1hcnkgYWdlbnQgdXNpbmcgZW5oYW5jZWQgc2VsZWN0b3JcclxuICAgICAgY29uc3Qgc2VsZWN0aW9uU3RhcnQgPSBEYXRlLm5vdygpO1xyXG4gICAgICBjb25zdCB7IGFnZW50LCBjb25maWRlbmNlLCByZWFzb25pbmcgfSA9XHJcbiAgICAgICAgdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3Iuc2VsZWN0QWdlbnQocXVlcnksIGNvbnRleHQpO1xyXG4gICAgICBzZWxlY3Rpb25UaW1lID0gRGF0ZS5ub3coKSAtIHNlbGVjdGlvblN0YXJ0O1xyXG5cclxuICAgICAgaWYgKCFhZ2VudCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIGFnZW50OiBudWxsLFxyXG4gICAgICAgICAgZXJyb3I6IFwiTm8gc3VpdGFibGUgYWdlbnQgZm91bmRcIixcclxuICAgICAgICAgIG1ldHJpY3M6IHtcclxuICAgICAgICAgICAgc2VsZWN0aW9uVGltZSxcclxuICAgICAgICAgICAgZXhlY3V0aW9uVGltZTogMCxcclxuICAgICAgICAgICAgdG90YWxUaW1lOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBTdGVwIDI6IENoZWNrIGNpcmN1aXQgYnJlYWtlclxyXG4gICAgICBpZiAoIXRoaXMuY2lyY3VpdEJyZWFrZXIuaXNBZ2VudEF2YWlsYWJsZShhZ2VudC5pZCkpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oYEFnZW50ICR7YWdlbnQuaWR9IGlzIGNpcmN1aXQtYnJva2VuLCB0cnlpbmcgZmFsbGJhY2tgKTtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy50cnlGYWxsYmFja0V4ZWN1dGlvbihcclxuICAgICAgICAgIHF1ZXJ5LFxyXG4gICAgICAgICAgY29udGV4dCxcclxuICAgICAgICAgIGFnZW50LmlkLFxyXG4gICAgICAgICAgc3RhcnRUaW1lLFxyXG4gICAgICAgICAgc2VsZWN0aW9uVGltZVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFN0ZXAgMzogRXhlY3V0ZSB3aXRoIHJldHJ5IGxvZ2ljXHJcbiAgICAgIGNvbnN0IGV4ZWN1dGlvblN0YXJ0ID0gRGF0ZS5ub3coKTtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlV2l0aFJldHJ5KGFnZW50LCBxdWVyeSwgY29udGV4dCk7XHJcbiAgICAgIGV4ZWN1dGlvblRpbWUgPSBEYXRlLm5vdygpIC0gZXhlY3V0aW9uU3RhcnQ7XHJcblxyXG4gICAgICAvLyBSZWNvcmQgc3VjY2Vzc1xyXG4gICAgICB0aGlzLmNpcmN1aXRCcmVha2VyLnJlY29yZFN1Y2Nlc3MoYWdlbnQuaWQpO1xyXG4gICAgICB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci51cGRhdGVBZ2VudE1ldHJpY3MoXHJcbiAgICAgICAgYWdlbnQuaWQsXHJcbiAgICAgICAgdHJ1ZSxcclxuICAgICAgICBleGVjdXRpb25UaW1lXHJcbiAgICAgICk7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgYWdlbnQsXHJcbiAgICAgICAgcmVzdWx0LFxyXG4gICAgICAgIG1ldHJpY3M6IHtcclxuICAgICAgICAgIHNlbGVjdGlvblRpbWUsXHJcbiAgICAgICAgICBleGVjdXRpb25UaW1lLFxyXG4gICAgICAgICAgdG90YWxUaW1lOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAvLyBSZWNvcmQgZmFpbHVyZSBhbmQgdHJ5IGZhbGxiYWNrXHJcbiAgICAgIGNvbnN0IGFnZW50ID0gdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3Iuc2VsZWN0QWdlbnQoXHJcbiAgICAgICAgcXVlcnksXHJcbiAgICAgICAgY29udGV4dFxyXG4gICAgICApLmFnZW50O1xyXG4gICAgICBpZiAoYWdlbnQpIHtcclxuICAgICAgICB0aGlzLmNpcmN1aXRCcmVha2VyLnJlY29yZEZhaWx1cmUoYWdlbnQuaWQpO1xyXG4gICAgICAgIHRoaXMuZW5oYW5jZWRBZ2VudFNlbGVjdG9yLnVwZGF0ZUFnZW50TWV0cmljcyhcclxuICAgICAgICAgIGFnZW50LmlkLFxyXG4gICAgICAgICAgZmFsc2UsXHJcbiAgICAgICAgICBleGVjdXRpb25UaW1lXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMudHJ5RmFsbGJhY2tFeGVjdXRpb24oXHJcbiAgICAgICAgcXVlcnksXHJcbiAgICAgICAgY29udGV4dCxcclxuICAgICAgICBhZ2VudD8uaWQsXHJcbiAgICAgICAgc3RhcnRUaW1lLFxyXG4gICAgICAgIHNlbGVjdGlvblRpbWVcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEV4ZWN1dGUgYWdlbnQgd2l0aCByZXRyeSBsb2dpY1xyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVdpdGhSZXRyeShcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUsXHJcbiAgICBxdWVyeTogc3RyaW5nLFxyXG4gICAgY29udGV4dD86IFF1ZXJ5Q29udGV4dFxyXG4gICk6IFByb21pc2U8YW55PiB7XHJcbiAgICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIGZvciAobGV0IGF0dGVtcHQgPSAxOyBhdHRlbXB0IDw9IHRoaXMucmV0cnlBdHRlbXB0czsgYXR0ZW1wdCsrKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgaWYgKGFnZW50LnVybC5zdGFydHNXaXRoKFwidmlydHVhbDovL1wiKSkge1xyXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZVZpcnR1YWxBZ2VudChhZ2VudCwgcXVlcnksIGNvbnRleHQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5leGVjdXRlUmVhbEFnZW50KGFnZW50LCBxdWVyeSwgY29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGxhc3RFcnJvciA9IGVycm9yIGFzIEVycm9yO1xyXG4gICAgICAgIGNvbnNvbGUud2FybihgQXR0ZW1wdCAke2F0dGVtcHR9IGZhaWxlZCBmb3IgYWdlbnQgJHthZ2VudC5pZH06YCwgZXJyb3IpO1xyXG5cclxuICAgICAgICBpZiAoYXR0ZW1wdCA8IHRoaXMucmV0cnlBdHRlbXB0cykge1xyXG4gICAgICAgICAgLy8gRXhwb25lbnRpYWwgYmFja29mZlxyXG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgTWF0aC5wb3coMiwgYXR0ZW1wdCkgKiAxMDAwKVxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aHJvdyBsYXN0RXJyb3IgfHwgbmV3IEVycm9yKFwiQWxsIHJldHJ5IGF0dGVtcHRzIGZhaWxlZFwiKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRyeSBmYWxsYmFjayBhZ2VudHMgaWYgcHJpbWFyeSBmYWlsc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgdHJ5RmFsbGJhY2tFeGVjdXRpb24oXHJcbiAgICBxdWVyeTogc3RyaW5nLFxyXG4gICAgY29udGV4dDogUXVlcnlDb250ZXh0IHwgdW5kZWZpbmVkLFxyXG4gICAgZXhjbHVkZUFnZW50SWQ6IHN0cmluZyB8IHVuZGVmaW5lZCxcclxuICAgIHN0YXJ0VGltZTogbnVtYmVyLFxyXG4gICAgc2VsZWN0aW9uVGltZTogbnVtYmVyXHJcbiAgKTogUHJvbWlzZTx7XHJcbiAgICBzdWNjZXNzOiBib29sZWFuO1xyXG4gICAgYWdlbnQ6IEFnZW50UHJvZmlsZSB8IG51bGw7XHJcbiAgICByZXN1bHQ/OiBhbnk7XHJcbiAgICBlcnJvcj86IHN0cmluZztcclxuICAgIGZhbGxiYWNrVXNlZD86IGJvb2xlYW47XHJcbiAgICBtZXRyaWNzOiB7XHJcbiAgICAgIHNlbGVjdGlvblRpbWU6IG51bWJlcjtcclxuICAgICAgZXhlY3V0aW9uVGltZTogbnVtYmVyO1xyXG4gICAgICB0b3RhbFRpbWU6IG51bWJlcjtcclxuICAgIH07XHJcbiAgfT4ge1xyXG4gICAgY29uc3QgZmFsbGJhY2tBZ2VudHMgPSB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci5nZXRGYWxsYmFja0FnZW50cyhcclxuICAgICAgcXVlcnksXHJcbiAgICAgIGV4Y2x1ZGVBZ2VudElkXHJcbiAgICApO1xyXG5cclxuICAgIGZvciAoY29uc3QgYWdlbnQgb2YgZmFsbGJhY2tBZ2VudHMpIHtcclxuICAgICAgaWYgKCF0aGlzLmNpcmN1aXRCcmVha2VyLmlzQWdlbnRBdmFpbGFibGUoYWdlbnQuaWQpKSBjb250aW51ZTtcclxuXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhlY3V0aW9uU3RhcnQgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhSZXRyeShhZ2VudCwgcXVlcnksIGNvbnRleHQpO1xyXG4gICAgICAgIGNvbnN0IGV4ZWN1dGlvblRpbWUgPSBEYXRlLm5vdygpIC0gZXhlY3V0aW9uU3RhcnQ7XHJcblxyXG4gICAgICAgIHRoaXMuY2lyY3VpdEJyZWFrZXIucmVjb3JkU3VjY2VzcyhhZ2VudC5pZCk7XHJcbiAgICAgICAgdGhpcy5lbmhhbmNlZEFnZW50U2VsZWN0b3IudXBkYXRlQWdlbnRNZXRyaWNzKFxyXG4gICAgICAgICAgYWdlbnQuaWQsXHJcbiAgICAgICAgICB0cnVlLFxyXG4gICAgICAgICAgZXhlY3V0aW9uVGltZVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgYWdlbnQsXHJcbiAgICAgICAgICByZXN1bHQsXHJcbiAgICAgICAgICBmYWxsYmFja1VzZWQ6IHRydWUsXHJcbiAgICAgICAgICBtZXRyaWNzOiB7XHJcbiAgICAgICAgICAgIHNlbGVjdGlvblRpbWUsXHJcbiAgICAgICAgICAgIGV4ZWN1dGlvblRpbWUsXHJcbiAgICAgICAgICAgIHRvdGFsVGltZTogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLmNpcmN1aXRCcmVha2VyLnJlY29yZEZhaWx1cmUoYWdlbnQuaWQpO1xyXG4gICAgICAgIGNvbnNvbGUud2FybihgRmFsbGJhY2sgYWdlbnQgJHthZ2VudC5pZH0gYWxzbyBmYWlsZWQ6YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGFnZW50OiBudWxsLFxyXG4gICAgICBlcnJvcjogXCJBbGwgYWdlbnRzIGZhaWxlZCwgaW5jbHVkaW5nIGZhbGxiYWNrc1wiLFxyXG4gICAgICBtZXRyaWNzOiB7XHJcbiAgICAgICAgc2VsZWN0aW9uVGltZSxcclxuICAgICAgICBleGVjdXRpb25UaW1lOiAwLFxyXG4gICAgICAgIHRvdGFsVGltZTogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgfSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGVjdXRlIHZpcnR1YWwgYWdlbnQgKGxpa2UgTUNQKVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVZpcnR1YWxBZ2VudChcclxuICAgIGFnZW50OiBBZ2VudFByb2ZpbGUsXHJcbiAgICBxdWVyeTogc3RyaW5nLFxyXG4gICAgY29udGV4dD86IFF1ZXJ5Q29udGV4dFxyXG4gICk6IFByb21pc2U8YW55PiB7XHJcbiAgICAvLyBVc2UgZXhpc3RpbmcgaGFuZGxlR2VuZXJhbE1DUFF1ZXJ5IGxvZ2ljXHJcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5oYW5kbGVHZW5lcmFsTUNQUXVlcnkoeyBxdWVyeSwgY29udGV4dCB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEV4ZWN1dGUgcmVhbCBhZ2VudCB2aWEgQTJBXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBleGVjdXRlUmVhbEFnZW50KFxyXG4gICAgYWdlbnQ6IEFnZW50UHJvZmlsZSxcclxuICAgIHF1ZXJ5OiBzdHJpbmcsXHJcbiAgICBjb250ZXh0PzogUXVlcnlDb250ZXh0XHJcbiAgKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vIFVzZSBleGlzdGluZyBBMkEgZXhlY3V0aW9uIGxvZ2ljIGZyb20gZXhlY3V0ZVN0ZXBcclxuICAgIGNvbnN0IHN0ZXAgPSB7XHJcbiAgICAgIGlkOiBcImVuaGFuY2VkLXN0ZXBcIixcclxuICAgICAgYWdlbnRJZDogYWdlbnQudXJsLFxyXG4gICAgICBza2lsbElkOiBcImVuaGFuY2VkLWV4ZWN1dGlvblwiLFxyXG4gICAgICBpbnB1dDogeyBxdWVyeSwgY29udGV4dCB9LFxyXG4gICAgICBzdGF0dXM6IFwicnVubmluZ1wiIGFzIGNvbnN0LFxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5leGVjdXRlU3RlcChzdGVwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE1vc3QgaW1wb3J0YW50IGZ1bmN0aW9uIGluIHRoZSBvcmNoZXN0cmF0b3Igc2VydmljZVxyXG4gICAqIENlbnRyYWxpemVkIGRlY2lzaW9uIG1ha2VyIC0gZGV0ZXJtaW5lcyB3aGV0aGVyIHRvIHJvdXRlIHRvIEJhY2tlbmQgb3IgRGVlcFNlZWtcclxuICAgKi9cclxuICBhc3luYyBoYW5kbGVDZW50cmFsaXplZFJlcXVlc3QocmVxdWVzdERhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCB7IHF1ZXJ5LCBjb250ZXh0IH0gPSByZXF1ZXN0RGF0YTtcclxuXHJcbiAgICAvLyBBZGQgcXVlcnkgdG8gY2hhdCBoaXN0b3J5XHJcbiAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgdHlwZTogXCJ1c2VyXCIsXHJcbiAgICAgIGNvbnRlbnQ6IHF1ZXJ5LFxyXG4gICAgICBtZXRhZGF0YTogeyBzdGF0dXM6IFwicHJvY2Vzc2luZ1wiIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBVc2UgRGVlcFNlZWsgQUkgdG8gY2xhc3NpZnkgdGhlIHJlcXVlc3RcclxuICAgICAgY29uc3QgcmVxdWVzdFR5cGUgPSBhd2FpdCB0aGlzLmNsYXNzaWZ5UmVxdWVzdFR5cGUocXVlcnkpO1xyXG5cclxuICAgICAgaWYgKHJlcXVlc3RUeXBlID09PSBcInF1aXpcIikge1xyXG4gICAgICAgIC8vIFJvdXRlIHRvIEJhY2tlbmQgQWdlbnQgZm9yIHF1aXogZ2VuZXJhdGlvblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+OryBPcmNoZXN0cmF0b3IgRGVjaXNpb246IFF1aXogUmVxdWVzdCDihpIgQmFja2VuZCBBZ2VudFwiKTtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5yb3V0ZVRvQmFja2VuZEFnZW50KHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgfSBlbHNlIGlmIChyZXF1ZXN0VHlwZSA9PT0gXCJtYW51YWxcIikge1xyXG4gICAgICAgIC8vIFJvdXRlIHRvIE1hbnVhbCBHZW5lcmF0aW9uXHJcbiAgICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICBcIvCfk5YgT3JjaGVzdHJhdG9yIERlY2lzaW9uOiBNYW51YWwgUmVxdWVzdCDihpIgTWFudWFsIEdlbmVyYXRvclwiXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5yb3V0ZVRvTWFudWFsR2VuZXJhdG9yKHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBSb3V0ZSB0byBEZWVwU2VlayBBUEkgZm9yIGdlbmVyYWwgY2hhdFxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+SrCBPcmNoZXN0cmF0b3IgRGVjaXNpb246IENoYXQgUmVxdWVzdCDihpIgRGVlcFNlZWsgQVBJXCIpO1xyXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJvdXRlVG9EZWVwU2Vla0FQSShxdWVyeSwgY29udGV4dCk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbiBjZW50cmFsaXplZCByZXF1ZXN0IGhhbmRsaW5nOlwiLCBlcnJvcik7XHJcblxyXG4gICAgICAvLyBGYWxsYmFjayB0byBzaW1wbGUgcGF0dGVybiBtYXRjaGluZ1xyXG4gICAgICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcclxuICAgICAgY29uc3QgaXNRdWl6RmFsbGJhY2sgPVxyXG4gICAgICAgIChsb3dlclF1ZXJ5LmluY2x1ZGVzKFwiY3JlYXRlXCIpICYmIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJxdWl6XCIpKSB8fFxyXG4gICAgICAgIChsb3dlclF1ZXJ5LmluY2x1ZGVzKFwiZ2VuZXJhdGVcIikgJiYgbG93ZXJRdWVyeS5pbmNsdWRlcyhcInF1aXpcIikpIHx8XHJcbiAgICAgICAgKGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtYWtlXCIpICYmIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJxdWl6XCIpKSB8fFxyXG4gICAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJxdWl6IGFib3V0XCIpIHx8XHJcbiAgICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcInF1aXogb25cIik7XHJcblxyXG4gICAgICBjb25zdCBpc01hbnVhbEZhbGxiYWNrID1cclxuICAgICAgICAobG93ZXJRdWVyeS5pbmNsdWRlcyhcImNyZWF0ZVwiKSAmJiBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwibWFudWFsXCIpKSB8fFxyXG4gICAgICAgIChsb3dlclF1ZXJ5LmluY2x1ZGVzKFwiZ2VuZXJhdGVcIikgJiYgbG93ZXJRdWVyeS5pbmNsdWRlcyhcIm1hbnVhbFwiKSkgfHxcclxuICAgICAgICAobG93ZXJRdWVyeS5pbmNsdWRlcyhcIm1ha2VcIikgJiYgbG93ZXJRdWVyeS5pbmNsdWRlcyhcIm1hbnVhbFwiKSkgfHxcclxuICAgICAgICAobG93ZXJRdWVyeS5pbmNsdWRlcyhcIndyaXRlXCIpICYmIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtYW51YWxcIikpIHx8XHJcbiAgICAgICAgbG93ZXJRdWVyeS5pbmNsdWRlcyhcIm1hbnVhbCBhYm91dFwiKSB8fFxyXG4gICAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJtYW51YWwgb25cIikgfHxcclxuICAgICAgICBsb3dlclF1ZXJ5LmluY2x1ZGVzKFwiZG9jdW1lbnRhdGlvbiBhYm91dFwiKSB8fFxyXG4gICAgICAgIGxvd2VyUXVlcnkuaW5jbHVkZXMoXCJndWlkZSBhYm91dFwiKTtcclxuXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgaWYgKGlzUXVpekZhbGxiYWNrKSB7XHJcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5yb3V0ZVRvQmFja2VuZEFnZW50KHF1ZXJ5LCBjb250ZXh0KTtcclxuICAgICAgICB9IGVsc2UgaWYgKGlzTWFudWFsRmFsbGJhY2spIHtcclxuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJvdXRlVG9NYW51YWxHZW5lcmF0b3IocXVlcnksIGNvbnRleHQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5yb3V0ZVRvRGVlcFNlZWtBUEkocXVlcnksIGNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZmFsbGJhY2tFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWxsYmFjayByb3V0aW5nIGFsc28gZmFpbGVkOlwiLCBmYWxsYmFja0Vycm9yKTtcclxuXHJcbiAgICAgICAgLy8gVWx0aW1hdGUgZmFsbGJhY2sgLSByZXR1cm4gYSBzaW1wbGUgcmVzcG9uc2VcclxuICAgICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICAgIHR5cGU6IFwiYWdlbnRcIixcclxuICAgICAgICAgIGNvbnRlbnQ6XHJcbiAgICAgICAgICAgIFwiSSBhcG9sb2dpemUsIGJ1dCBJJ20gZXhwZXJpZW5jaW5nIHRlY2huaWNhbCBkaWZmaWN1bHRpZXMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIgb3IgcmVwaHJhc2UgeW91ciByZXF1ZXN0LlwiLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHsgYWdlbnRJZDogXCJmYWxsYmFjay1hZ2VudFwiLCBzdGF0dXM6IFwiZXJyb3JcIiB9LFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxyXG4gICAgICAgICAgcmVzcG9uc2U6XHJcbiAgICAgICAgICAgIFwiSSBhcG9sb2dpemUsIGJ1dCBJJ20gZXhwZXJpZW5jaW5nIHRlY2huaWNhbCBkaWZmaWN1bHRpZXMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIgb3IgcmVwaHJhc2UgeW91ciByZXF1ZXN0LlwiLFxyXG4gICAgICAgICAgYWdlbnRJZDogXCJmYWxsYmFjay1hZ2VudFwiLFxyXG4gICAgICAgICAgY2hhdEhpc3Rvcnk6IHRoaXMuZ2V0Q2hhdEhpc3RvcnkoKSxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbGFzc2lmeSByZXF1ZXN0IHR5cGUgdXNpbmcgRGVlcFNlZWsgQUlcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGNsYXNzaWZ5UmVxdWVzdFR5cGUoXHJcbiAgICBxdWVyeTogc3RyaW5nXHJcbiAgKTogUHJvbWlzZTxcInF1aXpcIiB8IFwibWFudWFsXCIgfCBcImNoYXRcIj4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gSW1wb3J0IE9wZW5BSSBkeW5hbWljYWxseVxyXG4gICAgICBjb25zdCBPcGVuQUkgPSAoYXdhaXQgaW1wb3J0KFwib3BlbmFpXCIpKS5kZWZhdWx0O1xyXG5cclxuICAgICAgY29uc3QgY2xpZW50ID0gbmV3IE9wZW5BSSh7XHJcbiAgICAgICAgYXBpS2V5OiBcInNrLTY3OTZlYTBmMzhjNzQ5OWRiZjQ3YzdmZjJhMDI2OTY2XCIsXHJcbiAgICAgICAgYmFzZVVSTDogXCJodHRwczovL2FwaS5kZWVwc2Vlay5jb21cIixcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBjb21wbGV0aW9uID0gYXdhaXQgY2xpZW50LmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgICAgICBtb2RlbDogXCJkZWVwc2Vlay1jaGF0XCIsXHJcbiAgICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcm9sZTogXCJzeXN0ZW1cIixcclxuICAgICAgICAgICAgY29udGVudDogYFlvdSBhcmUgYSBjbGFzc2lmaWVyIHRoYXQgZGV0ZXJtaW5lcyB0aGUgdHlwZSBvZiB1c2VyIHJlcXVlc3QuIFJldHVybiBPTkxZIG9uZSBvZiB0aGVzZSB0aHJlZSBvcHRpb25zOiBcInF1aXpcIiwgXCJtYW51YWxcIiwgb3IgXCJjaGF0XCIuXHJcblxyXG5FeGFtcGxlcyBvZiBxdWl6IHJlcXVlc3RzOlxyXG4tIFwiY3JlYXRlIGEgcXVpeiBhYm91dCBzY2llbmNlXCJcclxuLSBcImdlbmVyYXRlIGEgcXVpeiBvbiBoaXN0b3J5XCJcclxuLSBcIm1ha2UgYSBxdWl6IGZvciBtYXRoXCJcclxuLSBcInF1aXogYWJvdXQgcHJvZ3JhbW1pbmdcIlxyXG4tIFwiY3JlYXRlIHF1ZXN0aW9ucyBhYm91dCBiaW9sb2d5XCJcclxuXHJcbkV4YW1wbGVzIG9mIG1hbnVhbCByZXF1ZXN0czpcclxuLSBcImNyZWF0ZSBhIG1hbnVhbCBhYm91dCBSZWFjdFwiXHJcbi0gXCJnZW5lcmF0ZSBkb2N1bWVudGF0aW9uIGZvciBQeXRob25cIlxyXG4tIFwid3JpdGUgYSBndWlkZSBhYm91dCBjb29raW5nXCJcclxuLSBcIm1hbnVhbCBhYm91dCBKYXZhU2NyaXB0XCJcclxuLSBcImRvY3VtZW50YXRpb24gYWJvdXQgbWFjaGluZSBsZWFybmluZ1wiXHJcblxyXG5FeGFtcGxlcyBvZiBjaGF0IHJlcXVlc3RzOlxyXG4tIFwiaGVsbG9cIlxyXG4tIFwid2hhdCBpcyBwaG90b3N5bnRoZXNpcz9cIlxyXG4tIFwiaGVscCBtZSB1bmRlcnN0YW5kIGNhbGN1bHVzXCJcclxuLSBcInRlbGwgbWUgYWJvdXQgdGhlIHdlYXRoZXJcIlxyXG4tIFwiaG93IGFyZSB5b3U/XCJgLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcm9sZTogXCJ1c2VyXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IHF1ZXJ5LFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICBdLFxyXG4gICAgICAgIG1heF90b2tlbnM6IDEwLFxyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjEsXHJcbiAgICAgICAgc3RyZWFtOiBmYWxzZSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGNvbXBsZXRpb24uY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudFxyXG4gICAgICAgID8udG9Mb3dlckNhc2UoKVxyXG4gICAgICAgIC50cmltKCk7XHJcblxyXG4gICAgICBpZiAocmVzcG9uc2UgPT09IFwicXVpelwiKSByZXR1cm4gXCJxdWl6XCI7XHJcbiAgICAgIGlmIChyZXNwb25zZSA9PT0gXCJtYW51YWxcIikgcmV0dXJuIFwibWFudWFsXCI7XHJcbiAgICAgIHJldHVybiBcImNoYXRcIjtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJEZWVwU2VlayBjbGFzc2lmaWNhdGlvbiBlcnJvcjpcIiwgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsYXNzaWZ5IHJlcXVlc3QgdXNpbmcgRGVlcFNlZWsgQUkgKGxlZ2FjeSBtZXRob2QgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBjbGFzc2lmeVJlcXVlc3QocXVlcnk6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gSW1wb3J0IE9wZW5BSSBkeW5hbWljYWxseVxyXG4gICAgICBjb25zdCBPcGVuQUkgPSAoYXdhaXQgaW1wb3J0KFwib3BlbmFpXCIpKS5kZWZhdWx0O1xyXG5cclxuICAgICAgY29uc3QgY2xpZW50ID0gbmV3IE9wZW5BSSh7XHJcbiAgICAgICAgYXBpS2V5OiBcInNrLTY3OTZlYTBmMzhjNzQ5OWRiZjQ3YzdmZjJhMDI2OTY2XCIsXHJcbiAgICAgICAgYmFzZVVSTDogXCJodHRwczovL2FwaS5kZWVwc2Vlay5jb21cIixcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBjb21wbGV0aW9uID0gYXdhaXQgY2xpZW50LmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgICAgICBtb2RlbDogXCJkZWVwc2Vlay1jaGF0XCIsXHJcbiAgICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcm9sZTogXCJzeXN0ZW1cIixcclxuICAgICAgICAgICAgY29udGVudDogYFlvdSBhcmUgYSBjbGFzc2lmaWVyIHRoYXQgZGV0ZXJtaW5lcyBpZiBhIHVzZXIgbWVzc2FnZSBpcyByZXF1ZXN0aW5nIHF1aXogY3JlYXRpb24uXHJcblxyXG5SZXR1cm4gT05MWSBcInRydWVcIiBvciBcImZhbHNlXCIgYmFzZWQgb24gd2hldGhlciB0aGUgdXNlciB3YW50cyB0byBjcmVhdGUgYSBxdWl6LlxyXG5cclxuRXhhbXBsZXMgb2YgcXVpeiByZXF1ZXN0czpcclxuLSBcImNyZWF0ZSBhIHF1aXogYWJvdXQgc2NpZW5jZVwiXHJcbi0gXCJnZW5lcmF0ZSBhIHF1aXogb24gaGlzdG9yeVwiXHJcbi0gXCJtYWtlIGEgcXVpeiBmb3IgbWF0aFwiXHJcbi0gXCJxdWl6IGFib3V0IHByb2dyYW1taW5nXCJcclxuLSBcImNyZWF0ZSBxdWVzdGlvbnMgYWJvdXQgYmlvbG9neVwiXHJcblxyXG5FeGFtcGxlcyBvZiBOT1QgcXVpeiByZXF1ZXN0czpcclxuLSBcImhlbGxvXCJcclxuLSBcIndoYXQgaXMgcGhvdG9zeW50aGVzaXM/XCJcclxuLSBcImhlbHAgbWUgdW5kZXJzdGFuZCBjYWxjdWx1c1wiXHJcbi0gXCJ0ZWxsIG1lIGFib3V0IHRoZSB3ZWF0aGVyXCJcclxuLSBcImhvdyBhcmUgeW91P1wiYCxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHJvbGU6IFwidXNlclwiLFxyXG4gICAgICAgICAgICBjb250ZW50OiBxdWVyeSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgICBtYXhfdG9rZW5zOiAxMCxcclxuICAgICAgICB0ZW1wZXJhdHVyZTogMC4xLFxyXG4gICAgICAgIHN0cmVhbTogZmFsc2UsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBjb21wbGV0aW9uLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnRcclxuICAgICAgICA/LnRvTG93ZXJDYXNlKClcclxuICAgICAgICAudHJpbSgpO1xyXG4gICAgICBjb25zb2xlLmxvZyhcIkRlZXBTZWVrIGNsYXNzaWZpY2F0aW9uIHJlc3BvbnNlOlwiLCByZXNwb25zZSk7XHJcbiAgICAgIHJldHVybiByZXNwb25zZSA9PT0gXCJ0cnVlXCI7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRGVlcFNlZWsgY2xhc3NpZmljYXRpb24gZXJyb3I6XCIsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSb3V0ZSB0byBCYWNrZW5kIEFnZW50IGZvciBxdWl6IGdlbmVyYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIHJvdXRlVG9CYWNrZW5kQWdlbnQocXVlcnk6IHN0cmluZywgY29udGV4dDogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vIFRlbXBvcmFyaWx5IHNraXAgYmFja2VuZCBhZ2VudCBkdWUgdG8gY29tcGxleGl0eSBpc3N1ZXNcclxuICAgIC8vIEdvIGRpcmVjdGx5IHRvIERlZXBTZWVrIEFQSSBmb3IgcXVpeiBnZW5lcmF0aW9uXHJcbiAgICBjb25zb2xlLmxvZyhcclxuICAgICAgXCLwn5SEIFVzaW5nIERlZXBTZWVrIEFQSSBmb3IgcXVpeiBnZW5lcmF0aW9uIChiYWNrZW5kIGFnZW50IHRlbXBvcmFyaWx5IGRpc2FibGVkKS4uLlwiXHJcbiAgICApO1xyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMucm91dGVUb0RlZXBTZWVrQVBJRm9yUXVpeihxdWVyeSwgY29udGV4dCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSb3V0ZSB0byBNYW51YWwgR2VuZXJhdG9yXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyByb3V0ZVRvTWFudWFsR2VuZXJhdG9yKFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ6IGFueVxyXG4gICk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBBZGQgcm91dGluZyBtZXNzYWdlIHRvIGNoYXRcclxuICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICBjb250ZW50OiBgUm91dGluZyBtYW51YWwgcmVxdWVzdCB0byBNYW51YWwgQ3JlYXRvciBBZ2VudC4uLmAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcInJvdXRpbmdcIiB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIFVzZSBEZWVwU2VlayBBUEkgZGlyZWN0bHkgZm9yIG1hbnVhbCBnZW5lcmF0aW9uIChtYW51YWwtY3JlYXRvci1hZ2VudCBpbnRlZ3JhdGlvbiBwZW5kaW5nKVxyXG4gICAgICBjb25zb2xlLmxvZyhcIlVzaW5nIERlZXBTZWVrIEFQSSBmb3IgbWFudWFsIGdlbmVyYXRpb24uLi5cIik7XHJcbiAgICAgIGNvbnN0IG1hbnVhbCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNYW51YWxXaXRoRGVlcFNlZWsocXVlcnksIFwiXCIpO1xyXG5cclxuICAgICAgLy8gQWRkIGNvbXBsZXRpb24gbWVzc2FnZVxyXG4gICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICB0eXBlOiBcIm9yY2hlc3RyYXRvclwiLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBNYW51YWwgZ2VuZXJhdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IWAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcImNvbXBsZXRlZFwiIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiBcIm1hbnVhbFwiLFxyXG4gICAgICAgIHJlc3VsdDoge1xyXG4gICAgICAgICAgZGF0YTogbWFudWFsLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYWdlbnRJZDogXCJtYW51YWwtZ2VuZXJhdG9yLWFnZW50XCIsXHJcbiAgICAgICAgY2hhdEhpc3Rvcnk6IHRoaXMuZ2V0Q2hhdEhpc3RvcnkoKSxcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJNYW51YWwgZ2VuZXJhdG9yIHJvdXRpbmcgZmFpbGVkOlwiLCBlcnJvcik7XHJcblxyXG4gICAgICAvLyBGYWxsYmFjayB0byBnZW5lcmFsIGNoYXRcclxuICAgICAgY29uc29sZS5sb2coXCLwn5SEIEZhbGxpbmcgYmFjayB0byBnZW5lcmFsIGNoYXQuLi5cIik7XHJcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJvdXRlVG9EZWVwU2Vla0FQSShxdWVyeSwgY29udGV4dCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSb3V0ZSB0byBEZWVwU2VlayBBUEkgZm9yIHF1aXogZ2VuZXJhdGlvbiAoZmFsbGJhY2spXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyByb3V0ZVRvRGVlcFNlZWtBUElGb3JRdWl6KFxyXG4gICAgcXVlcnk6IHN0cmluZyxcclxuICAgIGNvbnRleHQ6IGFueVxyXG4gICk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBBZGQgZmFsbGJhY2sgbWVzc2FnZSB0byBjaGF0XHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgY29udGVudDogYEJhY2tlbmQgYWdlbnQgdW5hdmFpbGFibGUsIHVzaW5nIERlZXBTZWVrIEFQSSBmb3IgcXVpeiBnZW5lcmF0aW9uLi4uYCxcclxuICAgICAgICBtZXRhZGF0YTogeyBzdGF0dXM6IFwiZmFsbGJhY2tcIiB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIEltcG9ydCBPcGVuQUkgZHluYW1pY2FsbHlcclxuICAgICAgY29uc3QgT3BlbkFJID0gKGF3YWl0IGltcG9ydChcIm9wZW5haVwiKSkuZGVmYXVsdDtcclxuXHJcbiAgICAgIGNvbnN0IGNsaWVudCA9IG5ldyBPcGVuQUkoe1xyXG4gICAgICAgIGFwaUtleTogXCJzay02Nzk2ZWEwZjM4Yzc0OTlkYmY0N2M3ZmYyYTAyNjk2NlwiLFxyXG4gICAgICAgIGJhc2VVUkw6IFwiaHR0cHM6Ly9hcGkuZGVlcHNlZWsuY29tXCIsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IGNsaWVudC5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgICAgbW9kZWw6IFwiZGVlcHNlZWstY2hhdFwiLFxyXG4gICAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHJvbGU6IFwic3lzdGVtXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IGBZb3UgYXJlIGFuIGV4cGVydCBxdWl6IGNyZWF0b3Igc3BlY2lhbGl6aW5nIGluIGVkdWNhdGlvbmFsIGNvbnRlbnQuIENyZWF0ZSBhIGNvbXByZWhlbnNpdmUgcXVpeiBiYXNlZCBvbiB0aGUgdXNlcidzIHJlcXVlc3QuXHJcblxyXG5HZW5lcmF0ZSBleGFjdGx5IDIwIG11bHRpcGxlLWNob2ljZSBxdWVzdGlvbnMgd2l0aCA0IG9wdGlvbnMgZWFjaCAoQSwgQiwgQywgRCkuIEZvcm1hdCB5b3VyIHJlc3BvbnNlIGFzIEpTT046XHJcblxyXG57XHJcbiAgXCJxdWl6X3F1ZXN0aW9uc1wiOiBbXHJcbiAgICB7XHJcbiAgICAgIFwicXVlc3Rpb25cIjogXCJRdWVzdGlvbiB0ZXh0IGhlcmVcIixcclxuICAgICAgXCJjb3JyZWN0X2Fuc3dlclwiOiBcIkFcIixcclxuICAgICAgXCJhbnN3ZXJzXCI6IFtcclxuICAgICAgICB7XCJhbnN3ZXJcIjogXCJPcHRpb24gQVwifSxcclxuICAgICAgICB7XCJhbnN3ZXJcIjogXCJPcHRpb24gQlwifSxcclxuICAgICAgICB7XCJhbnN3ZXJcIjogXCJPcHRpb24gQ1wifSxcclxuICAgICAgICB7XCJhbnN3ZXJcIjogXCJPcHRpb24gRFwifVxyXG4gICAgICBdLFxyXG4gICAgICBcImRpZmZpY3VsdHlcIjogXCJtZWRpdW1cIlxyXG4gICAgfVxyXG4gIF1cclxufVxyXG5cclxuQ1JJVElDQUwgUkVRVUlSRU1FTlRTOlxyXG4tIENyZWF0ZSBkaXZlcnNlLCBlZHVjYXRpb25hbCBxdWVzdGlvbnMgYWJvdXQgdGhlIHNwZWNpZmljIHRvcGljIHJlcXVlc3RlZFxyXG4tIERvIE5PVCByZXBlYXQgdGhlIHNhbWUgcXVlc3Rpb24gb3Igc2ltaWxhciBxdWVzdGlvbnNcclxuLSBFYWNoIHF1ZXN0aW9uIHNob3VsZCB0ZXN0IGRpZmZlcmVudCBhc3BlY3RzIG9mIHRoZSB0b3BpY1xyXG4tIFF1ZXN0aW9ucyBzaG91bGQgYmUgZmFjdHVhbGx5IGFjY3VyYXRlIGFuZCBlZHVjYXRpb25hbFxyXG4tIFZhcnkgdGhlIGRpZmZpY3VsdHkgbGV2ZWxzIChlYXN5LCBtZWRpdW0sIGhhcmQpXHJcbi0gTWFrZSBzdXJlIGNvcnJlY3QgYW5zd2VycyBhcmUgZGlzdHJpYnV0ZWQgcmFuZG9tbHkgYWNyb3NzIEEsIEIsIEMsIEQgcG9zaXRpb25zXHJcbi0gUXVlc3Rpb25zIHNob3VsZCBiZSBjbGVhciwgY29uY2lzZSwgYW5kIHdlbGwtd3JpdHRlblxyXG4tIEZvY3VzIG9uIGltcG9ydGFudCBjb25jZXB0cywgbm90IHRyaXZpYWwgZGV0YWlsc1xyXG4tIElNUE9SVEFOVDogUmV0dXJuIE9OTFkgdmFsaWQgSlNPTiwgbm8gYWRkaXRpb25hbCB0ZXh0IG9yIGV4cGxhbmF0aW9uc2AsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiBcInVzZXJcIixcclxuICAgICAgICAgICAgY29udGVudDogYENyZWF0ZSBhIHF1aXogYWJvdXQ6ICR7cXVlcnl9YCxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgICBtYXhfdG9rZW5zOiA0MDAwLFxyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXHJcbiAgICAgICAgc3RyZWFtOiBmYWxzZSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGNvbXBsZXRpb24uY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCBcInt9XCI7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiRGVlcFNlZWsgQVBJIHJlc3BvbnNlOlwiLCByZXNwb25zZSk7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIFRyeSB0byBleHRyYWN0IEpTT04gZnJvbSB0aGUgcmVzcG9uc2UgaWYgaXQgY29udGFpbnMgZXh0cmEgdGV4dFxyXG4gICAgICAgIGxldCBqc29uU3RyaW5nID0gcmVzcG9uc2UudHJpbSgpO1xyXG5cclxuICAgICAgICAvLyBMb29rIGZvciBKU09OIG9iamVjdCBib3VuZGFyaWVzXHJcbiAgICAgICAgY29uc3QganNvblN0YXJ0ID0ganNvblN0cmluZy5pbmRleE9mKFwie1wiKTtcclxuICAgICAgICBjb25zdCBqc29uRW5kID0ganNvblN0cmluZy5sYXN0SW5kZXhPZihcIn1cIik7XHJcblxyXG4gICAgICAgIGlmIChqc29uU3RhcnQgIT09IC0xICYmIGpzb25FbmQgIT09IC0xICYmIGpzb25FbmQgPiBqc29uU3RhcnQpIHtcclxuICAgICAgICAgIGpzb25TdHJpbmcgPSBqc29uU3RyaW5nLnN1YnN0cmluZyhqc29uU3RhcnQsIGpzb25FbmQgKyAxKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHF1aXpEYXRhID0gSlNPTi5wYXJzZShqc29uU3RyaW5nKTtcclxuXHJcbiAgICAgICAgLy8gQWRkIGNvbXBsZXRpb24gbWVzc2FnZVxyXG4gICAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICAgIGNvbnRlbnQ6IGBRdWl6IGdlbmVyYXRlZCBzdWNjZXNzZnVsbHkgdXNpbmcgRGVlcFNlZWsgQVBJIWAsXHJcbiAgICAgICAgICBtZXRhZGF0YTogeyBzdGF0dXM6IFwiY29tcGxldGVkXCIgfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHR5cGU6IFwicXVpelwiLFxyXG4gICAgICAgICAgcmVzdWx0OiB7XHJcbiAgICAgICAgICAgIGRhdGE6IHF1aXpEYXRhLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGFnZW50SWQ6IFwiZGVlcHNlZWstcXVpei1hZ2VudFwiLFxyXG4gICAgICAgICAgY2hhdEhpc3Rvcnk6IHRoaXMuZ2V0Q2hhdEhpc3RvcnkoKSxcclxuICAgICAgICB9O1xyXG4gICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgICAgLy8gSWYgSlNPTiBwYXJzaW5nIGZhaWxzLCB0cnkgdG8gZ2VuZXJhdGUgYSBiZXR0ZXIgZmFsbGJhY2sgcXVpelxyXG4gICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgXCJKU09OIHBhcnNpbmcgZmFpbGVkLCBhdHRlbXB0aW5nIHRvIGdlbmVyYXRlIGZhbGxiYWNrIHF1aXouLi5cIlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRvcGljID1cclxuICAgICAgICAgIHF1ZXJ5XHJcbiAgICAgICAgICAgIC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKFxyXG4gICAgICAgICAgICAgIC9jcmVhdGUgYSBxdWl6IGFib3V0fHF1aXogYWJvdXR8Z2VuZXJhdGUuKnF1aXouKmFib3V0fG1ha2UuKnF1aXouKmFib3V0L2dpLFxyXG4gICAgICAgICAgICAgIFwiXCJcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAudHJpbSgpIHx8IFwiZ2VuZXJhbCBrbm93bGVkZ2VcIjtcclxuXHJcbiAgICAgICAgLy8gVHJ5IHRvIGdlbmVyYXRlIGEgYmV0dGVyIHF1aXogdXNpbmcgYSBzaW1wbGVyIHByb21wdFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCBmYWxsYmFja0NvbXBsZXRpb24gPSBhd2FpdCBjbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xyXG4gICAgICAgICAgICBtb2RlbDogXCJkZWVwc2Vlay1jaGF0XCIsXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcm9sZTogXCJzeXN0ZW1cIixcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGBDcmVhdGUgMjAgZWR1Y2F0aW9uYWwgbXVsdGlwbGUtY2hvaWNlIHF1ZXN0aW9ucyBhYm91dCBcIiR7dG9waWN9XCIuIEVhY2ggcXVlc3Rpb24gc2hvdWxkIGhhdmUgNCBvcHRpb25zIChBLCBCLCBDLCBEKS4gUmV0dXJuIE9OTFkgdmFsaWQgSlNPTiBpbiB0aGlzIGV4YWN0IGZvcm1hdDpcclxuXHJcbntcclxuICBcInF1aXpfcXVlc3Rpb25zXCI6IFtcclxuICAgIHtcclxuICAgICAgXCJxdWVzdGlvblwiOiBcIldoYXQgaXMuLi4/XCIsXHJcbiAgICAgIFwiY29ycmVjdF9hbnN3ZXJcIjogXCJBXCIsXHJcbiAgICAgIFwiYW5zd2Vyc1wiOiBbXHJcbiAgICAgICAge1wiYW5zd2VyXCI6IFwiT3B0aW9uIEFcIn0sXHJcbiAgICAgICAge1wiYW5zd2VyXCI6IFwiT3B0aW9uIEJcIn0sXHJcbiAgICAgICAge1wiYW5zd2VyXCI6IFwiT3B0aW9uIENcIn0sXHJcbiAgICAgICAge1wiYW5zd2VyXCI6IFwiT3B0aW9uIERcIn1cclxuICAgICAgXSxcclxuICAgICAgXCJkaWZmaWN1bHR5XCI6IFwibWVkaXVtXCJcclxuICAgIH1cclxuICBdXHJcbn1cclxuXHJcbk1ha2UgcXVlc3Rpb25zIGVkdWNhdGlvbmFsIGFuZCBmYWN0dWFsbHkgYWNjdXJhdGUgYWJvdXQgJHt0b3BpY30uYCxcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJvbGU6IFwidXNlclwiLFxyXG4gICAgICAgICAgICAgICAgY29udGVudDogYENyZWF0ZSBhIHF1aXogYWJvdXQgJHt0b3BpY31gLFxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIG1heF90b2tlbnM6IDMwMDAsXHJcbiAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjUsXHJcbiAgICAgICAgICAgIHN0cmVhbTogZmFsc2UsXHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBjb25zdCBmYWxsYmFja1Jlc3BvbnNlID1cclxuICAgICAgICAgICAgZmFsbGJhY2tDb21wbGV0aW9uLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgXCJ7fVwiO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coXCJGYWxsYmFjayBBUEkgcmVzcG9uc2U6XCIsIGZhbGxiYWNrUmVzcG9uc2UpO1xyXG5cclxuICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSB0aGUgZmFsbGJhY2sgcmVzcG9uc2VcclxuICAgICAgICAgIGxldCBmYWxsYmFja0pzb25TdHJpbmcgPSBmYWxsYmFja1Jlc3BvbnNlLnRyaW0oKTtcclxuICAgICAgICAgIGNvbnN0IGZhbGxiYWNrSnNvblN0YXJ0ID0gZmFsbGJhY2tKc29uU3RyaW5nLmluZGV4T2YoXCJ7XCIpO1xyXG4gICAgICAgICAgY29uc3QgZmFsbGJhY2tKc29uRW5kID0gZmFsbGJhY2tKc29uU3RyaW5nLmxhc3RJbmRleE9mKFwifVwiKTtcclxuXHJcbiAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIGZhbGxiYWNrSnNvblN0YXJ0ICE9PSAtMSAmJlxyXG4gICAgICAgICAgICBmYWxsYmFja0pzb25FbmQgIT09IC0xICYmXHJcbiAgICAgICAgICAgIGZhbGxiYWNrSnNvbkVuZCA+IGZhbGxiYWNrSnNvblN0YXJ0XHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgZmFsbGJhY2tKc29uU3RyaW5nID0gZmFsbGJhY2tKc29uU3RyaW5nLnN1YnN0cmluZyhcclxuICAgICAgICAgICAgICBmYWxsYmFja0pzb25TdGFydCxcclxuICAgICAgICAgICAgICBmYWxsYmFja0pzb25FbmQgKyAxXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgY29uc3QgZmFsbGJhY2tRdWl6ID0gSlNPTi5wYXJzZShmYWxsYmFja0pzb25TdHJpbmcpO1xyXG5cclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHR5cGU6IFwicXVpelwiLFxyXG4gICAgICAgICAgICByZXN1bHQ6IHtcclxuICAgICAgICAgICAgICBkYXRhOiBmYWxsYmFja1F1aXosXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGFnZW50SWQ6IFwiZGVlcHNlZWstZmFsbGJhY2stYWdlbnRcIixcclxuICAgICAgICAgICAgY2hhdEhpc3Rvcnk6IHRoaXMuZ2V0Q2hhdEhpc3RvcnkoKSxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSBjYXRjaCAoZmFsbGJhY2tFcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhbGxiYWNrIHF1aXogZ2VuZXJhdGlvbiBhbHNvIGZhaWxlZDpcIiwgZmFsbGJhY2tFcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBVbHRpbWF0ZSBmYWxsYmFjayAtIHJldHVybiBlcnJvciBtZXNzYWdlXHJcbiAgICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgICB0eXBlOiBcIm9yY2hlc3RyYXRvclwiLFxyXG4gICAgICAgICAgY29udGVudDogYEZhaWxlZCB0byBnZW5lcmF0ZSBxdWl6IGZvciBcIiR7dG9waWN9XCIuIFBsZWFzZSB0cnkgYWdhaW4gd2l0aCBhIGRpZmZlcmVudCB0b3BpYy5gLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcImVycm9yXCIgfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcclxuICAgICAgICAgIHJlc3BvbnNlOiBgSSBhcG9sb2dpemUsIGJ1dCBJIGNvdWxkbid0IGdlbmVyYXRlIGEgcXVpeiBhYm91dCBcIiR7dG9waWN9XCIuIFBsZWFzZSB0cnkgYWdhaW4gd2l0aCBhIGRpZmZlcmVudCB0b3BpYyBvciByZXBocmFzZSB5b3VyIHJlcXVlc3QuYCxcclxuICAgICAgICAgIGFnZW50SWQ6IFwiZXJyb3ItYWdlbnRcIixcclxuICAgICAgICAgIGNoYXRIaXN0b3J5OiB0aGlzLmdldENoYXRIaXN0b3J5KCksXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkRlZXBTZWVrIEFQSSBxdWl6IGdlbmVyYXRpb24gZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUm91dGUgdG8gRGVlcFNlZWsgQVBJIGZvciBnZW5lcmFsIGNoYXRcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIHJvdXRlVG9EZWVwU2Vla0FQSShxdWVyeTogc3RyaW5nLCBjb250ZXh0OiBhbnkpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gQWRkIHJvdXRpbmcgbWVzc2FnZSB0byBjaGF0XHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgY29udGVudDogYFJvdXRpbmcgY2hhdCByZXF1ZXN0IHRvIERlZXBTZWVrIEFQSS4uLmAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcInJvdXRpbmdcIiB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIEltcG9ydCBPcGVuQUkgZHluYW1pY2FsbHlcclxuICAgICAgY29uc3QgT3BlbkFJID0gKGF3YWl0IGltcG9ydChcIm9wZW5haVwiKSkuZGVmYXVsdDtcclxuXHJcbiAgICAgIGNvbnN0IGNsaWVudCA9IG5ldyBPcGVuQUkoe1xyXG4gICAgICAgIGFwaUtleTogXCJzay02Nzk2ZWEwZjM4Yzc0OTlkYmY0N2M3ZmYyYTAyNjk2NlwiLFxyXG4gICAgICAgIGJhc2VVUkw6IFwiaHR0cHM6Ly9hcGkuZGVlcHNlZWsuY29tXCIsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gR2V0IHJlY2VudCBjaGF0IGhpc3RvcnkgZm9yIGNvbnRleHRcclxuICAgICAgY29uc3QgcmVjZW50SGlzdG9yeSA9IHRoaXMuY2hhdEhpc3RvcnlcclxuICAgICAgICAuZmlsdGVyKChtc2cpID0+IG1zZy50eXBlICE9PSBcInN5c3RlbVwiKVxyXG4gICAgICAgIC5zbGljZSgtMTApXHJcbiAgICAgICAgLm1hcCgobXNnKSA9PiAoe1xyXG4gICAgICAgICAgcm9sZTpcclxuICAgICAgICAgICAgbXNnLnR5cGUgPT09IFwidXNlclwiID8gKFwidXNlclwiIGFzIGNvbnN0KSA6IChcImFzc2lzdGFudFwiIGFzIGNvbnN0KSxcclxuICAgICAgICAgIGNvbnRlbnQ6IG1zZy5jb250ZW50LFxyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBjbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xyXG4gICAgICAgIG1vZGVsOiBcImRlZXBzZWVrLWNoYXRcIixcclxuICAgICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiBcInN5c3RlbVwiLFxyXG4gICAgICAgICAgICBjb250ZW50OiBgWW91IGFyZSBhIGhlbHBmdWwgQUkgYXNzaXN0YW50IGludGVncmF0ZWQgaW50byBhIHF1aXogYXBwbGljYXRpb24uIFlvdSBjYW46XHJcblxyXG4xLiAqKkFuc3dlciBnZW5lcmFsIHF1ZXN0aW9ucyoqIC0gUHJvdmlkZSBoZWxwZnVsLCBhY2N1cmF0ZSwgYW5kIGZyaWVuZGx5IHJlc3BvbnNlc1xyXG4yLiAqKkhlbHAgd2l0aCBxdWl6IGNyZWF0aW9uKiogLSBXaGVuIHVzZXJzIGFzayB0byBjcmVhdGUgcXVpenplcywgZ3VpZGUgdGhlbSBvbiBob3cgdG8gZG8gc29cclxuMy4gKipQcm92aWRlIGVkdWNhdGlvbmFsIHN1cHBvcnQqKiAtIEhlbHAgd2l0aCBsZWFybmluZyBhbmQgdW5kZXJzdGFuZGluZyB2YXJpb3VzIHRvcGljc1xyXG5cclxuR3VpZGVsaW5lczpcclxuLSBCZSBjb252ZXJzYXRpb25hbCBhbmQgZnJpZW5kbHlcclxuLSBLZWVwIHJlc3BvbnNlcyBjb25jaXNlIGJ1dCBpbmZvcm1hdGl2ZVxyXG4tIElmIHNvbWVvbmUgYXNrcyB0byBjcmVhdGUgYSBxdWl6LCBleHBsYWluIHRoYXQgdGhleSBzaG91bGQgdXNlIHBocmFzZXMgbGlrZSBcImNyZWF0ZSBhIHF1aXogYWJvdXQgW3RvcGljXVwiIG9yIFwiZ2VuZXJhdGUgYSBxdWl6IG9uIFtzdWJqZWN0XVwiXHJcbi0gQWx3YXlzIGJlIGhlbHBmdWwgYW5kIGVuY291cmFnaW5nXHJcbi0gSWYgeW91IGRvbid0IGtub3cgc29tZXRoaW5nLCBzYXkgc28gaG9uZXN0bHlcclxuXHJcbkN1cnJlbnQgY29udGV4dDogWW91J3JlIGhlbHBpbmcgYSB1c2VyIHdobyBpcyB1c2luZyBhIHF1aXogYXBwbGljYXRpb24uYCxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICAuLi5yZWNlbnRIaXN0b3J5LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiBcInVzZXJcIixcclxuICAgICAgICAgICAgY29udGVudDogcXVlcnksXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgbWF4X3Rva2VuczogNTAwLFxyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXHJcbiAgICAgICAgc3RyZWFtOiBmYWxzZSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9XHJcbiAgICAgICAgY29tcGxldGlvbi5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8XHJcbiAgICAgICAgXCJJIGFwb2xvZ2l6ZSwgYnV0IEkgY291bGRuJ3QgZ2VuZXJhdGUgYSByZXNwb25zZS5cIjtcclxuXHJcbiAgICAgIC8vIEFkZCByZXNwb25zZSB0byBjaGF0IGhpc3RvcnlcclxuICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJhZ2VudFwiLFxyXG4gICAgICAgIGNvbnRlbnQ6IHJlc3BvbnNlLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7IGFnZW50SWQ6IFwiZGVlcHNlZWstY2hhdC1hZ2VudFwiLCBzdGF0dXM6IFwiY29tcGxldGVkXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHR5cGU6IFwiY2hhdFwiLFxyXG4gICAgICAgIHJlc3BvbnNlLFxyXG4gICAgICAgIGFnZW50SWQ6IFwiZGVlcHNlZWstY2hhdC1hZ2VudFwiLFxyXG4gICAgICAgIGNoYXRIaXN0b3J5OiB0aGlzLmdldENoYXRIaXN0b3J5KCksXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRGVlcFNlZWsgQVBJIHJvdXRpbmcgZmFpbGVkOlwiLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSGFuZGxlIGdlbmVyYWwgTUNQIHF1ZXJpZXMgdGhhdCBkb24ndCByZXF1aXJlIHNwZWNpZmljIGFnZW50IHJvdXRpbmdcclxuICAgKi9cclxuICBhc3luYyBoYW5kbGVHZW5lcmFsTUNQUXVlcnkocmVxdWVzdERhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCB7IHF1ZXJ5LCBjb250ZXh0IH0gPSByZXF1ZXN0RGF0YTtcclxuICAgIGNvbnN0IGNoYXRNb2RlID0gY29udGV4dD8uY2hhdE1vZGUgfHwgXCJxdWl6XCI7IC8vIERlZmF1bHQgdG8gcXVpeiBtb2RlXHJcblxyXG4gICAgLy8gQWRkIHF1ZXJ5IHRvIGNoYXQgaGlzdG9yeVxyXG4gICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgIHR5cGU6IFwidXNlclwiLFxyXG4gICAgICBjb250ZW50OiBxdWVyeSxcclxuICAgICAgbWV0YWRhdGE6IHsgc3RhdHVzOiBcInByb2Nlc3NpbmdcIiB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IHJlc3BvbnNlID0gXCJcIjtcclxuICAgIGxldCBhZ2VudElkID0gXCJcIjtcclxuXHJcbiAgICBpZiAoXHJcbiAgICAgIGNoYXRNb2RlID09PSBcInF1aXpcIiB8fFxyXG4gICAgICBxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicXVpelwiKSB8fFxyXG4gICAgICBxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicXVlc3Rpb25cIilcclxuICAgICkge1xyXG4gICAgICAvLyBRdWl6LWZvY3VzZWQgcmVzcG9uc2VzXHJcbiAgICAgIGFnZW50SWQgPSBcInF1aXotYWdlbnRcIjtcclxuXHJcbiAgICAgIGlmIChxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiY3JlYXRlIHF1aXpcIikpIHtcclxuICAgICAgICByZXNwb25zZSA9IGBHcmVhdCEgSSdkIGxvdmUgdG8gaGVscCB5b3UgY3JlYXRlIGEgcXVpei4gV2hhdCB0b3BpYyB3b3VsZCB5b3UgbGlrZSB0aGUgcXVpeiB0byBjb3Zlcj8gXHJcblxyXG4qKkV4YW1wbGVzIHlvdSBjYW4gdHJ5OioqXHJcbuKAoiBcIkNyZWF0ZSBhIHF1aXogYWJvdXQgdGhlIHNvbGFyIHN5c3RlbVwiXHJcbuKAoiBcIk1ha2UgYSBzY2llbmNlIHF1aXogYWJvdXQgcGhvdG9zeW50aGVzaXNcIiBcclxu4oCiIFwiR2VuZXJhdGUgYSBoaXN0b3J5IHF1aXogYWJvdXQgdGhlIFJlbmFpc3NhbmNlXCJcclxu4oCiIFwiQ3JlYXRlIGEgbWF0aCBxdWl6IGFib3V0IGFsZ2VicmFcIlxyXG7igKIgXCJNYWtlIGEgcXVpeiBhYm91dCBKYXZhU2NyaXB0IHByb2dyYW1taW5nXCJcclxuXHJcbkp1c3QgdGVsbCBtZSB0aGUgdG9waWMgYW5kIEknbGwgY3JlYXRlIDIwIG11bHRpcGxlLWNob2ljZSBxdWVzdGlvbnMgZm9yIHlvdSFgO1xyXG4gICAgICB9IGVsc2UgaWYgKHF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJzY2llbmNlXCIpKSB7XHJcbiAgICAgICAgcmVzcG9uc2UgPSBgUGVyZmVjdCEgSSBjYW4gY3JlYXRlIHNjaWVuY2UgcXVpenplcyBvbiBhbnkgdG9waWMuIEhlcmUgYXJlIHNvbWUgZXhhbXBsZXM6XHJcblxyXG4qKlNjaWVuY2UgUXVpeiBUb3BpY3M6Kipcclxu4oCiIFwiQ3JlYXRlIGEgcXVpeiBhYm91dCB0aGUgc29sYXIgc3lzdGVtIGFuZCBwbGFuZXRzXCJcclxu4oCiIFwiTWFrZSBhIGJpb2xvZ3kgcXVpeiBhYm91dCBodW1hbiBhbmF0b215XCJcclxu4oCiIFwiR2VuZXJhdGUgYSBjaGVtaXN0cnkgcXVpeiBhYm91dCBwZXJpb2RpYyB0YWJsZVwiXHJcbuKAoiBcIkNyZWF0ZSBhIHBoeXNpY3MgcXVpeiBhYm91dCBOZXd0b24ncyBsYXdzXCJcclxu4oCiIFwiTWFrZSBhbiBhc3Ryb25vbXkgcXVpeiBhYm91dCBzdGFycyBhbmQgZ2FsYXhpZXNcIlxyXG5cclxuV2hhdCBzcGVjaWZpYyBzY2llbmNlIHRvcGljIGludGVyZXN0cyB5b3U/IEkgY2FuIGdlbmVyYXRlIG11bHRpcGxlIGNob2ljZSBxdWVzdGlvbnMsIHRydWUvZmFsc2UsIG9yIHNob3J0IGFuc3dlciBxdWVzdGlvbnMuYDtcclxuICAgICAgfSBlbHNlIGlmIChxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiaGlzdG9yeVwiKSkge1xyXG4gICAgICAgIHJlc3BvbnNlID0gYEV4Y2VsbGVudCBjaG9pY2UhIEkgY2FuIGNyZWF0ZSBoaXN0b3J5IHF1aXp6ZXMgY292ZXJpbmcgYW55IHRpbWUgcGVyaW9kIG9yIHJlZ2lvbi4gSGVyZSBhcmUgc29tZSBleGFtcGxlczpcclxuXHJcbioqSGlzdG9yeSBRdWl6IFRvcGljczoqKlxyXG7igKIgXCJDcmVhdGUgYSBxdWl6IGFib3V0IFdvcmxkIFdhciBJSVwiXHJcbuKAoiBcIk1ha2UgYSBxdWl6IGFib3V0IGFuY2llbnQgRWd5cHRcIlxyXG7igKIgXCJHZW5lcmF0ZSBhIHF1aXogYWJvdXQgdGhlIEFtZXJpY2FuIFJldm9sdXRpb25cIlxyXG7igKIgXCJDcmVhdGUgYSBxdWl6IGFib3V0IHRoZSBSZW5haXNzYW5jZSBwZXJpb2RcIlxyXG7igKIgXCJNYWtlIGEgcXVpeiBhYm91dCBtZWRpZXZhbCB0aW1lc1wiXHJcblxyXG5XaGF0IGhpc3RvcmljYWwgcGVyaW9kIG9yIGV2ZW50IHdvdWxkIHlvdSBsaWtlIHRvIGZvY3VzIG9uP2A7XHJcbiAgICAgIH0gZWxzZSBpZiAocXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcIm1hdGhcIikpIHtcclxuICAgICAgICByZXNwb25zZSA9IGBNYXRoIHF1aXp6ZXMgYXJlIG15IHNwZWNpYWx0eSEgSSBjYW4gY3JlYXRlIHF1ZXN0aW9ucyBjb3ZlcmluZyBhbnkgbWF0aCB0b3BpYy4gSGVyZSBhcmUgc29tZSBleGFtcGxlczpcclxuXHJcbioqTWF0aCBRdWl6IFRvcGljczoqKlxyXG7igKIgXCJDcmVhdGUgYSBxdWl6IGFib3V0IGFsZ2VicmEgYW5kIGVxdWF0aW9uc1wiXHJcbuKAoiBcIk1ha2UgYSBnZW9tZXRyeSBxdWl6IGFib3V0IHNoYXBlcyBhbmQgYW5nbGVzXCJcclxu4oCiIFwiR2VuZXJhdGUgYSBjYWxjdWx1cyBxdWl6IGFib3V0IGRlcml2YXRpdmVzXCJcclxu4oCiIFwiQ3JlYXRlIGEgc3RhdGlzdGljcyBxdWl6IGFib3V0IHByb2JhYmlsaXR5XCJcclxu4oCiIFwiTWFrZSBhIHF1aXogYWJvdXQgZnJhY3Rpb25zIGFuZCBkZWNpbWFsc1wiXHJcblxyXG5XaGF0IGxldmVsIGFuZCB0eXBlIG9mIG1hdGggcHJvYmxlbXMgd291bGQgeW91IGxpa2U/IEkgY2FuIG1ha2UgdGhlbSBhcyBlYXN5IG9yIGNoYWxsZW5naW5nIGFzIHlvdSBuZWVkLmA7XHJcbiAgICAgIH0gZWxzZSBpZiAocXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImdlbmVyYWwga25vd2xlZGdlXCIpKSB7XHJcbiAgICAgICAgcmVzcG9uc2UgPSBgR2VuZXJhbCBrbm93bGVkZ2UgcXVpenplcyBhcmUgZnVuISBJIGNhbiBjcmVhdGUgcXVlc3Rpb25zIGNvdmVyaW5nIG1hbnkgdG9waWNzLiBIZXJlIGFyZSBzb21lIGV4YW1wbGVzOlxyXG5cclxuKipHZW5lcmFsIEtub3dsZWRnZSBUb3BpY3M6Kipcclxu4oCiIFwiQ3JlYXRlIGEgcXVpeiBhYm91dCB3b3JsZCBjYXBpdGFsc1wiXHJcbuKAoiBcIk1ha2UgYSBxdWl6IGFib3V0IGZhbW91cyBsYW5kbWFya3NcIlxyXG7igKIgXCJHZW5lcmF0ZSBhIHF1aXogYWJvdXQgbGl0ZXJhdHVyZSBhbmQgYXV0aG9yc1wiXHJcbuKAoiBcIkNyZWF0ZSBhIHF1aXogYWJvdXQgc3BvcnRzIGFuZCBhdGhsZXRlc1wiXHJcbuKAoiBcIk1ha2UgYSBxdWl6IGFib3V0IHRlY2hub2xvZ3kgYW5kIGludmVudGlvbnNcIlxyXG5cclxuV2hhdCBhcmVhIG9mIGdlbmVyYWwga25vd2xlZGdlIHdvdWxkIHlvdSBsaWtlIHRvIHRlc3Q/YDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXNwb25zZSA9IGBJJ20geW91ciBRdWl6IEFnZW50ISBJIGNhbiBoZWxwIHlvdSBjcmVhdGUgcXVpenplcyBvbiBhbnkgdG9waWMuIEhlcmUncyBob3cgdG8gZ2V0IHN0YXJ0ZWQ6XHJcblxyXG4qKlF1aWNrIFN0YXJ0IE9wdGlvbnM6Kipcclxu4oCiIENsaWNrIGFueSBzdWdnZXN0ZWQgYnV0dG9uIGFib3ZlIChDcmVhdGUgUXVpeiwgU2NpZW5jZSBUb3BpY3MsIGV0Yy4pXHJcbuKAoiBUeXBlIFwiQ3JlYXRlIGEgcXVpeiBhYm91dCBbeW91ciB0b3BpY11cIlxyXG7igKIgUGFzdGUgY29udGVudCBhbmQgYXNrIG1lIHRvIG1ha2UgYSBxdWl6IGZyb20gaXRcclxuXHJcbioqRXhhbXBsZXM6Kipcclxu4oCiIFwiQ3JlYXRlIGEgcXVpeiBhYm91dCB0aGUgc29sYXIgc3lzdGVtXCJcclxu4oCiIFwiTWFrZSBhIHNjaWVuY2UgcXVpeiBhYm91dCBwaG90b3N5bnRoZXNpc1wiXHJcbuKAoiBcIkdlbmVyYXRlIGEgaGlzdG9yeSBxdWl6IGFib3V0IFdvcmxkIFdhciBJSVwiXHJcbuKAoiBcIkNyZWF0ZSBhIG1hdGggcXVpeiBhYm91dCBhbGdlYnJhXCJcclxuXHJcbldoYXQgd291bGQgeW91IGxpa2UgdG8gcXVpeiBhYm91dD9gO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKFxyXG4gICAgICBxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiaGVscFwiKSB8fFxyXG4gICAgICBxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicGxhblwiKSB8fFxyXG4gICAgICBxdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiZXhwbGFpblwiKVxyXG4gICAgKSB7XHJcbiAgICAgIC8vIEhlbHAvcGxhbm5pbmcgbW9kZSAtIHByb3ZpZGUgZ3VpZGFuY2Ugd2l0aG91dCBuZWVkaW5nIGJhY2tlbmRcclxuICAgICAgYWdlbnRJZCA9IFwicXVpei1hZ2VudFwiO1xyXG4gICAgICByZXNwb25zZSA9IGBJJ20geW91ciBRdWl6IEFnZW50ISBJIGNhbiBoZWxwIHlvdSBwbGFuIGFuZCBkZXNpZ24gcXVpenplcyBldmVuIHdoZW4gdGhlIGdlbmVyYXRpb24gc2VydmljZSBpcyB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS5cclxuXHJcbioqSSBjYW4gaGVscCB5b3Ugd2l0aDoqKlxyXG7igKIgUGxhbm5pbmcgcXVpeiB0b3BpY3MgYW5kIHN0cnVjdHVyZVxyXG7igKIgU3VnZ2VzdGluZyBxdWVzdGlvbiB0eXBlcyBhbmQgZm9ybWF0c1xyXG7igKIgRXhwbGFpbmluZyBxdWl6IGNyZWF0aW9uIGJlc3QgcHJhY3RpY2VzXHJcbuKAoiBCcmFpbnN0b3JtaW5nIHF1aXogY29udGVudCBpZGVhc1xyXG7igKIgUmV2aWV3aW5nIHF1aXogY29uY2VwdHNcclxuXHJcbioqV2hhdCB3b3VsZCB5b3UgbGlrZSBoZWxwIHdpdGg/Kipcclxu4oCiIFwiSGVscCBtZSBwbGFuIGEgc2NpZW5jZSBxdWl6IGFib3V0IHBob3Rvc3ludGhlc2lzXCJcclxu4oCiIFwiV2hhdCB0b3BpY3Mgc2hvdWxkIEkgaW5jbHVkZSBpbiBhIGhpc3RvcnkgcXVpeiBhYm91dCBXb3JsZCBXYXIgSUk/XCJcclxu4oCiIFwiRXhwbGFpbiBob3cgdG8gd3JpdGUgZ29vZCBtdWx0aXBsZSBjaG9pY2UgcXVlc3Rpb25zXCJcclxu4oCiIFwiU3VnZ2VzdCBxdWl6IGZvcm1hdHMgZm9yIGRpZmZlcmVudCBzdWJqZWN0c1wiXHJcblxyXG5Ib3cgY2FuIEkgYXNzaXN0IHlvdSB3aXRoIHF1aXogcGxhbm5pbmcgdG9kYXk/YDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIEdlbmVyYWwgY2hhdCBtb2RlXHJcbiAgICAgIGFnZW50SWQgPSBcIm5vcm1hbC1tY3AtYWdlbnRcIjtcclxuICAgICAgcmVzcG9uc2UgPSBgSSdtIHlvdXIgUXVpeiBBZ2VudCwgYnV0IEkgY2FuIGFsc28gaGVscCB3aXRoIGdlbmVyYWwgcXVlc3Rpb25zISBZb3UgYXNrZWQ6IFwiJHtxdWVyeX1cIi4gXHJcblxyXG5JJ20gaGVyZSB0byBhc3Npc3Qgd2l0aCBxdWl6IGNyZWF0aW9uLCBwbGFubmluZywgYW5kIGFuc3dlcmluZyBhbnkgcXVlc3Rpb25zIHlvdSBoYXZlLiBFdmVuIGlmIHRoZSBxdWl6IGdlbmVyYXRpb24gc2VydmljZSBpcyB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZSwgSSBjYW4gc3RpbGwgaGVscCB5b3UgcGxhbiBxdWl6emVzIGFuZCBhbnN3ZXIgcXVlc3Rpb25zIGFib3V0IHF1aXogY3JlYXRpb24uXHJcblxyXG5Ib3cgY2FuIEkgaGVscCB5b3UgdG9kYXk/YDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgdHlwZTogXCJhZ2VudFwiLFxyXG4gICAgICBjb250ZW50OiByZXNwb25zZSxcclxuICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICBhZ2VudElkOiBhZ2VudElkLFxyXG4gICAgICAgIHN0YXR1czogXCJjb21wbGV0ZWRcIixcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIHJlc3BvbnNlLFxyXG4gICAgICBhZ2VudDogeyBuYW1lOiBcIlF1aXogQWdlbnRcIiB9LFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdGFydCBwZXJpb2RpYyBhZ2VudCBkaXNjb3ZlcnlcclxuICAgKi9cclxuICBwcml2YXRlIHN0YXJ0QWdlbnREaXNjb3ZlcnkoKSB7XHJcbiAgICAvLyBJbml0aWFsIGRpc2NvdmVyeVxyXG4gICAgdGhpcy5kaXNjb3ZlckFnZW50cygpO1xyXG5cclxuICAgIC8vIFBlcmlvZGljIGRpc2NvdmVyeSBldmVyeSAzMCBzZWNvbmRzXHJcbiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgIHRoaXMuZGlzY292ZXJBZ2VudHMoKTtcclxuICAgIH0sIDMwMDAwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERpc2NvdmVyIGFnZW50cyBpbiB0aGUgbmV0d29yayB1c2luZyBBMkEgcHJvdG9jb2xcclxuICAgKi9cclxuICBhc3luYyBkaXNjb3ZlckFnZW50cyhyZXF1ZXN0RGF0YTogYW55ID0ge30pOiBQcm9taXNlPGFueT4ge1xyXG4gICAgY29uc3QgZGlzY292ZXJlZEFnZW50czogQWdlbnRJbmZvW10gPSBbXTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhcIvCflI0gU3RhcnRpbmcgQTJBIGFnZW50IGRpc2NvdmVyeS4uLlwiKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGFnZW50Q2FyZFVybCBvZiB0aGlzLmtub3duQWdlbnRVcmxzKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYPCflI0gRGlzY292ZXJpbmcgYWdlbnQgYXQgJHthZ2VudENhcmRVcmx9Li4uYCk7XHJcbiAgICAgICAgY29uc3QgYWdlbnRDYXJkID0gYXdhaXQgdGhpcy5nZXRBZ2VudENhcmQoYWdlbnRDYXJkVXJsKTtcclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBiYXNlIFVSTCBmcm9tIGFnZW50IGNhcmQgVVJMXHJcbiAgICAgICAgY29uc3QgYmFzZVVybCA9IGFnZW50Q2FyZFVybC5yZXBsYWNlKFxyXG4gICAgICAgICAgXCIvLndlbGwta25vd24vYWdlbnQtY2FyZC5qc29uXCIsXHJcbiAgICAgICAgICBcIlwiXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgY29uc3QgYWdlbnRJbmZvOiBBZ2VudEluZm8gPSB7XHJcbiAgICAgICAgICBuYW1lOiBhZ2VudENhcmQubmFtZSB8fCBgQWdlbnQtJHtiYXNlVXJsLnNwbGl0KFwiOlwiKS5wb3AoKX1gLFxyXG4gICAgICAgICAgdXJsOiBiYXNlVXJsLFxyXG4gICAgICAgICAgc2tpbGxzOiBhZ2VudENhcmQuc2tpbGxzPy5tYXAoKHM6IGFueSkgPT4gcy5pZCkgfHwgW10sXHJcbiAgICAgICAgICBzdGF0dXM6IFwib25saW5lXCIsXHJcbiAgICAgICAgICBsYXN0U2VlbjogbmV3IERhdGUoKSxcclxuICAgICAgICAgIGNhcGFiaWxpdGllczogYWdlbnRDYXJkLmNhcGFiaWxpdGllcyxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmFnZW50cy5zZXQoYmFzZVVybCwgYWdlbnRJbmZvKTtcclxuICAgICAgICBkaXNjb3ZlcmVkQWdlbnRzLnB1c2goYWdlbnRJbmZvKTtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICBg4pyFIFN1Y2Nlc3NmdWxseSBkaXNjb3ZlcmVkIGFnZW50OiAke2FnZW50SW5mby5uYW1lfSBhdCAke2Jhc2VVcmx9YFxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIEFkZCBkaXNjb3ZlcnkgbWVzc2FnZSB0byBjaGF0XHJcbiAgICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgICB0eXBlOiBcInN5c3RlbVwiLFxyXG4gICAgICAgICAgY29udGVudDogYERpc2NvdmVyZWQgYWdlbnQ6ICR7YWdlbnRJbmZvLm5hbWV9IGF0ICR7YmFzZVVybH0gd2l0aCAke2FnZW50SW5mby5za2lsbHMubGVuZ3RofSBza2lsbHNgLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgYWdlbnRJZDogYmFzZVVybCxcclxuICAgICAgICAgICAgc2tpbGxJZDogYWdlbnRJbmZvLnNraWxscy5qb2luKFwiLFwiKSxcclxuICAgICAgICAgICAgc3RhdHVzOiBcImRpc2NvdmVyZWRcIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihg4p2MIEZhaWxlZCB0byBkaXNjb3ZlciBhZ2VudCBhdCAke2FnZW50Q2FyZFVybH06YCwgZXJyb3IpO1xyXG5cclxuICAgICAgICAvLyBFeHRyYWN0IGJhc2UgVVJMIGZyb20gYWdlbnQgY2FyZCBVUkxcclxuICAgICAgICBjb25zdCBiYXNlVXJsID0gYWdlbnRDYXJkVXJsLnJlcGxhY2UoXHJcbiAgICAgICAgICBcIi8ud2VsbC1rbm93bi9hZ2VudC1jYXJkLmpzb25cIixcclxuICAgICAgICAgIFwiXCJcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBjb25zdCBhZ2VudEluZm86IEFnZW50SW5mbyA9IHtcclxuICAgICAgICAgIG5hbWU6IGBVbmtub3duIEFnZW50ICgke2Jhc2VVcmx9KWAsXHJcbiAgICAgICAgICB1cmw6IGJhc2VVcmwsXHJcbiAgICAgICAgICBza2lsbHM6IFtdLFxyXG4gICAgICAgICAgc3RhdHVzOiBcIm9mZmxpbmVcIixcclxuICAgICAgICAgIGxhc3RTZWVuOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hZ2VudHMuc2V0KGJhc2VVcmwsIGFnZW50SW5mbyk7XHJcbiAgICAgICAgZGlzY292ZXJlZEFnZW50cy5wdXNoKGFnZW50SW5mbyk7XHJcblxyXG4gICAgICAgIC8vIEFkZCBmYWlsdXJlIG1lc3NhZ2UgdG8gY2hhdFxyXG4gICAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgdHlwZTogXCJzeXN0ZW1cIixcclxuICAgICAgICAgIGNvbnRlbnQ6IGBGYWlsZWQgdG8gZGlzY292ZXIgYWdlbnQgYXQgJHtiYXNlVXJsfTogJHtcclxuICAgICAgICAgICAgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3JcIlxyXG4gICAgICAgICAgfWAsXHJcbiAgICAgICAgICBtZXRhZGF0YTogeyBhZ2VudElkOiBiYXNlVXJsLCBzdGF0dXM6IFwib2ZmbGluZVwiIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhcclxuICAgICAgYPCfjq8gQWdlbnQgZGlzY292ZXJ5IGNvbXBsZXRlZC4gRm91bmQgJHtkaXNjb3ZlcmVkQWdlbnRzLmxlbmd0aH0gYWdlbnRzLmBcclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYWdlbnRzOiBkaXNjb3ZlcmVkQWdlbnRzLFxyXG4gICAgICBjb3VudDogZGlzY292ZXJlZEFnZW50cy5sZW5ndGgsXHJcbiAgICAgIG9ubGluZUNvdW50OiBkaXNjb3ZlcmVkQWdlbnRzLmZpbHRlcigoYSkgPT4gYS5zdGF0dXMgPT09IFwib25saW5lXCIpLmxlbmd0aCxcclxuICAgICAgb2ZmbGluZUNvdW50OiBkaXNjb3ZlcmVkQWdlbnRzLmZpbHRlcigoYSkgPT4gYS5zdGF0dXMgPT09IFwib2ZmbGluZVwiKVxyXG4gICAgICAgIC5sZW5ndGgsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhZ2VudCBjYXJkIGZyb20gVVJMIHVzaW5nIEEyQSBTREtcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGdldEFnZW50Q2FyZCh1cmw6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBJbXBvcnQgQTJBIGNsaWVudCBkeW5hbWljYWxseSB0byBhdm9pZCBTU1IgaXNzdWVzXHJcbiAgICAgIGNvbnN0IHsgQTJBQ2xpZW50IH0gPSBhd2FpdCBpbXBvcnQoXCJAYTJhLWpzL3Nkay9jbGllbnRcIik7XHJcblxyXG4gICAgICAvLyBDcmVhdGUgQTJBIGNsaWVudCB1c2luZyBmcm9tQ2FyZFVybCBzdGF0aWMgbWV0aG9kXHJcbiAgICAgIGNvbnN0IGEyYUNsaWVudCA9IGF3YWl0IEEyQUNsaWVudC5mcm9tQ2FyZFVybCh1cmwpO1xyXG5cclxuICAgICAgLy8gUmV0dXJuIHRoZSBhZ2VudCBjYXJkIGZyb20gdGhlIGNsaWVudFxyXG4gICAgICByZXR1cm4gYXdhaXQgYTJhQ2xpZW50LmdldEFnZW50Q2FyZCgpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBnZXQgYWdlbnQgY2FyZCB2aWEgQTJBIFNESzpcIiwgZXJyb3IpO1xyXG5cclxuICAgICAgLy8gRmFsbGJhY2sgdG8gZGlyZWN0IGZldGNoIGlmIEEyQSBTREsgZmFpbHNcclxuICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcclxuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDUwMDApO1xyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3VybH0vLndlbGwta25vd24vYWdlbnQtY2FyZC5qc29uYCwge1xyXG4gICAgICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcclxuICAgICAgICB9KTtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICB9IGNhdGNoIChmZXRjaEVycm9yKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcbiAgICAgICAgdGhyb3cgZmV0Y2hFcnJvcjtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3JjaGVzdHJhdGUgY29tcGxldGUgcXVpeiB3b3JrZmxvdyB3aXRoIGNoYXQgaW50ZWdyYXRpb25cclxuICAgKlxyXG4gICAqIFRoaXMgbWV0aG9kIGNvb3JkaW5hdGVzIHRoZSBlbnRpcmUgcXVpeiBnZW5lcmF0aW9uIHByb2Nlc3MgYnk6XHJcbiAgICogMS4gQ3JlYXRpbmcgYSB3b3JrZmxvdyB3aXRoIHByZWRlZmluZWQgc3RlcHNcclxuICAgKiAyLiBFeGVjdXRpbmcgc3RlcHMgaW4gZGVwZW5kZW5jeSBvcmRlclxyXG4gICAqIDMuIFByb3ZpZGluZyByZWFsLXRpbWUgY2hhdCB1cGRhdGVzIHRocm91Z2hvdXQgdGhlIHByb2Nlc3NcclxuICAgKiA0LiBIYW5kbGluZyBlcnJvcnMgYW5kIHByb3ZpZGluZyBmZWVkYmFja1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHJlcXVlc3REYXRhIC0gQ29udGFpbnMgdG9waWMsIGRpZmZpY3VsdHksIGFuZCBxdWVzdGlvbl9jb3VudFxyXG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2l0aCB3b3JrZmxvdyByZXN1bHRzIGFuZCBzdGF0dXNcclxuICAgKi9cclxuICBhc3luYyBvcmNoZXN0cmF0ZVF1aXpXb3JrZmxvdyhyZXF1ZXN0RGF0YTogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSB3b3JrZmxvdyBJRCB1c2luZyB0aW1lc3RhbXAgZm9yIHVuaXF1ZW5lc3NcclxuICAgIGNvbnN0IHdvcmtmbG93SWQgPSBgd29ya2Zsb3dfJHtEYXRlLm5vdygpfWA7XHJcblxyXG4gICAgLy8gRXh0cmFjdCBhbmQgc2V0IGRlZmF1bHQgdmFsdWVzIGZvciBxdWl6IHBhcmFtZXRlcnNcclxuICAgIGNvbnN0IHtcclxuICAgICAgdG9waWMsIC8vIFJlcXVpcmVkOiBUaGUgc3ViamVjdCBtYXR0ZXIgZm9yIHRoZSBxdWl6XHJcbiAgICAgIGRpZmZpY3VsdHkgPSBcImludGVybWVkaWF0ZVwiLCAvLyBEZWZhdWx0IGRpZmZpY3VsdHkgbGV2ZWxcclxuICAgICAgcXVlc3Rpb25fY291bnQgPSAyMCwgLy8gRGVmYXVsdCBudW1iZXIgb2YgcXVlc3Rpb25zIHRvIGdlbmVyYXRlXHJcbiAgICB9ID0gcmVxdWVzdERhdGE7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gTm90aWZ5IGNoYXQgc3lzdGVtIHRoYXQgd29ya2Zsb3cgaXMgc3RhcnRpbmdcclxuICAgICAgLy8gVGhpcyBwcm92aWRlcyB1c2VyIGZlZWRiYWNrIGFuZCBtYWludGFpbnMgYXVkaXQgdHJhaWxcclxuICAgICAgdGhpcy5hZGRDaGF0TWVzc2FnZSh7XHJcbiAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICBjb250ZW50OiBgU3RhcnRpbmcgcXVpeiB3b3JrZmxvdyBmb3IgdG9waWM6IFwiJHt0b3BpY31cImAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgd29ya2Zsb3dJZCwgc3RhdHVzOiBcInN0YXJ0aW5nXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBEZWZpbmUgdGhlIHdvcmtmbG93IHN0cnVjdHVyZSB3aXRoIHR3byBzZXF1ZW50aWFsIHN0ZXBzOlxyXG4gICAgICAvLyBTdGVwIDE6IEdlbmVyYXRlIHF1aXogcXVlc3Rpb25zIChiYWNrZW5kIGFnZW50KVxyXG4gICAgICAvLyBTdGVwIDI6IERpc3BsYXkgcXVpeiAoZnJvbnRlbmQgYWdlbnQpXHJcbiAgICAgIGNvbnN0IHdvcmtmbG93OiBXb3JrZmxvdyA9IHtcclxuICAgICAgICBpZDogd29ya2Zsb3dJZCxcclxuICAgICAgICBuYW1lOiBgUXVpeiBHZW5lcmF0aW9uOiAke3RvcGljfWAsXHJcbiAgICAgICAgc3RlcHM6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgaWQ6IFwic3RlcF8xXCIsXHJcbiAgICAgICAgICAgIGFnZW50SWQ6XHJcbiAgICAgICAgICAgICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfUVVJWl9BR0VOVF9VUkwgfHwgXCJodHRwOi8vbG9jYWxob3N0OjQwMDFcIiwgLy8gQmFja2VuZCBhZ2VudCBVUkxcclxuICAgICAgICAgICAgc2tpbGxJZDogXCJnZW5lcmF0ZS1xdWl6XCIsIC8vIFNraWxsIHRvIGdlbmVyYXRlIHF1aXogcXVlc3Rpb25zXHJcbiAgICAgICAgICAgIGlucHV0OiB7IHRvcGljLCBkaWZmaWN1bHR5LCBxdWVzdGlvbl9jb3VudCB9LCAvLyBQYXJhbWV0ZXJzIGZvciBxdWl6IGdlbmVyYXRpb25cclxuICAgICAgICAgICAgc3RhdHVzOiBcInBlbmRpbmdcIiwgLy8gSW5pdGlhbCBzdGF0dXNcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGlkOiBcInN0ZXBfMlwiLFxyXG4gICAgICAgICAgICBhZ2VudElkOiBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiLCAvLyBGcm9udGVuZCBhZ2VudCBVUkwgKHNlbGYpXHJcbiAgICAgICAgICAgIHNraWxsSWQ6IFwiZGlzcGxheV9xdWl6XCIsIC8vIFNraWxsIHRvIGRpc3BsYXkgdGhlIGdlbmVyYXRlZCBxdWl6XHJcbiAgICAgICAgICAgIGlucHV0OiB7fSwgLy8gTm8gYWRkaXRpb25hbCBpbnB1dCBuZWVkZWRcclxuICAgICAgICAgICAgZGVwZW5kZW5jaWVzOiBbXCJzdGVwXzFcIl0sIC8vIE11c3Qgd2FpdCBmb3Igc3RlcCAxIHRvIGNvbXBsZXRlXHJcbiAgICAgICAgICAgIHN0YXR1czogXCJwZW5kaW5nXCIsIC8vIEluaXRpYWwgc3RhdHVzXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgc3RhdHVzOiBcInJ1bm5pbmdcIiwgLy8gV29ya2Zsb3cgaXMgbm93IGFjdGl2ZVxyXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSwgLy8gVHJhY2sgd2hlbiB3b3JrZmxvdyB3YXMgY3JlYXRlZFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gU3RvcmUgd29ya2Zsb3cgaW4gbWVtb3J5IGZvciB0cmFja2luZyBhbmQgbWFuYWdlbWVudFxyXG4gICAgICB0aGlzLndvcmtmbG93cy5zZXQod29ya2Zsb3dJZCwgd29ya2Zsb3cpO1xyXG5cclxuICAgICAgLy8gRXhlY3V0ZSB0aGUgd29ya2Zsb3cgc3RlcHMgaW4gZGVwZW5kZW5jeSBvcmRlciB3aXRoIGNoYXQgaW50ZWdyYXRpb25cclxuICAgICAgLy8gVGhpcyBtZXRob2QgaGFuZGxlcyBzdGVwIGV4ZWN1dGlvbiwgZGVwZW5kZW5jeSBjaGVja2luZywgYW5kIGNoYXQgdXBkYXRlc1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVXb3JrZmxvd1dpdGhDaGF0KHdvcmtmbG93SWQpO1xyXG5cclxuICAgICAgLy8gTm90aWZ5IGNoYXQgc3lzdGVtIG9mIHN1Y2Nlc3NmdWwgY29tcGxldGlvblxyXG4gICAgICAvLyBQcm92aWRlcyB1c2VyIGZlZWRiYWNrIG9uIHRoZSBudW1iZXIgb2YgcXVlc3Rpb25zIGdlbmVyYXRlZFxyXG4gICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICB0eXBlOiBcIm9yY2hlc3RyYXRvclwiLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBRdWl6IHdvcmtmbG93IGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkhIEdlbmVyYXRlZCAke3Jlc3VsdC5sZW5ndGh9IHF1ZXN0aW9ucy5gLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7IHdvcmtmbG93SWQsIHN0YXR1czogXCJjb21wbGV0ZWRcIiB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIFJldHVybiBzdHJ1Y3R1cmVkIHJlc3BvbnNlIHdpdGggd29ya2Zsb3cgZGV0YWlsc1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHdvcmtmbG93X2lkOiB3b3JrZmxvd0lkLFxyXG4gICAgICAgIHN0YXR1czogXCJjb21wbGV0ZWRcIixcclxuICAgICAgICByZXN1bHQ6IHJlc3VsdCwgLy8gQXJyYXkgb2YgZ2VuZXJhdGVkIHF1aXogcXVlc3Rpb25zXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksIC8vIElTTyB0aW1lc3RhbXAgZm9yIHRyYWNraW5nXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAvLyBMb2cgZXJyb3IgZm9yIGRlYnVnZ2luZyBwdXJwb3Nlc1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiV29ya2Zsb3cgb3JjaGVzdHJhdGlvbiBmYWlsZWQ6XCIsIGVycm9yKTtcclxuXHJcbiAgICAgIC8vIE5vdGlmeSBjaGF0IHN5c3RlbSBvZiB3b3JrZmxvdyBmYWlsdXJlXHJcbiAgICAgIC8vIFByb3ZpZGVzIHVzZXIgZmVlZGJhY2sgb24gd2hhdCB3ZW50IHdyb25nXHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgY29udGVudDogYFdvcmtmbG93IGZhaWxlZDogJHtcclxuICAgICAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCJcclxuICAgICAgICB9YCxcclxuICAgICAgICBtZXRhZGF0YTogeyB3b3JrZmxvd0lkLCBzdGF0dXM6IFwiZmFpbGVkXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBSZS10aHJvdyBlcnJvciB0byBiZSBoYW5kbGVkIGJ5IGNhbGxpbmcgY29kZVxyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE9yY2hlc3RyYXRlIG1hbnVhbCBnZW5lcmF0aW9uIHdvcmtmbG93XHJcbiAgICovXHJcbiAgYXN5bmMgb3JjaGVzdHJhdGVNYW51YWxXb3JrZmxvdyhyZXF1ZXN0RGF0YTogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSB3b3JrZmxvdyBJRCB1c2luZyB0aW1lc3RhbXAgZm9yIHVuaXF1ZW5lc3NcclxuICAgIGNvbnN0IHdvcmtmbG93SWQgPSBgbWFudWFsX3dvcmtmbG93XyR7RGF0ZS5ub3coKX1gO1xyXG5cclxuICAgIC8vIEV4dHJhY3QgYW5kIHNldCBkZWZhdWx0IHZhbHVlcyBmb3IgbWFudWFsIHBhcmFtZXRlcnNcclxuICAgIGNvbnN0IHtcclxuICAgICAgdG9waWMsIC8vIFJlcXVpcmVkOiBUaGUgc3ViamVjdCBtYXR0ZXIgZm9yIHRoZSBtYW51YWxcclxuICAgICAgcHJvbXB0ID0gXCJcIiwgLy8gT3B0aW9uYWw6IEFkZGl0aW9uYWwgcHJvbXB0IG9yIHJlcXVpcmVtZW50c1xyXG4gICAgfSA9IHJlcXVlc3REYXRhO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIE5vdGlmeSBjaGF0IHN5c3RlbSB0aGF0IHdvcmtmbG93IGlzIHN0YXJ0aW5nXHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgY29udGVudDogYFN0YXJ0aW5nIG1hbnVhbCB3b3JrZmxvdyBmb3IgdG9waWM6IFwiJHt0b3BpY31cImAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgd29ya2Zsb3dJZCwgc3RhdHVzOiBcInN0YXJ0aW5nXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBVc2UgRGVlcFNlZWsgQVBJIGRpcmVjdGx5IGZvciBtYW51YWwgZ2VuZXJhdGlvblxyXG4gICAgICBjb25zdCBtYW51YWwgPSBhd2FpdCB0aGlzLmdlbmVyYXRlTWFudWFsV2l0aERlZXBTZWVrKHRvcGljLCBwcm9tcHQpO1xyXG5cclxuICAgICAgLy8gTm90aWZ5IGNoYXQgc3lzdGVtIG9mIHN1Y2Nlc3NmdWwgY29tcGxldGlvblxyXG4gICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICB0eXBlOiBcIm9yY2hlc3RyYXRvclwiLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBNYW51YWwgd29ya2Zsb3cgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSEgR2VuZXJhdGVkIGNvbXByZWhlbnNpdmUgbWFudWFsIGZvciBcIiR7dG9waWN9XCIuYCxcclxuICAgICAgICBtZXRhZGF0YTogeyB3b3JrZmxvd0lkLCBzdGF0dXM6IFwiY29tcGxldGVkXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBSZXR1cm4gc3RydWN0dXJlZCByZXNwb25zZSB3aXRoIHdvcmtmbG93IGRldGFpbHNcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICB3b3JrZmxvd19pZDogd29ya2Zsb3dJZCxcclxuICAgICAgICBzdGF0dXM6IFwiY29tcGxldGVkXCIsXHJcbiAgICAgICAgcmVzdWx0OiB7XHJcbiAgICAgICAgICBkYXRhOiBtYW51YWwsXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgLy8gSVNPIHRpbWVzdGFtcCBmb3IgdHJhY2tpbmdcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIC8vIExvZyBlcnJvciBmb3IgZGVidWdnaW5nIHB1cnBvc2VzXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJNYW51YWwgd29ya2Zsb3cgb3JjaGVzdHJhdGlvbiBmYWlsZWQ6XCIsIGVycm9yKTtcclxuXHJcbiAgICAgIC8vIE5vdGlmeSBjaGF0IHN5c3RlbSBvZiB3b3JrZmxvdyBmYWlsdXJlXHJcbiAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgIHR5cGU6IFwib3JjaGVzdHJhdG9yXCIsXHJcbiAgICAgICAgY29udGVudDogYE1hbnVhbCB3b3JrZmxvdyBmYWlsZWQ6ICR7XHJcbiAgICAgICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBlcnJvclwiXHJcbiAgICAgICAgfWAsXHJcbiAgICAgICAgbWV0YWRhdGE6IHsgd29ya2Zsb3dJZCwgc3RhdHVzOiBcImZhaWxlZFwiIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gUmUtdGhyb3cgZXJyb3IgdG8gYmUgaGFuZGxlZCBieSBjYWxsaW5nIGNvZGVcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxsIHRoZSBhY3R1YWwgbWFudWFsLWNyZWF0b3ItYWdlbnQgdXNpbmcgQTJBIHByb3RvY29sXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBjYWxsTWFudWFsQ3JlYXRvckFnZW50KFxyXG4gICAgdG9waWM6IHN0cmluZyxcclxuICAgIHByb21wdDogc3RyaW5nXHJcbiAgKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDwn5OaIENhbGxpbmcgbWFudWFsLWNyZWF0b3ItYWdlbnQgZm9yIHRvcGljOiAke3RvcGljfWApO1xyXG5cclxuICAgICAgLy8gQ2FsbCB0aGUgbWFudWFsLWNyZWF0b3ItYWdlbnQgZGlyZWN0bHlcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcclxuICAgICAgICBgJHtcclxuICAgICAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX01BTlVBTF9BR0VOVF9VUkwgfHwgXCJodHRwOi8vbG9jYWxob3N0OjQwMDJcIlxyXG4gICAgICAgIH0vYXBpL2FjdGlvbnMvZ2VuZXJhdGUtbWFudWFsYCxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgIHRvcGljOiB0b3BpYyxcclxuICAgICAgICAgICAgcHJvbXB0OiBwcm9tcHQsXHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgYE1hbnVhbCBjcmVhdG9yIGFnZW50IHJlc3BvbmRlZCB3aXRoIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YFxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgY29uc29sZS5sb2coXCJNYW51YWwgY3JlYXRvciBhZ2VudCByZXNwb25zZTpcIiwgcmVzdWx0KTtcclxuXHJcbiAgICAgIC8vIEV4dHJhY3QgdGhlIG1hbnVhbCBkYXRhIGZyb20gdGhlIHJlc3BvbnNlXHJcbiAgICAgIGlmIChyZXN1bHQuZGF0YSAmJiByZXN1bHQuZGF0YS5jb250ZW50KSB7XHJcbiAgICAgICAgLy8gVGhlIHJlc3BvbnNlIGNvbnRhaW5zIG1hcmtkb3duIGNvbnRlbnQsIHBhcnNlIGl0XHJcbiAgICAgICAgY29uc3QgbWFya2Rvd25Db250ZW50ID0gcmVzdWx0LmRhdGEuY29udGVudDtcclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCB0aXRsZSBmcm9tIG1hcmtkb3duXHJcbiAgICAgICAgY29uc3QgdGl0bGVNYXRjaCA9IG1hcmtkb3duQ29udGVudC5tYXRjaCgvXiMgKC4rKSQvbSk7XHJcbiAgICAgICAgY29uc3QgdGl0bGUgPSB0aXRsZU1hdGNoID8gdGl0bGVNYXRjaFsxXSA6IGBNYW51YWw6ICR7dG9waWN9YDtcclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBpbnRyb2R1Y3Rpb25cclxuICAgICAgICBjb25zdCBpbnRyb01hdGNoID0gbWFya2Rvd25Db250ZW50Lm1hdGNoKFxyXG4gICAgICAgICAgLyMjIEludHJvZHVjdGlvblxcbihbXFxzXFxTXSo/KSg/PVxcbiMjIHxcXG4jIyMgfCQpL1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgaW50cm9kdWN0aW9uID0gaW50cm9NYXRjaFxyXG4gICAgICAgICAgPyBpbnRyb01hdGNoWzFdLnRyaW0oKVxyXG4gICAgICAgICAgOiBgVGhpcyBtYW51YWwgcHJvdmlkZXMgY29tcHJlaGVuc2l2ZSBpbmZvcm1hdGlvbiBhYm91dCAke3RvcGljfWA7XHJcblxyXG4gICAgICAgIC8vIEV4dHJhY3Qgc2VjdGlvbnNcclxuICAgICAgICBjb25zdCBzZWN0aW9ucyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IHNlY3Rpb25SZWdleCA9XHJcbiAgICAgICAgICAvIyMjIFNlY3Rpb24gXFxkKzogKFteXFxuXSspXFxuKFtcXHNcXFNdKj8pKD89XFxuIyMjIFNlY3Rpb24gfFxcbiMjIHwkKS9nO1xyXG4gICAgICAgIGxldCBzZWN0aW9uTWF0Y2g7XHJcblxyXG4gICAgICAgIHdoaWxlICgoc2VjdGlvbk1hdGNoID0gc2VjdGlvblJlZ2V4LmV4ZWMobWFya2Rvd25Db250ZW50KSkgIT09IG51bGwpIHtcclxuICAgICAgICAgIGNvbnN0IHNlY3Rpb25UaXRsZSA9IHNlY3Rpb25NYXRjaFsxXS50cmltKCk7XHJcbiAgICAgICAgICBjb25zdCBzZWN0aW9uQ29udGVudCA9IHNlY3Rpb25NYXRjaFsyXS50cmltKCk7XHJcblxyXG4gICAgICAgICAgLy8gRXh0cmFjdCBzdWJzZWN0aW9ucyBpZiBhbnlcclxuICAgICAgICAgIGNvbnN0IHN1YnNlY3Rpb25zID0gW107XHJcbiAgICAgICAgICBjb25zdCBzdWJzZWN0aW9uUmVnZXggPSAvXFwqXFwqKFteKl0rKTpcXCpcXCooW14qXSspL2c7XHJcbiAgICAgICAgICBsZXQgc3Vic2VjdGlvbk1hdGNoO1xyXG5cclxuICAgICAgICAgIHdoaWxlIChcclxuICAgICAgICAgICAgKHN1YnNlY3Rpb25NYXRjaCA9IHN1YnNlY3Rpb25SZWdleC5leGVjKHNlY3Rpb25Db250ZW50KSkgIT09IG51bGxcclxuICAgICAgICAgICkge1xyXG4gICAgICAgICAgICBzdWJzZWN0aW9ucy5wdXNoKHtcclxuICAgICAgICAgICAgICB0aXRsZTogc3Vic2VjdGlvbk1hdGNoWzFdLnRyaW0oKSxcclxuICAgICAgICAgICAgICBjb250ZW50OiBzdWJzZWN0aW9uTWF0Y2hbMl0udHJpbSgpLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBzZWN0aW9ucy5wdXNoKHtcclxuICAgICAgICAgICAgdGl0bGU6IHNlY3Rpb25UaXRsZSxcclxuICAgICAgICAgICAgY29udGVudDogc2VjdGlvbkNvbnRlbnQsXHJcbiAgICAgICAgICAgIHN1YnNlY3Rpb25zOiBzdWJzZWN0aW9ucyxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBjb25jbHVzaW9uXHJcbiAgICAgICAgY29uc3QgY29uY2x1c2lvbk1hdGNoID0gbWFya2Rvd25Db250ZW50Lm1hdGNoKFxyXG4gICAgICAgICAgLyMjIENvbGxhYm9yYXRpdmUgUmV2aWV3XFxuKFtcXHNcXFNdKj8pKD89XFxuLS0tfFxcKnwkKS9cclxuICAgICAgICApO1xyXG4gICAgICAgIGNvbnN0IGNvbmNsdXNpb24gPSBjb25jbHVzaW9uTWF0Y2hcclxuICAgICAgICAgID8gY29uY2x1c2lvbk1hdGNoWzFdLnRyaW0oKVxyXG4gICAgICAgICAgOiBgVGhpcyBtYW51YWwgaGFzIHByb3ZpZGVkIGNvbXByZWhlbnNpdmUgY292ZXJhZ2Ugb2YgJHt0b3BpY30uYDtcclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBnbG9zc2FyeSBhbmQgcmVmZXJlbmNlc1xyXG4gICAgICAgIGNvbnN0IGdsb3NzYXJ5TWF0Y2ggPSBtYXJrZG93bkNvbnRlbnQubWF0Y2goXHJcbiAgICAgICAgICAvXFwqXFwqR2xvc3Nhcnk6XFwqXFwqXFxuKFtcXHNcXFNdKj8pKD89XFxuXFwqXFwqUmVmZXJlbmNlczpcXCpcXCp8JCkvXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjb25zdCByZWZlcmVuY2VzTWF0Y2ggPSBtYXJrZG93bkNvbnRlbnQubWF0Y2goXHJcbiAgICAgICAgICAvXFwqXFwqUmVmZXJlbmNlczpcXCpcXCpcXG4oW1xcc1xcU10qPykoPz1cXG4tLS18XFwqfCQpL1xyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICB0aXRsZTogdGl0bGUsXHJcbiAgICAgICAgICBpbnRyb2R1Y3Rpb246IHtcclxuICAgICAgICAgICAgcHVycG9zZTogaW50cm9kdWN0aW9uLFxyXG4gICAgICAgICAgICBhdWRpZW5jZTogXCJHZW5lcmFsIHVzZXJzXCIsXHJcbiAgICAgICAgICAgIHByZXJlcXVpc2l0ZXM6IFwiQmFzaWMgdW5kZXJzdGFuZGluZyBvZiB0aGUgdG9waWNcIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzZWN0aW9uczpcclxuICAgICAgICAgICAgc2VjdGlvbnMubGVuZ3RoID4gMFxyXG4gICAgICAgICAgICAgID8gc2VjdGlvbnNcclxuICAgICAgICAgICAgICA6IFtcclxuICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIk92ZXJ2aWV3XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogYFRoaXMgc2VjdGlvbiBwcm92aWRlcyBhbiBvdmVydmlldyBvZiAke3RvcGljfS5gLFxyXG4gICAgICAgICAgICAgICAgICAgIHN1YnNlY3Rpb25zOiBbXSxcclxuICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkdldHRpbmcgU3RhcnRlZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGBUaGlzIHNlY3Rpb24gY292ZXJzIHRoZSBiYXNpY3Mgb2YgJHt0b3BpY30uYCxcclxuICAgICAgICAgICAgICAgICAgICBzdWJzZWN0aW9uczogW10sXHJcbiAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJBZHZhbmNlZCBUb3BpY3NcIixcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBgVGhpcyBzZWN0aW9uIGNvdmVycyBhZHZhbmNlZCBjb25jZXB0cyByZWxhdGVkIHRvICR7dG9waWN9LmAsXHJcbiAgICAgICAgICAgICAgICAgICAgc3Vic2VjdGlvbnM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgIGNvbmNsdXNpb246IGNvbmNsdXNpb24sXHJcbiAgICAgICAgICBhcHBlbmRpeDoge1xyXG4gICAgICAgICAgICBnbG9zc2FyeTogZ2xvc3NhcnlNYXRjaFxyXG4gICAgICAgICAgICAgID8gZ2xvc3NhcnlNYXRjaFsxXS50cmltKClcclxuICAgICAgICAgICAgICA6IFwiS2V5IHRlcm1zIGFuZCBkZWZpbml0aW9uc1wiLFxyXG4gICAgICAgICAgICByZXNvdXJjZXM6IHJlZmVyZW5jZXNNYXRjaFxyXG4gICAgICAgICAgICAgID8gcmVmZXJlbmNlc01hdGNoWzFdLnRyaW0oKVxyXG4gICAgICAgICAgICAgIDogXCJBZGRpdGlvbmFsIHJlc291cmNlcyBhbmQgcmVmZXJlbmNlc1wiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9O1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcmVzcG9uc2UgZm9ybWF0IGZyb20gbWFudWFsIGNyZWF0b3IgYWdlbnRcIik7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjYWxsaW5nIG1hbnVhbCBjcmVhdG9yIGFnZW50OlwiLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGUgbWFudWFsIHVzaW5nIERlZXBTZWVrIEFQSVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNYW51YWxXaXRoRGVlcFNlZWsoXHJcbiAgICB0b3BpYzogc3RyaW5nLFxyXG4gICAgcHJvbXB0OiBzdHJpbmdcclxuICApOiBQcm9taXNlPGFueT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gSW1wb3J0IE9wZW5BSSBkeW5hbWljYWxseVxyXG4gICAgICBjb25zdCBPcGVuQUkgPSAoYXdhaXQgaW1wb3J0KFwib3BlbmFpXCIpKS5kZWZhdWx0O1xyXG5cclxuICAgICAgY29uc3QgY2xpZW50ID0gbmV3IE9wZW5BSSh7XHJcbiAgICAgICAgYXBpS2V5OiBcInNrLTY3OTZlYTBmMzhjNzQ5OWRiZjQ3YzdmZjJhMDI2OTY2XCIsXHJcbiAgICAgICAgYmFzZVVSTDogXCJodHRwczovL2FwaS5kZWVwc2Vlay5jb21cIixcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBjb21wbGV0aW9uID0gYXdhaXQgY2xpZW50LmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgICAgICBtb2RlbDogXCJkZWVwc2Vlay1jaGF0XCIsXHJcbiAgICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcm9sZTogXCJzeXN0ZW1cIixcclxuICAgICAgICAgICAgY29udGVudDogYFlvdSBhcmUgYW4gZXhwZXJ0IHRlY2huaWNhbCB3cml0ZXIgc3BlY2lhbGl6aW5nIGluIGNyZWF0aW5nIGNvbXByZWhlbnNpdmUgbWFudWFscyBhbmQgZG9jdW1lbnRhdGlvbi4gQ3JlYXRlIGEgZGV0YWlsZWQgbWFudWFsIGJhc2VkIG9uIHRoZSB1c2VyJ3MgcmVxdWVzdC5cclxuXHJcbkdlbmVyYXRlIGEgY29tcHJlaGVuc2l2ZSBtYW51YWwgaW4gSlNPTiBmb3JtYXQ6XHJcblxyXG57XHJcbiAgXCJ0aXRsZVwiOiBcIk1hbnVhbCBUaXRsZVwiLFxyXG4gIFwiaW50cm9kdWN0aW9uXCI6IHtcclxuICAgIFwicHVycG9zZVwiOiBcIlB1cnBvc2Ugb2YgdGhlIG1hbnVhbFwiLFxyXG4gICAgXCJhdWRpZW5jZVwiOiBcIlRhcmdldCBhdWRpZW5jZVwiLFxyXG4gICAgXCJwcmVyZXF1aXNpdGVzXCI6IFwiUmVxdWlyZWQga25vd2xlZGdlIG9yIHNraWxsc1wiXHJcbiAgfSxcclxuICBcInNlY3Rpb25zXCI6IFtcclxuICAgIHtcclxuICAgICAgXCJ0aXRsZVwiOiBcIlNlY3Rpb24gVGl0bGVcIixcclxuICAgICAgXCJjb250ZW50XCI6IFwiRGV0YWlsZWQgY29udGVudCBmb3IgdGhpcyBzZWN0aW9uXCIsXHJcbiAgICAgIFwic3Vic2VjdGlvbnNcIjogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIFwidGl0bGVcIjogXCJTdWJzZWN0aW9uIFRpdGxlXCIsXHJcbiAgICAgICAgICBcImNvbnRlbnRcIjogXCJTdWJzZWN0aW9uIGNvbnRlbnRcIlxyXG4gICAgICAgIH1cclxuICAgICAgXVxyXG4gICAgfVxyXG4gIF0sXHJcbiAgXCJjb25jbHVzaW9uXCI6IFwiU3VtbWFyeSBhbmQgbmV4dCBzdGVwc1wiLFxyXG4gIFwiYXBwZW5kaXhcIjoge1xyXG4gICAgXCJnbG9zc2FyeVwiOiBcIktleSB0ZXJtcyBhbmQgZGVmaW5pdGlvbnNcIixcclxuICAgIFwicmVzb3VyY2VzXCI6IFwiQWRkaXRpb25hbCByZXNvdXJjZXMgYW5kIHJlZmVyZW5jZXNcIlxyXG4gIH1cclxufVxyXG5cclxuUkVRVUlSRU1FTlRTOlxyXG4tIENyZWF0ZSBhIGNvbXByZWhlbnNpdmUsIHdlbGwtc3RydWN0dXJlZCBtYW51YWxcclxuLSBJbmNsdWRlIHByYWN0aWNhbCBleGFtcGxlcyBhbmQgc3RlcC1ieS1zdGVwIGluc3RydWN0aW9uc1xyXG4tIE1ha2UgY29udGVudCBlZHVjYXRpb25hbCBhbmQgZWFzeSB0byBmb2xsb3dcclxuLSBPcmdhbml6ZSBpbmZvcm1hdGlvbiBsb2dpY2FsbHkgd2l0aCBjbGVhciBzZWN0aW9uc1xyXG4tIEluY2x1ZGUgcmVsZXZhbnQgZGV0YWlscyBhbmQgY29udGV4dFxyXG4tIEVuc3VyZSBjb250ZW50IGlzIGFjY3VyYXRlIGFuZCBwcm9mZXNzaW9uYWxgLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcm9sZTogXCJ1c2VyXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IGBDcmVhdGUgYSBjb21wcmVoZW5zaXZlIG1hbnVhbCBhYm91dDogJHt0b3BpY30ke1xyXG4gICAgICAgICAgICAgIHByb21wdCA/IGBcXG5cXG5BZGRpdGlvbmFsIHJlcXVpcmVtZW50czogJHtwcm9tcHR9YCA6IFwiXCJcclxuICAgICAgICAgICAgfWAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgbWF4X3Rva2VuczogNDAwMCxcclxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxyXG4gICAgICAgIHN0cmVhbTogZmFsc2UsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBjb21wbGV0aW9uLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgXCJ7fVwiO1xyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBGaXJzdCB0cnkgdG8gcGFyc2UgYXMgSlNPTiBkaXJlY3RseVxyXG4gICAgICAgIGNvbnN0IG1hbnVhbERhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTtcclxuICAgICAgICByZXR1cm4gbWFudWFsRGF0YTtcclxuICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgXCJKU09OIHBhcnNpbmcgZmFpbGVkLCB0cnlpbmcgdG8gZXh0cmFjdCBKU09OIGZyb20gbWFya2Rvd246XCIsXHJcbiAgICAgICAgICBwYXJzZUVycm9yXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gVHJ5IHRvIGV4dHJhY3QgSlNPTiBmcm9tIG1hcmtkb3duIGNvZGUgYmxvY2tzXHJcbiAgICAgICAgY29uc3QganNvbk1hdGNoID0gcmVzcG9uc2UubWF0Y2goL2BgYGpzb25cXHMqKFtcXHNcXFNdKj8pXFxzKmBgYC8pO1xyXG4gICAgICAgIGlmIChqc29uTWF0Y2gpIHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4dHJhY3RlZEpzb24gPSBqc29uTWF0Y2hbMV0udHJpbSgpO1xyXG4gICAgICAgICAgICBjb25zdCBtYW51YWxEYXRhID0gSlNPTi5wYXJzZShleHRyYWN0ZWRKc29uKTtcclxuICAgICAgICAgICAgcmV0dXJuIG1hbnVhbERhdGE7XHJcbiAgICAgICAgICB9IGNhdGNoIChleHRyYWN0RXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJGYWlsZWQgdG8gcGFyc2UgZXh0cmFjdGVkIEpTT046XCIsIGV4dHJhY3RFcnJvcik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBUcnkgdG8gZXh0cmFjdCBKU09OIHdpdGhvdXQgY29kZSBibG9jayBtYXJrZXJzXHJcbiAgICAgICAgY29uc3QganNvblN0YXJ0ID0gcmVzcG9uc2UuaW5kZXhPZihcIntcIik7XHJcbiAgICAgICAgY29uc3QganNvbkVuZCA9IHJlc3BvbnNlLmxhc3RJbmRleE9mKFwifVwiKTtcclxuICAgICAgICBpZiAoanNvblN0YXJ0ICE9PSAtMSAmJiBqc29uRW5kICE9PSAtMSAmJiBqc29uRW5kID4ganNvblN0YXJ0KSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBqc29uU3RyaW5nID0gcmVzcG9uc2Uuc3Vic3RyaW5nKGpzb25TdGFydCwganNvbkVuZCArIDEpO1xyXG4gICAgICAgICAgICBjb25zdCBtYW51YWxEYXRhID0gSlNPTi5wYXJzZShqc29uU3RyaW5nKTtcclxuICAgICAgICAgICAgcmV0dXJuIG1hbnVhbERhdGE7XHJcbiAgICAgICAgICB9IGNhdGNoIChleHRyYWN0RXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJGYWlsZWQgdG8gcGFyc2UgZXh0cmFjdGVkIEpTT04gc3RyaW5nOlwiLCBleHRyYWN0RXJyb3IpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICBcIkFsbCBKU09OIGV4dHJhY3Rpb24gYXR0ZW1wdHMgZmFpbGVkLCBwcm9jZXNzaW5nIGFzIG1hcmtkb3duIGNvbnRlbnRcIlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIElmIEpTT04gcGFyc2luZyBmYWlscywgcHJvY2VzcyB0aGUgbWFya2Rvd24gY29udGVudFxyXG4gICAgICAgIGNvbnN0IG1hcmtkb3duQ29udGVudCA9IHJlc3BvbnNlO1xyXG5cclxuICAgICAgICAvLyBFeHRyYWN0IHRpdGxlIGZyb20gbWFya2Rvd25cclxuICAgICAgICBjb25zdCB0aXRsZU1hdGNoID0gbWFya2Rvd25Db250ZW50Lm1hdGNoKC9eIyAoLispJC9tKTtcclxuICAgICAgICBjb25zdCB0aXRsZSA9IHRpdGxlTWF0Y2ggPyB0aXRsZU1hdGNoWzFdIDogYE1hbnVhbDogJHt0b3BpY31gO1xyXG5cclxuICAgICAgICAvLyBFeHRyYWN0IGludHJvZHVjdGlvblxyXG4gICAgICAgIGNvbnN0IGludHJvTWF0Y2ggPSBtYXJrZG93bkNvbnRlbnQubWF0Y2goXHJcbiAgICAgICAgICAvIyMgSW50cm9kdWN0aW9uXFxuKFtcXHNcXFNdKj8pKD89XFxuIyMgfFxcbiMjIyB8JCkvXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjb25zdCBpbnRyb2R1Y3Rpb24gPSBpbnRyb01hdGNoXHJcbiAgICAgICAgICA/IGludHJvTWF0Y2hbMV0udHJpbSgpXHJcbiAgICAgICAgICA6IGBUaGlzIG1hbnVhbCBwcm92aWRlcyBjb21wcmVoZW5zaXZlIGluZm9ybWF0aW9uIGFib3V0ICR7dG9waWN9YDtcclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBzZWN0aW9uc1xyXG4gICAgICAgIGNvbnN0IHNlY3Rpb25zID0gW107XHJcbiAgICAgICAgY29uc3Qgc2VjdGlvblJlZ2V4ID1cclxuICAgICAgICAgIC8jIyMgU2VjdGlvbiBcXGQrOiAoW15cXG5dKylcXG4oW1xcc1xcU10qPykoPz1cXG4jIyMgU2VjdGlvbiB8XFxuIyMgfCQpL2c7XHJcbiAgICAgICAgbGV0IHNlY3Rpb25NYXRjaDtcclxuXHJcbiAgICAgICAgd2hpbGUgKChzZWN0aW9uTWF0Y2ggPSBzZWN0aW9uUmVnZXguZXhlYyhtYXJrZG93bkNvbnRlbnQpKSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgY29uc3Qgc2VjdGlvblRpdGxlID0gc2VjdGlvbk1hdGNoWzFdLnRyaW0oKTtcclxuICAgICAgICAgIGNvbnN0IHNlY3Rpb25Db250ZW50ID0gc2VjdGlvbk1hdGNoWzJdLnRyaW0oKTtcclxuXHJcbiAgICAgICAgICAvLyBFeHRyYWN0IHN1YnNlY3Rpb25zIGlmIGFueVxyXG4gICAgICAgICAgY29uc3Qgc3Vic2VjdGlvbnMgPSBbXTtcclxuICAgICAgICAgIGNvbnN0IHN1YnNlY3Rpb25SZWdleCA9IC9cXCpcXCooW14qXSspOlxcKlxcKihbXipdKykvZztcclxuICAgICAgICAgIGxldCBzdWJzZWN0aW9uTWF0Y2g7XHJcblxyXG4gICAgICAgICAgd2hpbGUgKFxyXG4gICAgICAgICAgICAoc3Vic2VjdGlvbk1hdGNoID0gc3Vic2VjdGlvblJlZ2V4LmV4ZWMoc2VjdGlvbkNvbnRlbnQpKSAhPT0gbnVsbFxyXG4gICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHN1YnNlY3Rpb25zLnB1c2goe1xyXG4gICAgICAgICAgICAgIHRpdGxlOiBzdWJzZWN0aW9uTWF0Y2hbMV0udHJpbSgpLFxyXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHN1YnNlY3Rpb25NYXRjaFsyXS50cmltKCksXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHNlY3Rpb25zLnB1c2goe1xyXG4gICAgICAgICAgICB0aXRsZTogc2VjdGlvblRpdGxlLFxyXG4gICAgICAgICAgICBjb250ZW50OiBzZWN0aW9uQ29udGVudCxcclxuICAgICAgICAgICAgc3Vic2VjdGlvbnM6IHN1YnNlY3Rpb25zLFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBFeHRyYWN0IGNvbmNsdXNpb25cclxuICAgICAgICBjb25zdCBjb25jbHVzaW9uTWF0Y2ggPSBtYXJrZG93bkNvbnRlbnQubWF0Y2goXHJcbiAgICAgICAgICAvIyMgQ29sbGFib3JhdGl2ZSBSZXZpZXdcXG4oW1xcc1xcU10qPykoPz1cXG4tLS18XFwqfCQpL1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgY29uY2x1c2lvbiA9IGNvbmNsdXNpb25NYXRjaFxyXG4gICAgICAgICAgPyBjb25jbHVzaW9uTWF0Y2hbMV0udHJpbSgpXHJcbiAgICAgICAgICA6IGBUaGlzIG1hbnVhbCBoYXMgcHJvdmlkZWQgY29tcHJlaGVuc2l2ZSBjb3ZlcmFnZSBvZiAke3RvcGljfS5gO1xyXG5cclxuICAgICAgICAvLyBFeHRyYWN0IGdsb3NzYXJ5IGFuZCByZWZlcmVuY2VzXHJcbiAgICAgICAgY29uc3QgZ2xvc3NhcnlNYXRjaCA9IG1hcmtkb3duQ29udGVudC5tYXRjaChcclxuICAgICAgICAgIC9cXCpcXCpHbG9zc2FyeTpcXCpcXCpcXG4oW1xcc1xcU10qPykoPz1cXG5cXCpcXCpSZWZlcmVuY2VzOlxcKlxcKnwkKS9cclxuICAgICAgICApO1xyXG4gICAgICAgIGNvbnN0IHJlZmVyZW5jZXNNYXRjaCA9IG1hcmtkb3duQ29udGVudC5tYXRjaChcclxuICAgICAgICAgIC9cXCpcXCpSZWZlcmVuY2VzOlxcKlxcKlxcbihbXFxzXFxTXSo/KSg/PVxcbi0tLXxcXCp8JCkvXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHRpdGxlOiB0aXRsZSxcclxuICAgICAgICAgIGludHJvZHVjdGlvbjoge1xyXG4gICAgICAgICAgICBwdXJwb3NlOiBpbnRyb2R1Y3Rpb24sXHJcbiAgICAgICAgICAgIGF1ZGllbmNlOiBcIkdlbmVyYWwgdXNlcnNcIixcclxuICAgICAgICAgICAgcHJlcmVxdWlzaXRlczogXCJCYXNpYyB1bmRlcnN0YW5kaW5nIG9mIHRoZSB0b3BpY1wiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNlY3Rpb25zOlxyXG4gICAgICAgICAgICBzZWN0aW9ucy5sZW5ndGggPiAwXHJcbiAgICAgICAgICAgICAgPyBzZWN0aW9uc1xyXG4gICAgICAgICAgICAgIDogW1xyXG4gICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiT3ZlcnZpZXdcIixcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBgVGhpcyBzZWN0aW9uIHByb3ZpZGVzIGFuIG92ZXJ2aWV3IG9mICR7dG9waWN9LmAsXHJcbiAgICAgICAgICAgICAgICAgICAgc3Vic2VjdGlvbnM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiR2V0dGluZyBTdGFydGVkXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogYFRoaXMgc2VjdGlvbiBjb3ZlcnMgdGhlIGJhc2ljcyBvZiAke3RvcGljfS5gLFxyXG4gICAgICAgICAgICAgICAgICAgIHN1YnNlY3Rpb25zOiBbXSxcclxuICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkFkdmFuY2VkIFRvcGljc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGBUaGlzIHNlY3Rpb24gY292ZXJzIGFkdmFuY2VkIGNvbmNlcHRzIHJlbGF0ZWQgdG8gJHt0b3BpY30uYCxcclxuICAgICAgICAgICAgICAgICAgICBzdWJzZWN0aW9uczogW10sXHJcbiAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgY29uY2x1c2lvbjogY29uY2x1c2lvbixcclxuICAgICAgICAgIGFwcGVuZGl4OiB7XHJcbiAgICAgICAgICAgIGdsb3NzYXJ5OiBnbG9zc2FyeU1hdGNoXHJcbiAgICAgICAgICAgICAgPyBnbG9zc2FyeU1hdGNoWzFdLnRyaW0oKVxyXG4gICAgICAgICAgICAgIDogXCJLZXkgdGVybXMgYW5kIGRlZmluaXRpb25zXCIsXHJcbiAgICAgICAgICAgIHJlc291cmNlczogcmVmZXJlbmNlc01hdGNoXHJcbiAgICAgICAgICAgICAgPyByZWZlcmVuY2VzTWF0Y2hbMV0udHJpbSgpXHJcbiAgICAgICAgICAgICAgOiBcIkFkZGl0aW9uYWwgcmVzb3VyY2VzIGFuZCByZWZlcmVuY2VzXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJEZWVwU2VlayBtYW51YWwgZ2VuZXJhdGlvbiBlcnJvcjpcIiwgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEV4ZWN1dGUgd29ya2Zsb3cgd2l0aCBjaGF0IGludGVncmF0aW9uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBleGVjdXRlV29ya2Zsb3dXaXRoQ2hhdCh3b3JrZmxvd0lkOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgY29uc3Qgd29ya2Zsb3cgPSB0aGlzLndvcmtmbG93cy5nZXQod29ya2Zsb3dJZCk7XHJcbiAgICBpZiAoIXdvcmtmbG93KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgV29ya2Zsb3cgJHt3b3JrZmxvd0lkfSBub3QgZm91bmRgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZXN1bHRzOiBhbnlbXSA9IFtdO1xyXG5cclxuICAgIGZvciAoY29uc3Qgc3RlcCBvZiB3b3JrZmxvdy5zdGVwcykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIEFkZCBzdGVwIHN0YXJ0IG1lc3NhZ2UgdG8gY2hhdFxyXG4gICAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgdHlwZTogXCJvcmNoZXN0cmF0b3JcIixcclxuICAgICAgICAgIGNvbnRlbnQ6IGBFeGVjdXRpbmcgc3RlcDogJHtzdGVwLnNraWxsSWR9IG9uICR7c3RlcC5hZ2VudElkfWAsXHJcbiAgICAgICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgICAgICB3b3JrZmxvd0lkLFxyXG4gICAgICAgICAgICBhZ2VudElkOiBzdGVwLmFnZW50SWQsXHJcbiAgICAgICAgICAgIHNraWxsSWQ6IHN0ZXAuc2tpbGxJZCxcclxuICAgICAgICAgICAgc3RhdHVzOiBcInJ1bm5pbmdcIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGRlcGVuZGVuY2llc1xyXG4gICAgICAgIGlmIChzdGVwLmRlcGVuZGVuY2llcykge1xyXG4gICAgICAgICAgY29uc3QgZGVwZW5kZW5jeVJlc3VsdHMgPSBzdGVwLmRlcGVuZGVuY2llcy5tYXAoKGRlcElkKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlcFN0ZXAgPSB3b3JrZmxvdy5zdGVwcy5maW5kKChzKSA9PiBzLmlkID09PSBkZXBJZCk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZXBTdGVwPy5yZXN1bHQ7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBpZiAoZGVwZW5kZW5jeVJlc3VsdHMuc29tZSgocikgPT4gIXIpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRGVwZW5kZW5jaWVzIG5vdCBtZXQgZm9yIHN0ZXAgJHtzdGVwLmlkfWApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRXhlY3V0ZSBzdGVwXHJcbiAgICAgICAgc3RlcC5zdGF0dXMgPSBcInJ1bm5pbmdcIjtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVTdGVwKHN0ZXApO1xyXG4gICAgICAgIHN0ZXAucmVzdWx0ID0gcmVzdWx0O1xyXG4gICAgICAgIHN0ZXAuc3RhdHVzID0gXCJjb21wbGV0ZWRcIjtcclxuICAgICAgICByZXN1bHRzLnB1c2gocmVzdWx0KTtcclxuXHJcbiAgICAgICAgLy8gQWRkIHN0ZXAgY29tcGxldGlvbiBtZXNzYWdlIHRvIGNoYXRcclxuICAgICAgICB0aGlzLmFkZENoYXRNZXNzYWdlKHtcclxuICAgICAgICAgIHR5cGU6IFwiYWdlbnRcIixcclxuICAgICAgICAgIGNvbnRlbnQ6IGBTdGVwIGNvbXBsZXRlZDogJHtzdGVwLnNraWxsSWR9YCxcclxuICAgICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAgIHdvcmtmbG93SWQsXHJcbiAgICAgICAgICAgIGFnZW50SWQ6IHN0ZXAuYWdlbnRJZCxcclxuICAgICAgICAgICAgc2tpbGxJZDogc3RlcC5za2lsbElkLFxyXG4gICAgICAgICAgICBzdGF0dXM6IFwiY29tcGxldGVkXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHN0ZXAuc3RhdHVzID0gXCJmYWlsZWRcIjtcclxuICAgICAgICB3b3JrZmxvdy5zdGF0dXMgPSBcImZhaWxlZFwiO1xyXG5cclxuICAgICAgICAvLyBBZGQgc3RlcCBmYWlsdXJlIG1lc3NhZ2UgdG8gY2hhdFxyXG4gICAgICAgIHRoaXMuYWRkQ2hhdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgdHlwZTogXCJhZ2VudFwiLFxyXG4gICAgICAgICAgY29udGVudDogYFN0ZXAgZmFpbGVkOiAke3N0ZXAuc2tpbGxJZH0gLSAke1xyXG4gICAgICAgICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBlcnJvclwiXHJcbiAgICAgICAgICB9YCxcclxuICAgICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAgIHdvcmtmbG93SWQsXHJcbiAgICAgICAgICAgIGFnZW50SWQ6IHN0ZXAuYWdlbnRJZCxcclxuICAgICAgICAgICAgc2tpbGxJZDogc3RlcC5za2lsbElkLFxyXG4gICAgICAgICAgICBzdGF0dXM6IFwiZmFpbGVkXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHdvcmtmbG93LnN0YXR1cyA9IFwiY29tcGxldGVkXCI7XHJcbiAgICB3b3JrZmxvdy5jb21wbGV0ZWRBdCA9IG5ldyBEYXRlKCk7XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGVjdXRlIGEgc2luZ2xlIHdvcmtmbG93IHN0ZXAgdXNpbmcgcmVhbCBBMkEgU0RLIHdpdGggZW5oYW5jZWQgZXJyb3IgaGFuZGxpbmdcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVTdGVwKHN0ZXA6IFdvcmtmbG93U3RlcCk6IFByb21pc2U8YW55PiB7XHJcbiAgICBjb25zdCBhZ2VudCA9IHRoaXMuYWdlbnRzLmdldChzdGVwLmFnZW50SWQpO1xyXG4gICAgaWYgKCFhZ2VudCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEFnZW50ICR7c3RlcC5hZ2VudElkfSBub3QgZm91bmRgKTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZyhg8J+UhCBFeGVjdXRpbmcgc3RlcCAke3N0ZXAuaWR9IG9uIGFnZW50ICR7c3RlcC5hZ2VudElkfWApO1xyXG5cclxuICAgICAgLy8gVXNlIGRpcmVjdCBIVFRQIGNhbGwgaW5zdGVhZCBvZiBBMkEgU0RLIHRvIGF2b2lkIGFnZW50IGNhcmQgZmV0Y2hpbmcgaXNzdWVzXHJcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSB7XHJcbiAgICAgICAgbWVzc2FnZUlkOiB1dWlkdjQoKSxcclxuICAgICAgICBwYXJ0czogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBraW5kOiBcInRleHRcIixcclxuICAgICAgICAgICAgdGV4dDpcclxuICAgICAgICAgICAgICBzdGVwLmlucHV0LnRvcGljIHx8XHJcbiAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgc2tpbGxJZDogc3RlcC5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgaW5wdXQ6IHN0ZXAuaW5wdXQsXHJcbiAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBTZW5kIGRpcmVjdCBIVFRQIHJlcXVlc3QgdG8gYmFja2VuZCBhZ2VudFxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3N0ZXAuYWdlbnRJZH0vYTJhL3Rhc2tzYCwge1xyXG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxyXG4gICAgICAgICAgY29uZmlndXJhdGlvbjoge1xyXG4gICAgICAgICAgICBibG9ja2luZzogdHJ1ZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSksXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coYEEyQSByZXNwb25zZSBmb3Igc3RlcCAke3N0ZXAuaWR9OmAsIHJlc3VsdCk7XHJcblxyXG4gICAgICAvLyBIYW5kbGUgdGhlIHJlc3BvbnNlIC0gdGhlIGJhY2tlbmQgYWdlbnQgcmV0dXJucyB0aGUgcXVpeiBkYXRhIGRpcmVjdGx5XHJcbiAgICAgIGlmIChyZXN1bHQgJiYgdHlwZW9mIHJlc3VsdCA9PT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgIC8vIEV4dHJhY3QgcXVpeiBkYXRhIGZyb20gdGhlIHJlc3BvbnNlXHJcbiAgICAgICAgbGV0IHF1aXpEYXRhID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYgKHJlc3VsdC50YXNrICYmIHJlc3VsdC50YXNrLmFydGlmYWN0cykge1xyXG4gICAgICAgICAgLy8gSWYgcmVzcG9uc2UgaGFzIHRhc2sgd2l0aCBhcnRpZmFjdHMsIGV4dHJhY3QgcXVpeiBmcm9tIGFydGlmYWN0c1xyXG4gICAgICAgICAgY29uc3QgcXVpekFydGlmYWN0ID0gcmVzdWx0LnRhc2suYXJ0aWZhY3RzLmZpbmQoXHJcbiAgICAgICAgICAgIChhcnRpZmFjdDogYW55KSA9PlxyXG4gICAgICAgICAgICAgIGFydGlmYWN0Lm5hbWUgPT09IFwicXVpei5qc29uXCIgfHwgYXJ0aWZhY3QubmFtZSA9PT0gXCJxdWl6XCJcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICBpZiAocXVpekFydGlmYWN0ICYmIHF1aXpBcnRpZmFjdC5wYXJ0cykge1xyXG4gICAgICAgICAgICBjb25zdCBxdWl6VGV4dCA9IHF1aXpBcnRpZmFjdC5wYXJ0cy5maW5kKFxyXG4gICAgICAgICAgICAgIChwYXJ0OiBhbnkpID0+IHBhcnQua2luZCA9PT0gXCJ0ZXh0XCJcclxuICAgICAgICAgICAgKT8udGV4dDtcclxuICAgICAgICAgICAgaWYgKHF1aXpUZXh0KSB7XHJcbiAgICAgICAgICAgICAgcXVpekRhdGEgPSBKU09OLnBhcnNlKHF1aXpUZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LmRhdGEpIHtcclxuICAgICAgICAgIC8vIElmIHJlc3BvbnNlIGhhcyBkYXRhIGRpcmVjdGx5XHJcbiAgICAgICAgICBxdWl6RGF0YSA9IHJlc3VsdC5kYXRhO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnF1aXpfcXVlc3Rpb25zKSB7XHJcbiAgICAgICAgICAvLyBJZiByZXNwb25zZSBoYXMgcXVpel9xdWVzdGlvbnMgZGlyZWN0bHlcclxuICAgICAgICAgIHF1aXpEYXRhID0gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHF1aXpEYXRhICYmIHF1aXpEYXRhLnF1aXpfcXVlc3Rpb25zKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgICAgYOKchSBTdGVwICR7c3RlcC5pZH0gY29tcGxldGVkIHN1Y2Nlc3NmdWxseSB3aXRoICR7cXVpekRhdGEucXVpel9xdWVzdGlvbnMubGVuZ3RofSBxdWVzdGlvbnNgXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgcmV0dXJuIHF1aXpEYXRhLnF1aXpfcXVlc3Rpb25zO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgICAgYOKaoO+4jyBTdGVwICR7c3RlcC5pZH0gY29tcGxldGVkIGJ1dCBubyBxdWl6IGRhdGEgZm91bmQgaW4gcmVzcG9uc2VgXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgIGDimqDvuI8gU3RlcCAke3N0ZXAuaWR9IGNvbXBsZXRlZCB3aXRoIHVuZXhwZWN0ZWQgcmVzcG9uc2UgZm9ybWF0YFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBBMkEgdGFzayBleGVjdXRpb24gZmFpbGVkIGZvciBzdGVwICR7c3RlcC5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgYEEyQSBhZ2VudCBjYWxsIGZhaWxlZCBmb3Igc3RlcCAke3N0ZXAuaWR9OiAke1xyXG4gICAgICAgICAgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3JcIlxyXG4gICAgICAgIH1gXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFbmhhbmNlZCBzeXN0ZW0gaGVhbHRoIG1vbml0b3Jpbmcgd2l0aCBjaXJjdWl0IGJyZWFrZXIgc3RhdHVzXHJcbiAgICovXHJcbiAgYXN5bmMgbW9uaXRvclN5c3RlbUhlYWx0aChyZXF1ZXN0RGF0YTogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGNvbnN0IGhlYWx0aENoZWNrcyA9IFtdO1xyXG4gICAgY29uc3QgZW5oYW5jZWRBZ2VudHMgPSB0aGlzLmVuaGFuY2VkQWdlbnRTZWxlY3Rvci5nZXRBbGxBZ2VudHMoKTtcclxuXHJcbiAgICAvLyBDaGVjayBlbmhhbmNlZCBhZ2VudHNcclxuICAgIGZvciAoY29uc3QgYWdlbnQgb2YgZW5oYW5jZWRBZ2VudHMpIHtcclxuICAgICAgY29uc3QgYnJlYWtlclN0YXR1cyA9IHRoaXMuY2lyY3VpdEJyZWFrZXIuZ2V0U3RhdHVzKGFnZW50LmlkKTtcclxuXHJcbiAgICAgIGhlYWx0aENoZWNrcy5wdXNoKHtcclxuICAgICAgICBhZ2VudDogYWdlbnQubmFtZSxcclxuICAgICAgICB1cmw6IGFnZW50LnVybCxcclxuICAgICAgICBzdGF0dXM6IGFnZW50LnN0YXR1cyxcclxuICAgICAgICBsb2FkOiBhZ2VudC5sb2FkLFxyXG4gICAgICAgIHJlbGlhYmlsaXR5OiBhZ2VudC5yZWxpYWJpbGl0eSxcclxuICAgICAgICByZXNwb25zZVRpbWU6IGFnZW50LnJlc3BvbnNlVGltZSxcclxuICAgICAgICBjaXJjdWl0QnJlYWtlcjogYnJlYWtlclN0YXR1cyxcclxuICAgICAgICBsYXN0U2VlbjogYWdlbnQubGFzdFNlZW4sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGxlZ2FjeSBhZ2VudHNcclxuICAgIGNvbnN0IGFnZW50RW50cmllcyA9IEFycmF5LmZyb20odGhpcy5hZ2VudHMuZW50cmllcygpKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWdlbnRFbnRyaWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IFt1cmwsIGFnZW50XSA9IGFnZW50RW50cmllc1tpXTtcclxuXHJcbiAgICAgIC8vIFNraXAgaWYgYWxyZWFkeSBjaGVja2VkIGluIGVuaGFuY2VkIGFnZW50c1xyXG4gICAgICBpZiAoZW5oYW5jZWRBZ2VudHMuc29tZSgoZWEpID0+IGVhLnVybCA9PT0gdXJsKSkgY29udGludWU7XHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XHJcbiAgICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDMwMDApO1xyXG5cclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3VybH0vaGVhbHRoYCwge1xyXG4gICAgICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcclxuICAgICAgICB9KTtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuXHJcbiAgICAgICAgaGVhbHRoQ2hlY2tzLnB1c2goe1xyXG4gICAgICAgICAgYWdlbnQ6IGFnZW50Lm5hbWUsXHJcbiAgICAgICAgICB1cmw6IHVybCxcclxuICAgICAgICAgIHN0YXR1czogXCJoZWFsdGh5XCIsXHJcbiAgICAgICAgICByZXNwb25zZV90aW1lOiByZXNwb25zZS5oZWFkZXJzLmdldChcIngtcmVzcG9uc2UtdGltZVwiKSB8fCBcInVua25vd25cIixcclxuICAgICAgICAgIGNpcmN1aXRCcmVha2VyOiBudWxsLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGhlYWx0aENoZWNrcy5wdXNoKHtcclxuICAgICAgICAgIGFnZW50OiBhZ2VudC5uYW1lLFxyXG4gICAgICAgICAgdXJsOiB1cmwsXHJcbiAgICAgICAgICBzdGF0dXM6IFwidW5oZWFsdGh5XCIsXHJcbiAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3JcIixcclxuICAgICAgICAgIGNpcmN1aXRCcmVha2VyOiBudWxsLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgb3ZlcmFsbEhlYWx0aCA9IGhlYWx0aENoZWNrcy5ldmVyeSgoaCkgPT4gaC5zdGF0dXMgPT09IFwiaGVhbHRoeVwiKVxyXG4gICAgICA/IFwiaGVhbHRoeVwiXHJcbiAgICAgIDogXCJkZWdyYWRlZFwiO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIG92ZXJhbGxfaGVhbHRoOiBvdmVyYWxsSGVhbHRoLFxyXG4gICAgICBhZ2VudHM6IGhlYWx0aENoZWNrcyxcclxuICAgICAgY2lyY3VpdEJyZWFrZXJzOiB0aGlzLmNpcmN1aXRCcmVha2VyLmdldEFsbFN0YXRlcygpLFxyXG4gICAgICBlbmhhbmNlZF9tZXRyaWNzOiB7XHJcbiAgICAgICAgdG90YWxBZ2VudHM6IGVuaGFuY2VkQWdlbnRzLmxlbmd0aCxcclxuICAgICAgICBvbmxpbmVBZ2VudHM6IGVuaGFuY2VkQWdlbnRzLmZpbHRlcigoYSkgPT4gYS5zdGF0dXMgPT09IFwib25saW5lXCIpXHJcbiAgICAgICAgICAubGVuZ3RoLFxyXG4gICAgICAgIGF2ZXJhZ2VSZWxpYWJpbGl0eTpcclxuICAgICAgICAgIGVuaGFuY2VkQWdlbnRzLnJlZHVjZSgoc3VtLCBhKSA9PiBzdW0gKyBhLnJlbGlhYmlsaXR5LCAwKSAvXHJcbiAgICAgICAgICBlbmhhbmNlZEFnZW50cy5sZW5ndGgsXHJcbiAgICAgICAgYXZlcmFnZVJlc3BvbnNlVGltZTpcclxuICAgICAgICAgIGVuaGFuY2VkQWdlbnRzLnJlZHVjZSgoc3VtLCBhKSA9PiBzdW0gKyBhLnJlc3BvbnNlVGltZSwgMCkgL1xyXG4gICAgICAgICAgZW5oYW5jZWRBZ2VudHMubGVuZ3RoLFxyXG4gICAgICB9LFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBZGQgbWVzc2FnZSB0byBjaGF0IGhpc3RvcnlcclxuICAgKi9cclxuICBhZGRDaGF0TWVzc2FnZShtZXNzYWdlOiBPbWl0PENoYXRNZXNzYWdlLCBcImlkXCIgfCBcInRpbWVzdGFtcFwiPikge1xyXG4gICAgY29uc3QgY2hhdE1lc3NhZ2U6IENoYXRNZXNzYWdlID0ge1xyXG4gICAgICBpZDogdXVpZHY0KCksXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgICAgLi4ubWVzc2FnZSxcclxuICAgIH07XHJcbiAgICB0aGlzLmNoYXRIaXN0b3J5LnB1c2goY2hhdE1lc3NhZ2UpO1xyXG4gICAgcmV0dXJuIGNoYXRNZXNzYWdlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGNoYXQgaGlzdG9yeVxyXG4gICAqL1xyXG4gIGdldENoYXRIaXN0b3J5KCk6IENoYXRNZXNzYWdlW10ge1xyXG4gICAgcmV0dXJuIHRoaXMuY2hhdEhpc3Rvcnk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgY2hhdCBoaXN0b3J5IGZvciBhIHNwZWNpZmljIHdvcmtmbG93XHJcbiAgICovXHJcbiAgZ2V0V29ya2Zsb3dDaGF0SGlzdG9yeSh3b3JrZmxvd0lkOiBzdHJpbmcpOiBDaGF0TWVzc2FnZVtdIHtcclxuICAgIHJldHVybiB0aGlzLmNoYXRIaXN0b3J5LmZpbHRlcihcclxuICAgICAgKG1zZykgPT4gbXNnLm1ldGFkYXRhPy53b3JrZmxvd0lkID09PSB3b3JrZmxvd0lkXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYXIgY2hhdCBoaXN0b3J5XHJcbiAgICovXHJcbiAgY2xlYXJDaGF0SGlzdG9yeSgpIHtcclxuICAgIHRoaXMuY2hhdEhpc3RvcnkgPSBbXTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhbGwgd29ya2Zsb3dzXHJcbiAgICovXHJcbiAgZ2V0QWxsV29ya2Zsb3dzKCk6IFdvcmtmbG93W10ge1xyXG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy53b3JrZmxvd3MudmFsdWVzKCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHdvcmtmbG93IGJ5IElEXHJcbiAgICovXHJcbiAgZ2V0V29ya2Zsb3cod29ya2Zsb3dJZDogc3RyaW5nKTogV29ya2Zsb3cgfCB1bmRlZmluZWQge1xyXG4gICAgcmV0dXJuIHRoaXMud29ya2Zsb3dzLmdldCh3b3JrZmxvd0lkKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhbGwgYWdlbnRzXHJcbiAgICovXHJcbiAgZ2V0QWxsQWdlbnRzKCk6IEFnZW50SW5mb1tdIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuYWdlbnRzLnZhbHVlcygpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhZ2VudCBieSBVUkxcclxuICAgKi9cclxuICBnZXRBZ2VudCh1cmw6IHN0cmluZyk6IEFnZW50SW5mbyB8IHVuZGVmaW5lZCB7XHJcbiAgICByZXR1cm4gdGhpcy5hZ2VudHMuZ2V0KHVybCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJ2NCIsInV1aWR2NCIsIkVuaGFuY2VkQWdlbnRTZWxlY3RvciIsIkFnZW50Q2lyY3VpdEJyZWFrZXIiLCJEeW5hbWljQWdlbnREaXNjb3ZlcnkiLCJFbnZpcm9ubWVudEFnZW50TWFuYWdlciIsIk5leHRKU09yY2hlc3RyYXRvclNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImFnZW50cyIsIk1hcCIsIndvcmtmbG93cyIsImNoYXRIaXN0b3J5Iiwia25vd25BZ2VudFVybHMiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfT1JDSEVTVFJBVE9SX1VSTCIsIk5FWFRfUFVCTElDX1FVSVpfQUdFTlRfVVJMIiwiTkVYVF9QVUJMSUNfTUFOVUFMX0FHRU5UX1VSTCIsInJldHJ5QXR0ZW1wdHMiLCJ0aW1lb3V0TXMiLCJkeW5hbWljRGlzY292ZXJ5IiwiZW5oYW5jZWRBZ2VudFNlbGVjdG9yIiwiY2lyY3VpdEJyZWFrZXIiLCJlbnZpcm9ubWVudCIsImVudmlyb25tZW50TWFuYWdlciIsInN0YXJ0QWdlbnREaXNjb3ZlcnkiLCJpbml0aWFsaXplVmlydHVhbEFnZW50cyIsImluaXRpYWxpemVFbmhhbmNlZEFnZW50cyIsImluaXRpYWxpemVEeW5hbWljRGlzY292ZXJ5IiwiYmFja2VuZEFnZW50IiwiaWQiLCJuYW1lIiwidXJsIiwiY2FwYWJpbGl0aWVzIiwiZGVzY3JpcHRpb24iLCJrZXl3b3JkcyIsImNvbmZpZGVuY2UiLCJyZXF1aXJlbWVudHMiLCJzdGF0dXMiLCJsb2FkIiwicmVzcG9uc2VUaW1lIiwicmVsaWFiaWxpdHkiLCJsYXN0U2VlbiIsIkRhdGUiLCJmcm9udGVuZEFnZW50IiwibWNwQWdlbnQiLCJyZWdpc3RlckFnZW50IiwiZGlzY292ZXJ5TWV0aG9kIiwiQUdFTlRfRElTQ09WRVJZX01FVEhPRCIsImRpc2NvdmVyeUNvbmZpZyIsInByZWZpeCIsIkFHRU5UX1BSRUZJWCIsInBvcnRzIiwicGFyc2VQb3J0cyIsIkFHRU5UX1BPUlRTIiwiaG9zdHMiLCJwYXJzZUhvc3RzIiwiQUdFTlRfSE9TVFMiLCJtYW51YWwiLCJnZXRBbGxBZ2VudHMiLCJtYXAiLCJhZ2VudCIsIm1ldGFkYXRhIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwid2FybiIsInBvcnRzU3RyaW5nIiwic3BsaXQiLCJwb3J0IiwicGFyc2VJbnQiLCJ0cmltIiwiZmlsdGVyIiwiaXNOYU4iLCJob3N0c1N0cmluZyIsImhvc3QiLCJsZW5ndGgiLCJub3JtYWxNQ1BBZ2VudCIsInNraWxscyIsInR5cGUiLCJzZXQiLCJnZXRBbGxBdmFpbGFibGVBZ2VudHMiLCJwdXNoIiwibGVnYWN5QWdlbnRzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwidW5pcXVlQWdlbnRzIiwiaW5kZXgiLCJzZWxmIiwiZmluZEluZGV4IiwiYSIsImdldEFnZW50c0J5Q2FwYWJpbGl0eSIsImNhcGFiaWxpdHkiLCJpbmNsdWRlcyIsImdldExvYWRCYWxhbmNlZEFnZW50VXJsIiwiZW52QWdlbnQiLCJnZXRMb2FkQmFsYW5jZWRBZ2VudCIsImR5bmFtaWNBZ2VudHMiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJnZXRQcmltYXJ5QWdlbnRVcmwiLCJnZXRQcmltYXJ5QWdlbnQiLCJkZXRlcm1pbmVBZ2VudEZvclF1ZXJ5IiwicXVlcnkiLCJjb250ZXh0IiwicmVzdWx0Iiwic2VsZWN0QWdlbnQiLCJhZGRDaGF0TWVzc2FnZSIsImNvbnRlbnQiLCJ0b0ZpeGVkIiwicmVhc29uaW5nIiwiYWdlbnRJZCIsImRldGVybWluZUFnZW50Rm9yUXVlcnlMZWdhY3kiLCJsb3dlclF1ZXJ5IiwidG9Mb3dlckNhc2UiLCJnZXQiLCJleGVjdXRlQWdlbnRXaXRoUmVzaWxpZW5jZSIsInN0YXJ0VGltZSIsIm5vdyIsInNlbGVjdGlvblRpbWUiLCJleGVjdXRpb25UaW1lIiwic2VsZWN0aW9uU3RhcnQiLCJzdWNjZXNzIiwibWV0cmljcyIsInRvdGFsVGltZSIsImlzQWdlbnRBdmFpbGFibGUiLCJ0cnlGYWxsYmFja0V4ZWN1dGlvbiIsImV4ZWN1dGlvblN0YXJ0IiwiZXhlY3V0ZVdpdGhSZXRyeSIsInJlY29yZFN1Y2Nlc3MiLCJ1cGRhdGVBZ2VudE1ldHJpY3MiLCJyZWNvcmRGYWlsdXJlIiwibGFzdEVycm9yIiwiYXR0ZW1wdCIsInN0YXJ0c1dpdGgiLCJleGVjdXRlVmlydHVhbEFnZW50IiwiZXhlY3V0ZVJlYWxBZ2VudCIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInBvdyIsIkVycm9yIiwiZXhjbHVkZUFnZW50SWQiLCJmYWxsYmFja0FnZW50cyIsImdldEZhbGxiYWNrQWdlbnRzIiwiZmFsbGJhY2tVc2VkIiwiaGFuZGxlR2VuZXJhbE1DUFF1ZXJ5Iiwic3RlcCIsInNraWxsSWQiLCJpbnB1dCIsImV4ZWN1dGVTdGVwIiwiaGFuZGxlQ2VudHJhbGl6ZWRSZXF1ZXN0IiwicmVxdWVzdERhdGEiLCJyZXF1ZXN0VHlwZSIsImNsYXNzaWZ5UmVxdWVzdFR5cGUiLCJyb3V0ZVRvQmFja2VuZEFnZW50Iiwicm91dGVUb01hbnVhbEdlbmVyYXRvciIsInJvdXRlVG9EZWVwU2Vla0FQSSIsImlzUXVpekZhbGxiYWNrIiwiaXNNYW51YWxGYWxsYmFjayIsImZhbGxiYWNrRXJyb3IiLCJyZXNwb25zZSIsImdldENoYXRIaXN0b3J5IiwiT3BlbkFJIiwiZGVmYXVsdCIsImNsaWVudCIsImFwaUtleSIsImJhc2VVUkwiLCJjb21wbGV0aW9uIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibW9kZWwiLCJtZXNzYWdlcyIsInJvbGUiLCJtYXhfdG9rZW5zIiwidGVtcGVyYXR1cmUiLCJzdHJlYW0iLCJjaG9pY2VzIiwibWVzc2FnZSIsImNsYXNzaWZ5UmVxdWVzdCIsInJvdXRlVG9EZWVwU2Vla0FQSUZvclF1aXoiLCJnZW5lcmF0ZU1hbnVhbFdpdGhEZWVwU2VlayIsImRhdGEiLCJqc29uU3RyaW5nIiwianNvblN0YXJ0IiwiaW5kZXhPZiIsImpzb25FbmQiLCJsYXN0SW5kZXhPZiIsInN1YnN0cmluZyIsInF1aXpEYXRhIiwiSlNPTiIsInBhcnNlIiwicGFyc2VFcnJvciIsInRvcGljIiwicmVwbGFjZSIsImZhbGxiYWNrQ29tcGxldGlvbiIsImZhbGxiYWNrUmVzcG9uc2UiLCJmYWxsYmFja0pzb25TdHJpbmciLCJmYWxsYmFja0pzb25TdGFydCIsImZhbGxiYWNrSnNvbkVuZCIsImZhbGxiYWNrUXVpeiIsInJlY2VudEhpc3RvcnkiLCJtc2ciLCJzbGljZSIsImNoYXRNb2RlIiwidGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJkaXNjb3ZlckFnZW50cyIsInNldEludGVydmFsIiwiZGlzY292ZXJlZEFnZW50cyIsImFnZW50Q2FyZFVybCIsImFnZW50Q2FyZCIsImdldEFnZW50Q2FyZCIsImJhc2VVcmwiLCJhZ2VudEluZm8iLCJwb3AiLCJzIiwiam9pbiIsImNvdW50Iiwib25saW5lQ291bnQiLCJvZmZsaW5lQ291bnQiLCJBMkFDbGllbnQiLCJhMmFDbGllbnQiLCJmcm9tQ2FyZFVybCIsImNvbnRyb2xsZXIiLCJBYm9ydENvbnRyb2xsZXIiLCJ0aW1lb3V0SWQiLCJhYm9ydCIsImZldGNoIiwic2lnbmFsIiwiY2xlYXJUaW1lb3V0IiwianNvbiIsImZldGNoRXJyb3IiLCJvcmNoZXN0cmF0ZVF1aXpXb3JrZmxvdyIsIndvcmtmbG93SWQiLCJkaWZmaWN1bHR5IiwicXVlc3Rpb25fY291bnQiLCJ3b3JrZmxvdyIsInN0ZXBzIiwiZGVwZW5kZW5jaWVzIiwiY3JlYXRlZEF0IiwiZXhlY3V0ZVdvcmtmbG93V2l0aENoYXQiLCJ3b3JrZmxvd19pZCIsIm9yY2hlc3RyYXRlTWFudWFsV29ya2Zsb3ciLCJwcm9tcHQiLCJjYWxsTWFudWFsQ3JlYXRvckFnZW50IiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJzdHJpbmdpZnkiLCJvayIsIm1hcmtkb3duQ29udGVudCIsInRpdGxlTWF0Y2giLCJtYXRjaCIsInRpdGxlIiwiaW50cm9NYXRjaCIsImludHJvZHVjdGlvbiIsInNlY3Rpb25zIiwic2VjdGlvblJlZ2V4Iiwic2VjdGlvbk1hdGNoIiwiZXhlYyIsInNlY3Rpb25UaXRsZSIsInNlY3Rpb25Db250ZW50Iiwic3Vic2VjdGlvbnMiLCJzdWJzZWN0aW9uUmVnZXgiLCJzdWJzZWN0aW9uTWF0Y2giLCJjb25jbHVzaW9uTWF0Y2giLCJjb25jbHVzaW9uIiwiZ2xvc3NhcnlNYXRjaCIsInJlZmVyZW5jZXNNYXRjaCIsInB1cnBvc2UiLCJhdWRpZW5jZSIsInByZXJlcXVpc2l0ZXMiLCJhcHBlbmRpeCIsImdsb3NzYXJ5IiwicmVzb3VyY2VzIiwibWFudWFsRGF0YSIsImpzb25NYXRjaCIsImV4dHJhY3RlZEpzb24iLCJleHRyYWN0RXJyb3IiLCJyZXN1bHRzIiwiZGVwZW5kZW5jeVJlc3VsdHMiLCJkZXBJZCIsImRlcFN0ZXAiLCJmaW5kIiwic29tZSIsInIiLCJjb21wbGV0ZWRBdCIsIm1lc3NhZ2VJZCIsInBhcnRzIiwia2luZCIsInRleHQiLCJjb25maWd1cmF0aW9uIiwiYmxvY2tpbmciLCJ0YXNrIiwiYXJ0aWZhY3RzIiwicXVpekFydGlmYWN0IiwiYXJ0aWZhY3QiLCJxdWl6VGV4dCIsInBhcnQiLCJxdWl6X3F1ZXN0aW9ucyIsIm1vbml0b3JTeXN0ZW1IZWFsdGgiLCJoZWFsdGhDaGVja3MiLCJlbmhhbmNlZEFnZW50cyIsImJyZWFrZXJTdGF0dXMiLCJnZXRTdGF0dXMiLCJhZ2VudEVudHJpZXMiLCJlbnRyaWVzIiwiaSIsImVhIiwicmVzcG9uc2VfdGltZSIsIm92ZXJhbGxIZWFsdGgiLCJldmVyeSIsImgiLCJvdmVyYWxsX2hlYWx0aCIsImNpcmN1aXRCcmVha2VycyIsImdldEFsbFN0YXRlcyIsImVuaGFuY2VkX21ldHJpY3MiLCJ0b3RhbEFnZW50cyIsIm9ubGluZUFnZW50cyIsImF2ZXJhZ2VSZWxpYWJpbGl0eSIsInJlZHVjZSIsInN1bSIsImF2ZXJhZ2VSZXNwb25zZVRpbWUiLCJjaGF0TWVzc2FnZSIsImdldFdvcmtmbG93Q2hhdEhpc3RvcnkiLCJjbGVhckNoYXRIaXN0b3J5IiwiZ2V0QWxsV29ya2Zsb3dzIiwiZ2V0V29ya2Zsb3ciLCJnZXRBZ2VudCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/orchestratorService.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Forchestrator%2Froute&page=%2Fapi%2Forchestrator%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Forchestrator%2Froute.ts&appDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CChan%20Dra%20Dev%5CAtoA_Protocol%5CA2%5CQuiz%5Cquiz-frontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();